var IO=Object.defineProperty;var DO=(e,t,n)=>t in e?IO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var T=(e,t,n)=>DO(e,typeof t!="symbol"?t+"":t,n);function PO(e,t){for(var n=0;n<t.length;n++){const s=t[n];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in e)){const r=Object.getOwnPropertyDescriptor(s,i);r&&Object.defineProperty(e,i,r.get?r:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();function Nm(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Jp={exports:{}},tl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lE;function FO(){if(lE)return tl;lE=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(s,i,r){var a=null;if(r!==void 0&&(a=""+r),i.key!==void 0&&(a=""+i.key),"key"in i){r={};for(var l in i)l!=="key"&&(r[l]=i[l])}else r=i;return i=r.ref,{$$typeof:e,type:s,key:a,ref:i!==void 0?i:null,props:r}}return tl.Fragment=t,tl.jsx=n,tl.jsxs=n,tl}var uE;function UO(){return uE||(uE=1,Jp.exports=FO()),Jp.exports}var pi=UO(),Zp={exports:{}},Ct={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hE;function LO(){if(hE)return Ct;hE=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),_=Symbol.iterator;function m(U){return U===null||typeof U!="object"?null:(U=_&&U[_]||U["@@iterator"],typeof U=="function"?U:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,b={};function R(U,st,ut){this.props=U,this.context=st,this.refs=b,this.updater=ut||y}R.prototype.isReactComponent={},R.prototype.setState=function(U,st){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,st,"setState")},R.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function M(){}M.prototype=R.prototype;function N(U,st,ut){this.props=U,this.context=st,this.refs=b,this.updater=ut||y}var O=N.prototype=new M;O.constructor=N,E(O,R.prototype),O.isPureReactComponent=!0;var x=Array.isArray,I={H:null,A:null,T:null,S:null,V:null},P=Object.prototype.hasOwnProperty;function J(U,st,ut,ht,_t,It){return ut=It.ref,{$$typeof:e,type:U,key:st,ref:ut!==void 0?ut:null,props:It}}function et(U,st){return J(U.type,st,void 0,void 0,void 0,U.props)}function q(U){return typeof U=="object"&&U!==null&&U.$$typeof===e}function Q(U){var st={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(ut){return st[ut]})}var rt=/\/+/g;function ct(U,st){return typeof U=="object"&&U!==null&&U.key!=null?Q(""+U.key):st.toString(36)}function ft(){}function Y(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(ft,ft):(U.status="pending",U.then(function(st){U.status==="pending"&&(U.status="fulfilled",U.value=st)},function(st){U.status==="pending"&&(U.status="rejected",U.reason=st)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function Tt(U,st,ut,ht,_t){var It=typeof U;(It==="undefined"||It==="boolean")&&(U=null);var vt=!1;if(U===null)vt=!0;else switch(It){case"bigint":case"string":case"number":vt=!0;break;case"object":switch(U.$$typeof){case e:case t:vt=!0;break;case g:return vt=U._init,Tt(vt(U._payload),st,ut,ht,_t)}}if(vt)return _t=_t(U),vt=ht===""?"."+ct(U,0):ht,x(_t)?(ut="",vt!=null&&(ut=vt.replace(rt,"$&/")+"/"),Tt(_t,st,ut,"",function($t){return $t})):_t!=null&&(q(_t)&&(_t=et(_t,ut+(_t.key==null||U&&U.key===_t.key?"":(""+_t.key).replace(rt,"$&/")+"/")+vt)),st.push(_t)),1;vt=0;var jt=ht===""?".":ht+":";if(x(U))for(var Ut=0;Ut<U.length;Ut++)ht=U[Ut],It=jt+ct(ht,Ut),vt+=Tt(ht,st,ut,It,_t);else if(Ut=m(U),typeof Ut=="function")for(U=Ut.call(U),Ut=0;!(ht=U.next()).done;)ht=ht.value,It=jt+ct(ht,Ut++),vt+=Tt(ht,st,ut,It,_t);else if(It==="object"){if(typeof U.then=="function")return Tt(Y(U),st,ut,ht,_t);throw st=String(U),Error("Objects are not valid as a React child (found: "+(st==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":st)+"). If you meant to render a collection of children, use an array instead.")}return vt}function K(U,st,ut){if(U==null)return U;var ht=[],_t=0;return Tt(U,ht,"","",function(It){return st.call(ut,It,_t++)}),ht}function lt(U){if(U._status===-1){var st=U._result;st=st(),st.then(function(ut){(U._status===0||U._status===-1)&&(U._status=1,U._result=ut)},function(ut){(U._status===0||U._status===-1)&&(U._status=2,U._result=ut)}),U._status===-1&&(U._status=0,U._result=st)}if(U._status===1)return U._result.default;throw U._result}var At=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var st=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(st))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)};function Pt(){}return Ct.Children={map:K,forEach:function(U,st,ut){K(U,function(){st.apply(this,arguments)},ut)},count:function(U){var st=0;return K(U,function(){st++}),st},toArray:function(U){return K(U,function(st){return st})||[]},only:function(U){if(!q(U))throw Error("React.Children.only expected to receive a single React element child.");return U}},Ct.Component=R,Ct.Fragment=n,Ct.Profiler=i,Ct.PureComponent=N,Ct.StrictMode=s,Ct.Suspense=h,Ct.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,Ct.__COMPILER_RUNTIME={__proto__:null,c:function(U){return I.H.useMemoCache(U)}},Ct.cache=function(U){return function(){return U.apply(null,arguments)}},Ct.cloneElement=function(U,st,ut){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var ht=E({},U.props),_t=U.key,It=void 0;if(st!=null)for(vt in st.ref!==void 0&&(It=void 0),st.key!==void 0&&(_t=""+st.key),st)!P.call(st,vt)||vt==="key"||vt==="__self"||vt==="__source"||vt==="ref"&&st.ref===void 0||(ht[vt]=st[vt]);var vt=arguments.length-2;if(vt===1)ht.children=ut;else if(1<vt){for(var jt=Array(vt),Ut=0;Ut<vt;Ut++)jt[Ut]=arguments[Ut+2];ht.children=jt}return J(U.type,_t,void 0,void 0,It,ht)},Ct.createContext=function(U){return U={$$typeof:a,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:r,_context:U},U},Ct.createElement=function(U,st,ut){var ht,_t={},It=null;if(st!=null)for(ht in st.key!==void 0&&(It=""+st.key),st)P.call(st,ht)&&ht!=="key"&&ht!=="__self"&&ht!=="__source"&&(_t[ht]=st[ht]);var vt=arguments.length-2;if(vt===1)_t.children=ut;else if(1<vt){for(var jt=Array(vt),Ut=0;Ut<vt;Ut++)jt[Ut]=arguments[Ut+2];_t.children=jt}if(U&&U.defaultProps)for(ht in vt=U.defaultProps,vt)_t[ht]===void 0&&(_t[ht]=vt[ht]);return J(U,It,void 0,void 0,null,_t)},Ct.createRef=function(){return{current:null}},Ct.forwardRef=function(U){return{$$typeof:l,render:U}},Ct.isValidElement=q,Ct.lazy=function(U){return{$$typeof:g,_payload:{_status:-1,_result:U},_init:lt}},Ct.memo=function(U,st){return{$$typeof:d,type:U,compare:st===void 0?null:st}},Ct.startTransition=function(U){var st=I.T,ut={};I.T=ut;try{var ht=U(),_t=I.S;_t!==null&&_t(ut,ht),typeof ht=="object"&&ht!==null&&typeof ht.then=="function"&&ht.then(Pt,At)}catch(It){At(It)}finally{I.T=st}},Ct.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},Ct.use=function(U){return I.H.use(U)},Ct.useActionState=function(U,st,ut){return I.H.useActionState(U,st,ut)},Ct.useCallback=function(U,st){return I.H.useCallback(U,st)},Ct.useContext=function(U){return I.H.useContext(U)},Ct.useDebugValue=function(){},Ct.useDeferredValue=function(U,st){return I.H.useDeferredValue(U,st)},Ct.useEffect=function(U,st,ut){var ht=I.H;if(typeof ut=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ht.useEffect(U,st)},Ct.useId=function(){return I.H.useId()},Ct.useImperativeHandle=function(U,st,ut){return I.H.useImperativeHandle(U,st,ut)},Ct.useInsertionEffect=function(U,st){return I.H.useInsertionEffect(U,st)},Ct.useLayoutEffect=function(U,st){return I.H.useLayoutEffect(U,st)},Ct.useMemo=function(U,st){return I.H.useMemo(U,st)},Ct.useOptimistic=function(U,st){return I.H.useOptimistic(U,st)},Ct.useReducer=function(U,st,ut){return I.H.useReducer(U,st,ut)},Ct.useRef=function(U){return I.H.useRef(U)},Ct.useState=function(U){return I.H.useState(U)},Ct.useSyncExternalStore=function(U,st,ut){return I.H.useSyncExternalStore(U,st,ut)},Ct.useTransition=function(){return I.H.useTransition()},Ct.version="19.1.0",Ct}var fE;function Im(){return fE||(fE=1,Zp.exports=LO()),Zp.exports}var mt=Im();const kO=Nm(mt);var Qp={exports:{}},el={},t_={exports:{}},e_={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dE;function zO(){return dE||(dE=1,function(e){function t(K,lt){var At=K.length;K.push(lt);t:for(;0<At;){var Pt=At-1>>>1,U=K[Pt];if(0<i(U,lt))K[Pt]=lt,K[At]=U,At=Pt;else break t}}function n(K){return K.length===0?null:K[0]}function s(K){if(K.length===0)return null;var lt=K[0],At=K.pop();if(At!==lt){K[0]=At;t:for(var Pt=0,U=K.length,st=U>>>1;Pt<st;){var ut=2*(Pt+1)-1,ht=K[ut],_t=ut+1,It=K[_t];if(0>i(ht,At))_t<U&&0>i(It,ht)?(K[Pt]=It,K[_t]=At,Pt=_t):(K[Pt]=ht,K[ut]=At,Pt=ut);else if(_t<U&&0>i(It,At))K[Pt]=It,K[_t]=At,Pt=_t;else break t}}return lt}function i(K,lt){var At=K.sortIndex-lt.sortIndex;return At!==0?At:K.id-lt.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;e.unstable_now=function(){return r.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var h=[],d=[],g=1,_=null,m=3,y=!1,E=!1,b=!1,R=!1,M=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function x(K){for(var lt=n(d);lt!==null;){if(lt.callback===null)s(d);else if(lt.startTime<=K)s(d),lt.sortIndex=lt.expirationTime,t(h,lt);else break;lt=n(d)}}function I(K){if(b=!1,x(K),!E)if(n(h)!==null)E=!0,P||(P=!0,ct());else{var lt=n(d);lt!==null&&Tt(I,lt.startTime-K)}}var P=!1,J=-1,et=5,q=-1;function Q(){return R?!0:!(e.unstable_now()-q<et)}function rt(){if(R=!1,P){var K=e.unstable_now();q=K;var lt=!0;try{t:{E=!1,b&&(b=!1,N(J),J=-1),y=!0;var At=m;try{e:{for(x(K),_=n(h);_!==null&&!(_.expirationTime>K&&Q());){var Pt=_.callback;if(typeof Pt=="function"){_.callback=null,m=_.priorityLevel;var U=Pt(_.expirationTime<=K);if(K=e.unstable_now(),typeof U=="function"){_.callback=U,x(K),lt=!0;break e}_===n(h)&&s(h),x(K)}else s(h);_=n(h)}if(_!==null)lt=!0;else{var st=n(d);st!==null&&Tt(I,st.startTime-K),lt=!1}}break t}finally{_=null,m=At,y=!1}lt=void 0}}finally{lt?ct():P=!1}}}var ct;if(typeof O=="function")ct=function(){O(rt)};else if(typeof MessageChannel<"u"){var ft=new MessageChannel,Y=ft.port2;ft.port1.onmessage=rt,ct=function(){Y.postMessage(null)}}else ct=function(){M(rt,0)};function Tt(K,lt){J=M(function(){K(e.unstable_now())},lt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(K){K.callback=null},e.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):et=0<K?Math.floor(1e3/K):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_next=function(K){switch(m){case 1:case 2:case 3:var lt=3;break;default:lt=m}var At=m;m=lt;try{return K()}finally{m=At}},e.unstable_requestPaint=function(){R=!0},e.unstable_runWithPriority=function(K,lt){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var At=m;m=K;try{return lt()}finally{m=At}},e.unstable_scheduleCallback=function(K,lt,At){var Pt=e.unstable_now();switch(typeof At=="object"&&At!==null?(At=At.delay,At=typeof At=="number"&&0<At?Pt+At:Pt):At=Pt,K){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=At+U,K={id:g++,callback:lt,priorityLevel:K,startTime:At,expirationTime:U,sortIndex:-1},At>Pt?(K.sortIndex=At,t(d,K),n(h)===null&&K===n(d)&&(b?(N(J),J=-1):b=!0,Tt(I,At-Pt))):(K.sortIndex=U,t(h,K),E||y||(E=!0,P||(P=!0,ct()))),K},e.unstable_shouldYield=Q,e.unstable_wrapCallback=function(K){var lt=m;return function(){var At=m;m=lt;try{return K.apply(this,arguments)}finally{m=At}}}}(e_)),e_}var gE;function VO(){return gE||(gE=1,t_.exports=zO()),t_.exports}var n_={exports:{}},Je={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pE;function HO(){if(pE)return Je;pE=1;var e=Im();function t(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var s={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},i=Symbol.for("react.portal");function r(h,d,g){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:_==null?null:""+_,children:h,containerInfo:d,implementation:g}}var a=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Je.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Je.createPortal=function(h,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return r(h,d,null,g)},Je.flushSync=function(h){var d=a.T,g=s.p;try{if(a.T=null,s.p=2,h)return h()}finally{a.T=d,s.p=g,s.d.f()}},Je.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,s.d.C(h,d))},Je.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},Je.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var g=d.as,_=l(g,d.crossOrigin),m=typeof d.integrity=="string"?d.integrity:void 0,y=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;g==="style"?s.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:_,integrity:m,fetchPriority:y}):g==="script"&&s.d.X(h,{crossOrigin:_,integrity:m,fetchPriority:y,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Je.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var g=l(d.as,d.crossOrigin);s.d.M(h,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&s.d.M(h)},Je.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var g=d.as,_=l(g,d.crossOrigin);s.d.L(h,g,{crossOrigin:_,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Je.preloadModule=function(h,d){if(typeof h=="string")if(d){var g=l(d.as,d.crossOrigin);s.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else s.d.m(h)},Je.requestFormReset=function(h){s.d.r(h)},Je.unstable_batchedUpdates=function(h,d){return h(d)},Je.useFormState=function(h,d,g){return a.H.useFormState(h,d,g)},Je.useFormStatus=function(){return a.H.useHostTransitionStatus()},Je.version="19.1.0",Je}var _E;function y3(){if(_E)return n_.exports;_E=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),n_.exports=HO(),n_.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mE;function jO(){if(mE)return el;mE=1;var e=VO(),t=Im(),n=y3();function s(o){var c="https://react.dev/errors/"+o;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)c+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+o+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function r(o){var c=o,u=o;if(o.alternate)for(;c.return;)c=c.return;else{o=c;do c=o,(c.flags&4098)!==0&&(u=c.return),o=c.return;while(o)}return c.tag===3?u:null}function a(o){if(o.tag===13){var c=o.memoizedState;if(c===null&&(o=o.alternate,o!==null&&(c=o.memoizedState)),c!==null)return c.dehydrated}return null}function l(o){if(r(o)!==o)throw Error(s(188))}function h(o){var c=o.alternate;if(!c){if(c=r(o),c===null)throw Error(s(188));return c!==o?null:o}for(var u=o,f=c;;){var p=u.return;if(p===null)break;var A=p.alternate;if(A===null){if(f=p.return,f!==null){u=f;continue}break}if(p.child===A.child){for(A=p.child;A;){if(A===u)return l(p),o;if(A===f)return l(p),c;A=A.sibling}throw Error(s(188))}if(u.return!==f.return)u=p,f=A;else{for(var S=!1,C=p.child;C;){if(C===u){S=!0,u=p,f=A;break}if(C===f){S=!0,f=p,u=A;break}C=C.sibling}if(!S){for(C=A.child;C;){if(C===u){S=!0,u=A,f=p;break}if(C===f){S=!0,f=A,u=p;break}C=C.sibling}if(!S)throw Error(s(189))}}if(u.alternate!==f)throw Error(s(190))}if(u.tag!==3)throw Error(s(188));return u.stateNode.current===u?o:c}function d(o){var c=o.tag;if(c===5||c===26||c===27||c===6)return o;for(o=o.child;o!==null;){if(c=d(o),c!==null)return c;o=o.sibling}return null}var g=Object.assign,_=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),N=Symbol.for("react.consumer"),O=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),J=Symbol.for("react.memo"),et=Symbol.for("react.lazy"),q=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),rt=Symbol.iterator;function ct(o){return o===null||typeof o!="object"?null:(o=rt&&o[rt]||o["@@iterator"],typeof o=="function"?o:null)}var ft=Symbol.for("react.client.reference");function Y(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===ft?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case E:return"Fragment";case R:return"Profiler";case b:return"StrictMode";case I:return"Suspense";case P:return"SuspenseList";case q:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case y:return"Portal";case O:return(o.displayName||"Context")+".Provider";case N:return(o._context.displayName||"Context")+".Consumer";case x:var c=o.render;return o=o.displayName,o||(o=c.displayName||c.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case J:return c=o.displayName||null,c!==null?c:Y(o.type)||"Memo";case et:c=o._payload,o=o._init;try{return Y(o(c))}catch{}}return null}var Tt=Array.isArray,K=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,lt=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,At={pending:!1,data:null,method:null,action:null},Pt=[],U=-1;function st(o){return{current:o}}function ut(o){0>U||(o.current=Pt[U],Pt[U]=null,U--)}function ht(o,c){U++,Pt[U]=o.current,o.current=c}var _t=st(null),It=st(null),vt=st(null),jt=st(null);function Ut(o,c){switch(ht(vt,c),ht(It,o),ht(_t,null),c.nodeType){case 9:case 11:o=(o=c.documentElement)&&(o=o.namespaceURI)?UT(o):0;break;default:if(o=c.tagName,c=c.namespaceURI)c=UT(c),o=LT(c,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}ut(_t),ht(_t,o)}function $t(){ut(_t),ut(It),ut(vt)}function xe(o){o.memoizedState!==null&&ht(jt,o);var c=_t.current,u=LT(c,o.type);c!==u&&(ht(It,o),ht(_t,u))}function Xs(o){It.current===o&&(ut(_t),ut(It)),jt.current===o&&(ut(jt),Yc._currentValue=At)}var Gs=Object.prototype.hasOwnProperty,Ws=e.unstable_scheduleCallback,qs=e.unstable_cancelCallback,Er=e.unstable_shouldYield,Vn=e.unstable_requestPaint,Ne=e.unstable_now,cu=e.unstable_getCurrentPriorityLevel,ec=e.unstable_ImmediatePriority,br=e.unstable_UserBlockingPriority,ke=e.unstable_NormalPriority,Wd=e.unstable_LowPriority,lu=e.unstable_IdlePriority,qd=e.log,Yd=e.unstable_setDisableYieldValue,Sr=null,Ge=null;function ss(o){if(typeof qd=="function"&&Yd(o),Ge&&typeof Ge.setStrictMode=="function")try{Ge.setStrictMode(Sr,o)}catch{}}var We=Math.clz32?Math.clz32:nc,uu=Math.log,go=Math.LN2;function nc(o){return o>>>=0,o===0?32:31-(uu(o)/go|0)|0}var po=256,_o=4194304;function Ys(o){var c=o&42;if(c!==0)return c;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function mo(o,c,u){var f=o.pendingLanes;if(f===0)return 0;var p=0,A=o.suspendedLanes,S=o.pingedLanes;o=o.warmLanes;var C=f&134217727;return C!==0?(f=C&~A,f!==0?p=Ys(f):(S&=C,S!==0?p=Ys(S):u||(u=C&~o,u!==0&&(p=Ys(u))))):(C=f&~A,C!==0?p=Ys(C):S!==0?p=Ys(S):u||(u=f&~o,u!==0&&(p=Ys(u)))),p===0?0:c!==0&&c!==p&&(c&A)===0&&(A=p&-p,u=c&-c,A>=u||A===32&&(u&4194048)!==0)?c:p}function Rr(o,c){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&c)===0}function Ao(o,c){switch(o){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hu(){var o=po;return po<<=1,(po&4194048)===0&&(po=256),o}function fu(){var o=_o;return _o<<=1,(_o&62914560)===0&&(_o=4194304),o}function yo(o){for(var c=[],u=0;31>u;u++)c.push(o);return c}function Ri(o,c){o.pendingLanes|=c,c!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function sc(o,c,u,f,p,A){var S=o.pendingLanes;o.pendingLanes=u,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=u,o.entangledLanes&=u,o.errorRecoveryDisabledLanes&=u,o.shellSuspendCounter=0;var C=o.entanglements,D=o.expirationTimes,$=o.hiddenUpdates;for(u=S&~u;0<u;){var Z=31-We(u),nt=1<<Z;C[Z]=0,D[Z]=-1;var X=$[Z];if(X!==null)for($[Z]=null,Z=0;Z<X.length;Z++){var W=X[Z];W!==null&&(W.lane&=-536870913)}u&=~nt}f!==0&&du(o,f,0),A!==0&&p===0&&o.tag!==0&&(o.suspendedLanes|=A&~(S&~c))}function du(o,c,u){o.pendingLanes|=c,o.suspendedLanes&=~c;var f=31-We(c);o.entangledLanes|=c,o.entanglements[f]=o.entanglements[f]|1073741824|u&4194090}function gu(o,c){var u=o.entangledLanes|=c;for(o=o.entanglements;u;){var f=31-We(u),p=1<<f;p&c|o[f]&c&&(o[f]|=c),u&=~p}}function ic(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function To(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function pu(){var o=lt.p;return o!==0?o:(o=window.event,o===void 0?32:sE(o.type))}function Kd(o,c){var u=lt.p;try{return lt.p=o,c()}finally{lt.p=u}}var Ts=Math.random().toString(36).slice(2),me="__reactFiber$"+Ts,qe="__reactProps$"+Ts,vi="__reactContainer$"+Ts,Eo="__reactEvents$"+Ts,rc="__reactListeners$"+Ts,Jd="__reactHandles$"+Ts,oc="__reactResources$"+Ts,vr="__reactMarker$"+Ts;function bo(o){delete o[me],delete o[qe],delete o[Eo],delete o[rc],delete o[Jd]}function Ks(o){var c=o[me];if(c)return c;for(var u=o.parentNode;u;){if(c=u[vi]||u[me]){if(u=c.alternate,c.child!==null||u!==null&&u.child!==null)for(o=HT(o);o!==null;){if(u=o[me])return u;o=HT(o)}return c}o=u,u=o.parentNode}return null}function Js(o){if(o=o[me]||o[vi]){var c=o.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return o}return null}function Ci(o){var c=o.tag;if(c===5||c===26||c===27||c===6)return o.stateNode;throw Error(s(33))}function Es(o){var c=o[oc];return c||(c=o[oc]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function oe(o){o[vr]=!0}var Mi=new Set,wi={};function Hn(o,c){bs(o,c),bs(o+"Capture",c)}function bs(o,c){for(wi[o]=c,o=0;o<c.length;o++)Mi.add(c[o])}var Zd=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),_u={},Cr={};function an(o){return Gs.call(Cr,o)?!0:Gs.call(_u,o)?!1:Zd.test(o)?Cr[o]=!0:(_u[o]=!0,!1)}function is(o,c,u){if(an(c))if(u===null)o.removeAttribute(c);else{switch(typeof u){case"undefined":case"function":case"symbol":o.removeAttribute(c);return;case"boolean":var f=c.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){o.removeAttribute(c);return}}o.setAttribute(c,""+u)}}function Rn(o,c,u){if(u===null)o.removeAttribute(c);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(c);return}o.setAttribute(c,""+u)}}function Ce(o,c,u,f){if(f===null)o.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(u);return}o.setAttributeNS(c,u,""+f)}}var Zs,vn;function Ye(o){if(Zs===void 0)try{throw Error()}catch(u){var c=u.stack.trim().match(/\n( *(at )?)/);Zs=c&&c[1]||"",vn=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Zs+o+vn}var So=!1;function Ro(o,c){if(!o||So)return"";So=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(c){var nt=function(){throw Error()};if(Object.defineProperty(nt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(nt,[])}catch(W){var X=W}Reflect.construct(o,[],nt)}else{try{nt.call()}catch(W){X=W}o.call(nt.prototype)}}else{try{throw Error()}catch(W){X=W}(nt=o())&&typeof nt.catch=="function"&&nt.catch(function(){})}}catch(W){if(W&&X&&typeof W.stack=="string")return[W.stack,X.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=f.DetermineComponentFrameRoot(),S=A[0],C=A[1];if(S&&C){var D=S.split(`
`),$=C.split(`
`);for(p=f=0;f<D.length&&!D[f].includes("DetermineComponentFrameRoot");)f++;for(;p<$.length&&!$[p].includes("DetermineComponentFrameRoot");)p++;if(f===D.length||p===$.length)for(f=D.length-1,p=$.length-1;1<=f&&0<=p&&D[f]!==$[p];)p--;for(;1<=f&&0<=p;f--,p--)if(D[f]!==$[p]){if(f!==1||p!==1)do if(f--,p--,0>p||D[f]!==$[p]){var Z=`
`+D[f].replace(" at new "," at ");return o.displayName&&Z.includes("<anonymous>")&&(Z=Z.replace("<anonymous>",o.displayName)),Z}while(1<=f&&0<=p);break}}}finally{So=!1,Error.prepareStackTrace=u}return(u=o?o.displayName||o.name:"")?Ye(u):""}function vo(o){switch(o.tag){case 26:case 27:case 5:return Ye(o.type);case 16:return Ye("Lazy");case 13:return Ye("Suspense");case 19:return Ye("SuspenseList");case 0:case 15:return Ro(o.type,!1);case 11:return Ro(o.type.render,!1);case 1:return Ro(o.type,!0);case 31:return Ye("Activity");default:return""}}function cn(o){try{var c="";do c+=vo(o),o=o.return;while(o);return c}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function ze(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Co(o){var c=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function ac(o){var c=Co(o)?"checked":"value",u=Object.getOwnPropertyDescriptor(o.constructor.prototype,c),f=""+o[c];if(!o.hasOwnProperty(c)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var p=u.get,A=u.set;return Object.defineProperty(o,c,{configurable:!0,get:function(){return p.call(this)},set:function(S){f=""+S,A.call(this,S)}}),Object.defineProperty(o,c,{enumerable:u.enumerable}),{getValue:function(){return f},setValue:function(S){f=""+S},stopTracking:function(){o._valueTracker=null,delete o[c]}}}}function Oi(o){o._valueTracker||(o._valueTracker=ac(o))}function Mo(o){if(!o)return!1;var c=o._valueTracker;if(!c)return!0;var u=c.getValue(),f="";return o&&(f=Co(o)?o.checked?"true":"false":o.value),o=f,o!==u?(c.setValue(o),!0):!1}function Qs(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var Ss=/[\n"\\]/g;function ln(o){return o.replace(Ss,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function wo(o,c,u,f,p,A,S,C){o.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?o.type=S:o.removeAttribute("type"),c!=null?S==="number"?(c===0&&o.value===""||o.value!=c)&&(o.value=""+ze(c)):o.value!==""+ze(c)&&(o.value=""+ze(c)):S!=="submit"&&S!=="reset"||o.removeAttribute("value"),c!=null?Bo(o,S,ze(c)):u!=null?Bo(o,S,ze(u)):f!=null&&o.removeAttribute("value"),p==null&&A!=null&&(o.defaultChecked=!!A),p!=null&&(o.checked=p&&typeof p!="function"&&typeof p!="symbol"),C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?o.name=""+ze(C):o.removeAttribute("name")}function Oo(o,c,u,f,p,A,S,C){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(o.type=A),c!=null||u!=null){if(!(A!=="submit"&&A!=="reset"||c!=null))return;u=u!=null?""+ze(u):"",c=c!=null?""+ze(c):u,C||c===o.value||(o.value=c),o.defaultValue=c}f=f??p,f=typeof f!="function"&&typeof f!="symbol"&&!!f,o.checked=C?o.checked:!!f,o.defaultChecked=!!f,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(o.name=S)}function Bo(o,c,u){c==="number"&&Qs(o.ownerDocument)===o||o.defaultValue===""+u||(o.defaultValue=""+u)}function Bi(o,c,u,f){if(o=o.options,c){c={};for(var p=0;p<u.length;p++)c["$"+u[p]]=!0;for(u=0;u<o.length;u++)p=c.hasOwnProperty("$"+o[u].value),o[u].selected!==p&&(o[u].selected=p),p&&f&&(o[u].defaultSelected=!0)}else{for(u=""+ze(u),c=null,p=0;p<o.length;p++){if(o[p].value===u){o[p].selected=!0,f&&(o[p].defaultSelected=!0);return}c!==null||o[p].disabled||(c=o[p])}c!==null&&(c.selected=!0)}}function mu(o,c,u){if(c!=null&&(c=""+ze(c),c!==o.value&&(o.value=c),u==null)){o.defaultValue!==c&&(o.defaultValue=c);return}o.defaultValue=u!=null?""+ze(u):""}function v(o,c,u,f){if(c==null){if(f!=null){if(u!=null)throw Error(s(92));if(Tt(f)){if(1<f.length)throw Error(s(93));f=f[0]}u=f}u==null&&(u=""),c=u}u=ze(c),o.defaultValue=u,f=o.textContent,f===u&&f!==""&&f!==null&&(o.value=f)}function w(o,c){if(c){var u=o.firstChild;if(u&&u===o.lastChild&&u.nodeType===3){u.nodeValue=c;return}}o.textContent=c}var F=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function G(o,c,u){var f=c.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?f?o.setProperty(c,""):c==="float"?o.cssFloat="":o[c]="":f?o.setProperty(c,u):typeof u!="number"||u===0||F.has(c)?c==="float"?o.cssFloat=u:o[c]=(""+u).trim():o[c]=u+"px"}function it(o,c,u){if(c!=null&&typeof c!="object")throw Error(s(62));if(o=o.style,u!=null){for(var f in u)!u.hasOwnProperty(f)||c!=null&&c.hasOwnProperty(f)||(f.indexOf("--")===0?o.setProperty(f,""):f==="float"?o.cssFloat="":o[f]="");for(var p in c)f=c[p],c.hasOwnProperty(p)&&u[p]!==f&&G(o,p,f)}else for(var A in c)c.hasOwnProperty(A)&&G(o,A,c[A])}function dt(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Te=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function de(o){return Te.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}var Me=null;function un(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var xo=null,No=null;function k1(o){var c=Js(o);if(c&&(o=c.stateNode)){var u=o[qe]||null;t:switch(o=c.stateNode,c.type){case"input":if(wo(o,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),c=u.name,u.type==="radio"&&c!=null){for(u=o;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+ln(""+c)+'"][type="radio"]'),c=0;c<u.length;c++){var f=u[c];if(f!==o&&f.form===o.form){var p=f[qe]||null;if(!p)throw Error(s(90));wo(f,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(c=0;c<u.length;c++)f=u[c],f.form===o.form&&Mo(f)}break t;case"textarea":mu(o,u.value,u.defaultValue);break t;case"select":c=u.value,c!=null&&Bi(o,!!u.multiple,c,!1)}}}var Qd=!1;function z1(o,c,u){if(Qd)return o(c,u);Qd=!0;try{var f=o(c);return f}finally{if(Qd=!1,(xo!==null||No!==null)&&(nh(),xo&&(c=xo,o=No,No=xo=null,k1(c),o)))for(c=0;c<o.length;c++)k1(o[c])}}function cc(o,c){var u=o.stateNode;if(u===null)return null;var f=u[qe]||null;if(f===null)return null;u=f[c];t:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(o=o.type,f=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!f;break t;default:o=!1}if(o)return null;if(u&&typeof u!="function")throw Error(s(231,c,typeof u));return u}var ti=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tg=!1;if(ti)try{var lc={};Object.defineProperty(lc,"passive",{get:function(){tg=!0}}),window.addEventListener("test",lc,lc),window.removeEventListener("test",lc,lc)}catch{tg=!1}var xi=null,eg=null,Au=null;function V1(){if(Au)return Au;var o,c=eg,u=c.length,f,p="value"in xi?xi.value:xi.textContent,A=p.length;for(o=0;o<u&&c[o]===p[o];o++);var S=u-o;for(f=1;f<=S&&c[u-f]===p[A-f];f++);return Au=p.slice(o,1<f?1-f:void 0)}function yu(o){var c=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&c===13&&(o=13)):o=c,o===10&&(o=13),32<=o||o===13?o:0}function Tu(){return!0}function H1(){return!1}function hn(o){function c(u,f,p,A,S){this._reactName=u,this._targetInst=p,this.type=f,this.nativeEvent=A,this.target=S,this.currentTarget=null;for(var C in o)o.hasOwnProperty(C)&&(u=o[C],this[C]=u?u(A):A[C]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?Tu:H1,this.isPropagationStopped=H1,this}return g(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Tu)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Tu)},persist:function(){},isPersistent:Tu}),c}var Mr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Eu=hn(Mr),uc=g({},Mr,{view:0,detail:0}),IM=hn(uc),ng,sg,hc,bu=g({},uc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rg,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==hc&&(hc&&o.type==="mousemove"?(ng=o.screenX-hc.screenX,sg=o.screenY-hc.screenY):sg=ng=0,hc=o),ng)},movementY:function(o){return"movementY"in o?o.movementY:sg}}),j1=hn(bu),DM=g({},bu,{dataTransfer:0}),PM=hn(DM),FM=g({},uc,{relatedTarget:0}),ig=hn(FM),UM=g({},Mr,{animationName:0,elapsedTime:0,pseudoElement:0}),LM=hn(UM),kM=g({},Mr,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),zM=hn(kM),VM=g({},Mr,{data:0}),$1=hn(VM),HM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$M={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function XM(o){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(o):(o=$M[o])?!!c[o]:!1}function rg(){return XM}var GM=g({},uc,{key:function(o){if(o.key){var c=HM[o.key]||o.key;if(c!=="Unidentified")return c}return o.type==="keypress"?(o=yu(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?jM[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rg,charCode:function(o){return o.type==="keypress"?yu(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?yu(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),WM=hn(GM),qM=g({},bu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),X1=hn(qM),YM=g({},uc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rg}),KM=hn(YM),JM=g({},Mr,{propertyName:0,elapsedTime:0,pseudoElement:0}),ZM=hn(JM),QM=g({},bu,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),tw=hn(QM),ew=g({},Mr,{newState:0,oldState:0}),nw=hn(ew),sw=[9,13,27,32],og=ti&&"CompositionEvent"in window,fc=null;ti&&"documentMode"in document&&(fc=document.documentMode);var iw=ti&&"TextEvent"in window&&!fc,G1=ti&&(!og||fc&&8<fc&&11>=fc),W1=" ",q1=!1;function Y1(o,c){switch(o){case"keyup":return sw.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function K1(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var Io=!1;function rw(o,c){switch(o){case"compositionend":return K1(c);case"keypress":return c.which!==32?null:(q1=!0,W1);case"textInput":return o=c.data,o===W1&&q1?null:o;default:return null}}function ow(o,c){if(Io)return o==="compositionend"||!og&&Y1(o,c)?(o=V1(),Au=eg=xi=null,Io=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return G1&&c.locale!=="ko"?null:c.data;default:return null}}var aw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function J1(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c==="input"?!!aw[o.type]:c==="textarea"}function Z1(o,c,u,f){xo?No?No.push(f):No=[f]:xo=f,c=ch(c,"onChange"),0<c.length&&(u=new Eu("onChange","change",null,u,f),o.push({event:u,listeners:c}))}var dc=null,gc=null;function cw(o){NT(o,0)}function Su(o){var c=Ci(o);if(Mo(c))return o}function Q1(o,c){if(o==="change")return c}var tA=!1;if(ti){var ag;if(ti){var cg="oninput"in document;if(!cg){var eA=document.createElement("div");eA.setAttribute("oninput","return;"),cg=typeof eA.oninput=="function"}ag=cg}else ag=!1;tA=ag&&(!document.documentMode||9<document.documentMode)}function nA(){dc&&(dc.detachEvent("onpropertychange",sA),gc=dc=null)}function sA(o){if(o.propertyName==="value"&&Su(gc)){var c=[];Z1(c,gc,o,un(o)),z1(cw,c)}}function lw(o,c,u){o==="focusin"?(nA(),dc=c,gc=u,dc.attachEvent("onpropertychange",sA)):o==="focusout"&&nA()}function uw(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Su(gc)}function hw(o,c){if(o==="click")return Su(c)}function fw(o,c){if(o==="input"||o==="change")return Su(c)}function dw(o,c){return o===c&&(o!==0||1/o===1/c)||o!==o&&c!==c}var Cn=typeof Object.is=="function"?Object.is:dw;function pc(o,c){if(Cn(o,c))return!0;if(typeof o!="object"||o===null||typeof c!="object"||c===null)return!1;var u=Object.keys(o),f=Object.keys(c);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var p=u[f];if(!Gs.call(c,p)||!Cn(o[p],c[p]))return!1}return!0}function iA(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function rA(o,c){var u=iA(o);o=0;for(var f;u;){if(u.nodeType===3){if(f=o+u.textContent.length,o<=c&&f>=c)return{node:u,offset:c-o};o=f}t:{for(;u;){if(u.nextSibling){u=u.nextSibling;break t}u=u.parentNode}u=void 0}u=iA(u)}}function oA(o,c){return o&&c?o===c?!0:o&&o.nodeType===3?!1:c&&c.nodeType===3?oA(o,c.parentNode):"contains"in o?o.contains(c):o.compareDocumentPosition?!!(o.compareDocumentPosition(c)&16):!1:!1}function aA(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var c=Qs(o.document);c instanceof o.HTMLIFrameElement;){try{var u=typeof c.contentWindow.location.href=="string"}catch{u=!1}if(u)o=c.contentWindow;else break;c=Qs(o.document)}return c}function lg(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c&&(c==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||c==="textarea"||o.contentEditable==="true")}var gw=ti&&"documentMode"in document&&11>=document.documentMode,Do=null,ug=null,_c=null,hg=!1;function cA(o,c,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;hg||Do==null||Do!==Qs(f)||(f=Do,"selectionStart"in f&&lg(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),_c&&pc(_c,f)||(_c=f,f=ch(ug,"onSelect"),0<f.length&&(c=new Eu("onSelect","select",null,c,u),o.push({event:c,listeners:f}),c.target=Do)))}function wr(o,c){var u={};return u[o.toLowerCase()]=c.toLowerCase(),u["Webkit"+o]="webkit"+c,u["Moz"+o]="moz"+c,u}var Po={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionrun:wr("Transition","TransitionRun"),transitionstart:wr("Transition","TransitionStart"),transitioncancel:wr("Transition","TransitionCancel"),transitionend:wr("Transition","TransitionEnd")},fg={},lA={};ti&&(lA=document.createElement("div").style,"AnimationEvent"in window||(delete Po.animationend.animation,delete Po.animationiteration.animation,delete Po.animationstart.animation),"TransitionEvent"in window||delete Po.transitionend.transition);function Or(o){if(fg[o])return fg[o];if(!Po[o])return o;var c=Po[o],u;for(u in c)if(c.hasOwnProperty(u)&&u in lA)return fg[o]=c[u];return o}var uA=Or("animationend"),hA=Or("animationiteration"),fA=Or("animationstart"),pw=Or("transitionrun"),_w=Or("transitionstart"),mw=Or("transitioncancel"),dA=Or("transitionend"),gA=new Map,dg="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");dg.push("scrollEnd");function rs(o,c){gA.set(o,c),Hn(c,[o])}var pA=new WeakMap;function jn(o,c){if(typeof o=="object"&&o!==null){var u=pA.get(o);return u!==void 0?u:(c={value:o,source:c,stack:cn(c)},pA.set(o,c),c)}return{value:o,source:c,stack:cn(c)}}var $n=[],Fo=0,gg=0;function Ru(){for(var o=Fo,c=gg=Fo=0;c<o;){var u=$n[c];$n[c++]=null;var f=$n[c];$n[c++]=null;var p=$n[c];$n[c++]=null;var A=$n[c];if($n[c++]=null,f!==null&&p!==null){var S=f.pending;S===null?p.next=p:(p.next=S.next,S.next=p),f.pending=p}A!==0&&_A(u,p,A)}}function vu(o,c,u,f){$n[Fo++]=o,$n[Fo++]=c,$n[Fo++]=u,$n[Fo++]=f,gg|=f,o.lanes|=f,o=o.alternate,o!==null&&(o.lanes|=f)}function pg(o,c,u,f){return vu(o,c,u,f),Cu(o)}function Uo(o,c){return vu(o,null,null,c),Cu(o)}function _A(o,c,u){o.lanes|=u;var f=o.alternate;f!==null&&(f.lanes|=u);for(var p=!1,A=o.return;A!==null;)A.childLanes|=u,f=A.alternate,f!==null&&(f.childLanes|=u),A.tag===22&&(o=A.stateNode,o===null||o._visibility&1||(p=!0)),o=A,A=A.return;return o.tag===3?(A=o.stateNode,p&&c!==null&&(p=31-We(u),o=A.hiddenUpdates,f=o[p],f===null?o[p]=[c]:f.push(c),c.lane=u|536870912),A):null}function Cu(o){if(50<Vc)throw Vc=0,Ep=null,Error(s(185));for(var c=o.return;c!==null;)o=c,c=o.return;return o.tag===3?o.stateNode:null}var Lo={};function Aw(o,c,u,f){this.tag=o,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mn(o,c,u,f){return new Aw(o,c,u,f)}function _g(o){return o=o.prototype,!(!o||!o.isReactComponent)}function ei(o,c){var u=o.alternate;return u===null?(u=Mn(o.tag,c,o.key,o.mode),u.elementType=o.elementType,u.type=o.type,u.stateNode=o.stateNode,u.alternate=o,o.alternate=u):(u.pendingProps=c,u.type=o.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=o.flags&65011712,u.childLanes=o.childLanes,u.lanes=o.lanes,u.child=o.child,u.memoizedProps=o.memoizedProps,u.memoizedState=o.memoizedState,u.updateQueue=o.updateQueue,c=o.dependencies,u.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},u.sibling=o.sibling,u.index=o.index,u.ref=o.ref,u.refCleanup=o.refCleanup,u}function mA(o,c){o.flags&=65011714;var u=o.alternate;return u===null?(o.childLanes=0,o.lanes=c,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=u.childLanes,o.lanes=u.lanes,o.child=u.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,o.type=u.type,c=u.dependencies,o.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),o}function Mu(o,c,u,f,p,A){var S=0;if(f=o,typeof o=="function")_g(o)&&(S=1);else if(typeof o=="string")S=TO(o,u,_t.current)?26:o==="html"||o==="head"||o==="body"?27:5;else t:switch(o){case q:return o=Mn(31,u,c,p),o.elementType=q,o.lanes=A,o;case E:return Br(u.children,p,A,c);case b:S=8,p|=24;break;case R:return o=Mn(12,u,c,p|2),o.elementType=R,o.lanes=A,o;case I:return o=Mn(13,u,c,p),o.elementType=I,o.lanes=A,o;case P:return o=Mn(19,u,c,p),o.elementType=P,o.lanes=A,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case M:case O:S=10;break t;case N:S=9;break t;case x:S=11;break t;case J:S=14;break t;case et:S=16,f=null;break t}S=29,u=Error(s(130,o===null?"null":typeof o,"")),f=null}return c=Mn(S,u,c,p),c.elementType=o,c.type=f,c.lanes=A,c}function Br(o,c,u,f){return o=Mn(7,o,f,c),o.lanes=u,o}function mg(o,c,u){return o=Mn(6,o,null,c),o.lanes=u,o}function Ag(o,c,u){return c=Mn(4,o.children!==null?o.children:[],o.key,c),c.lanes=u,c.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},c}var ko=[],zo=0,wu=null,Ou=0,Xn=[],Gn=0,xr=null,ni=1,si="";function Nr(o,c){ko[zo++]=Ou,ko[zo++]=wu,wu=o,Ou=c}function AA(o,c,u){Xn[Gn++]=ni,Xn[Gn++]=si,Xn[Gn++]=xr,xr=o;var f=ni;o=si;var p=32-We(f)-1;f&=~(1<<p),u+=1;var A=32-We(c)+p;if(30<A){var S=p-p%5;A=(f&(1<<S)-1).toString(32),f>>=S,p-=S,ni=1<<32-We(c)+p|u<<p|f,si=A+o}else ni=1<<A|u<<p|f,si=o}function yg(o){o.return!==null&&(Nr(o,1),AA(o,1,0))}function Tg(o){for(;o===wu;)wu=ko[--zo],ko[zo]=null,Ou=ko[--zo],ko[zo]=null;for(;o===xr;)xr=Xn[--Gn],Xn[Gn]=null,si=Xn[--Gn],Xn[Gn]=null,ni=Xn[--Gn],Xn[Gn]=null}var rn=null,ge=null,Vt=!1,Ir=null,Rs=!1,Eg=Error(s(519));function Dr(o){var c=Error(s(418,""));throw yc(jn(c,o)),Eg}function yA(o){var c=o.stateNode,u=o.type,f=o.memoizedProps;switch(c[me]=o,c[qe]=f,u){case"dialog":xt("cancel",c),xt("close",c);break;case"iframe":case"object":case"embed":xt("load",c);break;case"video":case"audio":for(u=0;u<jc.length;u++)xt(jc[u],c);break;case"source":xt("error",c);break;case"img":case"image":case"link":xt("error",c),xt("load",c);break;case"details":xt("toggle",c);break;case"input":xt("invalid",c),Oo(c,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),Oi(c);break;case"select":xt("invalid",c);break;case"textarea":xt("invalid",c),v(c,f.value,f.defaultValue,f.children),Oi(c)}u=f.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||c.textContent===""+u||f.suppressHydrationWarning===!0||FT(c.textContent,u)?(f.popover!=null&&(xt("beforetoggle",c),xt("toggle",c)),f.onScroll!=null&&xt("scroll",c),f.onScrollEnd!=null&&xt("scrollend",c),f.onClick!=null&&(c.onclick=lh),c=!0):c=!1,c||Dr(o)}function TA(o){for(rn=o.return;rn;)switch(rn.tag){case 5:case 13:Rs=!1;return;case 27:case 3:Rs=!0;return;default:rn=rn.return}}function mc(o){if(o!==rn)return!1;if(!Vt)return TA(o),Vt=!0,!1;var c=o.tag,u;if((u=c!==3&&c!==27)&&((u=c===5)&&(u=o.type,u=!(u!=="form"&&u!=="button")||Up(o.type,o.memoizedProps)),u=!u),u&&ge&&Dr(o),TA(o),c===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(s(317));t:{for(o=o.nextSibling,c=0;o;){if(o.nodeType===8)if(u=o.data,u==="/$"){if(c===0){ge=as(o.nextSibling);break t}c--}else u!=="$"&&u!=="$!"&&u!=="$?"||c++;o=o.nextSibling}ge=null}}else c===27?(c=ge,Wi(o.type)?(o=Vp,Vp=null,ge=o):ge=c):ge=rn?as(o.stateNode.nextSibling):null;return!0}function Ac(){ge=rn=null,Vt=!1}function EA(){var o=Ir;return o!==null&&(gn===null?gn=o:gn.push.apply(gn,o),Ir=null),o}function yc(o){Ir===null?Ir=[o]:Ir.push(o)}var bg=st(null),Pr=null,ii=null;function Ni(o,c,u){ht(bg,c._currentValue),c._currentValue=u}function ri(o){o._currentValue=bg.current,ut(bg)}function Sg(o,c,u){for(;o!==null;){var f=o.alternate;if((o.childLanes&c)!==c?(o.childLanes|=c,f!==null&&(f.childLanes|=c)):f!==null&&(f.childLanes&c)!==c&&(f.childLanes|=c),o===u)break;o=o.return}}function Rg(o,c,u,f){var p=o.child;for(p!==null&&(p.return=o);p!==null;){var A=p.dependencies;if(A!==null){var S=p.child;A=A.firstContext;t:for(;A!==null;){var C=A;A=p;for(var D=0;D<c.length;D++)if(C.context===c[D]){A.lanes|=u,C=A.alternate,C!==null&&(C.lanes|=u),Sg(A.return,u,o),f||(S=null);break t}A=C.next}}else if(p.tag===18){if(S=p.return,S===null)throw Error(s(341));S.lanes|=u,A=S.alternate,A!==null&&(A.lanes|=u),Sg(S,u,o),S=null}else S=p.child;if(S!==null)S.return=p;else for(S=p;S!==null;){if(S===o){S=null;break}if(p=S.sibling,p!==null){p.return=S.return,S=p;break}S=S.return}p=S}}function Tc(o,c,u,f){o=null;for(var p=c,A=!1;p!==null;){if(!A){if((p.flags&524288)!==0)A=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var S=p.alternate;if(S===null)throw Error(s(387));if(S=S.memoizedProps,S!==null){var C=p.type;Cn(p.pendingProps.value,S.value)||(o!==null?o.push(C):o=[C])}}else if(p===jt.current){if(S=p.alternate,S===null)throw Error(s(387));S.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(o!==null?o.push(Yc):o=[Yc])}p=p.return}o!==null&&Rg(c,o,u,f),c.flags|=262144}function Bu(o){for(o=o.firstContext;o!==null;){if(!Cn(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function Fr(o){Pr=o,ii=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function Ke(o){return bA(Pr,o)}function xu(o,c){return Pr===null&&Fr(o),bA(o,c)}function bA(o,c){var u=c._currentValue;if(c={context:c,memoizedValue:u,next:null},ii===null){if(o===null)throw Error(s(308));ii=c,o.dependencies={lanes:0,firstContext:c},o.flags|=524288}else ii=ii.next=c;return u}var yw=typeof AbortController<"u"?AbortController:function(){var o=[],c=this.signal={aborted:!1,addEventListener:function(u,f){o.push(f)}};this.abort=function(){c.aborted=!0,o.forEach(function(u){return u()})}},Tw=e.unstable_scheduleCallback,Ew=e.unstable_NormalPriority,we={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function vg(){return{controller:new yw,data:new Map,refCount:0}}function Ec(o){o.refCount--,o.refCount===0&&Tw(Ew,function(){o.controller.abort()})}var bc=null,Cg=0,Vo=0,Ho=null;function bw(o,c){if(bc===null){var u=bc=[];Cg=0,Vo=wp(),Ho={status:"pending",value:void 0,then:function(f){u.push(f)}}}return Cg++,c.then(SA,SA),c}function SA(){if(--Cg===0&&bc!==null){Ho!==null&&(Ho.status="fulfilled");var o=bc;bc=null,Vo=0,Ho=null;for(var c=0;c<o.length;c++)(0,o[c])()}}function Sw(o,c){var u=[],f={status:"pending",value:null,reason:null,then:function(p){u.push(p)}};return o.then(function(){f.status="fulfilled",f.value=c;for(var p=0;p<u.length;p++)(0,u[p])(c)},function(p){for(f.status="rejected",f.reason=p,p=0;p<u.length;p++)(0,u[p])(void 0)}),f}var RA=K.S;K.S=function(o,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&bw(o,c),RA!==null&&RA(o,c)};var Ur=st(null);function Mg(){var o=Ur.current;return o!==null?o:ae.pooledCache}function Nu(o,c){c===null?ht(Ur,Ur.current):ht(Ur,c.pool)}function vA(){var o=Mg();return o===null?null:{parent:we._currentValue,pool:o}}var Sc=Error(s(460)),CA=Error(s(474)),Iu=Error(s(542)),wg={then:function(){}};function MA(o){return o=o.status,o==="fulfilled"||o==="rejected"}function Du(){}function wA(o,c,u){switch(u=o[u],u===void 0?o.push(c):u!==c&&(c.then(Du,Du),c=u),c.status){case"fulfilled":return c.value;case"rejected":throw o=c.reason,BA(o),o;default:if(typeof c.status=="string")c.then(Du,Du);else{if(o=ae,o!==null&&100<o.shellSuspendCounter)throw Error(s(482));o=c,o.status="pending",o.then(function(f){if(c.status==="pending"){var p=c;p.status="fulfilled",p.value=f}},function(f){if(c.status==="pending"){var p=c;p.status="rejected",p.reason=f}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw o=c.reason,BA(o),o}throw Rc=c,Sc}}var Rc=null;function OA(){if(Rc===null)throw Error(s(459));var o=Rc;return Rc=null,o}function BA(o){if(o===Sc||o===Iu)throw Error(s(483))}var Ii=!1;function Og(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Bg(o,c){o=o.updateQueue,c.updateQueue===o&&(c.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function Di(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function Pi(o,c,u){var f=o.updateQueue;if(f===null)return null;if(f=f.shared,(Xt&2)!==0){var p=f.pending;return p===null?c.next=c:(c.next=p.next,p.next=c),f.pending=c,c=Cu(o),_A(o,null,u),c}return vu(o,f,c,u),Cu(o)}function vc(o,c,u){if(c=c.updateQueue,c!==null&&(c=c.shared,(u&4194048)!==0)){var f=c.lanes;f&=o.pendingLanes,u|=f,c.lanes=u,gu(o,u)}}function xg(o,c){var u=o.updateQueue,f=o.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var p=null,A=null;if(u=u.firstBaseUpdate,u!==null){do{var S={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};A===null?p=A=S:A=A.next=S,u=u.next}while(u!==null);A===null?p=A=c:A=A.next=c}else p=A=c;u={baseState:f.baseState,firstBaseUpdate:p,lastBaseUpdate:A,shared:f.shared,callbacks:f.callbacks},o.updateQueue=u;return}o=u.lastBaseUpdate,o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=c}var Ng=!1;function Cc(){if(Ng){var o=Ho;if(o!==null)throw o}}function Mc(o,c,u,f){Ng=!1;var p=o.updateQueue;Ii=!1;var A=p.firstBaseUpdate,S=p.lastBaseUpdate,C=p.shared.pending;if(C!==null){p.shared.pending=null;var D=C,$=D.next;D.next=null,S===null?A=$:S.next=$,S=D;var Z=o.alternate;Z!==null&&(Z=Z.updateQueue,C=Z.lastBaseUpdate,C!==S&&(C===null?Z.firstBaseUpdate=$:C.next=$,Z.lastBaseUpdate=D))}if(A!==null){var nt=p.baseState;S=0,Z=$=D=null,C=A;do{var X=C.lane&-536870913,W=X!==C.lane;if(W?(Dt&X)===X:(f&X)===X){X!==0&&X===Vo&&(Ng=!0),Z!==null&&(Z=Z.next={lane:0,tag:C.tag,payload:C.payload,callback:null,next:null});t:{var Rt=o,Et=C;X=c;var Kt=u;switch(Et.tag){case 1:if(Rt=Et.payload,typeof Rt=="function"){nt=Rt.call(Kt,nt,X);break t}nt=Rt;break t;case 3:Rt.flags=Rt.flags&-65537|128;case 0:if(Rt=Et.payload,X=typeof Rt=="function"?Rt.call(Kt,nt,X):Rt,X==null)break t;nt=g({},nt,X);break t;case 2:Ii=!0}}X=C.callback,X!==null&&(o.flags|=64,W&&(o.flags|=8192),W=p.callbacks,W===null?p.callbacks=[X]:W.push(X))}else W={lane:X,tag:C.tag,payload:C.payload,callback:C.callback,next:null},Z===null?($=Z=W,D=nt):Z=Z.next=W,S|=X;if(C=C.next,C===null){if(C=p.shared.pending,C===null)break;W=C,C=W.next,W.next=null,p.lastBaseUpdate=W,p.shared.pending=null}}while(!0);Z===null&&(D=nt),p.baseState=D,p.firstBaseUpdate=$,p.lastBaseUpdate=Z,A===null&&(p.shared.lanes=0),ji|=S,o.lanes=S,o.memoizedState=nt}}function xA(o,c){if(typeof o!="function")throw Error(s(191,o));o.call(c)}function NA(o,c){var u=o.callbacks;if(u!==null)for(o.callbacks=null,o=0;o<u.length;o++)xA(u[o],c)}var jo=st(null),Pu=st(0);function IA(o,c){o=fi,ht(Pu,o),ht(jo,c),fi=o|c.baseLanes}function Ig(){ht(Pu,fi),ht(jo,jo.current)}function Dg(){fi=Pu.current,ut(jo),ut(Pu)}var Fi=0,wt=null,qt=null,Ee=null,Fu=!1,$o=!1,Lr=!1,Uu=0,wc=0,Xo=null,Rw=0;function Ae(){throw Error(s(321))}function Pg(o,c){if(c===null)return!1;for(var u=0;u<c.length&&u<o.length;u++)if(!Cn(o[u],c[u]))return!1;return!0}function Fg(o,c,u,f,p,A){return Fi=A,wt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,K.H=o===null||o.memoizedState===null?_y:my,Lr=!1,A=u(f,p),Lr=!1,$o&&(A=PA(c,u,f,p)),DA(o),A}function DA(o){K.H=ju;var c=qt!==null&&qt.next!==null;if(Fi=0,Ee=qt=wt=null,Fu=!1,wc=0,Xo=null,c)throw Error(s(300));o===null||Ie||(o=o.dependencies,o!==null&&Bu(o)&&(Ie=!0))}function PA(o,c,u,f){wt=o;var p=0;do{if($o&&(Xo=null),wc=0,$o=!1,25<=p)throw Error(s(301));if(p+=1,Ee=qt=null,o.updateQueue!=null){var A=o.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}K.H=xw,A=c(u,f)}while($o);return A}function vw(){var o=K.H,c=o.useState()[0];return c=typeof c.then=="function"?Oc(c):c,o=o.useState()[0],(qt!==null?qt.memoizedState:null)!==o&&(wt.flags|=1024),c}function Ug(){var o=Uu!==0;return Uu=0,o}function Lg(o,c,u){c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~u}function kg(o){if(Fu){for(o=o.memoizedState;o!==null;){var c=o.queue;c!==null&&(c.pending=null),o=o.next}Fu=!1}Fi=0,Ee=qt=wt=null,$o=!1,wc=Uu=0,Xo=null}function fn(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ee===null?wt.memoizedState=Ee=o:Ee=Ee.next=o,Ee}function be(){if(qt===null){var o=wt.alternate;o=o!==null?o.memoizedState:null}else o=qt.next;var c=Ee===null?wt.memoizedState:Ee.next;if(c!==null)Ee=c,qt=o;else{if(o===null)throw wt.alternate===null?Error(s(467)):Error(s(310));qt=o,o={memoizedState:qt.memoizedState,baseState:qt.baseState,baseQueue:qt.baseQueue,queue:qt.queue,next:null},Ee===null?wt.memoizedState=Ee=o:Ee=Ee.next=o}return Ee}function zg(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Oc(o){var c=wc;return wc+=1,Xo===null&&(Xo=[]),o=wA(Xo,o,c),c=wt,(Ee===null?c.memoizedState:Ee.next)===null&&(c=c.alternate,K.H=c===null||c.memoizedState===null?_y:my),o}function Lu(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return Oc(o);if(o.$$typeof===O)return Ke(o)}throw Error(s(438,String(o)))}function Vg(o){var c=null,u=wt.updateQueue;if(u!==null&&(c=u.memoCache),c==null){var f=wt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(c={data:f.data.map(function(p){return p.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),u===null&&(u=zg(),wt.updateQueue=u),u.memoCache=c,u=c.data[c.index],u===void 0)for(u=c.data[c.index]=Array(o),f=0;f<o;f++)u[f]=Q;return c.index++,u}function oi(o,c){return typeof c=="function"?c(o):c}function ku(o){var c=be();return Hg(c,qt,o)}function Hg(o,c,u){var f=o.queue;if(f===null)throw Error(s(311));f.lastRenderedReducer=u;var p=o.baseQueue,A=f.pending;if(A!==null){if(p!==null){var S=p.next;p.next=A.next,A.next=S}c.baseQueue=p=A,f.pending=null}if(A=o.baseState,p===null)o.memoizedState=A;else{c=p.next;var C=S=null,D=null,$=c,Z=!1;do{var nt=$.lane&-536870913;if(nt!==$.lane?(Dt&nt)===nt:(Fi&nt)===nt){var X=$.revertLane;if(X===0)D!==null&&(D=D.next={lane:0,revertLane:0,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null}),nt===Vo&&(Z=!0);else if((Fi&X)===X){$=$.next,X===Vo&&(Z=!0);continue}else nt={lane:0,revertLane:$.revertLane,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},D===null?(C=D=nt,S=A):D=D.next=nt,wt.lanes|=X,ji|=X;nt=$.action,Lr&&u(A,nt),A=$.hasEagerState?$.eagerState:u(A,nt)}else X={lane:nt,revertLane:$.revertLane,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},D===null?(C=D=X,S=A):D=D.next=X,wt.lanes|=nt,ji|=nt;$=$.next}while($!==null&&$!==c);if(D===null?S=A:D.next=C,!Cn(A,o.memoizedState)&&(Ie=!0,Z&&(u=Ho,u!==null)))throw u;o.memoizedState=A,o.baseState=S,o.baseQueue=D,f.lastRenderedState=A}return p===null&&(f.lanes=0),[o.memoizedState,f.dispatch]}function jg(o){var c=be(),u=c.queue;if(u===null)throw Error(s(311));u.lastRenderedReducer=o;var f=u.dispatch,p=u.pending,A=c.memoizedState;if(p!==null){u.pending=null;var S=p=p.next;do A=o(A,S.action),S=S.next;while(S!==p);Cn(A,c.memoizedState)||(Ie=!0),c.memoizedState=A,c.baseQueue===null&&(c.baseState=A),u.lastRenderedState=A}return[A,f]}function FA(o,c,u){var f=wt,p=be(),A=Vt;if(A){if(u===void 0)throw Error(s(407));u=u()}else u=c();var S=!Cn((qt||p).memoizedState,u);S&&(p.memoizedState=u,Ie=!0),p=p.queue;var C=kA.bind(null,f,p,o);if(Bc(2048,8,C,[o]),p.getSnapshot!==c||S||Ee!==null&&Ee.memoizedState.tag&1){if(f.flags|=2048,Go(9,zu(),LA.bind(null,f,p,u,c),null),ae===null)throw Error(s(349));A||(Fi&124)!==0||UA(f,c,u)}return u}function UA(o,c,u){o.flags|=16384,o={getSnapshot:c,value:u},c=wt.updateQueue,c===null?(c=zg(),wt.updateQueue=c,c.stores=[o]):(u=c.stores,u===null?c.stores=[o]:u.push(o))}function LA(o,c,u,f){c.value=u,c.getSnapshot=f,zA(c)&&VA(o)}function kA(o,c,u){return u(function(){zA(c)&&VA(o)})}function zA(o){var c=o.getSnapshot;o=o.value;try{var u=c();return!Cn(o,u)}catch{return!0}}function VA(o){var c=Uo(o,2);c!==null&&Nn(c,o,2)}function $g(o){var c=fn();if(typeof o=="function"){var u=o;if(o=u(),Lr){ss(!0);try{u()}finally{ss(!1)}}}return c.memoizedState=c.baseState=o,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:o},c}function HA(o,c,u,f){return o.baseState=u,Hg(o,qt,typeof f=="function"?f:oi)}function Cw(o,c,u,f,p){if(Hu(o))throw Error(s(485));if(o=c.action,o!==null){var A={payload:p,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){A.listeners.push(S)}};K.T!==null?u(!0):A.isTransition=!1,f(A),u=c.pending,u===null?(A.next=c.pending=A,jA(c,A)):(A.next=u.next,c.pending=u.next=A)}}function jA(o,c){var u=c.action,f=c.payload,p=o.state;if(c.isTransition){var A=K.T,S={};K.T=S;try{var C=u(p,f),D=K.S;D!==null&&D(S,C),$A(o,c,C)}catch($){Xg(o,c,$)}finally{K.T=A}}else try{A=u(p,f),$A(o,c,A)}catch($){Xg(o,c,$)}}function $A(o,c,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(f){XA(o,c,f)},function(f){return Xg(o,c,f)}):XA(o,c,u)}function XA(o,c,u){c.status="fulfilled",c.value=u,GA(c),o.state=u,c=o.pending,c!==null&&(u=c.next,u===c?o.pending=null:(u=u.next,c.next=u,jA(o,u)))}function Xg(o,c,u){var f=o.pending;if(o.pending=null,f!==null){f=f.next;do c.status="rejected",c.reason=u,GA(c),c=c.next;while(c!==f)}o.action=null}function GA(o){o=o.listeners;for(var c=0;c<o.length;c++)(0,o[c])()}function WA(o,c){return c}function qA(o,c){if(Vt){var u=ae.formState;if(u!==null){t:{var f=wt;if(Vt){if(ge){e:{for(var p=ge,A=Rs;p.nodeType!==8;){if(!A){p=null;break e}if(p=as(p.nextSibling),p===null){p=null;break e}}A=p.data,p=A==="F!"||A==="F"?p:null}if(p){ge=as(p.nextSibling),f=p.data==="F!";break t}}Dr(f)}f=!1}f&&(c=u[0])}}return u=fn(),u.memoizedState=u.baseState=c,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:WA,lastRenderedState:c},u.queue=f,u=dy.bind(null,wt,f),f.dispatch=u,f=$g(!1),A=Kg.bind(null,wt,!1,f.queue),f=fn(),p={state:c,dispatch:null,action:o,pending:null},f.queue=p,u=Cw.bind(null,wt,p,A,u),p.dispatch=u,f.memoizedState=o,[c,u,!1]}function YA(o){var c=be();return KA(c,qt,o)}function KA(o,c,u){if(c=Hg(o,c,WA)[0],o=ku(oi)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var f=Oc(c)}catch(S){throw S===Sc?Iu:S}else f=c;c=be();var p=c.queue,A=p.dispatch;return u!==c.memoizedState&&(wt.flags|=2048,Go(9,zu(),Mw.bind(null,p,u),null)),[f,A,o]}function Mw(o,c){o.action=c}function JA(o){var c=be(),u=qt;if(u!==null)return KA(c,u,o);be(),c=c.memoizedState,u=be();var f=u.queue.dispatch;return u.memoizedState=o,[c,f,!1]}function Go(o,c,u,f){return o={tag:o,create:u,deps:f,inst:c,next:null},c=wt.updateQueue,c===null&&(c=zg(),wt.updateQueue=c),u=c.lastEffect,u===null?c.lastEffect=o.next=o:(f=u.next,u.next=o,o.next=f,c.lastEffect=o),o}function zu(){return{destroy:void 0,resource:void 0}}function ZA(){return be().memoizedState}function Vu(o,c,u,f){var p=fn();f=f===void 0?null:f,wt.flags|=o,p.memoizedState=Go(1|c,zu(),u,f)}function Bc(o,c,u,f){var p=be();f=f===void 0?null:f;var A=p.memoizedState.inst;qt!==null&&f!==null&&Pg(f,qt.memoizedState.deps)?p.memoizedState=Go(c,A,u,f):(wt.flags|=o,p.memoizedState=Go(1|c,A,u,f))}function QA(o,c){Vu(8390656,8,o,c)}function ty(o,c){Bc(2048,8,o,c)}function ey(o,c){return Bc(4,2,o,c)}function ny(o,c){return Bc(4,4,o,c)}function sy(o,c){if(typeof c=="function"){o=o();var u=c(o);return function(){typeof u=="function"?u():c(null)}}if(c!=null)return o=o(),c.current=o,function(){c.current=null}}function iy(o,c,u){u=u!=null?u.concat([o]):null,Bc(4,4,sy.bind(null,c,o),u)}function Gg(){}function ry(o,c){var u=be();c=c===void 0?null:c;var f=u.memoizedState;return c!==null&&Pg(c,f[1])?f[0]:(u.memoizedState=[o,c],o)}function oy(o,c){var u=be();c=c===void 0?null:c;var f=u.memoizedState;if(c!==null&&Pg(c,f[1]))return f[0];if(f=o(),Lr){ss(!0);try{o()}finally{ss(!1)}}return u.memoizedState=[f,c],f}function Wg(o,c,u){return u===void 0||(Fi&1073741824)!==0?o.memoizedState=c:(o.memoizedState=u,o=lT(),wt.lanes|=o,ji|=o,u)}function ay(o,c,u,f){return Cn(u,c)?u:jo.current!==null?(o=Wg(o,u,f),Cn(o,c)||(Ie=!0),o):(Fi&42)===0?(Ie=!0,o.memoizedState=u):(o=lT(),wt.lanes|=o,ji|=o,c)}function cy(o,c,u,f,p){var A=lt.p;lt.p=A!==0&&8>A?A:8;var S=K.T,C={};K.T=C,Kg(o,!1,c,u);try{var D=p(),$=K.S;if($!==null&&$(C,D),D!==null&&typeof D=="object"&&typeof D.then=="function"){var Z=Sw(D,f);xc(o,c,Z,xn(o))}else xc(o,c,f,xn(o))}catch(nt){xc(o,c,{then:function(){},status:"rejected",reason:nt},xn())}finally{lt.p=A,K.T=S}}function ww(){}function qg(o,c,u,f){if(o.tag!==5)throw Error(s(476));var p=ly(o).queue;cy(o,p,c,At,u===null?ww:function(){return uy(o),u(f)})}function ly(o){var c=o.memoizedState;if(c!==null)return c;c={memoizedState:At,baseState:At,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:At},next:null};var u={};return c.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:u},next:null},o.memoizedState=c,o=o.alternate,o!==null&&(o.memoizedState=c),c}function uy(o){var c=ly(o).next.queue;xc(o,c,{},xn())}function Yg(){return Ke(Yc)}function hy(){return be().memoizedState}function fy(){return be().memoizedState}function Ow(o){for(var c=o.return;c!==null;){switch(c.tag){case 24:case 3:var u=xn();o=Di(u);var f=Pi(c,o,u);f!==null&&(Nn(f,c,u),vc(f,c,u)),c={cache:vg()},o.payload=c;return}c=c.return}}function Bw(o,c,u){var f=xn();u={lane:f,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},Hu(o)?gy(c,u):(u=pg(o,c,u,f),u!==null&&(Nn(u,o,f),py(u,c,f)))}function dy(o,c,u){var f=xn();xc(o,c,u,f)}function xc(o,c,u,f){var p={lane:f,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(Hu(o))gy(c,p);else{var A=o.alternate;if(o.lanes===0&&(A===null||A.lanes===0)&&(A=c.lastRenderedReducer,A!==null))try{var S=c.lastRenderedState,C=A(S,u);if(p.hasEagerState=!0,p.eagerState=C,Cn(C,S))return vu(o,c,p,0),ae===null&&Ru(),!1}catch{}finally{}if(u=pg(o,c,p,f),u!==null)return Nn(u,o,f),py(u,c,f),!0}return!1}function Kg(o,c,u,f){if(f={lane:2,revertLane:wp(),action:f,hasEagerState:!1,eagerState:null,next:null},Hu(o)){if(c)throw Error(s(479))}else c=pg(o,u,f,2),c!==null&&Nn(c,o,2)}function Hu(o){var c=o.alternate;return o===wt||c!==null&&c===wt}function gy(o,c){$o=Fu=!0;var u=o.pending;u===null?c.next=c:(c.next=u.next,u.next=c),o.pending=c}function py(o,c,u){if((u&4194048)!==0){var f=c.lanes;f&=o.pendingLanes,u|=f,c.lanes=u,gu(o,u)}}var ju={readContext:Ke,use:Lu,useCallback:Ae,useContext:Ae,useEffect:Ae,useImperativeHandle:Ae,useLayoutEffect:Ae,useInsertionEffect:Ae,useMemo:Ae,useReducer:Ae,useRef:Ae,useState:Ae,useDebugValue:Ae,useDeferredValue:Ae,useTransition:Ae,useSyncExternalStore:Ae,useId:Ae,useHostTransitionStatus:Ae,useFormState:Ae,useActionState:Ae,useOptimistic:Ae,useMemoCache:Ae,useCacheRefresh:Ae},_y={readContext:Ke,use:Lu,useCallback:function(o,c){return fn().memoizedState=[o,c===void 0?null:c],o},useContext:Ke,useEffect:QA,useImperativeHandle:function(o,c,u){u=u!=null?u.concat([o]):null,Vu(4194308,4,sy.bind(null,c,o),u)},useLayoutEffect:function(o,c){return Vu(4194308,4,o,c)},useInsertionEffect:function(o,c){Vu(4,2,o,c)},useMemo:function(o,c){var u=fn();c=c===void 0?null:c;var f=o();if(Lr){ss(!0);try{o()}finally{ss(!1)}}return u.memoizedState=[f,c],f},useReducer:function(o,c,u){var f=fn();if(u!==void 0){var p=u(c);if(Lr){ss(!0);try{u(c)}finally{ss(!1)}}}else p=c;return f.memoizedState=f.baseState=p,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:p},f.queue=o,o=o.dispatch=Bw.bind(null,wt,o),[f.memoizedState,o]},useRef:function(o){var c=fn();return o={current:o},c.memoizedState=o},useState:function(o){o=$g(o);var c=o.queue,u=dy.bind(null,wt,c);return c.dispatch=u,[o.memoizedState,u]},useDebugValue:Gg,useDeferredValue:function(o,c){var u=fn();return Wg(u,o,c)},useTransition:function(){var o=$g(!1);return o=cy.bind(null,wt,o.queue,!0,!1),fn().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,c,u){var f=wt,p=fn();if(Vt){if(u===void 0)throw Error(s(407));u=u()}else{if(u=c(),ae===null)throw Error(s(349));(Dt&124)!==0||UA(f,c,u)}p.memoizedState=u;var A={value:u,getSnapshot:c};return p.queue=A,QA(kA.bind(null,f,A,o),[o]),f.flags|=2048,Go(9,zu(),LA.bind(null,f,A,u,c),null),u},useId:function(){var o=fn(),c=ae.identifierPrefix;if(Vt){var u=si,f=ni;u=(f&~(1<<32-We(f)-1)).toString(32)+u,c="«"+c+"R"+u,u=Uu++,0<u&&(c+="H"+u.toString(32)),c+="»"}else u=Rw++,c="«"+c+"r"+u.toString(32)+"»";return o.memoizedState=c},useHostTransitionStatus:Yg,useFormState:qA,useActionState:qA,useOptimistic:function(o){var c=fn();c.memoizedState=c.baseState=o;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=u,c=Kg.bind(null,wt,!0,u),u.dispatch=c,[o,c]},useMemoCache:Vg,useCacheRefresh:function(){return fn().memoizedState=Ow.bind(null,wt)}},my={readContext:Ke,use:Lu,useCallback:ry,useContext:Ke,useEffect:ty,useImperativeHandle:iy,useInsertionEffect:ey,useLayoutEffect:ny,useMemo:oy,useReducer:ku,useRef:ZA,useState:function(){return ku(oi)},useDebugValue:Gg,useDeferredValue:function(o,c){var u=be();return ay(u,qt.memoizedState,o,c)},useTransition:function(){var o=ku(oi)[0],c=be().memoizedState;return[typeof o=="boolean"?o:Oc(o),c]},useSyncExternalStore:FA,useId:hy,useHostTransitionStatus:Yg,useFormState:YA,useActionState:YA,useOptimistic:function(o,c){var u=be();return HA(u,qt,o,c)},useMemoCache:Vg,useCacheRefresh:fy},xw={readContext:Ke,use:Lu,useCallback:ry,useContext:Ke,useEffect:ty,useImperativeHandle:iy,useInsertionEffect:ey,useLayoutEffect:ny,useMemo:oy,useReducer:jg,useRef:ZA,useState:function(){return jg(oi)},useDebugValue:Gg,useDeferredValue:function(o,c){var u=be();return qt===null?Wg(u,o,c):ay(u,qt.memoizedState,o,c)},useTransition:function(){var o=jg(oi)[0],c=be().memoizedState;return[typeof o=="boolean"?o:Oc(o),c]},useSyncExternalStore:FA,useId:hy,useHostTransitionStatus:Yg,useFormState:JA,useActionState:JA,useOptimistic:function(o,c){var u=be();return qt!==null?HA(u,qt,o,c):(u.baseState=o,[o,u.queue.dispatch])},useMemoCache:Vg,useCacheRefresh:fy},Wo=null,Nc=0;function $u(o){var c=Nc;return Nc+=1,Wo===null&&(Wo=[]),wA(Wo,o,c)}function Ic(o,c){c=c.props.ref,o.ref=c!==void 0?c:null}function Xu(o,c){throw c.$$typeof===_?Error(s(525)):(o=Object.prototype.toString.call(c),Error(s(31,o==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":o)))}function Ay(o){var c=o._init;return c(o._payload)}function yy(o){function c(V,L){if(o){var H=V.deletions;H===null?(V.deletions=[L],V.flags|=16):H.push(L)}}function u(V,L){if(!o)return null;for(;L!==null;)c(V,L),L=L.sibling;return null}function f(V){for(var L=new Map;V!==null;)V.key!==null?L.set(V.key,V):L.set(V.index,V),V=V.sibling;return L}function p(V,L){return V=ei(V,L),V.index=0,V.sibling=null,V}function A(V,L,H){return V.index=H,o?(H=V.alternate,H!==null?(H=H.index,H<L?(V.flags|=67108866,L):H):(V.flags|=67108866,L)):(V.flags|=1048576,L)}function S(V){return o&&V.alternate===null&&(V.flags|=67108866),V}function C(V,L,H,tt){return L===null||L.tag!==6?(L=mg(H,V.mode,tt),L.return=V,L):(L=p(L,H),L.return=V,L)}function D(V,L,H,tt){var gt=H.type;return gt===E?Z(V,L,H.props.children,tt,H.key):L!==null&&(L.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===et&&Ay(gt)===L.type)?(L=p(L,H.props),Ic(L,H),L.return=V,L):(L=Mu(H.type,H.key,H.props,null,V.mode,tt),Ic(L,H),L.return=V,L)}function $(V,L,H,tt){return L===null||L.tag!==4||L.stateNode.containerInfo!==H.containerInfo||L.stateNode.implementation!==H.implementation?(L=Ag(H,V.mode,tt),L.return=V,L):(L=p(L,H.children||[]),L.return=V,L)}function Z(V,L,H,tt,gt){return L===null||L.tag!==7?(L=Br(H,V.mode,tt,gt),L.return=V,L):(L=p(L,H),L.return=V,L)}function nt(V,L,H){if(typeof L=="string"&&L!==""||typeof L=="number"||typeof L=="bigint")return L=mg(""+L,V.mode,H),L.return=V,L;if(typeof L=="object"&&L!==null){switch(L.$$typeof){case m:return H=Mu(L.type,L.key,L.props,null,V.mode,H),Ic(H,L),H.return=V,H;case y:return L=Ag(L,V.mode,H),L.return=V,L;case et:var tt=L._init;return L=tt(L._payload),nt(V,L,H)}if(Tt(L)||ct(L))return L=Br(L,V.mode,H,null),L.return=V,L;if(typeof L.then=="function")return nt(V,$u(L),H);if(L.$$typeof===O)return nt(V,xu(V,L),H);Xu(V,L)}return null}function X(V,L,H,tt){var gt=L!==null?L.key:null;if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return gt!==null?null:C(V,L,""+H,tt);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case m:return H.key===gt?D(V,L,H,tt):null;case y:return H.key===gt?$(V,L,H,tt):null;case et:return gt=H._init,H=gt(H._payload),X(V,L,H,tt)}if(Tt(H)||ct(H))return gt!==null?null:Z(V,L,H,tt,null);if(typeof H.then=="function")return X(V,L,$u(H),tt);if(H.$$typeof===O)return X(V,L,xu(V,H),tt);Xu(V,H)}return null}function W(V,L,H,tt,gt){if(typeof tt=="string"&&tt!==""||typeof tt=="number"||typeof tt=="bigint")return V=V.get(H)||null,C(L,V,""+tt,gt);if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case m:return V=V.get(tt.key===null?H:tt.key)||null,D(L,V,tt,gt);case y:return V=V.get(tt.key===null?H:tt.key)||null,$(L,V,tt,gt);case et:var Ot=tt._init;return tt=Ot(tt._payload),W(V,L,H,tt,gt)}if(Tt(tt)||ct(tt))return V=V.get(H)||null,Z(L,V,tt,gt,null);if(typeof tt.then=="function")return W(V,L,H,$u(tt),gt);if(tt.$$typeof===O)return W(V,L,H,xu(L,tt),gt);Xu(L,tt)}return null}function Rt(V,L,H,tt){for(var gt=null,Ot=null,pt=L,St=L=0,Pe=null;pt!==null&&St<H.length;St++){pt.index>St?(Pe=pt,pt=null):Pe=pt.sibling;var Lt=X(V,pt,H[St],tt);if(Lt===null){pt===null&&(pt=Pe);break}o&&pt&&Lt.alternate===null&&c(V,pt),L=A(Lt,L,St),Ot===null?gt=Lt:Ot.sibling=Lt,Ot=Lt,pt=Pe}if(St===H.length)return u(V,pt),Vt&&Nr(V,St),gt;if(pt===null){for(;St<H.length;St++)pt=nt(V,H[St],tt),pt!==null&&(L=A(pt,L,St),Ot===null?gt=pt:Ot.sibling=pt,Ot=pt);return Vt&&Nr(V,St),gt}for(pt=f(pt);St<H.length;St++)Pe=W(pt,V,St,H[St],tt),Pe!==null&&(o&&Pe.alternate!==null&&pt.delete(Pe.key===null?St:Pe.key),L=A(Pe,L,St),Ot===null?gt=Pe:Ot.sibling=Pe,Ot=Pe);return o&&pt.forEach(function(Zi){return c(V,Zi)}),Vt&&Nr(V,St),gt}function Et(V,L,H,tt){if(H==null)throw Error(s(151));for(var gt=null,Ot=null,pt=L,St=L=0,Pe=null,Lt=H.next();pt!==null&&!Lt.done;St++,Lt=H.next()){pt.index>St?(Pe=pt,pt=null):Pe=pt.sibling;var Zi=X(V,pt,Lt.value,tt);if(Zi===null){pt===null&&(pt=Pe);break}o&&pt&&Zi.alternate===null&&c(V,pt),L=A(Zi,L,St),Ot===null?gt=Zi:Ot.sibling=Zi,Ot=Zi,pt=Pe}if(Lt.done)return u(V,pt),Vt&&Nr(V,St),gt;if(pt===null){for(;!Lt.done;St++,Lt=H.next())Lt=nt(V,Lt.value,tt),Lt!==null&&(L=A(Lt,L,St),Ot===null?gt=Lt:Ot.sibling=Lt,Ot=Lt);return Vt&&Nr(V,St),gt}for(pt=f(pt);!Lt.done;St++,Lt=H.next())Lt=W(pt,V,St,Lt.value,tt),Lt!==null&&(o&&Lt.alternate!==null&&pt.delete(Lt.key===null?St:Lt.key),L=A(Lt,L,St),Ot===null?gt=Lt:Ot.sibling=Lt,Ot=Lt);return o&&pt.forEach(function(NO){return c(V,NO)}),Vt&&Nr(V,St),gt}function Kt(V,L,H,tt){if(typeof H=="object"&&H!==null&&H.type===E&&H.key===null&&(H=H.props.children),typeof H=="object"&&H!==null){switch(H.$$typeof){case m:t:{for(var gt=H.key;L!==null;){if(L.key===gt){if(gt=H.type,gt===E){if(L.tag===7){u(V,L.sibling),tt=p(L,H.props.children),tt.return=V,V=tt;break t}}else if(L.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===et&&Ay(gt)===L.type){u(V,L.sibling),tt=p(L,H.props),Ic(tt,H),tt.return=V,V=tt;break t}u(V,L);break}else c(V,L);L=L.sibling}H.type===E?(tt=Br(H.props.children,V.mode,tt,H.key),tt.return=V,V=tt):(tt=Mu(H.type,H.key,H.props,null,V.mode,tt),Ic(tt,H),tt.return=V,V=tt)}return S(V);case y:t:{for(gt=H.key;L!==null;){if(L.key===gt)if(L.tag===4&&L.stateNode.containerInfo===H.containerInfo&&L.stateNode.implementation===H.implementation){u(V,L.sibling),tt=p(L,H.children||[]),tt.return=V,V=tt;break t}else{u(V,L);break}else c(V,L);L=L.sibling}tt=Ag(H,V.mode,tt),tt.return=V,V=tt}return S(V);case et:return gt=H._init,H=gt(H._payload),Kt(V,L,H,tt)}if(Tt(H))return Rt(V,L,H,tt);if(ct(H)){if(gt=ct(H),typeof gt!="function")throw Error(s(150));return H=gt.call(H),Et(V,L,H,tt)}if(typeof H.then=="function")return Kt(V,L,$u(H),tt);if(H.$$typeof===O)return Kt(V,L,xu(V,H),tt);Xu(V,H)}return typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint"?(H=""+H,L!==null&&L.tag===6?(u(V,L.sibling),tt=p(L,H),tt.return=V,V=tt):(u(V,L),tt=mg(H,V.mode,tt),tt.return=V,V=tt),S(V)):u(V,L)}return function(V,L,H,tt){try{Nc=0;var gt=Kt(V,L,H,tt);return Wo=null,gt}catch(pt){if(pt===Sc||pt===Iu)throw pt;var Ot=Mn(29,pt,null,V.mode);return Ot.lanes=tt,Ot.return=V,Ot}finally{}}}var qo=yy(!0),Ty=yy(!1),Wn=st(null),vs=null;function Ui(o){var c=o.alternate;ht(Oe,Oe.current&1),ht(Wn,o),vs===null&&(c===null||jo.current!==null||c.memoizedState!==null)&&(vs=o)}function Ey(o){if(o.tag===22){if(ht(Oe,Oe.current),ht(Wn,o),vs===null){var c=o.alternate;c!==null&&c.memoizedState!==null&&(vs=o)}}else Li()}function Li(){ht(Oe,Oe.current),ht(Wn,Wn.current)}function ai(o){ut(Wn),vs===o&&(vs=null),ut(Oe)}var Oe=st(0);function Gu(o){for(var c=o;c!==null;){if(c.tag===13){var u=c.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||zp(u)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function Jg(o,c,u,f){c=o.memoizedState,u=u(f,c),u=u==null?c:g({},c,u),o.memoizedState=u,o.lanes===0&&(o.updateQueue.baseState=u)}var Zg={enqueueSetState:function(o,c,u){o=o._reactInternals;var f=xn(),p=Di(f);p.payload=c,u!=null&&(p.callback=u),c=Pi(o,p,f),c!==null&&(Nn(c,o,f),vc(c,o,f))},enqueueReplaceState:function(o,c,u){o=o._reactInternals;var f=xn(),p=Di(f);p.tag=1,p.payload=c,u!=null&&(p.callback=u),c=Pi(o,p,f),c!==null&&(Nn(c,o,f),vc(c,o,f))},enqueueForceUpdate:function(o,c){o=o._reactInternals;var u=xn(),f=Di(u);f.tag=2,c!=null&&(f.callback=c),c=Pi(o,f,u),c!==null&&(Nn(c,o,u),vc(c,o,u))}};function by(o,c,u,f,p,A,S){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(f,A,S):c.prototype&&c.prototype.isPureReactComponent?!pc(u,f)||!pc(p,A):!0}function Sy(o,c,u,f){o=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(u,f),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(u,f),c.state!==o&&Zg.enqueueReplaceState(c,c.state,null)}function kr(o,c){var u=c;if("ref"in c){u={};for(var f in c)f!=="ref"&&(u[f]=c[f])}if(o=o.defaultProps){u===c&&(u=g({},u));for(var p in o)u[p]===void 0&&(u[p]=o[p])}return u}var Wu=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)};function Ry(o){Wu(o)}function vy(o){console.error(o)}function Cy(o){Wu(o)}function qu(o,c){try{var u=o.onUncaughtError;u(c.value,{componentStack:c.stack})}catch(f){setTimeout(function(){throw f})}}function My(o,c,u){try{var f=o.onCaughtError;f(u.value,{componentStack:u.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Qg(o,c,u){return u=Di(u),u.tag=3,u.payload={element:null},u.callback=function(){qu(o,c)},u}function wy(o){return o=Di(o),o.tag=3,o}function Oy(o,c,u,f){var p=u.type.getDerivedStateFromError;if(typeof p=="function"){var A=f.value;o.payload=function(){return p(A)},o.callback=function(){My(c,u,f)}}var S=u.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(o.callback=function(){My(c,u,f),typeof p!="function"&&($i===null?$i=new Set([this]):$i.add(this));var C=f.stack;this.componentDidCatch(f.value,{componentStack:C!==null?C:""})})}function Nw(o,c,u,f,p){if(u.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(c=u.alternate,c!==null&&Tc(c,u,p,!0),u=Wn.current,u!==null){switch(u.tag){case 13:return vs===null?Sp():u.alternate===null&&pe===0&&(pe=3),u.flags&=-257,u.flags|=65536,u.lanes=p,f===wg?u.flags|=16384:(c=u.updateQueue,c===null?u.updateQueue=new Set([f]):c.add(f),vp(o,f,p)),!1;case 22:return u.flags|=65536,f===wg?u.flags|=16384:(c=u.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([f])},u.updateQueue=c):(u=c.retryQueue,u===null?c.retryQueue=new Set([f]):u.add(f)),vp(o,f,p)),!1}throw Error(s(435,u.tag))}return vp(o,f,p),Sp(),!1}if(Vt)return c=Wn.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=p,f!==Eg&&(o=Error(s(422),{cause:f}),yc(jn(o,u)))):(f!==Eg&&(c=Error(s(423),{cause:f}),yc(jn(c,u))),o=o.current.alternate,o.flags|=65536,p&=-p,o.lanes|=p,f=jn(f,u),p=Qg(o.stateNode,f,p),xg(o,p),pe!==4&&(pe=2)),!1;var A=Error(s(520),{cause:f});if(A=jn(A,u),zc===null?zc=[A]:zc.push(A),pe!==4&&(pe=2),c===null)return!0;f=jn(f,u),u=c;do{switch(u.tag){case 3:return u.flags|=65536,o=p&-p,u.lanes|=o,o=Qg(u.stateNode,f,o),xg(u,o),!1;case 1:if(c=u.type,A=u.stateNode,(u.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&($i===null||!$i.has(A))))return u.flags|=65536,p&=-p,u.lanes|=p,p=wy(p),Oy(p,o,u,f),xg(u,p),!1}u=u.return}while(u!==null);return!1}var By=Error(s(461)),Ie=!1;function Ve(o,c,u,f){c.child=o===null?Ty(c,null,u,f):qo(c,o.child,u,f)}function xy(o,c,u,f,p){u=u.render;var A=c.ref;if("ref"in f){var S={};for(var C in f)C!=="ref"&&(S[C]=f[C])}else S=f;return Fr(c),f=Fg(o,c,u,S,A,p),C=Ug(),o!==null&&!Ie?(Lg(o,c,p),ci(o,c,p)):(Vt&&C&&yg(c),c.flags|=1,Ve(o,c,f,p),c.child)}function Ny(o,c,u,f,p){if(o===null){var A=u.type;return typeof A=="function"&&!_g(A)&&A.defaultProps===void 0&&u.compare===null?(c.tag=15,c.type=A,Iy(o,c,A,f,p)):(o=Mu(u.type,null,f,c,c.mode,p),o.ref=c.ref,o.return=c,c.child=o)}if(A=o.child,!ap(o,p)){var S=A.memoizedProps;if(u=u.compare,u=u!==null?u:pc,u(S,f)&&o.ref===c.ref)return ci(o,c,p)}return c.flags|=1,o=ei(A,f),o.ref=c.ref,o.return=c,c.child=o}function Iy(o,c,u,f,p){if(o!==null){var A=o.memoizedProps;if(pc(A,f)&&o.ref===c.ref)if(Ie=!1,c.pendingProps=f=A,ap(o,p))(o.flags&131072)!==0&&(Ie=!0);else return c.lanes=o.lanes,ci(o,c,p)}return tp(o,c,u,f,p)}function Dy(o,c,u){var f=c.pendingProps,p=f.children,A=o!==null?o.memoizedState:null;if(f.mode==="hidden"){if((c.flags&128)!==0){if(f=A!==null?A.baseLanes|u:u,o!==null){for(p=c.child=o.child,A=0;p!==null;)A=A|p.lanes|p.childLanes,p=p.sibling;c.childLanes=A&~f}else c.childLanes=0,c.child=null;return Py(o,c,f,u)}if((u&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},o!==null&&Nu(c,A!==null?A.cachePool:null),A!==null?IA(c,A):Ig(),Ey(c);else return c.lanes=c.childLanes=536870912,Py(o,c,A!==null?A.baseLanes|u:u,u)}else A!==null?(Nu(c,A.cachePool),IA(c,A),Li(),c.memoizedState=null):(o!==null&&Nu(c,null),Ig(),Li());return Ve(o,c,p,u),c.child}function Py(o,c,u,f){var p=Mg();return p=p===null?null:{parent:we._currentValue,pool:p},c.memoizedState={baseLanes:u,cachePool:p},o!==null&&Nu(c,null),Ig(),Ey(c),o!==null&&Tc(o,c,f,!0),null}function Yu(o,c){var u=c.ref;if(u===null)o!==null&&o.ref!==null&&(c.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(s(284));(o===null||o.ref!==u)&&(c.flags|=4194816)}}function tp(o,c,u,f,p){return Fr(c),u=Fg(o,c,u,f,void 0,p),f=Ug(),o!==null&&!Ie?(Lg(o,c,p),ci(o,c,p)):(Vt&&f&&yg(c),c.flags|=1,Ve(o,c,u,p),c.child)}function Fy(o,c,u,f,p,A){return Fr(c),c.updateQueue=null,u=PA(c,f,u,p),DA(o),f=Ug(),o!==null&&!Ie?(Lg(o,c,A),ci(o,c,A)):(Vt&&f&&yg(c),c.flags|=1,Ve(o,c,u,A),c.child)}function Uy(o,c,u,f,p){if(Fr(c),c.stateNode===null){var A=Lo,S=u.contextType;typeof S=="object"&&S!==null&&(A=Ke(S)),A=new u(f,A),c.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=Zg,c.stateNode=A,A._reactInternals=c,A=c.stateNode,A.props=f,A.state=c.memoizedState,A.refs={},Og(c),S=u.contextType,A.context=typeof S=="object"&&S!==null?Ke(S):Lo,A.state=c.memoizedState,S=u.getDerivedStateFromProps,typeof S=="function"&&(Jg(c,u,S,f),A.state=c.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(S=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),S!==A.state&&Zg.enqueueReplaceState(A,A.state,null),Mc(c,f,A,p),Cc(),A.state=c.memoizedState),typeof A.componentDidMount=="function"&&(c.flags|=4194308),f=!0}else if(o===null){A=c.stateNode;var C=c.memoizedProps,D=kr(u,C);A.props=D;var $=A.context,Z=u.contextType;S=Lo,typeof Z=="object"&&Z!==null&&(S=Ke(Z));var nt=u.getDerivedStateFromProps;Z=typeof nt=="function"||typeof A.getSnapshotBeforeUpdate=="function",C=c.pendingProps!==C,Z||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(C||$!==S)&&Sy(c,A,f,S),Ii=!1;var X=c.memoizedState;A.state=X,Mc(c,f,A,p),Cc(),$=c.memoizedState,C||X!==$||Ii?(typeof nt=="function"&&(Jg(c,u,nt,f),$=c.memoizedState),(D=Ii||by(c,u,D,f,X,$,S))?(Z||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=f,c.memoizedState=$),A.props=f,A.state=$,A.context=S,f=D):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),f=!1)}else{A=c.stateNode,Bg(o,c),S=c.memoizedProps,Z=kr(u,S),A.props=Z,nt=c.pendingProps,X=A.context,$=u.contextType,D=Lo,typeof $=="object"&&$!==null&&(D=Ke($)),C=u.getDerivedStateFromProps,($=typeof C=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(S!==nt||X!==D)&&Sy(c,A,f,D),Ii=!1,X=c.memoizedState,A.state=X,Mc(c,f,A,p),Cc();var W=c.memoizedState;S!==nt||X!==W||Ii||o!==null&&o.dependencies!==null&&Bu(o.dependencies)?(typeof C=="function"&&(Jg(c,u,C,f),W=c.memoizedState),(Z=Ii||by(c,u,Z,f,X,W,D)||o!==null&&o.dependencies!==null&&Bu(o.dependencies))?($||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(f,W,D),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(f,W,D)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||S===o.memoizedProps&&X===o.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||S===o.memoizedProps&&X===o.memoizedState||(c.flags|=1024),c.memoizedProps=f,c.memoizedState=W),A.props=f,A.state=W,A.context=D,f=Z):(typeof A.componentDidUpdate!="function"||S===o.memoizedProps&&X===o.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||S===o.memoizedProps&&X===o.memoizedState||(c.flags|=1024),f=!1)}return A=f,Yu(o,c),f=(c.flags&128)!==0,A||f?(A=c.stateNode,u=f&&typeof u.getDerivedStateFromError!="function"?null:A.render(),c.flags|=1,o!==null&&f?(c.child=qo(c,o.child,null,p),c.child=qo(c,null,u,p)):Ve(o,c,u,p),c.memoizedState=A.state,o=c.child):o=ci(o,c,p),o}function Ly(o,c,u,f){return Ac(),c.flags|=256,Ve(o,c,u,f),c.child}var ep={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function np(o){return{baseLanes:o,cachePool:vA()}}function sp(o,c,u){return o=o!==null?o.childLanes&~u:0,c&&(o|=qn),o}function ky(o,c,u){var f=c.pendingProps,p=!1,A=(c.flags&128)!==0,S;if((S=A)||(S=o!==null&&o.memoizedState===null?!1:(Oe.current&2)!==0),S&&(p=!0,c.flags&=-129),S=(c.flags&32)!==0,c.flags&=-33,o===null){if(Vt){if(p?Ui(c):Li(),Vt){var C=ge,D;if(D=C){t:{for(D=C,C=Rs;D.nodeType!==8;){if(!C){C=null;break t}if(D=as(D.nextSibling),D===null){C=null;break t}}C=D}C!==null?(c.memoizedState={dehydrated:C,treeContext:xr!==null?{id:ni,overflow:si}:null,retryLane:536870912,hydrationErrors:null},D=Mn(18,null,null,0),D.stateNode=C,D.return=c,c.child=D,rn=c,ge=null,D=!0):D=!1}D||Dr(c)}if(C=c.memoizedState,C!==null&&(C=C.dehydrated,C!==null))return zp(C)?c.lanes=32:c.lanes=536870912,null;ai(c)}return C=f.children,f=f.fallback,p?(Li(),p=c.mode,C=Ku({mode:"hidden",children:C},p),f=Br(f,p,u,null),C.return=c,f.return=c,C.sibling=f,c.child=C,p=c.child,p.memoizedState=np(u),p.childLanes=sp(o,S,u),c.memoizedState=ep,f):(Ui(c),ip(c,C))}if(D=o.memoizedState,D!==null&&(C=D.dehydrated,C!==null)){if(A)c.flags&256?(Ui(c),c.flags&=-257,c=rp(o,c,u)):c.memoizedState!==null?(Li(),c.child=o.child,c.flags|=128,c=null):(Li(),p=f.fallback,C=c.mode,f=Ku({mode:"visible",children:f.children},C),p=Br(p,C,u,null),p.flags|=2,f.return=c,p.return=c,f.sibling=p,c.child=f,qo(c,o.child,null,u),f=c.child,f.memoizedState=np(u),f.childLanes=sp(o,S,u),c.memoizedState=ep,c=p);else if(Ui(c),zp(C)){if(S=C.nextSibling&&C.nextSibling.dataset,S)var $=S.dgst;S=$,f=Error(s(419)),f.stack="",f.digest=S,yc({value:f,source:null,stack:null}),c=rp(o,c,u)}else if(Ie||Tc(o,c,u,!1),S=(u&o.childLanes)!==0,Ie||S){if(S=ae,S!==null&&(f=u&-u,f=(f&42)!==0?1:ic(f),f=(f&(S.suspendedLanes|u))!==0?0:f,f!==0&&f!==D.retryLane))throw D.retryLane=f,Uo(o,f),Nn(S,o,f),By;C.data==="$?"||Sp(),c=rp(o,c,u)}else C.data==="$?"?(c.flags|=192,c.child=o.child,c=null):(o=D.treeContext,ge=as(C.nextSibling),rn=c,Vt=!0,Ir=null,Rs=!1,o!==null&&(Xn[Gn++]=ni,Xn[Gn++]=si,Xn[Gn++]=xr,ni=o.id,si=o.overflow,xr=c),c=ip(c,f.children),c.flags|=4096);return c}return p?(Li(),p=f.fallback,C=c.mode,D=o.child,$=D.sibling,f=ei(D,{mode:"hidden",children:f.children}),f.subtreeFlags=D.subtreeFlags&65011712,$!==null?p=ei($,p):(p=Br(p,C,u,null),p.flags|=2),p.return=c,f.return=c,f.sibling=p,c.child=f,f=p,p=c.child,C=o.child.memoizedState,C===null?C=np(u):(D=C.cachePool,D!==null?($=we._currentValue,D=D.parent!==$?{parent:$,pool:$}:D):D=vA(),C={baseLanes:C.baseLanes|u,cachePool:D}),p.memoizedState=C,p.childLanes=sp(o,S,u),c.memoizedState=ep,f):(Ui(c),u=o.child,o=u.sibling,u=ei(u,{mode:"visible",children:f.children}),u.return=c,u.sibling=null,o!==null&&(S=c.deletions,S===null?(c.deletions=[o],c.flags|=16):S.push(o)),c.child=u,c.memoizedState=null,u)}function ip(o,c){return c=Ku({mode:"visible",children:c},o.mode),c.return=o,o.child=c}function Ku(o,c){return o=Mn(22,o,null,c),o.lanes=0,o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},o}function rp(o,c,u){return qo(c,o.child,null,u),o=ip(c,c.pendingProps.children),o.flags|=2,c.memoizedState=null,o}function zy(o,c,u){o.lanes|=c;var f=o.alternate;f!==null&&(f.lanes|=c),Sg(o.return,c,u)}function op(o,c,u,f,p){var A=o.memoizedState;A===null?o.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:p}:(A.isBackwards=c,A.rendering=null,A.renderingStartTime=0,A.last=f,A.tail=u,A.tailMode=p)}function Vy(o,c,u){var f=c.pendingProps,p=f.revealOrder,A=f.tail;if(Ve(o,c,f.children,u),f=Oe.current,(f&2)!==0)f=f&1|2,c.flags|=128;else{if(o!==null&&(o.flags&128)!==0)t:for(o=c.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&zy(o,u,c);else if(o.tag===19)zy(o,u,c);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===c)break t;for(;o.sibling===null;){if(o.return===null||o.return===c)break t;o=o.return}o.sibling.return=o.return,o=o.sibling}f&=1}switch(ht(Oe,f),p){case"forwards":for(u=c.child,p=null;u!==null;)o=u.alternate,o!==null&&Gu(o)===null&&(p=u),u=u.sibling;u=p,u===null?(p=c.child,c.child=null):(p=u.sibling,u.sibling=null),op(c,!1,p,u,A);break;case"backwards":for(u=null,p=c.child,c.child=null;p!==null;){if(o=p.alternate,o!==null&&Gu(o)===null){c.child=p;break}o=p.sibling,p.sibling=u,u=p,p=o}op(c,!0,u,null,A);break;case"together":op(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function ci(o,c,u){if(o!==null&&(c.dependencies=o.dependencies),ji|=c.lanes,(u&c.childLanes)===0)if(o!==null){if(Tc(o,c,u,!1),(u&c.childLanes)===0)return null}else return null;if(o!==null&&c.child!==o.child)throw Error(s(153));if(c.child!==null){for(o=c.child,u=ei(o,o.pendingProps),c.child=u,u.return=c;o.sibling!==null;)o=o.sibling,u=u.sibling=ei(o,o.pendingProps),u.return=c;u.sibling=null}return c.child}function ap(o,c){return(o.lanes&c)!==0?!0:(o=o.dependencies,!!(o!==null&&Bu(o)))}function Iw(o,c,u){switch(c.tag){case 3:Ut(c,c.stateNode.containerInfo),Ni(c,we,o.memoizedState.cache),Ac();break;case 27:case 5:xe(c);break;case 4:Ut(c,c.stateNode.containerInfo);break;case 10:Ni(c,c.type,c.memoizedProps.value);break;case 13:var f=c.memoizedState;if(f!==null)return f.dehydrated!==null?(Ui(c),c.flags|=128,null):(u&c.child.childLanes)!==0?ky(o,c,u):(Ui(c),o=ci(o,c,u),o!==null?o.sibling:null);Ui(c);break;case 19:var p=(o.flags&128)!==0;if(f=(u&c.childLanes)!==0,f||(Tc(o,c,u,!1),f=(u&c.childLanes)!==0),p){if(f)return Vy(o,c,u);c.flags|=128}if(p=c.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),ht(Oe,Oe.current),f)break;return null;case 22:case 23:return c.lanes=0,Dy(o,c,u);case 24:Ni(c,we,o.memoizedState.cache)}return ci(o,c,u)}function Hy(o,c,u){if(o!==null)if(o.memoizedProps!==c.pendingProps)Ie=!0;else{if(!ap(o,u)&&(c.flags&128)===0)return Ie=!1,Iw(o,c,u);Ie=(o.flags&131072)!==0}else Ie=!1,Vt&&(c.flags&1048576)!==0&&AA(c,Ou,c.index);switch(c.lanes=0,c.tag){case 16:t:{o=c.pendingProps;var f=c.elementType,p=f._init;if(f=p(f._payload),c.type=f,typeof f=="function")_g(f)?(o=kr(f,o),c.tag=1,c=Uy(null,c,f,o,u)):(c.tag=0,c=tp(null,c,f,o,u));else{if(f!=null){if(p=f.$$typeof,p===x){c.tag=11,c=xy(null,c,f,o,u);break t}else if(p===J){c.tag=14,c=Ny(null,c,f,o,u);break t}}throw c=Y(f)||f,Error(s(306,c,""))}}return c;case 0:return tp(o,c,c.type,c.pendingProps,u);case 1:return f=c.type,p=kr(f,c.pendingProps),Uy(o,c,f,p,u);case 3:t:{if(Ut(c,c.stateNode.containerInfo),o===null)throw Error(s(387));f=c.pendingProps;var A=c.memoizedState;p=A.element,Bg(o,c),Mc(c,f,null,u);var S=c.memoizedState;if(f=S.cache,Ni(c,we,f),f!==A.cache&&Rg(c,[we],u,!0),Cc(),f=S.element,A.isDehydrated)if(A={element:f,isDehydrated:!1,cache:S.cache},c.updateQueue.baseState=A,c.memoizedState=A,c.flags&256){c=Ly(o,c,f,u);break t}else if(f!==p){p=jn(Error(s(424)),c),yc(p),c=Ly(o,c,f,u);break t}else{switch(o=c.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(ge=as(o.firstChild),rn=c,Vt=!0,Ir=null,Rs=!0,u=Ty(c,null,f,u),c.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Ac(),f===p){c=ci(o,c,u);break t}Ve(o,c,f,u)}c=c.child}return c;case 26:return Yu(o,c),o===null?(u=GT(c.type,null,c.pendingProps,null))?c.memoizedState=u:Vt||(u=c.type,o=c.pendingProps,f=uh(vt.current).createElement(u),f[me]=c,f[qe]=o,je(f,u,o),oe(f),c.stateNode=f):c.memoizedState=GT(c.type,o.memoizedProps,c.pendingProps,o.memoizedState),null;case 27:return xe(c),o===null&&Vt&&(f=c.stateNode=jT(c.type,c.pendingProps,vt.current),rn=c,Rs=!0,p=ge,Wi(c.type)?(Vp=p,ge=as(f.firstChild)):ge=p),Ve(o,c,c.pendingProps.children,u),Yu(o,c),o===null&&(c.flags|=4194304),c.child;case 5:return o===null&&Vt&&((p=f=ge)&&(f=aO(f,c.type,c.pendingProps,Rs),f!==null?(c.stateNode=f,rn=c,ge=as(f.firstChild),Rs=!1,p=!0):p=!1),p||Dr(c)),xe(c),p=c.type,A=c.pendingProps,S=o!==null?o.memoizedProps:null,f=A.children,Up(p,A)?f=null:S!==null&&Up(p,S)&&(c.flags|=32),c.memoizedState!==null&&(p=Fg(o,c,vw,null,null,u),Yc._currentValue=p),Yu(o,c),Ve(o,c,f,u),c.child;case 6:return o===null&&Vt&&((o=u=ge)&&(u=cO(u,c.pendingProps,Rs),u!==null?(c.stateNode=u,rn=c,ge=null,o=!0):o=!1),o||Dr(c)),null;case 13:return ky(o,c,u);case 4:return Ut(c,c.stateNode.containerInfo),f=c.pendingProps,o===null?c.child=qo(c,null,f,u):Ve(o,c,f,u),c.child;case 11:return xy(o,c,c.type,c.pendingProps,u);case 7:return Ve(o,c,c.pendingProps,u),c.child;case 8:return Ve(o,c,c.pendingProps.children,u),c.child;case 12:return Ve(o,c,c.pendingProps.children,u),c.child;case 10:return f=c.pendingProps,Ni(c,c.type,f.value),Ve(o,c,f.children,u),c.child;case 9:return p=c.type._context,f=c.pendingProps.children,Fr(c),p=Ke(p),f=f(p),c.flags|=1,Ve(o,c,f,u),c.child;case 14:return Ny(o,c,c.type,c.pendingProps,u);case 15:return Iy(o,c,c.type,c.pendingProps,u);case 19:return Vy(o,c,u);case 31:return f=c.pendingProps,u=c.mode,f={mode:f.mode,children:f.children},o===null?(u=Ku(f,u),u.ref=c.ref,c.child=u,u.return=c,c=u):(u=ei(o.child,f),u.ref=c.ref,c.child=u,u.return=c,c=u),c;case 22:return Dy(o,c,u);case 24:return Fr(c),f=Ke(we),o===null?(p=Mg(),p===null&&(p=ae,A=vg(),p.pooledCache=A,A.refCount++,A!==null&&(p.pooledCacheLanes|=u),p=A),c.memoizedState={parent:f,cache:p},Og(c),Ni(c,we,p)):((o.lanes&u)!==0&&(Bg(o,c),Mc(c,null,null,u),Cc()),p=o.memoizedState,A=c.memoizedState,p.parent!==f?(p={parent:f,cache:f},c.memoizedState=p,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=p),Ni(c,we,f)):(f=A.cache,Ni(c,we,f),f!==p.cache&&Rg(c,[we],u,!0))),Ve(o,c,c.pendingProps.children,u),c.child;case 29:throw c.pendingProps}throw Error(s(156,c.tag))}function li(o){o.flags|=4}function jy(o,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!JT(c)){if(c=Wn.current,c!==null&&((Dt&4194048)===Dt?vs!==null:(Dt&62914560)!==Dt&&(Dt&536870912)===0||c!==vs))throw Rc=wg,CA;o.flags|=8192}}function Ju(o,c){c!==null&&(o.flags|=4),o.flags&16384&&(c=o.tag!==22?fu():536870912,o.lanes|=c,Zo|=c)}function Dc(o,c){if(!Vt)switch(o.tailMode){case"hidden":c=o.tail;for(var u=null;c!==null;)c.alternate!==null&&(u=c),c=c.sibling;u===null?o.tail=null:u.sibling=null;break;case"collapsed":u=o.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?c||o.tail===null?o.tail=null:o.tail.sibling=null:f.sibling=null}}function he(o){var c=o.alternate!==null&&o.alternate.child===o.child,u=0,f=0;if(c)for(var p=o.child;p!==null;)u|=p.lanes|p.childLanes,f|=p.subtreeFlags&65011712,f|=p.flags&65011712,p.return=o,p=p.sibling;else for(p=o.child;p!==null;)u|=p.lanes|p.childLanes,f|=p.subtreeFlags,f|=p.flags,p.return=o,p=p.sibling;return o.subtreeFlags|=f,o.childLanes=u,c}function Dw(o,c,u){var f=c.pendingProps;switch(Tg(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return he(c),null;case 1:return he(c),null;case 3:return u=c.stateNode,f=null,o!==null&&(f=o.memoizedState.cache),c.memoizedState.cache!==f&&(c.flags|=2048),ri(we),$t(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(o===null||o.child===null)&&(mc(c)?li(c):o===null||o.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,EA())),he(c),null;case 26:return u=c.memoizedState,o===null?(li(c),u!==null?(he(c),jy(c,u)):(he(c),c.flags&=-16777217)):u?u!==o.memoizedState?(li(c),he(c),jy(c,u)):(he(c),c.flags&=-16777217):(o.memoizedProps!==f&&li(c),he(c),c.flags&=-16777217),null;case 27:Xs(c),u=vt.current;var p=c.type;if(o!==null&&c.stateNode!=null)o.memoizedProps!==f&&li(c);else{if(!f){if(c.stateNode===null)throw Error(s(166));return he(c),null}o=_t.current,mc(c)?yA(c):(o=jT(p,f,u),c.stateNode=o,li(c))}return he(c),null;case 5:if(Xs(c),u=c.type,o!==null&&c.stateNode!=null)o.memoizedProps!==f&&li(c);else{if(!f){if(c.stateNode===null)throw Error(s(166));return he(c),null}if(o=_t.current,mc(c))yA(c);else{switch(p=uh(vt.current),o){case 1:o=p.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:o=p.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":o=p.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":o=p.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":o=p.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof f.is=="string"?p.createElement("select",{is:f.is}):p.createElement("select"),f.multiple?o.multiple=!0:f.size&&(o.size=f.size);break;default:o=typeof f.is=="string"?p.createElement(u,{is:f.is}):p.createElement(u)}}o[me]=c,o[qe]=f;t:for(p=c.child;p!==null;){if(p.tag===5||p.tag===6)o.appendChild(p.stateNode);else if(p.tag!==4&&p.tag!==27&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===c)break t;for(;p.sibling===null;){if(p.return===null||p.return===c)break t;p=p.return}p.sibling.return=p.return,p=p.sibling}c.stateNode=o;t:switch(je(o,u,f),u){case"button":case"input":case"select":case"textarea":o=!!f.autoFocus;break t;case"img":o=!0;break t;default:o=!1}o&&li(c)}}return he(c),c.flags&=-16777217,null;case 6:if(o&&c.stateNode!=null)o.memoizedProps!==f&&li(c);else{if(typeof f!="string"&&c.stateNode===null)throw Error(s(166));if(o=vt.current,mc(c)){if(o=c.stateNode,u=c.memoizedProps,f=null,p=rn,p!==null)switch(p.tag){case 27:case 5:f=p.memoizedProps}o[me]=c,o=!!(o.nodeValue===u||f!==null&&f.suppressHydrationWarning===!0||FT(o.nodeValue,u)),o||Dr(c)}else o=uh(o).createTextNode(f),o[me]=c,c.stateNode=o}return he(c),null;case 13:if(f=c.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(p=mc(c),f!==null&&f.dehydrated!==null){if(o===null){if(!p)throw Error(s(318));if(p=c.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(s(317));p[me]=c}else Ac(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;he(c),p=!1}else p=EA(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=p),p=!0;if(!p)return c.flags&256?(ai(c),c):(ai(c),null)}if(ai(c),(c.flags&128)!==0)return c.lanes=u,c;if(u=f!==null,o=o!==null&&o.memoizedState!==null,u){f=c.child,p=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(p=f.alternate.memoizedState.cachePool.pool);var A=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(A=f.memoizedState.cachePool.pool),A!==p&&(f.flags|=2048)}return u!==o&&u&&(c.child.flags|=8192),Ju(c,c.updateQueue),he(c),null;case 4:return $t(),o===null&&Np(c.stateNode.containerInfo),he(c),null;case 10:return ri(c.type),he(c),null;case 19:if(ut(Oe),p=c.memoizedState,p===null)return he(c),null;if(f=(c.flags&128)!==0,A=p.rendering,A===null)if(f)Dc(p,!1);else{if(pe!==0||o!==null&&(o.flags&128)!==0)for(o=c.child;o!==null;){if(A=Gu(o),A!==null){for(c.flags|=128,Dc(p,!1),o=A.updateQueue,c.updateQueue=o,Ju(c,o),c.subtreeFlags=0,o=u,u=c.child;u!==null;)mA(u,o),u=u.sibling;return ht(Oe,Oe.current&1|2),c.child}o=o.sibling}p.tail!==null&&Ne()>th&&(c.flags|=128,f=!0,Dc(p,!1),c.lanes=4194304)}else{if(!f)if(o=Gu(A),o!==null){if(c.flags|=128,f=!0,o=o.updateQueue,c.updateQueue=o,Ju(c,o),Dc(p,!0),p.tail===null&&p.tailMode==="hidden"&&!A.alternate&&!Vt)return he(c),null}else 2*Ne()-p.renderingStartTime>th&&u!==536870912&&(c.flags|=128,f=!0,Dc(p,!1),c.lanes=4194304);p.isBackwards?(A.sibling=c.child,c.child=A):(o=p.last,o!==null?o.sibling=A:c.child=A,p.last=A)}return p.tail!==null?(c=p.tail,p.rendering=c,p.tail=c.sibling,p.renderingStartTime=Ne(),c.sibling=null,o=Oe.current,ht(Oe,f?o&1|2:o&1),c):(he(c),null);case 22:case 23:return ai(c),Dg(),f=c.memoizedState!==null,o!==null?o.memoizedState!==null!==f&&(c.flags|=8192):f&&(c.flags|=8192),f?(u&536870912)!==0&&(c.flags&128)===0&&(he(c),c.subtreeFlags&6&&(c.flags|=8192)):he(c),u=c.updateQueue,u!==null&&Ju(c,u.retryQueue),u=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(u=o.memoizedState.cachePool.pool),f=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(f=c.memoizedState.cachePool.pool),f!==u&&(c.flags|=2048),o!==null&&ut(Ur),null;case 24:return u=null,o!==null&&(u=o.memoizedState.cache),c.memoizedState.cache!==u&&(c.flags|=2048),ri(we),he(c),null;case 25:return null;case 30:return null}throw Error(s(156,c.tag))}function Pw(o,c){switch(Tg(c),c.tag){case 1:return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 3:return ri(we),$t(),o=c.flags,(o&65536)!==0&&(o&128)===0?(c.flags=o&-65537|128,c):null;case 26:case 27:case 5:return Xs(c),null;case 13:if(ai(c),o=c.memoizedState,o!==null&&o.dehydrated!==null){if(c.alternate===null)throw Error(s(340));Ac()}return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 19:return ut(Oe),null;case 4:return $t(),null;case 10:return ri(c.type),null;case 22:case 23:return ai(c),Dg(),o!==null&&ut(Ur),o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 24:return ri(we),null;case 25:return null;default:return null}}function $y(o,c){switch(Tg(c),c.tag){case 3:ri(we),$t();break;case 26:case 27:case 5:Xs(c);break;case 4:$t();break;case 13:ai(c);break;case 19:ut(Oe);break;case 10:ri(c.type);break;case 22:case 23:ai(c),Dg(),o!==null&&ut(Ur);break;case 24:ri(we)}}function Pc(o,c){try{var u=c.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var p=f.next;u=p;do{if((u.tag&o)===o){f=void 0;var A=u.create,S=u.inst;f=A(),S.destroy=f}u=u.next}while(u!==p)}}catch(C){te(c,c.return,C)}}function ki(o,c,u){try{var f=c.updateQueue,p=f!==null?f.lastEffect:null;if(p!==null){var A=p.next;f=A;do{if((f.tag&o)===o){var S=f.inst,C=S.destroy;if(C!==void 0){S.destroy=void 0,p=c;var D=u,$=C;try{$()}catch(Z){te(p,D,Z)}}}f=f.next}while(f!==A)}}catch(Z){te(c,c.return,Z)}}function Xy(o){var c=o.updateQueue;if(c!==null){var u=o.stateNode;try{NA(c,u)}catch(f){te(o,o.return,f)}}}function Gy(o,c,u){u.props=kr(o.type,o.memoizedProps),u.state=o.memoizedState;try{u.componentWillUnmount()}catch(f){te(o,c,f)}}function Fc(o,c){try{var u=o.ref;if(u!==null){switch(o.tag){case 26:case 27:case 5:var f=o.stateNode;break;case 30:f=o.stateNode;break;default:f=o.stateNode}typeof u=="function"?o.refCleanup=u(f):u.current=f}}catch(p){te(o,c,p)}}function Cs(o,c){var u=o.ref,f=o.refCleanup;if(u!==null)if(typeof f=="function")try{f()}catch(p){te(o,c,p)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(p){te(o,c,p)}else u.current=null}function Wy(o){var c=o.type,u=o.memoizedProps,f=o.stateNode;try{t:switch(c){case"button":case"input":case"select":case"textarea":u.autoFocus&&f.focus();break t;case"img":u.src?f.src=u.src:u.srcSet&&(f.srcset=u.srcSet)}}catch(p){te(o,o.return,p)}}function cp(o,c,u){try{var f=o.stateNode;nO(f,o.type,u,c),f[qe]=c}catch(p){te(o,o.return,p)}}function qy(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&Wi(o.type)||o.tag===4}function lp(o){t:for(;;){for(;o.sibling===null;){if(o.return===null||qy(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&Wi(o.type)||o.flags&2||o.child===null||o.tag===4)continue t;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function up(o,c,u){var f=o.tag;if(f===5||f===6)o=o.stateNode,c?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(o,c):(c=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,c.appendChild(o),u=u._reactRootContainer,u!=null||c.onclick!==null||(c.onclick=lh));else if(f!==4&&(f===27&&Wi(o.type)&&(u=o.stateNode,c=null),o=o.child,o!==null))for(up(o,c,u),o=o.sibling;o!==null;)up(o,c,u),o=o.sibling}function Zu(o,c,u){var f=o.tag;if(f===5||f===6)o=o.stateNode,c?u.insertBefore(o,c):u.appendChild(o);else if(f!==4&&(f===27&&Wi(o.type)&&(u=o.stateNode),o=o.child,o!==null))for(Zu(o,c,u),o=o.sibling;o!==null;)Zu(o,c,u),o=o.sibling}function Yy(o){var c=o.stateNode,u=o.memoizedProps;try{for(var f=o.type,p=c.attributes;p.length;)c.removeAttributeNode(p[0]);je(c,f,u),c[me]=o,c[qe]=u}catch(A){te(o,o.return,A)}}var ui=!1,ye=!1,hp=!1,Ky=typeof WeakSet=="function"?WeakSet:Set,De=null;function Fw(o,c){if(o=o.containerInfo,Pp=_h,o=aA(o),lg(o)){if("selectionStart"in o)var u={start:o.selectionStart,end:o.selectionEnd};else t:{u=(u=o.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var p=f.anchorOffset,A=f.focusNode;f=f.focusOffset;try{u.nodeType,A.nodeType}catch{u=null;break t}var S=0,C=-1,D=-1,$=0,Z=0,nt=o,X=null;e:for(;;){for(var W;nt!==u||p!==0&&nt.nodeType!==3||(C=S+p),nt!==A||f!==0&&nt.nodeType!==3||(D=S+f),nt.nodeType===3&&(S+=nt.nodeValue.length),(W=nt.firstChild)!==null;)X=nt,nt=W;for(;;){if(nt===o)break e;if(X===u&&++$===p&&(C=S),X===A&&++Z===f&&(D=S),(W=nt.nextSibling)!==null)break;nt=X,X=nt.parentNode}nt=W}u=C===-1||D===-1?null:{start:C,end:D}}else u=null}u=u||{start:0,end:0}}else u=null;for(Fp={focusedElem:o,selectionRange:u},_h=!1,De=c;De!==null;)if(c=De,o=c.child,(c.subtreeFlags&1024)!==0&&o!==null)o.return=c,De=o;else for(;De!==null;){switch(c=De,A=c.alternate,o=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((o&1024)!==0&&A!==null){o=void 0,u=c,p=A.memoizedProps,A=A.memoizedState,f=u.stateNode;try{var Rt=kr(u.type,p,u.elementType===u.type);o=f.getSnapshotBeforeUpdate(Rt,A),f.__reactInternalSnapshotBeforeUpdate=o}catch(Et){te(u,u.return,Et)}}break;case 3:if((o&1024)!==0){if(o=c.stateNode.containerInfo,u=o.nodeType,u===9)kp(o);else if(u===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":kp(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(s(163))}if(o=c.sibling,o!==null){o.return=c.return,De=o;break}De=c.return}}function Jy(o,c,u){var f=u.flags;switch(u.tag){case 0:case 11:case 15:zi(o,u),f&4&&Pc(5,u);break;case 1:if(zi(o,u),f&4)if(o=u.stateNode,c===null)try{o.componentDidMount()}catch(S){te(u,u.return,S)}else{var p=kr(u.type,c.memoizedProps);c=c.memoizedState;try{o.componentDidUpdate(p,c,o.__reactInternalSnapshotBeforeUpdate)}catch(S){te(u,u.return,S)}}f&64&&Xy(u),f&512&&Fc(u,u.return);break;case 3:if(zi(o,u),f&64&&(o=u.updateQueue,o!==null)){if(c=null,u.child!==null)switch(u.child.tag){case 27:case 5:c=u.child.stateNode;break;case 1:c=u.child.stateNode}try{NA(o,c)}catch(S){te(u,u.return,S)}}break;case 27:c===null&&f&4&&Yy(u);case 26:case 5:zi(o,u),c===null&&f&4&&Wy(u),f&512&&Fc(u,u.return);break;case 12:zi(o,u);break;case 13:zi(o,u),f&4&&tT(o,u),f&64&&(o=u.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(u=Xw.bind(null,u),lO(o,u))));break;case 22:if(f=u.memoizedState!==null||ui,!f){c=c!==null&&c.memoizedState!==null||ye,p=ui;var A=ye;ui=f,(ye=c)&&!A?Vi(o,u,(u.subtreeFlags&8772)!==0):zi(o,u),ui=p,ye=A}break;case 30:break;default:zi(o,u)}}function Zy(o){var c=o.alternate;c!==null&&(o.alternate=null,Zy(c)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(c=o.stateNode,c!==null&&bo(c)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var le=null,dn=!1;function hi(o,c,u){for(u=u.child;u!==null;)Qy(o,c,u),u=u.sibling}function Qy(o,c,u){if(Ge&&typeof Ge.onCommitFiberUnmount=="function")try{Ge.onCommitFiberUnmount(Sr,u)}catch{}switch(u.tag){case 26:ye||Cs(u,c),hi(o,c,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:ye||Cs(u,c);var f=le,p=dn;Wi(u.type)&&(le=u.stateNode,dn=!1),hi(o,c,u),Xc(u.stateNode),le=f,dn=p;break;case 5:ye||Cs(u,c);case 6:if(f=le,p=dn,le=null,hi(o,c,u),le=f,dn=p,le!==null)if(dn)try{(le.nodeType===9?le.body:le.nodeName==="HTML"?le.ownerDocument.body:le).removeChild(u.stateNode)}catch(A){te(u,c,A)}else try{le.removeChild(u.stateNode)}catch(A){te(u,c,A)}break;case 18:le!==null&&(dn?(o=le,VT(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,u.stateNode),Qc(o)):VT(le,u.stateNode));break;case 4:f=le,p=dn,le=u.stateNode.containerInfo,dn=!0,hi(o,c,u),le=f,dn=p;break;case 0:case 11:case 14:case 15:ye||ki(2,u,c),ye||ki(4,u,c),hi(o,c,u);break;case 1:ye||(Cs(u,c),f=u.stateNode,typeof f.componentWillUnmount=="function"&&Gy(u,c,f)),hi(o,c,u);break;case 21:hi(o,c,u);break;case 22:ye=(f=ye)||u.memoizedState!==null,hi(o,c,u),ye=f;break;default:hi(o,c,u)}}function tT(o,c){if(c.memoizedState===null&&(o=c.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{Qc(o)}catch(u){te(c,c.return,u)}}function Uw(o){switch(o.tag){case 13:case 19:var c=o.stateNode;return c===null&&(c=o.stateNode=new Ky),c;case 22:return o=o.stateNode,c=o._retryCache,c===null&&(c=o._retryCache=new Ky),c;default:throw Error(s(435,o.tag))}}function fp(o,c){var u=Uw(o);c.forEach(function(f){var p=Gw.bind(null,o,f);u.has(f)||(u.add(f),f.then(p,p))})}function wn(o,c){var u=c.deletions;if(u!==null)for(var f=0;f<u.length;f++){var p=u[f],A=o,S=c,C=S;t:for(;C!==null;){switch(C.tag){case 27:if(Wi(C.type)){le=C.stateNode,dn=!1;break t}break;case 5:le=C.stateNode,dn=!1;break t;case 3:case 4:le=C.stateNode.containerInfo,dn=!0;break t}C=C.return}if(le===null)throw Error(s(160));Qy(A,S,p),le=null,dn=!1,A=p.alternate,A!==null&&(A.return=null),p.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)eT(c,o),c=c.sibling}var os=null;function eT(o,c){var u=o.alternate,f=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:wn(c,o),On(o),f&4&&(ki(3,o,o.return),Pc(3,o),ki(5,o,o.return));break;case 1:wn(c,o),On(o),f&512&&(ye||u===null||Cs(u,u.return)),f&64&&ui&&(o=o.updateQueue,o!==null&&(f=o.callbacks,f!==null&&(u=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=u===null?f:u.concat(f))));break;case 26:var p=os;if(wn(c,o),On(o),f&512&&(ye||u===null||Cs(u,u.return)),f&4){var A=u!==null?u.memoizedState:null;if(f=o.memoizedState,u===null)if(f===null)if(o.stateNode===null){t:{f=o.type,u=o.memoizedProps,p=p.ownerDocument||p;e:switch(f){case"title":A=p.getElementsByTagName("title")[0],(!A||A[vr]||A[me]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=p.createElement(f),p.head.insertBefore(A,p.querySelector("head > title"))),je(A,f,u),A[me]=o,oe(A),f=A;break t;case"link":var S=YT("link","href",p).get(f+(u.href||""));if(S){for(var C=0;C<S.length;C++)if(A=S[C],A.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&A.getAttribute("rel")===(u.rel==null?null:u.rel)&&A.getAttribute("title")===(u.title==null?null:u.title)&&A.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){S.splice(C,1);break e}}A=p.createElement(f),je(A,f,u),p.head.appendChild(A);break;case"meta":if(S=YT("meta","content",p).get(f+(u.content||""))){for(C=0;C<S.length;C++)if(A=S[C],A.getAttribute("content")===(u.content==null?null:""+u.content)&&A.getAttribute("name")===(u.name==null?null:u.name)&&A.getAttribute("property")===(u.property==null?null:u.property)&&A.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&A.getAttribute("charset")===(u.charSet==null?null:u.charSet)){S.splice(C,1);break e}}A=p.createElement(f),je(A,f,u),p.head.appendChild(A);break;default:throw Error(s(468,f))}A[me]=o,oe(A),f=A}o.stateNode=f}else KT(p,o.type,o.stateNode);else o.stateNode=qT(p,f,o.memoizedProps);else A!==f?(A===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):A.count--,f===null?KT(p,o.type,o.stateNode):qT(p,f,o.memoizedProps)):f===null&&o.stateNode!==null&&cp(o,o.memoizedProps,u.memoizedProps)}break;case 27:wn(c,o),On(o),f&512&&(ye||u===null||Cs(u,u.return)),u!==null&&f&4&&cp(o,o.memoizedProps,u.memoizedProps);break;case 5:if(wn(c,o),On(o),f&512&&(ye||u===null||Cs(u,u.return)),o.flags&32){p=o.stateNode;try{w(p,"")}catch(W){te(o,o.return,W)}}f&4&&o.stateNode!=null&&(p=o.memoizedProps,cp(o,p,u!==null?u.memoizedProps:p)),f&1024&&(hp=!0);break;case 6:if(wn(c,o),On(o),f&4){if(o.stateNode===null)throw Error(s(162));f=o.memoizedProps,u=o.stateNode;try{u.nodeValue=f}catch(W){te(o,o.return,W)}}break;case 3:if(dh=null,p=os,os=hh(c.containerInfo),wn(c,o),os=p,On(o),f&4&&u!==null&&u.memoizedState.isDehydrated)try{Qc(c.containerInfo)}catch(W){te(o,o.return,W)}hp&&(hp=!1,nT(o));break;case 4:f=os,os=hh(o.stateNode.containerInfo),wn(c,o),On(o),os=f;break;case 12:wn(c,o),On(o);break;case 13:wn(c,o),On(o),o.child.flags&8192&&o.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Ap=Ne()),f&4&&(f=o.updateQueue,f!==null&&(o.updateQueue=null,fp(o,f)));break;case 22:p=o.memoizedState!==null;var D=u!==null&&u.memoizedState!==null,$=ui,Z=ye;if(ui=$||p,ye=Z||D,wn(c,o),ye=Z,ui=$,On(o),f&8192)t:for(c=o.stateNode,c._visibility=p?c._visibility&-2:c._visibility|1,p&&(u===null||D||ui||ye||zr(o)),u=null,c=o;;){if(c.tag===5||c.tag===26){if(u===null){D=u=c;try{if(A=D.stateNode,p)S=A.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{C=D.stateNode;var nt=D.memoizedProps.style,X=nt!=null&&nt.hasOwnProperty("display")?nt.display:null;C.style.display=X==null||typeof X=="boolean"?"":(""+X).trim()}}catch(W){te(D,D.return,W)}}}else if(c.tag===6){if(u===null){D=c;try{D.stateNode.nodeValue=p?"":D.memoizedProps}catch(W){te(D,D.return,W)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===o)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break t;for(;c.sibling===null;){if(c.return===null||c.return===o)break t;u===c&&(u=null),c=c.return}u===c&&(u=null),c.sibling.return=c.return,c=c.sibling}f&4&&(f=o.updateQueue,f!==null&&(u=f.retryQueue,u!==null&&(f.retryQueue=null,fp(o,u))));break;case 19:wn(c,o),On(o),f&4&&(f=o.updateQueue,f!==null&&(o.updateQueue=null,fp(o,f)));break;case 30:break;case 21:break;default:wn(c,o),On(o)}}function On(o){var c=o.flags;if(c&2){try{for(var u,f=o.return;f!==null;){if(qy(f)){u=f;break}f=f.return}if(u==null)throw Error(s(160));switch(u.tag){case 27:var p=u.stateNode,A=lp(o);Zu(o,A,p);break;case 5:var S=u.stateNode;u.flags&32&&(w(S,""),u.flags&=-33);var C=lp(o);Zu(o,C,S);break;case 3:case 4:var D=u.stateNode.containerInfo,$=lp(o);up(o,$,D);break;default:throw Error(s(161))}}catch(Z){te(o,o.return,Z)}o.flags&=-3}c&4096&&(o.flags&=-4097)}function nT(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var c=o;nT(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),o=o.sibling}}function zi(o,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)Jy(o,c.alternate,c),c=c.sibling}function zr(o){for(o=o.child;o!==null;){var c=o;switch(c.tag){case 0:case 11:case 14:case 15:ki(4,c,c.return),zr(c);break;case 1:Cs(c,c.return);var u=c.stateNode;typeof u.componentWillUnmount=="function"&&Gy(c,c.return,u),zr(c);break;case 27:Xc(c.stateNode);case 26:case 5:Cs(c,c.return),zr(c);break;case 22:c.memoizedState===null&&zr(c);break;case 30:zr(c);break;default:zr(c)}o=o.sibling}}function Vi(o,c,u){for(u=u&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var f=c.alternate,p=o,A=c,S=A.flags;switch(A.tag){case 0:case 11:case 15:Vi(p,A,u),Pc(4,A);break;case 1:if(Vi(p,A,u),f=A,p=f.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch($){te(f,f.return,$)}if(f=A,p=f.updateQueue,p!==null){var C=f.stateNode;try{var D=p.shared.hiddenCallbacks;if(D!==null)for(p.shared.hiddenCallbacks=null,p=0;p<D.length;p++)xA(D[p],C)}catch($){te(f,f.return,$)}}u&&S&64&&Xy(A),Fc(A,A.return);break;case 27:Yy(A);case 26:case 5:Vi(p,A,u),u&&f===null&&S&4&&Wy(A),Fc(A,A.return);break;case 12:Vi(p,A,u);break;case 13:Vi(p,A,u),u&&S&4&&tT(p,A);break;case 22:A.memoizedState===null&&Vi(p,A,u),Fc(A,A.return);break;case 30:break;default:Vi(p,A,u)}c=c.sibling}}function dp(o,c){var u=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(u=o.memoizedState.cachePool.pool),o=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(o=c.memoizedState.cachePool.pool),o!==u&&(o!=null&&o.refCount++,u!=null&&Ec(u))}function gp(o,c){o=null,c.alternate!==null&&(o=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==o&&(c.refCount++,o!=null&&Ec(o))}function Ms(o,c,u,f){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)sT(o,c,u,f),c=c.sibling}function sT(o,c,u,f){var p=c.flags;switch(c.tag){case 0:case 11:case 15:Ms(o,c,u,f),p&2048&&Pc(9,c);break;case 1:Ms(o,c,u,f);break;case 3:Ms(o,c,u,f),p&2048&&(o=null,c.alternate!==null&&(o=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==o&&(c.refCount++,o!=null&&Ec(o)));break;case 12:if(p&2048){Ms(o,c,u,f),o=c.stateNode;try{var A=c.memoizedProps,S=A.id,C=A.onPostCommit;typeof C=="function"&&C(S,c.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(D){te(c,c.return,D)}}else Ms(o,c,u,f);break;case 13:Ms(o,c,u,f);break;case 23:break;case 22:A=c.stateNode,S=c.alternate,c.memoizedState!==null?A._visibility&2?Ms(o,c,u,f):Uc(o,c):A._visibility&2?Ms(o,c,u,f):(A._visibility|=2,Yo(o,c,u,f,(c.subtreeFlags&10256)!==0)),p&2048&&dp(S,c);break;case 24:Ms(o,c,u,f),p&2048&&gp(c.alternate,c);break;default:Ms(o,c,u,f)}}function Yo(o,c,u,f,p){for(p=p&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var A=o,S=c,C=u,D=f,$=S.flags;switch(S.tag){case 0:case 11:case 15:Yo(A,S,C,D,p),Pc(8,S);break;case 23:break;case 22:var Z=S.stateNode;S.memoizedState!==null?Z._visibility&2?Yo(A,S,C,D,p):Uc(A,S):(Z._visibility|=2,Yo(A,S,C,D,p)),p&&$&2048&&dp(S.alternate,S);break;case 24:Yo(A,S,C,D,p),p&&$&2048&&gp(S.alternate,S);break;default:Yo(A,S,C,D,p)}c=c.sibling}}function Uc(o,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var u=o,f=c,p=f.flags;switch(f.tag){case 22:Uc(u,f),p&2048&&dp(f.alternate,f);break;case 24:Uc(u,f),p&2048&&gp(f.alternate,f);break;default:Uc(u,f)}c=c.sibling}}var Lc=8192;function Ko(o){if(o.subtreeFlags&Lc)for(o=o.child;o!==null;)iT(o),o=o.sibling}function iT(o){switch(o.tag){case 26:Ko(o),o.flags&Lc&&o.memoizedState!==null&&bO(os,o.memoizedState,o.memoizedProps);break;case 5:Ko(o);break;case 3:case 4:var c=os;os=hh(o.stateNode.containerInfo),Ko(o),os=c;break;case 22:o.memoizedState===null&&(c=o.alternate,c!==null&&c.memoizedState!==null?(c=Lc,Lc=16777216,Ko(o),Lc=c):Ko(o));break;default:Ko(o)}}function rT(o){var c=o.alternate;if(c!==null&&(o=c.child,o!==null)){c.child=null;do c=o.sibling,o.sibling=null,o=c;while(o!==null)}}function kc(o){var c=o.deletions;if((o.flags&16)!==0){if(c!==null)for(var u=0;u<c.length;u++){var f=c[u];De=f,aT(f,o)}rT(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)oT(o),o=o.sibling}function oT(o){switch(o.tag){case 0:case 11:case 15:kc(o),o.flags&2048&&ki(9,o,o.return);break;case 3:kc(o);break;case 12:kc(o);break;case 22:var c=o.stateNode;o.memoizedState!==null&&c._visibility&2&&(o.return===null||o.return.tag!==13)?(c._visibility&=-3,Qu(o)):kc(o);break;default:kc(o)}}function Qu(o){var c=o.deletions;if((o.flags&16)!==0){if(c!==null)for(var u=0;u<c.length;u++){var f=c[u];De=f,aT(f,o)}rT(o)}for(o=o.child;o!==null;){switch(c=o,c.tag){case 0:case 11:case 15:ki(8,c,c.return),Qu(c);break;case 22:u=c.stateNode,u._visibility&2&&(u._visibility&=-3,Qu(c));break;default:Qu(c)}o=o.sibling}}function aT(o,c){for(;De!==null;){var u=De;switch(u.tag){case 0:case 11:case 15:ki(8,u,c);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var f=u.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Ec(u.memoizedState.cache)}if(f=u.child,f!==null)f.return=u,De=f;else t:for(u=o;De!==null;){f=De;var p=f.sibling,A=f.return;if(Zy(f),f===u){De=null;break t}if(p!==null){p.return=A,De=p;break t}De=A}}}var Lw={getCacheForType:function(o){var c=Ke(we),u=c.data.get(o);return u===void 0&&(u=o(),c.data.set(o,u)),u}},kw=typeof WeakMap=="function"?WeakMap:Map,Xt=0,ae=null,Bt=null,Dt=0,Gt=0,Bn=null,Hi=!1,Jo=!1,pp=!1,fi=0,pe=0,ji=0,Vr=0,_p=0,qn=0,Zo=0,zc=null,gn=null,mp=!1,Ap=0,th=1/0,eh=null,$i=null,He=0,Xi=null,Qo=null,ta=0,yp=0,Tp=null,cT=null,Vc=0,Ep=null;function xn(){if((Xt&2)!==0&&Dt!==0)return Dt&-Dt;if(K.T!==null){var o=Vo;return o!==0?o:wp()}return pu()}function lT(){qn===0&&(qn=(Dt&536870912)===0||Vt?hu():536870912);var o=Wn.current;return o!==null&&(o.flags|=32),qn}function Nn(o,c,u){(o===ae&&(Gt===2||Gt===9)||o.cancelPendingCommit!==null)&&(ea(o,0),Gi(o,Dt,qn,!1)),Ri(o,u),((Xt&2)===0||o!==ae)&&(o===ae&&((Xt&2)===0&&(Vr|=u),pe===4&&Gi(o,Dt,qn,!1)),ws(o))}function uT(o,c,u){if((Xt&6)!==0)throw Error(s(327));var f=!u&&(c&124)===0&&(c&o.expiredLanes)===0||Rr(o,c),p=f?Hw(o,c):Rp(o,c,!0),A=f;do{if(p===0){Jo&&!f&&Gi(o,c,0,!1);break}else{if(u=o.current.alternate,A&&!zw(u)){p=Rp(o,c,!1),A=!1;continue}if(p===2){if(A=c,o.errorRecoveryDisabledLanes&A)var S=0;else S=o.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){c=S;t:{var C=o;p=zc;var D=C.current.memoizedState.isDehydrated;if(D&&(ea(C,S).flags|=256),S=Rp(C,S,!1),S!==2){if(pp&&!D){C.errorRecoveryDisabledLanes|=A,Vr|=A,p=4;break t}A=gn,gn=p,A!==null&&(gn===null?gn=A:gn.push.apply(gn,A))}p=S}if(A=!1,p!==2)continue}}if(p===1){ea(o,0),Gi(o,c,0,!0);break}t:{switch(f=o,A=p,A){case 0:case 1:throw Error(s(345));case 4:if((c&4194048)!==c)break;case 6:Gi(f,c,qn,!Hi);break t;case 2:gn=null;break;case 3:case 5:break;default:throw Error(s(329))}if((c&62914560)===c&&(p=Ap+300-Ne(),10<p)){if(Gi(f,c,qn,!Hi),mo(f,0,!0)!==0)break t;f.timeoutHandle=kT(hT.bind(null,f,u,gn,eh,mp,c,qn,Vr,Zo,Hi,A,2,-0,0),p);break t}hT(f,u,gn,eh,mp,c,qn,Vr,Zo,Hi,A,0,-0,0)}}break}while(!0);ws(o)}function hT(o,c,u,f,p,A,S,C,D,$,Z,nt,X,W){if(o.timeoutHandle=-1,nt=c.subtreeFlags,(nt&8192||(nt&16785408)===16785408)&&(qc={stylesheets:null,count:0,unsuspend:EO},iT(c),nt=SO(),nt!==null)){o.cancelPendingCommit=nt(AT.bind(null,o,c,A,u,f,p,S,C,D,Z,1,X,W)),Gi(o,A,S,!$);return}AT(o,c,A,u,f,p,S,C,D)}function zw(o){for(var c=o;;){var u=c.tag;if((u===0||u===11||u===15)&&c.flags&16384&&(u=c.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var f=0;f<u.length;f++){var p=u[f],A=p.getSnapshot;p=p.value;try{if(!Cn(A(),p))return!1}catch{return!1}}if(u=c.child,c.subtreeFlags&16384&&u!==null)u.return=c,c=u;else{if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Gi(o,c,u,f){c&=~_p,c&=~Vr,o.suspendedLanes|=c,o.pingedLanes&=~c,f&&(o.warmLanes|=c),f=o.expirationTimes;for(var p=c;0<p;){var A=31-We(p),S=1<<A;f[A]=-1,p&=~S}u!==0&&du(o,u,c)}function nh(){return(Xt&6)===0?(Hc(0),!1):!0}function bp(){if(Bt!==null){if(Gt===0)var o=Bt.return;else o=Bt,ii=Pr=null,kg(o),Wo=null,Nc=0,o=Bt;for(;o!==null;)$y(o.alternate,o),o=o.return;Bt=null}}function ea(o,c){var u=o.timeoutHandle;u!==-1&&(o.timeoutHandle=-1,iO(u)),u=o.cancelPendingCommit,u!==null&&(o.cancelPendingCommit=null,u()),bp(),ae=o,Bt=u=ei(o.current,null),Dt=c,Gt=0,Bn=null,Hi=!1,Jo=Rr(o,c),pp=!1,Zo=qn=_p=Vr=ji=pe=0,gn=zc=null,mp=!1,(c&8)!==0&&(c|=c&32);var f=o.entangledLanes;if(f!==0)for(o=o.entanglements,f&=c;0<f;){var p=31-We(f),A=1<<p;c|=o[p],f&=~A}return fi=c,Ru(),u}function fT(o,c){wt=null,K.H=ju,c===Sc||c===Iu?(c=OA(),Gt=3):c===CA?(c=OA(),Gt=4):Gt=c===By?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,Bn=c,Bt===null&&(pe=1,qu(o,jn(c,o.current)))}function dT(){var o=K.H;return K.H=ju,o===null?ju:o}function gT(){var o=K.A;return K.A=Lw,o}function Sp(){pe=4,Hi||(Dt&4194048)!==Dt&&Wn.current!==null||(Jo=!0),(ji&134217727)===0&&(Vr&134217727)===0||ae===null||Gi(ae,Dt,qn,!1)}function Rp(o,c,u){var f=Xt;Xt|=2;var p=dT(),A=gT();(ae!==o||Dt!==c)&&(eh=null,ea(o,c)),c=!1;var S=pe;t:do try{if(Gt!==0&&Bt!==null){var C=Bt,D=Bn;switch(Gt){case 8:bp(),S=6;break t;case 3:case 2:case 9:case 6:Wn.current===null&&(c=!0);var $=Gt;if(Gt=0,Bn=null,na(o,C,D,$),u&&Jo){S=0;break t}break;default:$=Gt,Gt=0,Bn=null,na(o,C,D,$)}}Vw(),S=pe;break}catch(Z){fT(o,Z)}while(!0);return c&&o.shellSuspendCounter++,ii=Pr=null,Xt=f,K.H=p,K.A=A,Bt===null&&(ae=null,Dt=0,Ru()),S}function Vw(){for(;Bt!==null;)pT(Bt)}function Hw(o,c){var u=Xt;Xt|=2;var f=dT(),p=gT();ae!==o||Dt!==c?(eh=null,th=Ne()+500,ea(o,c)):Jo=Rr(o,c);t:do try{if(Gt!==0&&Bt!==null){c=Bt;var A=Bn;e:switch(Gt){case 1:Gt=0,Bn=null,na(o,c,A,1);break;case 2:case 9:if(MA(A)){Gt=0,Bn=null,_T(c);break}c=function(){Gt!==2&&Gt!==9||ae!==o||(Gt=7),ws(o)},A.then(c,c);break t;case 3:Gt=7;break t;case 4:Gt=5;break t;case 7:MA(A)?(Gt=0,Bn=null,_T(c)):(Gt=0,Bn=null,na(o,c,A,7));break;case 5:var S=null;switch(Bt.tag){case 26:S=Bt.memoizedState;case 5:case 27:var C=Bt;if(!S||JT(S)){Gt=0,Bn=null;var D=C.sibling;if(D!==null)Bt=D;else{var $=C.return;$!==null?(Bt=$,sh($)):Bt=null}break e}}Gt=0,Bn=null,na(o,c,A,5);break;case 6:Gt=0,Bn=null,na(o,c,A,6);break;case 8:bp(),pe=6;break t;default:throw Error(s(462))}}jw();break}catch(Z){fT(o,Z)}while(!0);return ii=Pr=null,K.H=f,K.A=p,Xt=u,Bt!==null?0:(ae=null,Dt=0,Ru(),pe)}function jw(){for(;Bt!==null&&!Er();)pT(Bt)}function pT(o){var c=Hy(o.alternate,o,fi);o.memoizedProps=o.pendingProps,c===null?sh(o):Bt=c}function _T(o){var c=o,u=c.alternate;switch(c.tag){case 15:case 0:c=Fy(u,c,c.pendingProps,c.type,void 0,Dt);break;case 11:c=Fy(u,c,c.pendingProps,c.type.render,c.ref,Dt);break;case 5:kg(c);default:$y(u,c),c=Bt=mA(c,fi),c=Hy(u,c,fi)}o.memoizedProps=o.pendingProps,c===null?sh(o):Bt=c}function na(o,c,u,f){ii=Pr=null,kg(c),Wo=null,Nc=0;var p=c.return;try{if(Nw(o,p,c,u,Dt)){pe=1,qu(o,jn(u,o.current)),Bt=null;return}}catch(A){if(p!==null)throw Bt=p,A;pe=1,qu(o,jn(u,o.current)),Bt=null;return}c.flags&32768?(Vt||f===1?o=!0:Jo||(Dt&536870912)!==0?o=!1:(Hi=o=!0,(f===2||f===9||f===3||f===6)&&(f=Wn.current,f!==null&&f.tag===13&&(f.flags|=16384))),mT(c,o)):sh(c)}function sh(o){var c=o;do{if((c.flags&32768)!==0){mT(c,Hi);return}o=c.return;var u=Dw(c.alternate,c,fi);if(u!==null){Bt=u;return}if(c=c.sibling,c!==null){Bt=c;return}Bt=c=o}while(c!==null);pe===0&&(pe=5)}function mT(o,c){do{var u=Pw(o.alternate,o);if(u!==null){u.flags&=32767,Bt=u;return}if(u=o.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!c&&(o=o.sibling,o!==null)){Bt=o;return}Bt=o=u}while(o!==null);pe=6,Bt=null}function AT(o,c,u,f,p,A,S,C,D){o.cancelPendingCommit=null;do ih();while(He!==0);if((Xt&6)!==0)throw Error(s(327));if(c!==null){if(c===o.current)throw Error(s(177));if(A=c.lanes|c.childLanes,A|=gg,sc(o,u,A,S,C,D),o===ae&&(Bt=ae=null,Dt=0),Qo=c,Xi=o,ta=u,yp=A,Tp=p,cT=f,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,Ww(ke,function(){return ST(),null})):(o.callbackNode=null,o.callbackPriority=0),f=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||f){f=K.T,K.T=null,p=lt.p,lt.p=2,S=Xt,Xt|=4;try{Fw(o,c,u)}finally{Xt=S,lt.p=p,K.T=f}}He=1,yT(),TT(),ET()}}function yT(){if(He===1){He=0;var o=Xi,c=Qo,u=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||u){u=K.T,K.T=null;var f=lt.p;lt.p=2;var p=Xt;Xt|=4;try{eT(c,o);var A=Fp,S=aA(o.containerInfo),C=A.focusedElem,D=A.selectionRange;if(S!==C&&C&&C.ownerDocument&&oA(C.ownerDocument.documentElement,C)){if(D!==null&&lg(C)){var $=D.start,Z=D.end;if(Z===void 0&&(Z=$),"selectionStart"in C)C.selectionStart=$,C.selectionEnd=Math.min(Z,C.value.length);else{var nt=C.ownerDocument||document,X=nt&&nt.defaultView||window;if(X.getSelection){var W=X.getSelection(),Rt=C.textContent.length,Et=Math.min(D.start,Rt),Kt=D.end===void 0?Et:Math.min(D.end,Rt);!W.extend&&Et>Kt&&(S=Kt,Kt=Et,Et=S);var V=rA(C,Et),L=rA(C,Kt);if(V&&L&&(W.rangeCount!==1||W.anchorNode!==V.node||W.anchorOffset!==V.offset||W.focusNode!==L.node||W.focusOffset!==L.offset)){var H=nt.createRange();H.setStart(V.node,V.offset),W.removeAllRanges(),Et>Kt?(W.addRange(H),W.extend(L.node,L.offset)):(H.setEnd(L.node,L.offset),W.addRange(H))}}}}for(nt=[],W=C;W=W.parentNode;)W.nodeType===1&&nt.push({element:W,left:W.scrollLeft,top:W.scrollTop});for(typeof C.focus=="function"&&C.focus(),C=0;C<nt.length;C++){var tt=nt[C];tt.element.scrollLeft=tt.left,tt.element.scrollTop=tt.top}}_h=!!Pp,Fp=Pp=null}finally{Xt=p,lt.p=f,K.T=u}}o.current=c,He=2}}function TT(){if(He===2){He=0;var o=Xi,c=Qo,u=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||u){u=K.T,K.T=null;var f=lt.p;lt.p=2;var p=Xt;Xt|=4;try{Jy(o,c.alternate,c)}finally{Xt=p,lt.p=f,K.T=u}}He=3}}function ET(){if(He===4||He===3){He=0,Vn();var o=Xi,c=Qo,u=ta,f=cT;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?He=5:(He=0,Qo=Xi=null,bT(o,o.pendingLanes));var p=o.pendingLanes;if(p===0&&($i=null),To(u),c=c.stateNode,Ge&&typeof Ge.onCommitFiberRoot=="function")try{Ge.onCommitFiberRoot(Sr,c,void 0,(c.current.flags&128)===128)}catch{}if(f!==null){c=K.T,p=lt.p,lt.p=2,K.T=null;try{for(var A=o.onRecoverableError,S=0;S<f.length;S++){var C=f[S];A(C.value,{componentStack:C.stack})}}finally{K.T=c,lt.p=p}}(ta&3)!==0&&ih(),ws(o),p=o.pendingLanes,(u&4194090)!==0&&(p&42)!==0?o===Ep?Vc++:(Vc=0,Ep=o):Vc=0,Hc(0)}}function bT(o,c){(o.pooledCacheLanes&=c)===0&&(c=o.pooledCache,c!=null&&(o.pooledCache=null,Ec(c)))}function ih(o){return yT(),TT(),ET(),ST()}function ST(){if(He!==5)return!1;var o=Xi,c=yp;yp=0;var u=To(ta),f=K.T,p=lt.p;try{lt.p=32>u?32:u,K.T=null,u=Tp,Tp=null;var A=Xi,S=ta;if(He=0,Qo=Xi=null,ta=0,(Xt&6)!==0)throw Error(s(331));var C=Xt;if(Xt|=4,oT(A.current),sT(A,A.current,S,u),Xt=C,Hc(0,!1),Ge&&typeof Ge.onPostCommitFiberRoot=="function")try{Ge.onPostCommitFiberRoot(Sr,A)}catch{}return!0}finally{lt.p=p,K.T=f,bT(o,c)}}function RT(o,c,u){c=jn(u,c),c=Qg(o.stateNode,c,2),o=Pi(o,c,2),o!==null&&(Ri(o,2),ws(o))}function te(o,c,u){if(o.tag===3)RT(o,o,u);else for(;c!==null;){if(c.tag===3){RT(c,o,u);break}else if(c.tag===1){var f=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&($i===null||!$i.has(f))){o=jn(u,o),u=wy(2),f=Pi(c,u,2),f!==null&&(Oy(u,f,c,o),Ri(f,2),ws(f));break}}c=c.return}}function vp(o,c,u){var f=o.pingCache;if(f===null){f=o.pingCache=new kw;var p=new Set;f.set(c,p)}else p=f.get(c),p===void 0&&(p=new Set,f.set(c,p));p.has(u)||(pp=!0,p.add(u),o=$w.bind(null,o,c,u),c.then(o,o))}function $w(o,c,u){var f=o.pingCache;f!==null&&f.delete(c),o.pingedLanes|=o.suspendedLanes&u,o.warmLanes&=~u,ae===o&&(Dt&u)===u&&(pe===4||pe===3&&(Dt&62914560)===Dt&&300>Ne()-Ap?(Xt&2)===0&&ea(o,0):_p|=u,Zo===Dt&&(Zo=0)),ws(o)}function vT(o,c){c===0&&(c=fu()),o=Uo(o,c),o!==null&&(Ri(o,c),ws(o))}function Xw(o){var c=o.memoizedState,u=0;c!==null&&(u=c.retryLane),vT(o,u)}function Gw(o,c){var u=0;switch(o.tag){case 13:var f=o.stateNode,p=o.memoizedState;p!==null&&(u=p.retryLane);break;case 19:f=o.stateNode;break;case 22:f=o.stateNode._retryCache;break;default:throw Error(s(314))}f!==null&&f.delete(c),vT(o,u)}function Ww(o,c){return Ws(o,c)}var rh=null,sa=null,Cp=!1,oh=!1,Mp=!1,Hr=0;function ws(o){o!==sa&&o.next===null&&(sa===null?rh=sa=o:sa=sa.next=o),oh=!0,Cp||(Cp=!0,Yw())}function Hc(o,c){if(!Mp&&oh){Mp=!0;do for(var u=!1,f=rh;f!==null;){if(o!==0){var p=f.pendingLanes;if(p===0)var A=0;else{var S=f.suspendedLanes,C=f.pingedLanes;A=(1<<31-We(42|o)+1)-1,A&=p&~(S&~C),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(u=!0,OT(f,A))}else A=Dt,A=mo(f,f===ae?A:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(A&3)===0||Rr(f,A)||(u=!0,OT(f,A));f=f.next}while(u);Mp=!1}}function qw(){CT()}function CT(){oh=Cp=!1;var o=0;Hr!==0&&(sO()&&(o=Hr),Hr=0);for(var c=Ne(),u=null,f=rh;f!==null;){var p=f.next,A=MT(f,c);A===0?(f.next=null,u===null?rh=p:u.next=p,p===null&&(sa=u)):(u=f,(o!==0||(A&3)!==0)&&(oh=!0)),f=p}Hc(o)}function MT(o,c){for(var u=o.suspendedLanes,f=o.pingedLanes,p=o.expirationTimes,A=o.pendingLanes&-62914561;0<A;){var S=31-We(A),C=1<<S,D=p[S];D===-1?((C&u)===0||(C&f)!==0)&&(p[S]=Ao(C,c)):D<=c&&(o.expiredLanes|=C),A&=~C}if(c=ae,u=Dt,u=mo(o,o===c?u:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),f=o.callbackNode,u===0||o===c&&(Gt===2||Gt===9)||o.cancelPendingCommit!==null)return f!==null&&f!==null&&qs(f),o.callbackNode=null,o.callbackPriority=0;if((u&3)===0||Rr(o,u)){if(c=u&-u,c===o.callbackPriority)return c;switch(f!==null&&qs(f),To(u)){case 2:case 8:u=br;break;case 32:u=ke;break;case 268435456:u=lu;break;default:u=ke}return f=wT.bind(null,o),u=Ws(u,f),o.callbackPriority=c,o.callbackNode=u,c}return f!==null&&f!==null&&qs(f),o.callbackPriority=2,o.callbackNode=null,2}function wT(o,c){if(He!==0&&He!==5)return o.callbackNode=null,o.callbackPriority=0,null;var u=o.callbackNode;if(ih()&&o.callbackNode!==u)return null;var f=Dt;return f=mo(o,o===ae?f:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),f===0?null:(uT(o,f,c),MT(o,Ne()),o.callbackNode!=null&&o.callbackNode===u?wT.bind(null,o):null)}function OT(o,c){if(ih())return null;uT(o,c,!0)}function Yw(){rO(function(){(Xt&6)!==0?Ws(ec,qw):CT()})}function wp(){return Hr===0&&(Hr=hu()),Hr}function BT(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:de(""+o)}function xT(o,c){var u=c.ownerDocument.createElement("input");return u.name=c.name,u.value=c.value,o.id&&u.setAttribute("form",o.id),c.parentNode.insertBefore(u,c),o=new FormData(o),u.parentNode.removeChild(u),o}function Kw(o,c,u,f,p){if(c==="submit"&&u&&u.stateNode===p){var A=BT((p[qe]||null).action),S=f.submitter;S&&(c=(c=S[qe]||null)?BT(c.formAction):S.getAttribute("formAction"),c!==null&&(A=c,S=null));var C=new Eu("action","action",null,f,p);o.push({event:C,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Hr!==0){var D=S?xT(p,S):new FormData(p);qg(u,{pending:!0,data:D,method:p.method,action:A},null,D)}}else typeof A=="function"&&(C.preventDefault(),D=S?xT(p,S):new FormData(p),qg(u,{pending:!0,data:D,method:p.method,action:A},A,D))},currentTarget:p}]})}}for(var Op=0;Op<dg.length;Op++){var Bp=dg[Op],Jw=Bp.toLowerCase(),Zw=Bp[0].toUpperCase()+Bp.slice(1);rs(Jw,"on"+Zw)}rs(uA,"onAnimationEnd"),rs(hA,"onAnimationIteration"),rs(fA,"onAnimationStart"),rs("dblclick","onDoubleClick"),rs("focusin","onFocus"),rs("focusout","onBlur"),rs(pw,"onTransitionRun"),rs(_w,"onTransitionStart"),rs(mw,"onTransitionCancel"),rs(dA,"onTransitionEnd"),bs("onMouseEnter",["mouseout","mouseover"]),bs("onMouseLeave",["mouseout","mouseover"]),bs("onPointerEnter",["pointerout","pointerover"]),bs("onPointerLeave",["pointerout","pointerover"]),Hn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Hn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Hn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Hn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Hn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Hn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(jc));function NT(o,c){c=(c&4)!==0;for(var u=0;u<o.length;u++){var f=o[u],p=f.event;f=f.listeners;t:{var A=void 0;if(c)for(var S=f.length-1;0<=S;S--){var C=f[S],D=C.instance,$=C.currentTarget;if(C=C.listener,D!==A&&p.isPropagationStopped())break t;A=C,p.currentTarget=$;try{A(p)}catch(Z){Wu(Z)}p.currentTarget=null,A=D}else for(S=0;S<f.length;S++){if(C=f[S],D=C.instance,$=C.currentTarget,C=C.listener,D!==A&&p.isPropagationStopped())break t;A=C,p.currentTarget=$;try{A(p)}catch(Z){Wu(Z)}p.currentTarget=null,A=D}}}}function xt(o,c){var u=c[Eo];u===void 0&&(u=c[Eo]=new Set);var f=o+"__bubble";u.has(f)||(IT(c,o,2,!1),u.add(f))}function xp(o,c,u){var f=0;c&&(f|=4),IT(u,o,f,c)}var ah="_reactListening"+Math.random().toString(36).slice(2);function Np(o){if(!o[ah]){o[ah]=!0,Mi.forEach(function(u){u!=="selectionchange"&&(Qw.has(u)||xp(u,!1,o),xp(u,!0,o))});var c=o.nodeType===9?o:o.ownerDocument;c===null||c[ah]||(c[ah]=!0,xp("selectionchange",!1,c))}}function IT(o,c,u,f){switch(sE(c)){case 2:var p=CO;break;case 8:p=MO;break;default:p=Gp}u=p.bind(null,c,u,o),p=void 0,!tg||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(p=!0),f?p!==void 0?o.addEventListener(c,u,{capture:!0,passive:p}):o.addEventListener(c,u,!0):p!==void 0?o.addEventListener(c,u,{passive:p}):o.addEventListener(c,u,!1)}function Ip(o,c,u,f,p){var A=f;if((c&1)===0&&(c&2)===0&&f!==null)t:for(;;){if(f===null)return;var S=f.tag;if(S===3||S===4){var C=f.stateNode.containerInfo;if(C===p)break;if(S===4)for(S=f.return;S!==null;){var D=S.tag;if((D===3||D===4)&&S.stateNode.containerInfo===p)return;S=S.return}for(;C!==null;){if(S=Ks(C),S===null)return;if(D=S.tag,D===5||D===6||D===26||D===27){f=A=S;continue t}C=C.parentNode}}f=f.return}z1(function(){var $=A,Z=un(u),nt=[];t:{var X=gA.get(o);if(X!==void 0){var W=Eu,Rt=o;switch(o){case"keypress":if(yu(u)===0)break t;case"keydown":case"keyup":W=WM;break;case"focusin":Rt="focus",W=ig;break;case"focusout":Rt="blur",W=ig;break;case"beforeblur":case"afterblur":W=ig;break;case"click":if(u.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":W=j1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":W=PM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":W=KM;break;case uA:case hA:case fA:W=LM;break;case dA:W=ZM;break;case"scroll":case"scrollend":W=IM;break;case"wheel":W=tw;break;case"copy":case"cut":case"paste":W=zM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":W=X1;break;case"toggle":case"beforetoggle":W=nw}var Et=(c&4)!==0,Kt=!Et&&(o==="scroll"||o==="scrollend"),V=Et?X!==null?X+"Capture":null:X;Et=[];for(var L=$,H;L!==null;){var tt=L;if(H=tt.stateNode,tt=tt.tag,tt!==5&&tt!==26&&tt!==27||H===null||V===null||(tt=cc(L,V),tt!=null&&Et.push($c(L,tt,H))),Kt)break;L=L.return}0<Et.length&&(X=new W(X,Rt,null,u,Z),nt.push({event:X,listeners:Et}))}}if((c&7)===0){t:{if(X=o==="mouseover"||o==="pointerover",W=o==="mouseout"||o==="pointerout",X&&u!==Me&&(Rt=u.relatedTarget||u.fromElement)&&(Ks(Rt)||Rt[vi]))break t;if((W||X)&&(X=Z.window===Z?Z:(X=Z.ownerDocument)?X.defaultView||X.parentWindow:window,W?(Rt=u.relatedTarget||u.toElement,W=$,Rt=Rt?Ks(Rt):null,Rt!==null&&(Kt=r(Rt),Et=Rt.tag,Rt!==Kt||Et!==5&&Et!==27&&Et!==6)&&(Rt=null)):(W=null,Rt=$),W!==Rt)){if(Et=j1,tt="onMouseLeave",V="onMouseEnter",L="mouse",(o==="pointerout"||o==="pointerover")&&(Et=X1,tt="onPointerLeave",V="onPointerEnter",L="pointer"),Kt=W==null?X:Ci(W),H=Rt==null?X:Ci(Rt),X=new Et(tt,L+"leave",W,u,Z),X.target=Kt,X.relatedTarget=H,tt=null,Ks(Z)===$&&(Et=new Et(V,L+"enter",Rt,u,Z),Et.target=H,Et.relatedTarget=Kt,tt=Et),Kt=tt,W&&Rt)e:{for(Et=W,V=Rt,L=0,H=Et;H;H=ia(H))L++;for(H=0,tt=V;tt;tt=ia(tt))H++;for(;0<L-H;)Et=ia(Et),L--;for(;0<H-L;)V=ia(V),H--;for(;L--;){if(Et===V||V!==null&&Et===V.alternate)break e;Et=ia(Et),V=ia(V)}Et=null}else Et=null;W!==null&&DT(nt,X,W,Et,!1),Rt!==null&&Kt!==null&&DT(nt,Kt,Rt,Et,!0)}}t:{if(X=$?Ci($):window,W=X.nodeName&&X.nodeName.toLowerCase(),W==="select"||W==="input"&&X.type==="file")var gt=Q1;else if(J1(X))if(tA)gt=fw;else{gt=uw;var Ot=lw}else W=X.nodeName,!W||W.toLowerCase()!=="input"||X.type!=="checkbox"&&X.type!=="radio"?$&&dt($.elementType)&&(gt=Q1):gt=hw;if(gt&&(gt=gt(o,$))){Z1(nt,gt,u,Z);break t}Ot&&Ot(o,X,$),o==="focusout"&&$&&X.type==="number"&&$.memoizedProps.value!=null&&Bo(X,"number",X.value)}switch(Ot=$?Ci($):window,o){case"focusin":(J1(Ot)||Ot.contentEditable==="true")&&(Do=Ot,ug=$,_c=null);break;case"focusout":_c=ug=Do=null;break;case"mousedown":hg=!0;break;case"contextmenu":case"mouseup":case"dragend":hg=!1,cA(nt,u,Z);break;case"selectionchange":if(gw)break;case"keydown":case"keyup":cA(nt,u,Z)}var pt;if(og)t:{switch(o){case"compositionstart":var St="onCompositionStart";break t;case"compositionend":St="onCompositionEnd";break t;case"compositionupdate":St="onCompositionUpdate";break t}St=void 0}else Io?Y1(o,u)&&(St="onCompositionEnd"):o==="keydown"&&u.keyCode===229&&(St="onCompositionStart");St&&(G1&&u.locale!=="ko"&&(Io||St!=="onCompositionStart"?St==="onCompositionEnd"&&Io&&(pt=V1()):(xi=Z,eg="value"in xi?xi.value:xi.textContent,Io=!0)),Ot=ch($,St),0<Ot.length&&(St=new $1(St,o,null,u,Z),nt.push({event:St,listeners:Ot}),pt?St.data=pt:(pt=K1(u),pt!==null&&(St.data=pt)))),(pt=iw?rw(o,u):ow(o,u))&&(St=ch($,"onBeforeInput"),0<St.length&&(Ot=new $1("onBeforeInput","beforeinput",null,u,Z),nt.push({event:Ot,listeners:St}),Ot.data=pt)),Kw(nt,o,$,u,Z)}NT(nt,c)})}function $c(o,c,u){return{instance:o,listener:c,currentTarget:u}}function ch(o,c){for(var u=c+"Capture",f=[];o!==null;){var p=o,A=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||A===null||(p=cc(o,u),p!=null&&f.unshift($c(o,p,A)),p=cc(o,c),p!=null&&f.push($c(o,p,A))),o.tag===3)return f;o=o.return}return[]}function ia(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function DT(o,c,u,f,p){for(var A=c._reactName,S=[];u!==null&&u!==f;){var C=u,D=C.alternate,$=C.stateNode;if(C=C.tag,D!==null&&D===f)break;C!==5&&C!==26&&C!==27||$===null||(D=$,p?($=cc(u,A),$!=null&&S.unshift($c(u,$,D))):p||($=cc(u,A),$!=null&&S.push($c(u,$,D)))),u=u.return}S.length!==0&&o.push({event:c,listeners:S})}var tO=/\r\n?/g,eO=/\u0000|\uFFFD/g;function PT(o){return(typeof o=="string"?o:""+o).replace(tO,`
`).replace(eO,"")}function FT(o,c){return c=PT(c),PT(o)===c}function lh(){}function Yt(o,c,u,f,p,A){switch(u){case"children":typeof f=="string"?c==="body"||c==="textarea"&&f===""||w(o,f):(typeof f=="number"||typeof f=="bigint")&&c!=="body"&&w(o,""+f);break;case"className":Rn(o,"class",f);break;case"tabIndex":Rn(o,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Rn(o,u,f);break;case"style":it(o,f,A);break;case"data":if(c!=="object"){Rn(o,"data",f);break}case"src":case"href":if(f===""&&(c!=="a"||u!=="href")){o.removeAttribute(u);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){o.removeAttribute(u);break}f=de(""+f),o.setAttribute(u,f);break;case"action":case"formAction":if(typeof f=="function"){o.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(u==="formAction"?(c!=="input"&&Yt(o,c,"name",p.name,p,null),Yt(o,c,"formEncType",p.formEncType,p,null),Yt(o,c,"formMethod",p.formMethod,p,null),Yt(o,c,"formTarget",p.formTarget,p,null)):(Yt(o,c,"encType",p.encType,p,null),Yt(o,c,"method",p.method,p,null),Yt(o,c,"target",p.target,p,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){o.removeAttribute(u);break}f=de(""+f),o.setAttribute(u,f);break;case"onClick":f!=null&&(o.onclick=lh);break;case"onScroll":f!=null&&xt("scroll",o);break;case"onScrollEnd":f!=null&&xt("scrollend",o);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(s(61));if(u=f.__html,u!=null){if(p.children!=null)throw Error(s(60));o.innerHTML=u}}break;case"multiple":o.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":o.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){o.removeAttribute("xlink:href");break}u=de(""+f),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?o.setAttribute(u,""+f):o.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?o.setAttribute(u,""):o.removeAttribute(u);break;case"capture":case"download":f===!0?o.setAttribute(u,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?o.setAttribute(u,f):o.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?o.setAttribute(u,f):o.removeAttribute(u);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?o.removeAttribute(u):o.setAttribute(u,f);break;case"popover":xt("beforetoggle",o),xt("toggle",o),is(o,"popover",f);break;case"xlinkActuate":Ce(o,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Ce(o,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Ce(o,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Ce(o,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Ce(o,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Ce(o,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Ce(o,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Ce(o,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Ce(o,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":is(o,"is",f);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=Mt.get(u)||u,is(o,u,f))}}function Dp(o,c,u,f,p,A){switch(u){case"style":it(o,f,A);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(s(61));if(u=f.__html,u!=null){if(p.children!=null)throw Error(s(60));o.innerHTML=u}}break;case"children":typeof f=="string"?w(o,f):(typeof f=="number"||typeof f=="bigint")&&w(o,""+f);break;case"onScroll":f!=null&&xt("scroll",o);break;case"onScrollEnd":f!=null&&xt("scrollend",o);break;case"onClick":f!=null&&(o.onclick=lh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!wi.hasOwnProperty(u))t:{if(u[0]==="o"&&u[1]==="n"&&(p=u.endsWith("Capture"),c=u.slice(2,p?u.length-7:void 0),A=o[qe]||null,A=A!=null?A[u]:null,typeof A=="function"&&o.removeEventListener(c,A,p),typeof f=="function")){typeof A!="function"&&A!==null&&(u in o?o[u]=null:o.hasAttribute(u)&&o.removeAttribute(u)),o.addEventListener(c,f,p);break t}u in o?o[u]=f:f===!0?o.setAttribute(u,""):is(o,u,f)}}}function je(o,c,u){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":xt("error",o),xt("load",o);var f=!1,p=!1,A;for(A in u)if(u.hasOwnProperty(A)){var S=u[A];if(S!=null)switch(A){case"src":f=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,c));default:Yt(o,c,A,S,u,null)}}p&&Yt(o,c,"srcSet",u.srcSet,u,null),f&&Yt(o,c,"src",u.src,u,null);return;case"input":xt("invalid",o);var C=A=S=p=null,D=null,$=null;for(f in u)if(u.hasOwnProperty(f)){var Z=u[f];if(Z!=null)switch(f){case"name":p=Z;break;case"type":S=Z;break;case"checked":D=Z;break;case"defaultChecked":$=Z;break;case"value":A=Z;break;case"defaultValue":C=Z;break;case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(s(137,c));break;default:Yt(o,c,f,Z,u,null)}}Oo(o,A,C,D,$,S,p,!1),Oi(o);return;case"select":xt("invalid",o),f=S=A=null;for(p in u)if(u.hasOwnProperty(p)&&(C=u[p],C!=null))switch(p){case"value":A=C;break;case"defaultValue":S=C;break;case"multiple":f=C;default:Yt(o,c,p,C,u,null)}c=A,u=S,o.multiple=!!f,c!=null?Bi(o,!!f,c,!1):u!=null&&Bi(o,!!f,u,!0);return;case"textarea":xt("invalid",o),A=p=f=null;for(S in u)if(u.hasOwnProperty(S)&&(C=u[S],C!=null))switch(S){case"value":f=C;break;case"defaultValue":p=C;break;case"children":A=C;break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(s(91));break;default:Yt(o,c,S,C,u,null)}v(o,f,p,A),Oi(o);return;case"option":for(D in u)if(u.hasOwnProperty(D)&&(f=u[D],f!=null))switch(D){case"selected":o.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Yt(o,c,D,f,u,null)}return;case"dialog":xt("beforetoggle",o),xt("toggle",o),xt("cancel",o),xt("close",o);break;case"iframe":case"object":xt("load",o);break;case"video":case"audio":for(f=0;f<jc.length;f++)xt(jc[f],o);break;case"image":xt("error",o),xt("load",o);break;case"details":xt("toggle",o);break;case"embed":case"source":case"link":xt("error",o),xt("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for($ in u)if(u.hasOwnProperty($)&&(f=u[$],f!=null))switch($){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,c));default:Yt(o,c,$,f,u,null)}return;default:if(dt(c)){for(Z in u)u.hasOwnProperty(Z)&&(f=u[Z],f!==void 0&&Dp(o,c,Z,f,u,void 0));return}}for(C in u)u.hasOwnProperty(C)&&(f=u[C],f!=null&&Yt(o,c,C,f,u,null))}function nO(o,c,u,f){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,A=null,S=null,C=null,D=null,$=null,Z=null;for(W in u){var nt=u[W];if(u.hasOwnProperty(W)&&nt!=null)switch(W){case"checked":break;case"value":break;case"defaultValue":D=nt;default:f.hasOwnProperty(W)||Yt(o,c,W,null,f,nt)}}for(var X in f){var W=f[X];if(nt=u[X],f.hasOwnProperty(X)&&(W!=null||nt!=null))switch(X){case"type":A=W;break;case"name":p=W;break;case"checked":$=W;break;case"defaultChecked":Z=W;break;case"value":S=W;break;case"defaultValue":C=W;break;case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(s(137,c));break;default:W!==nt&&Yt(o,c,X,W,f,nt)}}wo(o,S,C,D,$,Z,A,p);return;case"select":W=S=C=X=null;for(A in u)if(D=u[A],u.hasOwnProperty(A)&&D!=null)switch(A){case"value":break;case"multiple":W=D;default:f.hasOwnProperty(A)||Yt(o,c,A,null,f,D)}for(p in f)if(A=f[p],D=u[p],f.hasOwnProperty(p)&&(A!=null||D!=null))switch(p){case"value":X=A;break;case"defaultValue":C=A;break;case"multiple":S=A;default:A!==D&&Yt(o,c,p,A,f,D)}c=C,u=S,f=W,X!=null?Bi(o,!!u,X,!1):!!f!=!!u&&(c!=null?Bi(o,!!u,c,!0):Bi(o,!!u,u?[]:"",!1));return;case"textarea":W=X=null;for(C in u)if(p=u[C],u.hasOwnProperty(C)&&p!=null&&!f.hasOwnProperty(C))switch(C){case"value":break;case"children":break;default:Yt(o,c,C,null,f,p)}for(S in f)if(p=f[S],A=u[S],f.hasOwnProperty(S)&&(p!=null||A!=null))switch(S){case"value":X=p;break;case"defaultValue":W=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(s(91));break;default:p!==A&&Yt(o,c,S,p,f,A)}mu(o,X,W);return;case"option":for(var Rt in u)if(X=u[Rt],u.hasOwnProperty(Rt)&&X!=null&&!f.hasOwnProperty(Rt))switch(Rt){case"selected":o.selected=!1;break;default:Yt(o,c,Rt,null,f,X)}for(D in f)if(X=f[D],W=u[D],f.hasOwnProperty(D)&&X!==W&&(X!=null||W!=null))switch(D){case"selected":o.selected=X&&typeof X!="function"&&typeof X!="symbol";break;default:Yt(o,c,D,X,f,W)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Et in u)X=u[Et],u.hasOwnProperty(Et)&&X!=null&&!f.hasOwnProperty(Et)&&Yt(o,c,Et,null,f,X);for($ in f)if(X=f[$],W=u[$],f.hasOwnProperty($)&&X!==W&&(X!=null||W!=null))switch($){case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(s(137,c));break;default:Yt(o,c,$,X,f,W)}return;default:if(dt(c)){for(var Kt in u)X=u[Kt],u.hasOwnProperty(Kt)&&X!==void 0&&!f.hasOwnProperty(Kt)&&Dp(o,c,Kt,void 0,f,X);for(Z in f)X=f[Z],W=u[Z],!f.hasOwnProperty(Z)||X===W||X===void 0&&W===void 0||Dp(o,c,Z,X,f,W);return}}for(var V in u)X=u[V],u.hasOwnProperty(V)&&X!=null&&!f.hasOwnProperty(V)&&Yt(o,c,V,null,f,X);for(nt in f)X=f[nt],W=u[nt],!f.hasOwnProperty(nt)||X===W||X==null&&W==null||Yt(o,c,nt,X,f,W)}var Pp=null,Fp=null;function uh(o){return o.nodeType===9?o:o.ownerDocument}function UT(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function LT(o,c){if(o===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&c==="foreignObject"?0:o}function Up(o,c){return o==="textarea"||o==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Lp=null;function sO(){var o=window.event;return o&&o.type==="popstate"?o===Lp?!1:(Lp=o,!0):(Lp=null,!1)}var kT=typeof setTimeout=="function"?setTimeout:void 0,iO=typeof clearTimeout=="function"?clearTimeout:void 0,zT=typeof Promise=="function"?Promise:void 0,rO=typeof queueMicrotask=="function"?queueMicrotask:typeof zT<"u"?function(o){return zT.resolve(null).then(o).catch(oO)}:kT;function oO(o){setTimeout(function(){throw o})}function Wi(o){return o==="head"}function VT(o,c){var u=c,f=0,p=0;do{var A=u.nextSibling;if(o.removeChild(u),A&&A.nodeType===8)if(u=A.data,u==="/$"){if(0<f&&8>f){u=f;var S=o.ownerDocument;if(u&1&&Xc(S.documentElement),u&2&&Xc(S.body),u&4)for(u=S.head,Xc(u),S=u.firstChild;S;){var C=S.nextSibling,D=S.nodeName;S[vr]||D==="SCRIPT"||D==="STYLE"||D==="LINK"&&S.rel.toLowerCase()==="stylesheet"||u.removeChild(S),S=C}}if(p===0){o.removeChild(A),Qc(c);return}p--}else u==="$"||u==="$?"||u==="$!"?p++:f=u.charCodeAt(0)-48;else f=0;u=A}while(u);Qc(c)}function kp(o){var c=o.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var u=c;switch(c=c.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":kp(u),bo(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}o.removeChild(u)}}function aO(o,c,u,f){for(;o.nodeType===1;){var p=u;if(o.nodeName.toLowerCase()!==c.toLowerCase()){if(!f&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(f){if(!o[vr])switch(c){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(A=o.getAttribute("rel"),A==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(A!==p.rel||o.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||o.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||o.getAttribute("title")!==(p.title==null?null:p.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(A=o.getAttribute("src"),(A!==(p.src==null?null:p.src)||o.getAttribute("type")!==(p.type==null?null:p.type)||o.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&A&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(c==="input"&&o.type==="hidden"){var A=p.name==null?null:""+p.name;if(p.type==="hidden"&&o.getAttribute("name")===A)return o}else return o;if(o=as(o.nextSibling),o===null)break}return null}function cO(o,c,u){if(c==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!u||(o=as(o.nextSibling),o===null))return null;return o}function zp(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState==="complete"}function lO(o,c){var u=o.ownerDocument;if(o.data!=="$?"||u.readyState==="complete")c();else{var f=function(){c(),u.removeEventListener("DOMContentLoaded",f)};u.addEventListener("DOMContentLoaded",f),o._reactRetry=f}}function as(o){for(;o!=null;o=o.nextSibling){var c=o.nodeType;if(c===1||c===3)break;if(c===8){if(c=o.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return o}var Vp=null;function HT(o){o=o.previousSibling;for(var c=0;o;){if(o.nodeType===8){var u=o.data;if(u==="$"||u==="$!"||u==="$?"){if(c===0)return o;c--}else u==="/$"&&c++}o=o.previousSibling}return null}function jT(o,c,u){switch(c=uh(u),o){case"html":if(o=c.documentElement,!o)throw Error(s(452));return o;case"head":if(o=c.head,!o)throw Error(s(453));return o;case"body":if(o=c.body,!o)throw Error(s(454));return o;default:throw Error(s(451))}}function Xc(o){for(var c=o.attributes;c.length;)o.removeAttributeNode(c[0]);bo(o)}var Yn=new Map,$T=new Set;function hh(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var di=lt.d;lt.d={f:uO,r:hO,D:fO,C:dO,L:gO,m:pO,X:mO,S:_O,M:AO};function uO(){var o=di.f(),c=nh();return o||c}function hO(o){var c=Js(o);c!==null&&c.tag===5&&c.type==="form"?uy(c):di.r(o)}var ra=typeof document>"u"?null:document;function XT(o,c,u){var f=ra;if(f&&typeof c=="string"&&c){var p=ln(c);p='link[rel="'+o+'"][href="'+p+'"]',typeof u=="string"&&(p+='[crossorigin="'+u+'"]'),$T.has(p)||($T.add(p),o={rel:o,crossOrigin:u,href:c},f.querySelector(p)===null&&(c=f.createElement("link"),je(c,"link",o),oe(c),f.head.appendChild(c)))}}function fO(o){di.D(o),XT("dns-prefetch",o,null)}function dO(o,c){di.C(o,c),XT("preconnect",o,c)}function gO(o,c,u){di.L(o,c,u);var f=ra;if(f&&o&&c){var p='link[rel="preload"][as="'+ln(c)+'"]';c==="image"&&u&&u.imageSrcSet?(p+='[imagesrcset="'+ln(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(p+='[imagesizes="'+ln(u.imageSizes)+'"]')):p+='[href="'+ln(o)+'"]';var A=p;switch(c){case"style":A=oa(o);break;case"script":A=aa(o)}Yn.has(A)||(o=g({rel:"preload",href:c==="image"&&u&&u.imageSrcSet?void 0:o,as:c},u),Yn.set(A,o),f.querySelector(p)!==null||c==="style"&&f.querySelector(Gc(A))||c==="script"&&f.querySelector(Wc(A))||(c=f.createElement("link"),je(c,"link",o),oe(c),f.head.appendChild(c)))}}function pO(o,c){di.m(o,c);var u=ra;if(u&&o){var f=c&&typeof c.as=="string"?c.as:"script",p='link[rel="modulepreload"][as="'+ln(f)+'"][href="'+ln(o)+'"]',A=p;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=aa(o)}if(!Yn.has(A)&&(o=g({rel:"modulepreload",href:o},c),Yn.set(A,o),u.querySelector(p)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Wc(A)))return}f=u.createElement("link"),je(f,"link",o),oe(f),u.head.appendChild(f)}}}function _O(o,c,u){di.S(o,c,u);var f=ra;if(f&&o){var p=Es(f).hoistableStyles,A=oa(o);c=c||"default";var S=p.get(A);if(!S){var C={loading:0,preload:null};if(S=f.querySelector(Gc(A)))C.loading=5;else{o=g({rel:"stylesheet",href:o,"data-precedence":c},u),(u=Yn.get(A))&&Hp(o,u);var D=S=f.createElement("link");oe(D),je(D,"link",o),D._p=new Promise(function($,Z){D.onload=$,D.onerror=Z}),D.addEventListener("load",function(){C.loading|=1}),D.addEventListener("error",function(){C.loading|=2}),C.loading|=4,fh(S,c,f)}S={type:"stylesheet",instance:S,count:1,state:C},p.set(A,S)}}}function mO(o,c){di.X(o,c);var u=ra;if(u&&o){var f=Es(u).hoistableScripts,p=aa(o),A=f.get(p);A||(A=u.querySelector(Wc(p)),A||(o=g({src:o,async:!0},c),(c=Yn.get(p))&&jp(o,c),A=u.createElement("script"),oe(A),je(A,"link",o),u.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},f.set(p,A))}}function AO(o,c){di.M(o,c);var u=ra;if(u&&o){var f=Es(u).hoistableScripts,p=aa(o),A=f.get(p);A||(A=u.querySelector(Wc(p)),A||(o=g({src:o,async:!0,type:"module"},c),(c=Yn.get(p))&&jp(o,c),A=u.createElement("script"),oe(A),je(A,"link",o),u.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},f.set(p,A))}}function GT(o,c,u,f){var p=(p=vt.current)?hh(p):null;if(!p)throw Error(s(446));switch(o){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(c=oa(u.href),u=Es(p).hoistableStyles,f=u.get(c),f||(f={type:"style",instance:null,count:0,state:null},u.set(c,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){o=oa(u.href);var A=Es(p).hoistableStyles,S=A.get(o);if(S||(p=p.ownerDocument||p,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(o,S),(A=p.querySelector(Gc(o)))&&!A._p&&(S.instance=A,S.state.loading=5),Yn.has(o)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Yn.set(o,u),A||yO(p,o,u,S.state))),c&&f===null)throw Error(s(528,""));return S}if(c&&f!==null)throw Error(s(529,""));return null;case"script":return c=u.async,u=u.src,typeof u=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=aa(u),u=Es(p).hoistableScripts,f=u.get(c),f||(f={type:"script",instance:null,count:0,state:null},u.set(c,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,o))}}function oa(o){return'href="'+ln(o)+'"'}function Gc(o){return'link[rel="stylesheet"]['+o+"]"}function WT(o){return g({},o,{"data-precedence":o.precedence,precedence:null})}function yO(o,c,u,f){o.querySelector('link[rel="preload"][as="style"]['+c+"]")?f.loading=1:(c=o.createElement("link"),f.preload=c,c.addEventListener("load",function(){return f.loading|=1}),c.addEventListener("error",function(){return f.loading|=2}),je(c,"link",u),oe(c),o.head.appendChild(c))}function aa(o){return'[src="'+ln(o)+'"]'}function Wc(o){return"script[async]"+o}function qT(o,c,u){if(c.count++,c.instance===null)switch(c.type){case"style":var f=o.querySelector('style[data-href~="'+ln(u.href)+'"]');if(f)return c.instance=f,oe(f),f;var p=g({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return f=(o.ownerDocument||o).createElement("style"),oe(f),je(f,"style",p),fh(f,u.precedence,o),c.instance=f;case"stylesheet":p=oa(u.href);var A=o.querySelector(Gc(p));if(A)return c.state.loading|=4,c.instance=A,oe(A),A;f=WT(u),(p=Yn.get(p))&&Hp(f,p),A=(o.ownerDocument||o).createElement("link"),oe(A);var S=A;return S._p=new Promise(function(C,D){S.onload=C,S.onerror=D}),je(A,"link",f),c.state.loading|=4,fh(A,u.precedence,o),c.instance=A;case"script":return A=aa(u.src),(p=o.querySelector(Wc(A)))?(c.instance=p,oe(p),p):(f=u,(p=Yn.get(A))&&(f=g({},u),jp(f,p)),o=o.ownerDocument||o,p=o.createElement("script"),oe(p),je(p,"link",f),o.head.appendChild(p),c.instance=p);case"void":return null;default:throw Error(s(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(f=c.instance,c.state.loading|=4,fh(f,u.precedence,o));return c.instance}function fh(o,c,u){for(var f=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=f.length?f[f.length-1]:null,A=p,S=0;S<f.length;S++){var C=f[S];if(C.dataset.precedence===c)A=C;else if(A!==p)break}A?A.parentNode.insertBefore(o,A.nextSibling):(c=u.nodeType===9?u.head:u,c.insertBefore(o,c.firstChild))}function Hp(o,c){o.crossOrigin==null&&(o.crossOrigin=c.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=c.referrerPolicy),o.title==null&&(o.title=c.title)}function jp(o,c){o.crossOrigin==null&&(o.crossOrigin=c.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=c.referrerPolicy),o.integrity==null&&(o.integrity=c.integrity)}var dh=null;function YT(o,c,u){if(dh===null){var f=new Map,p=dh=new Map;p.set(u,f)}else p=dh,f=p.get(u),f||(f=new Map,p.set(u,f));if(f.has(o))return f;for(f.set(o,null),u=u.getElementsByTagName(o),p=0;p<u.length;p++){var A=u[p];if(!(A[vr]||A[me]||o==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var S=A.getAttribute(c)||"";S=o+S;var C=f.get(S);C?C.push(A):f.set(S,[A])}}return f}function KT(o,c,u){o=o.ownerDocument||o,o.head.insertBefore(u,c==="title"?o.querySelector("head > title"):null)}function TO(o,c,u){if(u===1||c.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return o=c.disabled,typeof c.precedence=="string"&&o==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function JT(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}var qc=null;function EO(){}function bO(o,c,u){if(qc===null)throw Error(s(475));var f=qc;if(c.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var p=oa(u.href),A=o.querySelector(Gc(p));if(A){o=A._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(f.count++,f=gh.bind(f),o.then(f,f)),c.state.loading|=4,c.instance=A,oe(A);return}A=o.ownerDocument||o,u=WT(u),(p=Yn.get(p))&&Hp(u,p),A=A.createElement("link"),oe(A);var S=A;S._p=new Promise(function(C,D){S.onload=C,S.onerror=D}),je(A,"link",u),c.instance=A}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(f.count++,c=gh.bind(f),o.addEventListener("load",c),o.addEventListener("error",c))}}function SO(){if(qc===null)throw Error(s(475));var o=qc;return o.stylesheets&&o.count===0&&$p(o,o.stylesheets),0<o.count?function(c){var u=setTimeout(function(){if(o.stylesheets&&$p(o,o.stylesheets),o.unsuspend){var f=o.unsuspend;o.unsuspend=null,f()}},6e4);return o.unsuspend=c,function(){o.unsuspend=null,clearTimeout(u)}}:null}function gh(){if(this.count--,this.count===0){if(this.stylesheets)$p(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var ph=null;function $p(o,c){o.stylesheets=null,o.unsuspend!==null&&(o.count++,ph=new Map,c.forEach(RO,o),ph=null,gh.call(o))}function RO(o,c){if(!(c.state.loading&4)){var u=ph.get(o);if(u)var f=u.get(null);else{u=new Map,ph.set(o,u);for(var p=o.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<p.length;A++){var S=p[A];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(u.set(S.dataset.precedence,S),f=S)}f&&u.set(null,f)}p=c.instance,S=p.getAttribute("data-precedence"),A=u.get(S)||f,A===f&&u.set(null,p),u.set(S,p),this.count++,f=gh.bind(this),p.addEventListener("load",f),p.addEventListener("error",f),A?A.parentNode.insertBefore(p,A.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(p,o.firstChild)),c.state.loading|=4}}var Yc={$$typeof:O,Provider:null,Consumer:null,_currentValue:At,_currentValue2:At,_threadCount:0};function vO(o,c,u,f,p,A,S,C){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=yo(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yo(0),this.hiddenUpdates=yo(null),this.identifierPrefix=f,this.onUncaughtError=p,this.onCaughtError=A,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=C,this.incompleteTransitions=new Map}function ZT(o,c,u,f,p,A,S,C,D,$,Z,nt){return o=new vO(o,c,u,S,C,D,$,nt),c=1,A===!0&&(c|=24),A=Mn(3,null,null,c),o.current=A,A.stateNode=o,c=vg(),c.refCount++,o.pooledCache=c,c.refCount++,A.memoizedState={element:f,isDehydrated:u,cache:c},Og(A),o}function QT(o){return o?(o=Lo,o):Lo}function tE(o,c,u,f,p,A){p=QT(p),f.context===null?f.context=p:f.pendingContext=p,f=Di(c),f.payload={element:u},A=A===void 0?null:A,A!==null&&(f.callback=A),u=Pi(o,f,c),u!==null&&(Nn(u,o,c),vc(u,o,c))}function eE(o,c){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var u=o.retryLane;o.retryLane=u!==0&&u<c?u:c}}function Xp(o,c){eE(o,c),(o=o.alternate)&&eE(o,c)}function nE(o){if(o.tag===13){var c=Uo(o,67108864);c!==null&&Nn(c,o,67108864),Xp(o,67108864)}}var _h=!0;function CO(o,c,u,f){var p=K.T;K.T=null;var A=lt.p;try{lt.p=2,Gp(o,c,u,f)}finally{lt.p=A,K.T=p}}function MO(o,c,u,f){var p=K.T;K.T=null;var A=lt.p;try{lt.p=8,Gp(o,c,u,f)}finally{lt.p=A,K.T=p}}function Gp(o,c,u,f){if(_h){var p=Wp(f);if(p===null)Ip(o,c,f,mh,u),iE(o,f);else if(OO(p,o,c,u,f))f.stopPropagation();else if(iE(o,f),c&4&&-1<wO.indexOf(o)){for(;p!==null;){var A=Js(p);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var S=Ys(A.pendingLanes);if(S!==0){var C=A;for(C.pendingLanes|=2,C.entangledLanes|=2;S;){var D=1<<31-We(S);C.entanglements[1]|=D,S&=~D}ws(A),(Xt&6)===0&&(th=Ne()+500,Hc(0))}}break;case 13:C=Uo(A,2),C!==null&&Nn(C,A,2),nh(),Xp(A,2)}if(A=Wp(f),A===null&&Ip(o,c,f,mh,u),A===p)break;p=A}p!==null&&f.stopPropagation()}else Ip(o,c,f,null,u)}}function Wp(o){return o=un(o),qp(o)}var mh=null;function qp(o){if(mh=null,o=Ks(o),o!==null){var c=r(o);if(c===null)o=null;else{var u=c.tag;if(u===13){if(o=a(c),o!==null)return o;o=null}else if(u===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;o=null}else c!==o&&(o=null)}}return mh=o,null}function sE(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(cu()){case ec:return 2;case br:return 8;case ke:case Wd:return 32;case lu:return 268435456;default:return 32}default:return 32}}var Yp=!1,qi=null,Yi=null,Ki=null,Kc=new Map,Jc=new Map,Ji=[],wO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function iE(o,c){switch(o){case"focusin":case"focusout":qi=null;break;case"dragenter":case"dragleave":Yi=null;break;case"mouseover":case"mouseout":Ki=null;break;case"pointerover":case"pointerout":Kc.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jc.delete(c.pointerId)}}function Zc(o,c,u,f,p,A){return o===null||o.nativeEvent!==A?(o={blockedOn:c,domEventName:u,eventSystemFlags:f,nativeEvent:A,targetContainers:[p]},c!==null&&(c=Js(c),c!==null&&nE(c)),o):(o.eventSystemFlags|=f,c=o.targetContainers,p!==null&&c.indexOf(p)===-1&&c.push(p),o)}function OO(o,c,u,f,p){switch(c){case"focusin":return qi=Zc(qi,o,c,u,f,p),!0;case"dragenter":return Yi=Zc(Yi,o,c,u,f,p),!0;case"mouseover":return Ki=Zc(Ki,o,c,u,f,p),!0;case"pointerover":var A=p.pointerId;return Kc.set(A,Zc(Kc.get(A)||null,o,c,u,f,p)),!0;case"gotpointercapture":return A=p.pointerId,Jc.set(A,Zc(Jc.get(A)||null,o,c,u,f,p)),!0}return!1}function rE(o){var c=Ks(o.target);if(c!==null){var u=r(c);if(u!==null){if(c=u.tag,c===13){if(c=a(u),c!==null){o.blockedOn=c,Kd(o.priority,function(){if(u.tag===13){var f=xn();f=ic(f);var p=Uo(u,f);p!==null&&Nn(p,u,f),Xp(u,f)}});return}}else if(c===3&&u.stateNode.current.memoizedState.isDehydrated){o.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Ah(o){if(o.blockedOn!==null)return!1;for(var c=o.targetContainers;0<c.length;){var u=Wp(o.nativeEvent);if(u===null){u=o.nativeEvent;var f=new u.constructor(u.type,u);Me=f,u.target.dispatchEvent(f),Me=null}else return c=Js(u),c!==null&&nE(c),o.blockedOn=u,!1;c.shift()}return!0}function oE(o,c,u){Ah(o)&&u.delete(c)}function BO(){Yp=!1,qi!==null&&Ah(qi)&&(qi=null),Yi!==null&&Ah(Yi)&&(Yi=null),Ki!==null&&Ah(Ki)&&(Ki=null),Kc.forEach(oE),Jc.forEach(oE)}function yh(o,c){o.blockedOn===c&&(o.blockedOn=null,Yp||(Yp=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,BO)))}var Th=null;function aE(o){Th!==o&&(Th=o,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Th===o&&(Th=null);for(var c=0;c<o.length;c+=3){var u=o[c],f=o[c+1],p=o[c+2];if(typeof f!="function"){if(qp(f||u)===null)continue;break}var A=Js(u);A!==null&&(o.splice(c,3),c-=3,qg(A,{pending:!0,data:p,method:u.method,action:f},f,p))}}))}function Qc(o){function c(D){return yh(D,o)}qi!==null&&yh(qi,o),Yi!==null&&yh(Yi,o),Ki!==null&&yh(Ki,o),Kc.forEach(c),Jc.forEach(c);for(var u=0;u<Ji.length;u++){var f=Ji[u];f.blockedOn===o&&(f.blockedOn=null)}for(;0<Ji.length&&(u=Ji[0],u.blockedOn===null);)rE(u),u.blockedOn===null&&Ji.shift();if(u=(o.ownerDocument||o).$$reactFormReplay,u!=null)for(f=0;f<u.length;f+=3){var p=u[f],A=u[f+1],S=p[qe]||null;if(typeof A=="function")S||aE(u);else if(S){var C=null;if(A&&A.hasAttribute("formAction")){if(p=A,S=A[qe]||null)C=S.formAction;else if(qp(p)!==null)continue}else C=S.action;typeof C=="function"?u[f+1]=C:(u.splice(f,3),f-=3),aE(u)}}}function Kp(o){this._internalRoot=o}Eh.prototype.render=Kp.prototype.render=function(o){var c=this._internalRoot;if(c===null)throw Error(s(409));var u=c.current,f=xn();tE(u,f,o,c,null,null)},Eh.prototype.unmount=Kp.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var c=o.containerInfo;tE(o.current,2,null,o,null,null),nh(),c[vi]=null}};function Eh(o){this._internalRoot=o}Eh.prototype.unstable_scheduleHydration=function(o){if(o){var c=pu();o={blockedOn:null,target:o,priority:c};for(var u=0;u<Ji.length&&c!==0&&c<Ji[u].priority;u++);Ji.splice(u,0,o),u===0&&rE(o)}};var cE=t.version;if(cE!=="19.1.0")throw Error(s(527,cE,"19.1.0"));lt.findDOMNode=function(o){var c=o._reactInternals;if(c===void 0)throw typeof o.render=="function"?Error(s(188)):(o=Object.keys(o).join(","),Error(s(268,o)));return o=h(c),o=o!==null?d(o):null,o=o===null?null:o.stateNode,o};var xO={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:K,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bh.isDisabled&&bh.supportsFiber)try{Sr=bh.inject(xO),Ge=bh}catch{}}return el.createRoot=function(o,c){if(!i(o))throw Error(s(299));var u=!1,f="",p=Ry,A=vy,S=Cy,C=null;return c!=null&&(c.unstable_strictMode===!0&&(u=!0),c.identifierPrefix!==void 0&&(f=c.identifierPrefix),c.onUncaughtError!==void 0&&(p=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(S=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(C=c.unstable_transitionCallbacks)),c=ZT(o,1,!1,null,null,u,f,p,A,S,C,null),o[vi]=c.current,Np(o),new Kp(c)},el.hydrateRoot=function(o,c,u){if(!i(o))throw Error(s(299));var f=!1,p="",A=Ry,S=vy,C=Cy,D=null,$=null;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(p=u.identifierPrefix),u.onUncaughtError!==void 0&&(A=u.onUncaughtError),u.onCaughtError!==void 0&&(S=u.onCaughtError),u.onRecoverableError!==void 0&&(C=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(D=u.unstable_transitionCallbacks),u.formState!==void 0&&($=u.formState)),c=ZT(o,1,!0,c,u??null,f,p,A,S,C,D,$),c.context=QT(null),u=c.current,f=xn(),f=ic(f),p=Di(f),p.callback=null,Pi(u,p,f),u=f,c.current.lanes=u,Ri(c,u),ws(c),o[vi]=c.current,Np(o),new Eh(c)},el.version="19.1.0",el}var AE;function $O(){if(AE)return Qp.exports;AE=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Qp.exports=jO(),Qp.exports}var XO=$O();const GO=Nm(XO);function yE(e,t){if(!e)throw new Error(t||"loader assertion failed.")}const T3=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),TE=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);TE&&parseFloat(TE[1]);const Sh=globalThis,ca=globalThis.process||{},WO=globalThis.navigator||{};function E3(e){var s,i;if(typeof window<"u"&&((s=window.process)==null?void 0:s.type)==="renderer"||typeof process<"u"&&((i=process.versions)!=null&&i.electron))return!0;const n=typeof navigator<"u"&&navigator.userAgent;return!!(n&&n.indexOf("Electron")>=0)}function Ar(){return!(typeof process=="object"&&String(process)==="[object process]"&&!(process!=null&&process.browser))||E3()}function qO(e){return Ar()?E3()?"Electron":(WO.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node"}const b3="4.0.7";function YO(e){try{const t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),t}catch{return null}}class KO{constructor(t,n,s="sessionStorage"){this.storage=YO(s),this.id=t,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){if(Object.assign(this.config,t),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let t={};if(this.storage){const n=this.storage.getItem(this.id);t=n?JSON.parse(n):{}}return Object.assign(this.config,t),this}}function JO(e){let t;return e<10?t=`${e.toFixed(2)}ms`:e<100?t=`${e.toFixed(1)}ms`:e<1e3?t=`${e.toFixed(0)}ms`:t=`${(e/1e3).toFixed(2)}s`,t}function ZO(e,t=8){const n=Math.max(t-e.length,0);return`${" ".repeat(n)}${e}`}var Ff;(function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Ff||(Ff={}));const QO=10;function EE(e){return typeof e!="string"?e:(e=e.toUpperCase(),Ff[e]||Ff.WHITE)}function tB(e,t,n){return!Ar&&typeof e=="string"&&(t&&(e=`\x1B[${EE(t)}m${e}\x1B[39m`),n&&(e=`\x1B[${EE(n)+QO}m${e}\x1B[49m`)),e}function eB(e,t=["constructor"]){const n=Object.getPrototypeOf(e),s=Object.getOwnPropertyNames(n),i=e;for(const r of s){const a=i[r];typeof a=="function"&&(t.find(l=>r===l)||(i[r]=a.bind(e)))}}function Dm(e,t){if(!e)throw new Error("Assertion failed")}function la(){var t,n,s;let e;if(Ar()&&Sh.performance)e=(n=(t=Sh==null?void 0:Sh.performance)==null?void 0:t.now)==null?void 0:n.call(t);else if("hrtime"in ca){const i=(s=ca==null?void 0:ca.hrtime)==null?void 0:s.call(ca);e=i[0]*1e3+i[1]/1e6}else e=Date.now();return e}const ua={debug:Ar()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},nB={enabled:!0,level:0};function ha(){}const bE={},SE={once:!0};class Ja{constructor({id:t}={id:""}){this.VERSION=b3,this._startTs=la(),this._deltaTs=la(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=t,this.userData={},this._storage=new KO(`__probe-${this.id}__`,nB),this.timeStamp(`${this.id} started`),eB(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((la()-this._startTs).toPrecision(10))}getDelta(){return Number((la()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.setConfiguration({enabled:t}),this}setLevel(t){return this._storage.setConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,n){this._storage.setConfiguration({[t]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,n){if(!t)throw new Error(n||"Assertion failed")}warn(t){return this._getLogFunction(0,t,ua.warn,arguments,SE)}error(t){return this._getLogFunction(0,t,ua.error,arguments)}deprecated(t,n){return this.warn(`\`${t}\` is deprecated and will be removed in a later version. Use \`${n}\` instead`)}removed(t,n){return this.error(`\`${t}\` has been removed. Use \`${n}\` instead`)}probe(t,n){return this._getLogFunction(t,n,ua.log,arguments,{time:!0,once:!0})}log(t,n){return this._getLogFunction(t,n,ua.debug,arguments)}info(t,n){return this._getLogFunction(t,n,console.info,arguments)}once(t,n){return this._getLogFunction(t,n,ua.debug||ua.info,arguments,SE)}table(t,n,s){return n?this._getLogFunction(t,n,console.table||ha,s&&[s],{tag:iB(n)}):ha}time(t,n){return this._getLogFunction(t,n,console.time?console.time:console.info)}timeEnd(t,n){return this._getLogFunction(t,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,n){return this._getLogFunction(t,n,console.timeStamp||ha)}group(t,n,s={collapsed:!1}){const i=RE({logLevel:t,message:n,opts:s}),{collapsed:r}=s;return i.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(t,n,s={}){return this.group(t,n,Object.assign({},s,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||ha)}withGroup(t,n,s){this.group(t,n)();try{s()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=S3(t)}_getLogFunction(t,n,s,i,r){if(this._shouldLog(t)){r=RE({logLevel:t,message:n,args:i,opts:r}),s=s||r.method,Dm(s),r.total=this.getTotal(),r.delta=this.getDelta(),this._deltaTs=la();const a=r.tag||r.message;if(r.once&&a)if(!bE[a])bE[a]=la();else return ha;return n=sB(this.id,r.message,r),s.bind(console,n,...r.args)}return ha}}Ja.VERSION=b3;function S3(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return Dm(Number.isFinite(t)&&t>=0),t}function RE(e){const{logLevel:t,message:n}=e;e.logLevel=S3(t);const s=e.args?Array.from(e.args):[];for(;s.length&&s.shift()!==n;);switch(typeof t){case"string":case"function":n!==void 0&&s.unshift(n),e.message=t;break;case"object":Object.assign(e,t);break}typeof e.message=="function"&&(e.message=e.message());const i=typeof e.message;return Dm(i==="string"||i==="object"),Object.assign(e,{args:s},e.opts)}function sB(e,t,n){if(typeof t=="string"){const s=n.time?ZO(JO(n.total)):"";t=n.time?`${e}: ${s}  ${t}`:`${e}: ${t}`,t=tB(t,n.color,n.background)}return t}function iB(e){for(const t in e)for(const n in e[t])return n||"untitled";return"empty"}globalThis.probe={};const R3=new Ja({id:"@probe.gl/log"}),s_="4.3.0",rB=s_[0]>="0"&&s_[0]<="9"?`v${s_}`:"";function oB(){const e=new Ja({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=e,globalThis.loaders.version=rB,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=e,e}const aB=oB();function cB(e,t){return v3(e||{},t)}function v3(e,t,n=0){if(n>3)return t;const s={...e};for(const[i,r]of Object.entries(t))r&&typeof r=="object"&&!Array.isArray(r)?s[i]=v3(s[i]||{},t[i],n+1):s[i]=t[i];return s}const lB="latest";function uB(){var e;return(e=globalThis._loadersgl_)!=null&&e.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.0"),globalThis._loadersgl_.version}const hB=uB();function dr(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}const eo=typeof process!="object"||String(process)!=="[object process]"||process.browser,fB=typeof window<"u"&&typeof window.orientation<"u",vE=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);vE&&parseFloat(vE[1]);class dB{constructor(t,n){T(this,"name");T(this,"workerThread");T(this,"isRunning",!0);T(this,"result");T(this,"_resolve",()=>{});T(this,"_reject",()=>{});this.name=t,this.workerThread=n,this.result=new Promise((s,i)=>{this._resolve=s,this._reject=i})}postMessage(t,n){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:n})}done(t){dr(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){dr(this.isRunning),this.isRunning=!1,this._reject(t)}}class i_{terminate(){}}const r_=new Map;function gB(e){dr(e.source&&!e.url||!e.source&&e.url);let t=r_.get(e.source||e.url);return t||(e.url&&(t=pB(e.url),r_.set(e.url,t)),e.source&&(t=C3(e.source),r_.set(e.source,t))),dr(t),t}function pB(e){if(!e.startsWith("http"))return e;const t=_B(e);return C3(t)}function C3(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function _B(e){return`try {
  importScripts('${e}');
} catch (error) {
  console.error(error);
  throw error;
}`}function M3(e,t=!0,n){const s=n||new Set;if(e){if(CE(e))s.add(e);else if(CE(e.buffer))s.add(e.buffer);else if(!ArrayBuffer.isView(e)){if(t&&typeof e=="object")for(const i in e)M3(e[i],t,s)}}return n===void 0?Array.from(s):[]}function CE(e){return e?e instanceof ArrayBuffer||typeof MessagePort<"u"&&e instanceof MessagePort||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas:!1}const o_=()=>{};class S0{constructor(t){T(this,"name");T(this,"source");T(this,"url");T(this,"terminated",!1);T(this,"worker");T(this,"onMessage");T(this,"onError");T(this,"_loadableURL","");const{name:n,source:s,url:i}=t;dr(s||i),this.name=n,this.source=s,this.url=i,this.onMessage=o_,this.onError=r=>console.log(r),this.worker=eo?this._createBrowserWorker():this._createNodeWorker()}static isSupported(){return typeof Worker<"u"&&eo||typeof i_<"u"&&!eo}destroy(){this.onMessage=o_,this.onError=o_,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(t,n){n=n||M3(t),this.worker.postMessage(t,n)}_getErrorFromErrorEvent(t){let n="Failed to load ";return n+=`worker ${this.name} from ${this.url}. `,t.message&&(n+=`${t.message} in `),t.lineno&&(n+=`:${t.lineno}:${t.colno}`),new Error(n)}_createBrowserWorker(){this._loadableURL=gB({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},t.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},t.onmessageerror=n=>console.error(n),t}_createNodeWorker(){let t;if(this.url){const s=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;t=new i_(s,{eval:!1})}else if(this.source)t=new i_(this.source,{eval:!0});else throw new Error("no worker");return t.on("message",n=>{this.onMessage(n)}),t.on("error",n=>{this.onError(n)}),t.on("exit",n=>{}),t}}class mB{constructor(t){T(this,"name","unnamed");T(this,"source");T(this,"url");T(this,"maxConcurrency",1);T(this,"maxMobileConcurrency",1);T(this,"onDebug",()=>{});T(this,"reuseWorkers",!0);T(this,"props",{});T(this,"jobQueue",[]);T(this,"idleQueue",[]);T(this,"count",0);T(this,"isDestroyed",!1);this.source=t.source,this.url=t.url,this.setProps(t)}static isSupported(){return S0.isSupported()}destroy(){this.idleQueue.forEach(t=>t.destroy()),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},t.name!==void 0&&(this.name=t.name),t.maxConcurrency!==void 0&&(this.maxConcurrency=t.maxConcurrency),t.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=t.maxMobileConcurrency),t.reuseWorkers!==void 0&&(this.reuseWorkers=t.reuseWorkers),t.onDebug!==void 0&&(this.onDebug=t.onDebug)}async startJob(t,n=(i,r,a)=>i.done(a),s=(i,r)=>i.error(r)){const i=new Promise(r=>(this.jobQueue.push({name:t,onMessage:n,onError:s,onStart:r}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:t,backlog:this.jobQueue.length});const s=new dB(n.name,t);t.onMessage=i=>n.onMessage(s,i.type,i.payload),t.onError=i=>n.onError(s,i),n.onStart(s);try{await s.result}catch(i){console.error(`Worker exception: ${i}`)}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){!eo||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new S0({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return fB?this.maxMobileConcurrency:this.maxConcurrency}}const AB={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}},or=class or{constructor(t){T(this,"props");T(this,"workerPools",new Map);this.props={...AB},this.setProps(t),this.workerPools=new Map}static isSupported(){return S0.isSupported()}static getWorkerFarm(t={}){return or._workerFarm=or._workerFarm||new or({}),or._workerFarm.setProps(t),or._workerFarm}destroy(){for(const t of this.workerPools.values())t.destroy();this.workerPools=new Map}setProps(t){this.props={...this.props,...t};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:n,source:s,url:i}=t;let r=this.workerPools.get(n);return r||(r=new mB({name:n,source:s,url:i}),r.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,r)),r}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}};T(or,"_workerFarm");let Uf=or;function yB(e,t={}){const n=t[e.id]||{},s=eo?`${e.id}-worker.js`:`${e.id}-worker-node.js`;let i=n.workerUrl;if(!i&&e.id==="compression"&&(i=t.workerUrl),t._workerType==="test"&&(eo?i=`modules/${e.module}/dist/${s}`:i=`modules/${e.module}/src/workers/${e.id}-worker-node.ts`),!i){let r=e.version;r==="latest"&&(r=lB);const a=r?`@${r}`:"";i=`https://unpkg.com/@loaders.gl/${e.module}${a}/dist/${s}`}return dr(i),i}function TB(e,t=hB){dr(e,"no worker provided");const n=e.version;return!(!t||!n)}function EB(e,t){return!Uf.isSupported()||!eo&&!(t!=null&&t._nodeWorkers)?!1:e.worker&&(t==null?void 0:t.worker)}async function bB(e,t,n,s,i){const r=e.id,a=yB(e,n),h=Uf.getWorkerFarm(n).getWorkerPool({name:r,url:a});n=JSON.parse(JSON.stringify(n)),s=JSON.parse(JSON.stringify(s||{}));const d=await h.startJob("process-on-worker",SB.bind(null,i));return d.postMessage("process",{input:t,options:n,context:s}),await(await d.result).result}async function SB(e,t,n,s){switch(n){case"done":t.done(s);break;case"error":t.error(new Error(s.error));break;case"process":const{id:i,input:r,options:a}=s;try{const l=await e(r,a);t.postMessage("done",{id:i,result:l})}catch(l){const h=l instanceof Error?l.message:"unknown error";t.postMessage("error",{id:i,error:h})}break;default:console.warn(`parse-with-worker unknown message ${n}`)}}function RB(e,t,n){if(n=n||e.byteLength,e.byteLength<n||t.byteLength<n)return!1;const s=new Uint8Array(e),i=new Uint8Array(t);for(let r=0;r<s.length;++r)if(s[r]!==i[r])return!1;return!0}function vB(...e){return CB(e)}function CB(e){const t=e.map(r=>r instanceof ArrayBuffer?new Uint8Array(r):r),n=t.reduce((r,a)=>r+a.byteLength,0),s=new Uint8Array(n);let i=0;for(const r of t)s.set(r,i),i+=r.byteLength;return s.buffer}async function MB(e){const t=[];for await(const n of e)t.push(n);return vB(...t)}function ME(){let e;if(typeof window<"u"&&window.performance)e=window.performance.now();else if(typeof process<"u"&&process.hrtime){const t=process.hrtime();e=t[0]*1e3+t[1]/1e6}else e=Date.now();return e}class wE{constructor(t,n){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=t,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=ME(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(ME()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Za{constructor(t){this.stats={},this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t,n="count"){return this._getOrCreate({name:t,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const t of Object.values(this.stats))t.reset();return this}forEach(t){for(const n of Object.values(this.stats))t(n)}getTable(){const t={};return this.forEach(n=>{t[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),t}_initializeStats(t=[]){t.forEach(n=>this._getOrCreate(n))}_getOrCreate(t){const{name:n,type:s}=t;let i=this.stats[n];return i||(t instanceof wE?i=t:i=new wE(n,s),this.stats[n]=i),i}}let wB="";const OE={};function OB(e){for(const t in OE)if(e.startsWith(t)){const n=OE[t];e=e.replace(t,n)}return!e.startsWith("http://")&&!e.startsWith("https://")&&(e=`${wB}${e}`),e}function BB(e){return e&&typeof e=="object"&&e.isBuffer}function w3(e){if(BB(e))return e;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return e.byteOffset===0&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if(typeof e=="string"){const t=e;return new TextEncoder().encode(t).buffer}if(e&&typeof e=="object"&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}function O3(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}function xB(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}const NB=e=>typeof e=="boolean",yl=e=>typeof e=="function",Kl=e=>e!==null&&typeof e=="object",BE=e=>Kl(e)&&e.constructor==={}.constructor,IB=e=>!!e&&typeof e[Symbol.iterator]=="function",DB=e=>e&&typeof e[Symbol.asyncIterator]=="function",lo=e=>typeof Response<"u"&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,uo=e=>typeof Blob<"u"&&e instanceof Blob,PB=e=>e&&typeof e=="object"&&e.isBuffer,FB=e=>typeof ReadableStream<"u"&&e instanceof ReadableStream||Kl(e)&&yl(e.tee)&&yl(e.cancel)&&yl(e.getReader),UB=e=>Kl(e)&&yl(e.read)&&yl(e.pipe)&&NB(e.readable),B3=e=>FB(e)||UB(e);class LB extends Error{constructor(n,s){super(n);T(this,"reason");T(this,"url");T(this,"response");this.reason=s.reason,this.url=s.url,this.response=s.response}}const kB=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,zB=/^([-\w.]+\/[-\w.+]+)/;function xE(e,t){return e.toLowerCase()===t.toLowerCase()}function VB(e){const t=zB.exec(e);return t?t[1]:e}function NE(e){const t=kB.exec(e);return t?t[1]:""}const x3=/\?.*/;function HB(e){const t=e.match(x3);return t&&t[0]}function Pm(e){return e.replace(x3,"")}function jB(e){if(e.length<50)return e;const t=e.slice(e.length-15);return`${e.substr(0,32)}...${t}`}function Bd(e){return lo(e)?e.url:uo(e)?e.name||"":typeof e=="string"?e:""}function Fm(e){if(lo(e)){const t=e,n=t.headers.get("content-type")||"",s=Pm(t.url);return VB(n)||NE(s)}return uo(e)?e.type||"":typeof e=="string"?NE(e):""}function $B(e){return lo(e)?e.headers["content-length"]||-1:uo(e)?e.size:typeof e=="string"?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}async function N3(e){if(lo(e))return e;const t={},n=$B(e);n>=0&&(t["content-length"]=String(n));const s=Bd(e),i=Fm(e);i&&(t["content-type"]=i);const r=await WB(e);r&&(t["x-first-bytes"]=r),typeof e=="string"&&(e=new TextEncoder().encode(e));const a=new Response(e,{headers:t});return Object.defineProperty(a,"url",{value:s}),a}async function XB(e){if(!e.ok)throw await GB(e)}async function GB(e){const t=jB(e.url);let n=`Failed to fetch resource (${e.status}) ${e.statusText}: ${t}`;n=n.length>100?`${n.slice(0,100)}...`:n;const s={reason:e.statusText,url:e.url,response:e};try{const i=e.headers.get("Content-Type");s.reason=!e.bodyUsed&&(i!=null&&i.includes("application/json"))?await e.json():await e.text()}catch{}return new LB(n,s)}async function WB(e){if(typeof e=="string")return`data:,${e.slice(0,5)}`;if(e instanceof Blob){const n=e.slice(0,5);return await new Promise(s=>{const i=new FileReader;i.onload=r=>{var a;return s((a=r==null?void 0:r.target)==null?void 0:a.result)},i.readAsDataURL(n)})}if(e instanceof ArrayBuffer){const n=e.slice(0,5);return`data:base64,${qB(n)}`}return null}function qB(e){let t="";const n=new Uint8Array(e);for(let s=0;s<n.byteLength;s++)t+=String.fromCharCode(n[s]);return btoa(t)}function YB(e){return!KB(e)&&!JB(e)}function KB(e){return e.startsWith("http:")||e.startsWith("https:")}function JB(e){return e.startsWith("data:")}async function IE(e,t){var n,s;if(typeof e=="string"){const i=OB(e);return YB(i)&&(n=globalThis.loaders)!=null&&n.fetchNode?(s=globalThis.loaders)==null?void 0:s.fetchNode(i,t):await fetch(i,t)}return await N3(e)}const DE=new Ja({id:"loaders.gl"});class ZB{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class QB{constructor(){T(this,"console");this.console=console}log(...t){return this.console.log.bind(this.console,...t)}info(...t){return this.console.info.bind(this.console,...t)}warn(...t){return this.console.warn.bind(this.console,...t)}error(...t){return this.console.error.bind(this.console,...t)}}const I3={fetch:null,mimeType:void 0,nothrow:!1,log:new QB,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:T3,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},tx={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function D3(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state||(e._state={}),e._state}function P3(){const e=D3();return e.globalOptions=e.globalOptions||{...I3},e.globalOptions}function ex(e,t,n,s){return n=n||[],n=Array.isArray(n)?n:[n],nx(e,n),ix(t,e,s)}function nx(e,t){PE(e,null,I3,tx,t);for(const n of t){const s=e&&e[n.id]||{},i=n.options&&n.options[n.id]||{},r=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};PE(s,n.id,i,r,t)}}function PE(e,t,n,s,i){const r=t||"Top level",a=t?`${t}.`:"";for(const l in e){const h=!t&&Kl(e[l]),d=l==="baseUri"&&!t,g=l==="workerUrl"&&t;if(!(l in n)&&!d&&!g){if(l in s)DE.warn(`${r} loader option '${a}${l}' no longer supported, use '${s[l]}'`)();else if(!h){const _=sx(l,i);DE.warn(`${r} loader option '${a}${l}' not recognized. ${_}`)()}}}}function sx(e,t){const n=e.toLowerCase();let s="";for(const i of t)for(const r in i.options){if(e===r)return`Did you mean '${i.id}.${r}'?`;const a=r.toLowerCase();(n.startsWith(a)||a.startsWith(n))&&(s=s||`Did you mean '${i.id}.${r}'?`)}return s}function ix(e,t,n){const i={...e.options||{}};return rx(i,n),i.log===null&&(i.log=new ZB),FE(i,P3()),FE(i,t),i}function FE(e,t){for(const n in t)if(n in t){const s=t[n];BE(s)&&BE(e[n])?e[n]={...e[n],...t[n]}:e[n]=t[n]}}function rx(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}function Um(e){return e?(Array.isArray(e)&&(e=e[0]),Array.isArray(e==null?void 0:e.extensions)):!1}function Lm(e){yE(e,"null loader"),yE(Um(e),"invalid loader");let t;return Array.isArray(e)&&(t=e[1],e=e[0],e={...e,options:{...e.options,...t}}),(e!=null&&e.parseTextSync||e!=null&&e.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}const F3=()=>{const e=D3();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};function ox(e){const t=F3();e=Array.isArray(e)?e:[e];for(const n of e){const s=Lm(n);t.find(i=>s===i)||t.unshift(s)}}function ax(){return F3()}const cx=/\.([^.]+)$/;async function lx(e,t=[],n,s){if(!U3(e))return null;let i=UE(e,t,{...n,nothrow:!0},s);if(i)return i;if(uo(e)&&(e=await e.slice(0,10).arrayBuffer(),i=UE(e,t,n,s)),!i&&!(n!=null&&n.nothrow))throw new Error(L3(e));return i}function UE(e,t=[],n,s){if(!U3(e))return null;if(t&&!Array.isArray(t))return Lm(t);let i=[];t&&(i=i.concat(t)),n!=null&&n.ignoreRegisteredLoaders||i.push(...ax()),hx(i);const r=ux(e,i,n,s);if(!r&&!(n!=null&&n.nothrow))throw new Error(L3(e));return r}function ux(e,t,n,s){const i=Bd(e),r=Fm(e),a=Pm(i)||(s==null?void 0:s.url);let l=null,h="";return n!=null&&n.mimeType&&(l=a_(t,n==null?void 0:n.mimeType),h=`match forced by supplied MIME type ${n==null?void 0:n.mimeType}`),l=l||fx(t,a),h=h||(l?`matched url ${a}`:""),l=l||a_(t,r),h=h||(l?`matched MIME type ${r}`:""),l=l||gx(t,e),h=h||(l?`matched initial data ${k3(e)}`:""),n!=null&&n.fallbackMimeType&&(l=l||a_(t,n==null?void 0:n.fallbackMimeType),h=h||(l?`matched fallback MIME type ${r}`:"")),h&&aB.log(1,`selectLoader selected ${l==null?void 0:l.name}: ${h}.`),l}function U3(e){return!(e instanceof Response&&e.status===204)}function L3(e){const t=Bd(e),n=Fm(e);let s="No valid loader found (";s+=t?`${O3(t)}, `:"no url provided, ",s+=`MIME type: ${n?`"${n}"`:"not provided"}, `;const i=e?k3(e):"";return s+=i?` first bytes: "${i}"`:"first bytes: not available",s+=")",s}function hx(e){for(const t of e)Lm(t)}function fx(e,t){const n=t&&cx.exec(t),s=n&&n[1];return s?dx(e,s):null}function dx(e,t){t=t.toLowerCase();for(const n of e)for(const s of n.extensions)if(s.toLowerCase()===t)return n;return null}function a_(e,t){var n;for(const s of e)if((n=s.mimeTypes)!=null&&n.some(i=>xE(t,i))||xE(t,`application/x.${s.id}`))return s;return null}function gx(e,t){if(!t)return null;for(const n of e)if(typeof t=="string"){if(px(t,n))return n}else if(ArrayBuffer.isView(t)){if(LE(t.buffer,t.byteOffset,n))return n}else if(t instanceof ArrayBuffer&&LE(t,0,n))return n;return null}function px(e,t){return t.testText?t.testText(e):(Array.isArray(t.tests)?t.tests:[t.tests]).some(s=>e.startsWith(s))}function LE(e,t,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>_x(e,t,n,i))}function _x(e,t,n,s){if(s instanceof ArrayBuffer)return RB(s,e,s.byteLength);switch(typeof s){case"function":return s(e);case"string":const i=R0(e,t,s.length);return s===i;default:return!1}}function k3(e,t=5){return typeof e=="string"?e.slice(0,t):ArrayBuffer.isView(e)?R0(e.buffer,e.byteOffset,t):e instanceof ArrayBuffer?R0(e,0,t):""}function R0(e,t,n){if(e.byteLength<t+n)return"";const s=new DataView(e);let i="";for(let r=0;r<n;r++)i+=String.fromCharCode(s.getUint8(t+r));return i}const mx=256*1024;function*Ax(e,t){const n=(t==null?void 0:t.chunkSize)||mx;let s=0;const i=new TextEncoder;for(;s<e.length;){const r=Math.min(e.length-s,n),a=e.slice(s,s+r);s+=r,yield i.encode(a)}}const yx=256*1024;function*Tx(e,t={}){const{chunkSize:n=yx}=t;let s=0;for(;s<e.byteLength;){const i=Math.min(e.byteLength-s,n),r=new ArrayBuffer(i),a=new Uint8Array(e,s,i);new Uint8Array(r).set(a),s+=i,yield r}}const Ex=1024*1024;async function*bx(e,t){const n=(t==null?void 0:t.chunkSize)||Ex;let s=0;for(;s<e.size;){const i=s+n,r=await e.slice(s,i).arrayBuffer();s=i,yield r}}function kE(e,t){return T3?Sx(e,t):Rx(e)}async function*Sx(e,t){const n=e.getReader();let s;try{for(;;){const i=s||n.read();t!=null&&t._streamReadAhead&&(s=n.read());const{done:r,value:a}=await i;if(r)return;yield w3(a)}}catch{n.releaseLock()}}async function*Rx(e,t){for await(const n of e)yield w3(n)}function vx(e,t){if(typeof e=="string")return Ax(e,t);if(e instanceof ArrayBuffer)return Tx(e,t);if(uo(e))return bx(e,t);if(B3(e))return kE(e,t);if(lo(e))return kE(e.body,t);throw new Error("makeIterator")}const z3="Cannot convert supplied data type";function Cx(e,t,n){if(t.text&&typeof e=="string")return e;if(PB(e)&&(e=e.buffer),e instanceof ArrayBuffer){const s=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(s):s}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let s=e.buffer;const i=e.byteLength||e.length;return(e.byteOffset!==0||i!==s.byteLength)&&(s=s.slice(e.byteOffset,e.byteOffset+i)),s}throw new Error(z3)}async function Mx(e,t,n){const s=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if(typeof e=="string"||s)return Cx(e,t);if(uo(e)&&(e=await N3(e)),lo(e)){const i=e;return await XB(i),t.binary?await i.arrayBuffer():await i.text()}if(B3(e)&&(e=vx(e,n)),IB(e)||DB(e))return MB(e);throw new Error(z3)}function V3(e,t){const n=P3(),s=e||n;return typeof s.fetch=="function"?s.fetch:Kl(s.fetch)?i=>IE(i,s.fetch):t!=null&&t.fetch?t==null?void 0:t.fetch:IE}function wx(e,t,n){if(n)return n;const s={fetch:V3(t,e),...e};if(s.url){const i=Pm(s.url);s.baseUrl=i,s.queryString=HB(s.url),s.filename=O3(i),s.baseUrl=xB(i)}return Array.isArray(s.loaders)||(s.loaders=null),s}function Ox(e,t){if(e&&!Array.isArray(e))return e;let n;if(e&&(n=Array.isArray(e)?e:[e]),t&&t.loaders){const s=Array.isArray(t.loaders)?t.loaders:[t.loaders];n=n?[...n,...s]:s}return n&&n.length?n:void 0}async function Lf(e,t,n,s){t&&!Array.isArray(t)&&!Um(t)&&(s=void 0,n=t,t=void 0),e=await e,n=n||{};const i=Bd(e),a=Ox(t,s),l=await lx(e,a,n);return l?(n=ex(n,l,a,i),s=wx({url:i,_parse:Lf,loaders:a},n,s||null),await Bx(l,e,n,s)):null}async function Bx(e,t,n,s){if(TB(e),n=cB(e.options,n),lo(t)){const r=t,{ok:a,redirected:l,status:h,statusText:d,type:g,url:_}=r,m=Object.fromEntries(r.headers.entries());s.response={headers:m,ok:a,redirected:l,status:h,statusText:d,type:g,url:_}}t=await Mx(t,e,n);const i=e;if(i.parseTextSync&&typeof t=="string")return i.parseTextSync(t,n,s);if(EB(e,n))return await bB(e,t,n,s,Lf);if(i.parseText&&typeof t=="string")return await i.parseText(t,n,s);if(i.parse)return await i.parse(t,n,s);throw dr(!i.parseSync),new Error(`${e.id} loader - no parser found and worker is disabled`)}async function gr(e,t,n,s){let i,r;!Array.isArray(t)&&!Um(t)?(i=[],r=t):(i=t,r=n);const a=V3(r);let l=e;return typeof e=="string"&&(l=await a(e)),uo(e)&&(l=await a(e)),Array.isArray(i)?await Lf(l,i,r):await Lf(l,i,r)}const xx="4.2.0-beta.2";function H3(e,t){if(!e)throw new Error("loader assertion failed.")}const Nx=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),zE=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);zE&&parseFloat(zE[1]);var m3;const Ix=(m3=globalThis.loaders)==null?void 0:m3.parseImageNode,v0=typeof Image<"u",C0=typeof ImageBitmap<"u",Dx=!!Ix,M0=Nx?!0:Dx;function Px(e){switch(e){case"auto":return C0||v0||M0;case"imagebitmap":return C0;case"image":return v0;case"data":return M0;default:throw new Error(`@loaders.gl/images: image ${e} not supported in this environment`)}}function Fx(){if(C0)return"imagebitmap";if(v0)return"image";if(M0)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function Ux(e){const t=kx(e);if(!t)throw new Error("Not an image");return t}function Lx(e){switch(Ux(e)){case"data":return e;case"image":case"imagebitmap":const t=document.createElement("canvas"),n=t.getContext("2d");if(!n)throw new Error("getImageData");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),n.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function kx(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&e instanceof Image?"image":e&&typeof e=="object"&&e.data&&e.width&&e.height?"data":null}const zx=/^data:image\/svg\+xml/,Vx=/\.svg((\?|#).*)?$/;function km(e){return e&&(zx.test(e)||Vx.test(e))}function Hx(e,t){if(km(t)){let s=new TextDecoder().decode(e);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(s=unescape(encodeURIComponent(s)))}catch(r){throw new Error(r.message)}return`data:image/svg+xml;base64,${btoa(s)}`}return j3(e,t)}function j3(e,t){if(km(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function $3(e,t,n){const s=Hx(e,n),i=self.URL||self.webkitURL,r=typeof s!="string"&&i.createObjectURL(s);try{return await jx(r||s,t)}finally{r&&i.revokeObjectURL(r)}}async function jx(e,t){const n=new Image;return n.src=e,t.image&&t.image.decode&&n.decode?(await n.decode(),n):await new Promise((s,i)=>{try{n.onload=()=>s(n),n.onerror=r=>{const a=r instanceof Error?r.message:"error";i(new Error(a))}}catch(r){i(r)}})}const $x={};let VE=!0;async function Xx(e,t,n){let s;km(n)?s=await $3(e,t,n):s=j3(e,n);const i=t&&t.imagebitmap;return await Gx(s,i)}async function Gx(e,t=null){if((Wx(t)||!VE)&&(t=null),t)try{return await createImageBitmap(e,t)}catch(n){console.warn(n),VE=!1}return await createImageBitmap(e)}function Wx(e){for(const t in e||$x)return!1;return!0}function qx(e){return!Zx(e,"ftyp",4)||(e[8]&96)===0?null:Yx(e)}function Yx(e){switch(Kx(e,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function Kx(e,t,n){return String.fromCharCode(...e.slice(t,n))}function Jx(e){return[...e].map(t=>t.charCodeAt(0))}function Zx(e,t,n=0){const s=Jx(t);for(let i=0;i<s.length;++i)if(s[i]!==e[i+n])return!1;return!0}const Ls=!1,Tl=!0;function X3(e){const t=Jl(e);return tN(t)||sN(t)||eN(t)||nN(t)||Qx(t)}function Qx(e){const t=new Uint8Array(e instanceof DataView?e.buffer:e),n=qx(t);return n?{mimeType:n.mimeType,width:0,height:0}:null}function tN(e){const t=Jl(e);return t.byteLength>=24&&t.getUint32(0,Ls)===2303741511?{mimeType:"image/png",width:t.getUint32(16,Ls),height:t.getUint32(20,Ls)}:null}function eN(e){const t=Jl(e);return t.byteLength>=10&&t.getUint32(0,Ls)===1195984440?{mimeType:"image/gif",width:t.getUint16(6,Tl),height:t.getUint16(8,Tl)}:null}function nN(e){const t=Jl(e);return t.byteLength>=14&&t.getUint16(0,Ls)===16973&&t.getUint32(2,Tl)===t.byteLength?{mimeType:"image/bmp",width:t.getUint32(18,Tl),height:t.getUint32(22,Tl)}:null}function sN(e){const t=Jl(e);if(!(t.byteLength>=3&&t.getUint16(0,Ls)===65496&&t.getUint8(2)===255))return null;const{tableMarkers:s,sofMarkers:i}=iN();let r=2;for(;r+9<t.byteLength;){const a=t.getUint16(r,Ls);if(i.has(a))return{mimeType:"image/jpeg",height:t.getUint16(r+5,Ls),width:t.getUint16(r+7,Ls)};if(!s.has(a))return null;r+=2,r+=t.getUint16(r,Ls)}return null}function iN(){const e=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)e.add(n);return{tableMarkers:e,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Jl(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}async function rN(e,t){var i;const{mimeType:n}=X3(e)||{},s=(i=globalThis.loaders)==null?void 0:i.parseImageNode;return H3(s),await s(e,n)}async function oN(e,t,n){t=t||{};const i=(t.image||{}).type||"auto",{url:r}=n||{},a=aN(i);let l;switch(a){case"imagebitmap":l=await Xx(e,t,r);break;case"image":l=await $3(e,t,r);break;case"data":l=await rN(e);break;default:H3(!1)}return i==="data"&&(l=Lx(l)),l}function aN(e){switch(e){case"auto":case"data":return Fx();default:return Px(e),e}}const cN=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],lN=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],uN={image:{type:"auto",decode:!0}},hN={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:xx,mimeTypes:lN,extensions:cN,parse:oN,tests:[e=>!!X3(new DataView(e))],options:uN},kt=new Ja({id:"deck"});let w0={};function fN(e){w0=e}function Qe(e,t,n,s){kt.level>0&&w0[e]&&w0[e].call(null,t,n,s)}function dN(e){const t=e[0],n=e[e.length-1];return t==="{"&&n==="}"||t==="["&&n==="]"}const gN={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:dN,parseTextSync:JSON.parse};function pN(){const e="9.0.40",t=globalThis.deck&&globalThis.deck.VERSION;if(t&&t!==e)throw new Error(`deck.gl - multiple versions detected: ${t} vs ${e}`);return t||(kt.log(1,`deck.gl ${e}`)(),globalThis.deck={...globalThis.deck,VERSION:e,version:e,log:kt,_registerLoggers:fN},ox([gN,[hN,{imagebitmap:{premultiplyAlpha:"none"}}]])),e}const _N=pN();function Kr(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}const c_={number:{type:"number",validate(e,t){return Number.isFinite(e)&&typeof t=="object"&&(t.max===void 0||e<=t.max)&&(t.min===void 0||e>=t.min)}},array:{type:"array",validate(e,t){return Array.isArray(e)||ArrayBuffer.isView(e)}}};function mN(e){const t={};for(const[n,s]of Object.entries(e))t[n]=yN(s);return t}function AN(e,t,n){const s={};for(const[i,r]of Object.entries(t))e&&i in e&&!r.private?(r.validate&&Kr(r.validate(e[i],r),`${n}: invalid ${i}`),s[i]=e[i]):s[i]=r.value;return s}function yN(e){let t=HE(e);if(t!=="object")return{value:e,...c_[t],type:t};if(typeof e=="object")return e?e.type!==void 0?{...e,...c_[e.type],type:e.type}:e.value===void 0?{type:"object",value:e}:(t=HE(e.value),{...e,...c_[t],type:t}):{type:"object",value:null};throw new Error("props")}function HE(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}const TN=`#ifdef MODULE_LOGDEPTH
logdepth_adjustPosition(gl_Position);
#endif
`,EN=`#ifdef MODULE_MATERIAL
gl_FragColor = material_filterColor(gl_FragColor);
#endif
#ifdef MODULE_LIGHTING
gl_FragColor = lighting_filterColor(gl_FragColor);
#endif
#ifdef MODULE_FOG
gl_FragColor = fog_filterColor(gl_FragColor);
#endif
#ifdef MODULE_PICKING
gl_FragColor = picking_filterHighlightColor(gl_FragColor);
gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif
#ifdef MODULE_LOGDEPTH
logdepth_setFragDepth();
#endif
`,bN={vertex:TN,fragment:EN},jE=/void\s+main\s*\([^)]*\)\s*\{\n?/,$E=/}\n?[^{}]*$/,l_=[],Tf="__LUMA_INJECT_DECLARATIONS__";function SN(e){const t={vertex:{},fragment:{}};for(const n in e){let s=e[n];const i=RN(n);typeof s=="string"&&(s={order:0,injection:s}),t[i][n]=s}return t}function RN(e){const t=e.slice(0,2);switch(t){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(t)}}function kf(e,t,n,s=!1){const i=t==="vertex";for(const r in n){const a=n[r];a.sort((h,d)=>h.order-d.order),l_.length=a.length;for(let h=0,d=a.length;h<d;++h)l_[h]=a[h].injection;const l=`${l_.join(`
`)}
`;switch(r){case"vs:#decl":i&&(e=e.replace(Tf,l));break;case"vs:#main-start":i&&(e=e.replace(jE,h=>h+l));break;case"vs:#main-end":i&&(e=e.replace($E,h=>l+h));break;case"fs:#decl":i||(e=e.replace(Tf,l));break;case"fs:#main-start":i||(e=e.replace(jE,h=>h+l));break;case"fs:#main-end":i||(e=e.replace($E,h=>l+h));break;default:e=e.replace(r,h=>h+l)}}return e=e.replace(Tf,""),s&&(e=e.replace(/\}\s*$/,r=>r+bN[t])),e}let vN=1;class Jr{constructor(t){T(this,"name");T(this,"vs");T(this,"fs");T(this,"getModuleUniforms");T(this,"dependencies");T(this,"deprecations");T(this,"defines");T(this,"injections");T(this,"uniforms",{});T(this,"uniformTypes",{});const{name:n,vs:s,fs:i,dependencies:r=[],uniformTypes:a={},uniformPropTypes:l={},getUniforms:h,deprecations:d=[],defines:g={},inject:_={}}=t;Kr(typeof n=="string"),this.name=n,this.vs=s,this.fs=i,this.getModuleUniforms=h,this.dependencies=Jr.instantiateModules(r),this.deprecations=this._parseDeprecationDefinitions(d),this.defines=g,this.injections=SN(_),this.uniformTypes=a,l&&(this.uniforms=mN(l))}static instantiateModules(t){return t.map(n=>{if(n instanceof Jr)return n;Kr(typeof n!="string",`Shader module use by name is deprecated. Import shader module '${JSON.stringify(n)}' and use it directly.`),n.name||(console.warn("shader module has no name"),n.name=`shader-module-${vN++}`);const s=new Jr(n);return s.dependencies=Jr.instantiateModules(n.dependencies||[]),s})}getModuleSource(t){let n;switch(t){case"vertex":n=this.vs||"";break;case"fragment":n=this.fs||"";break;default:Kr(!1)}const s=this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");return`// ----- MODULE ${this.name} ---------------

#define MODULE_${s}
${n}

`}getUniforms(t,n){return this.getModuleUniforms?this.getModuleUniforms(t,n):AN(t,this.uniforms,this.name)}getDefines(){return this.defines}checkDeprecations(t,n){this.deprecations.forEach(s=>{var i;(i=s.regex)!=null&&i.test(t)&&(s.deprecated?n.deprecated(s.old,s.new)():n.removed(s.old,s.new)())})}_parseDeprecationDefinitions(t){return t.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp(`\\b${n.old}\\(`);break;default:n.regex=new RegExp(`${n.type} ${n.old};`)}}),t}_defaultGetUniforms(t={}){const n={},s=this.uniforms;for(const i in s){const r=s[i];i in t&&!r.private?(r.validate&&Kr(r.validate(t[i],r),`${this.name}: invalid ${i}`),n[i]=t[i]):n[i]=r.value}return n}}function XE(e){if(e.source&&e.platformInfo.type==="webgpu")return{...e,vs:void 0,fs:void 0};if(!e.vs)throw new Error("no vertex shader");const t=GE(e.platformInfo,e.vs);let n;return e.fs&&(n=GE(e.platformInfo,e.fs)),{...e,vs:t,fs:n}}function GE(e,t){if(typeof t=="string")return t;switch(e.type){case"webgpu":if(t!=null&&t.wgsl)return t.wgsl;throw new Error("WebGPU does not support GLSL shaders");default:if(t!=null&&t.glsl)return t.glsl;throw new Error("WebGL does not support WGSL shaders")}}function xd(e){const t=Jr.instantiateModules(e);return CN(t)}function CN(e){const t={},n={};return G3({modules:e,level:0,moduleMap:t,moduleDepth:n}),Object.keys(n).sort((s,i)=>n[i]-n[s]).map(s=>t[s])}function G3(e){const{modules:t,level:n,moduleMap:s,moduleDepth:i}=e;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const r of t)s[r.name]=r,(i[r.name]===void 0||i[r.name]<n)&&(i[r.name]=n);for(const r of t)r.dependencies&&G3({modules:r.dependencies,level:n+1,moduleMap:s,moduleDepth:i})}function MN(e){switch(e==null?void 0:e.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function wN(e,t){var s;if(Number(((s=e.match(/^#version[ \t]+(\d+)/m))==null?void 0:s[1])||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(t){case"vertex":return e=WE(e,ON),e;case"fragment":return e=WE(e,BN),e;default:throw new Error(t)}}const W3=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],ON=[...W3,[O0("attribute"),"in $1"],[O0("varying"),"out $1"]],BN=[...W3,[O0("varying"),"in $1"]];function WE(e,t){for(const[n,s]of t)e=e.replace(n,s);return e}function O0(e){return new RegExp(`\\b${e}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function q3(e,t){let n="";for(const s in e){const i=e[s];if(n+=`void ${i.signature} {
`,i.header&&(n+=`  ${i.header}`),t[s]){const r=t[s];r.sort((a,l)=>a.order-l.order);for(const a of r)n+=`  ${a.injection}
`}i.footer&&(n+=`  ${i.footer}`),n+=`}
`}return n}function Y3(e){const t={vertex:{},fragment:{}};for(const n of e){let s,i;typeof n!="string"?(s=n,i=s.hook):(s={},i=n),i=i.trim();const[r,a]=i.split(":"),l=i.replace(/\(.+/,""),h=Object.assign(s,{signature:a});switch(r){case"vs":t.vertex[l]=h;break;case"fs":t.fragment[l]=h;break;default:throw new Error(r)}}return t}function xN(e,t){return{name:NN(e,t),language:"glsl",version:IN(e)}}function NN(e,t="unnamed"){const s=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(e);return s?s[1]:t}function IN(e){let t=100;const n=e.match(/[^\s]+/g);if(n&&n.length>=2&&n[0]==="#version"){const s=parseInt(n[1],10);Number.isFinite(s)&&(t=s)}if(t!==100&&t!==300)throw new Error(`Invalid GLSL version ${t}`);return t}const K3=`

${Tf}
`,DN=`precision highp float;
`;function PN(e){const t=xd(e.modules||[]);return{source:B0(e.platformInfo,{...e,source:e.source,stage:"vertex",modules:t}),getUniforms:zm(t)}}function FN(e){const t=xd(e.modules||[]);return{vs:B0(e.platformInfo,{...e,source:e.vs,stage:"vertex",modules:t}),fs:B0(e.platformInfo,{...e,source:e.fs,stage:"fragment",modules:t}),getUniforms:zm(t)}}function UN(e){const{vs:t,fs:n}=e,s=xd(e.modules||[]);return{vs:qE(e.platformInfo,{...e,source:t,stage:"vertex",modules:s}),fs:qE(e.platformInfo,{...e,source:n,stage:"fragment",modules:s}),getUniforms:zm(s)}}function B0(e,t){const{source:n,stage:s,modules:i,hookFunctions:r=[],inject:a={},log:l}=t;Kr(typeof n=="string","shader source must be a string");const h=n;let d="";const g=Y3(r),_={},m={},y={};for(const b in a){const R=typeof a[b]=="string"?{injection:a[b],order:0}:a[b],M=/^(v|f)s:(#)?([\w-]+)$/.exec(b);if(M){const N=M[2],O=M[3];N?O==="decl"?m[b]=[R]:y[b]=[R]:_[b]=[R]}else y[b]=[R]}const E=e.type!=="webgpu"?i:[];for(const b of E){l&&b.checkDeprecations(h,l);const R=b.getModuleSource(s,"wgsl");d+=R;const M=b.injections[s];for(const N in M){const O=/^(v|f)s:#([\w-]+)$/.exec(N);if(O){const I=O[2]==="decl"?m:y;I[N]=I[N]||[],I[N].push(M[N])}else _[N]=_[N]||[],_[N].push(M[N])}}return d+=K3,d=kf(d,s,m),d+=q3(g[s],_),d+=h,d=kf(d,s,y),d}function qE(e,t){const{id:n,source:s,stage:i,language:r="glsl",modules:a,defines:l={},hookFunctions:h=[],inject:d={},prologue:g=!0,log:_}=t;Kr(typeof s=="string","shader source must be a string");const m=r==="glsl"?xN(s).version:-1,y=e.shaderLanguageVersion,E=m===100?"#version 100":"#version 300 es",R=s.split(`
`).slice(1).join(`
`),M={};a.forEach(J=>{Object.assign(M,J.getDefines())}),Object.assign(M,l);let N="";switch(r){case"wgsl":break;case"glsl":N=g?`${E}

// ----- PROLOGUE -------------------------
${LN({id:n,source:s,stage:i})}
${`#define SHADER_TYPE_${i.toUpperCase()}`}
${MN(e)}
${i==="fragment"?DN:""}

// ----- APPLICATION DEFINES -------------------------

${kN(M)}

`:`${E}
`;break}const O=Y3(h),x={},I={},P={};for(const J in d){const et=typeof d[J]=="string"?{injection:d[J],order:0}:d[J],q=/^(v|f)s:(#)?([\w-]+)$/.exec(J);if(q){const Q=q[2],rt=q[3];Q?rt==="decl"?I[J]=[et]:P[J]=[et]:x[J]=[et]}else P[J]=[et]}for(const J of a){_&&J.checkDeprecations(R,_);const et=J.getModuleSource(i);N+=et;const q=J.injections[i];for(const Q in q){const rt=/^(v|f)s:#([\w-]+)$/.exec(Q);if(rt){const ft=rt[2]==="decl"?I:P;ft[Q]=ft[Q]||[],ft[Q].push(q[Q])}else x[Q]=x[Q]||[],x[Q].push(q[Q])}}return N+="// ----- MAIN SHADER SOURCE -------------------------",N+=K3,N=kf(N,i,I),N+=q3(O[i],x),N+=R,N=kf(N,i,P),r==="glsl"&&m!==y&&(N=wN(N,i)),N.trim()}function zm(e){return function(n){const s={};for(const i of e){const r=i.getUniforms(n,s);Object.assign(s,r)}return s}}function LN(e){const{id:t,source:n,stage:s}=e;return t&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME ${t}_${s}

`:""}function kN(e={}){let t="";for(const n in e){const s=e[n];(s||Number.isFinite(s))&&(t+=`#define ${n.toUpperCase()} ${e[n]}
`)}return t}const qr=class qr{constructor(){T(this,"_hookFunctions",[]);T(this,"_defaultModules",[])}static getDefaultShaderAssembler(){return qr.defaultShaderAssembler=qr.defaultShaderAssembler||new qr,qr.defaultShaderAssembler}addDefaultModule(t){this._defaultModules.find(n=>n.name===(typeof t=="string"?t:t.name))||this._defaultModules.push(t)}removeDefaultModule(t){const n=typeof t=="string"?t:t.name;this._defaultModules=this._defaultModules.filter(s=>s.name!==n)}addShaderHook(t,n){n&&(t=Object.assign(n,{hook:t})),this._hookFunctions.push(t)}assembleShader(t){const n=this._getModuleList(t.modules),s=this._hookFunctions,i=XE(t);return{...PN({platformInfo:t.platformInfo,...i,modules:n,hookFunctions:s}),modules:n}}assembleShaderPair(t){const n=XE(t),s=this._getModuleList(t.modules),i=this._hookFunctions,{platformInfo:r}=t;return{...t.platformInfo.shaderLanguage==="wgsl"?FN({platformInfo:r,...n,modules:s,hookFunctions:i}):UN({platformInfo:r,...n,modules:s,hookFunctions:i}),modules:s}}_getModuleList(t=[]){const n=new Array(this._defaultModules.length+t.length),s={};let i=0;for(let r=0,a=this._defaultModules.length;r<a;++r){const l=this._defaultModules[r],h=l.name;n[i++]=l,s[h]=!0}for(let r=0,a=t.length;r<a;++r){const l=t[r],h=l.name;s[h]||(n[i++]=l,s[h]=!0)}return n.length=i,Jr.instantiateModules(n)}};T(qr,"defaultShaderAssembler");let zf=qr;const zN=`out vec4 transform_output;
void main() {
transform_output = vec4(0);
}`,VN=`#version 300 es
${zN}`;function HN(e){const{input:t,inputChannels:n,output:s}={};if(!t)return VN;if(!n)throw new Error("inputChannels");const i=jN(n),r=$N(t,n);return`#version 300 es
in ${i} ${t};
out vec4 ${s};
void main() {
  ${s} = ${r};
}`}function jN(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${e}`)}}function $N(e,t){switch(t){case 1:return`vec4(${e}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${e}, 0.0, 1.0)`;case 3:return`vec4(${e}, 1.0)`;case 4:return e;default:throw new Error(`invalid channels: ${t}`)}}const ot=new Ja({id:"luma.gl"});class XN{constructor(){T(this,"stats",new Map)}getStats(t){return this.get(t)}get(t){return this.stats.has(t)||this.stats.set(t,new Za({id:t})),this.stats.get(t)}}const Vm=new XN;function GN(){const e="9.0.27",t="set luma.log.level=1 (or higher) to trace rendering";if(globalThis.luma&&globalThis.luma.VERSION!==e)throw new Error(`luma.gl - multiple VERSIONs detected: ${globalThis.luma.VERSION} vs ${e}`);return globalThis.luma||(Ar()&&ot.log(1,`${e} - ${t}`)(),globalThis.luma=globalThis.luma||{VERSION:e,version:e,log:ot,stats:Vm}),e}const WN=GN();function qN(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)?e:null}function Dl(e){return Array.isArray(e)?e.length===0||typeof e[0]=="number"?e:null:qN(e)}const u_={};function yr(e="id"){u_[e]=u_[e]||1;const t=u_[e]++;return`${e}-${t}`}function Vf(e){let t=!0;for(const n in e){t=!1;break}return t}var b0;let Qt=(b0=class{constructor(t,n,s){T(this,"id");T(this,"props");T(this,"userData",{});T(this,"_device");T(this,"destroyed",!1);T(this,"allocatedBytes",0);T(this,"_attachedResources",new Set);if(!t)throw new Error("no device");this._device=t,this.props=YN(n,s);const i=this.props.id!=="undefined"?this.props.id:yr(this[Symbol.toStringTag]);this.props.id=i,this.id=i,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}toString(){return`${this[Symbol.toStringTag]||this.constructor.name}(${this.id})`}getProps(){return this.props}attachResource(t){this._attachedResources.add(t)}detachResource(t){this._attachedResources.delete(t)}destroyAttachedResource(t){this._attachedResources.delete(t)&&t.destroy()}destroyAttachedResources(){for(const t of Object.values(this._attachedResources))t.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const t=this._device.statsManager.getStats("Resource Counts"),n=this[Symbol.toStringTag];t.get(`${n}s Active`).decrementCount()}trackAllocatedMemory(t,n=this[Symbol.toStringTag]){const s=this._device.statsManager.getStats("Resource Counts");s.get("GPU Memory").addCount(t),s.get(`${n} Memory`).addCount(t),this.allocatedBytes=t}trackDeallocatedMemory(t=this[Symbol.toStringTag]){const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").subtractCount(this.allocatedBytes),n.get(`${t} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const t=this._device.statsManager.getStats("Resource Counts"),n=this[Symbol.toStringTag];t.get("Resources Created").incrementCount(),t.get(`${n}s Created`).incrementCount(),t.get(`${n}s Active`).incrementCount()}},T(b0,"defaultProps",{id:"undefined",handle:void 0,userData:void 0}),b0);function YN(e,t){const n={...t};for(const s in e)e[s]!==void 0&&(n[s]=e[s]);return n}const $e=class $e extends Qt{constructor(n,s){const i={...s};(s.usage||0)&$e.INDEX&&!s.indexType&&(s.data instanceof Uint32Array?i.indexType="uint32":s.data instanceof Uint16Array&&(i.indexType="uint16"));super(n,i,$e.defaultProps);T(this,"usage");T(this,"indexType");T(this,"updateTimestamp");T(this,"debugData",new ArrayBuffer(0));this.usage=s.usage||0,this.indexType=i.indexType,this.updateTimestamp=n.incrementTimestamp()}get[Symbol.toStringTag](){return"Buffer"}readSyncWebGL(n,s){throw new Error("not implemented")}_setDebugData(n,s,i){const r=ArrayBuffer.isView(n)?n.buffer:n,a=Math.min(n?n.byteLength:i,$e.DEBUG_DATA_MAX_LENGTH);n===null?this.debugData=new ArrayBuffer(a):s===0&&i===n.byteLength?this.debugData=r.slice(0,a):this.debugData=r.slice(s,s+a)}};T($e,"defaultProps",{...Qt.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1}),T($e,"MAP_READ",1),T($e,"MAP_WRITE",2),T($e,"COPY_SRC",4),T($e,"COPY_DST",8),T($e,"INDEX",16),T($e,"VERTEX",32),T($e,"UNIFORM",64),T($e,"STORAGE",128),T($e,"INDIRECT",256),T($e,"QUERY_RESOLVE",512),T($e,"DEBUG_DATA_MAX_LENGTH",32);let fe=$e;function J3(e){const t=YE[e],n=KN(t),s=e.includes("norm"),i=!s&&!e.startsWith("float"),r=e.startsWith("s");return{dataType:YE[e],byteLength:n,integer:i,signed:r,normalized:s}}function KN(e){return JN[e]}const YE={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},JN={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4},ZN=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],QN=/^(rg?b?a?)([0-9]*)([a-z]*)(-srgb)?(-webgl|-unsized)?$/;function tI(e){return ZN.some(t=>e.startsWith(t))}function Z3(e){const t=QN.exec(e);if(t){const[,n,s,i,r,a]=t;if(n){const l=`${i}${s}`,h=J3(l);return{format:n,components:n.length,srgb:r==="-srgb",unsized:a==="-unsized",webgl:a==="-webgl",...h}}}return nI(e)}const eI={"rgba4unorm-webgl":{format:"rgba",bpp:2},"rgb565unorm-webgl":{format:"rgb",bpp:2},"rgb5a1unorm-webgl":{format:"rgba",bbp:2},rgb9e5ufloat:{format:"rgb",bbp:4},rg11b10ufloat:{format:"rgb",bbp:4},rgb10a2unorm:{format:"rgba",bbp:4},"rgb10a2uint-webgl":{format:"rgba",bbp:4},stencil8:{components:1,bpp:1,a:"stencil"},depth16unorm:{components:1,bpp:2,a:"depth"},depth24plus:{components:1,bpp:3,a:"depth"},depth32float:{components:1,bpp:4,a:"depth"},"depth24plus-stencil8":{components:2,bpp:4,a:"depth-stencil"},"depth24unorm-stencil8":{components:2,bpp:4,a:"depth-stencil"},"depth32float-stencil8":{components:2,bpp:4,a:"depth-stencil"}};function nI(e){var n;const t=eI[e];if(!t)throw new Error(`Unknown format ${e}`);return{format:t.format||"",components:t.components||((n=t.format)==null?void 0:n.length)||1,byteLength:t.bpp||1,srgb:!1,unsized:!1}}class sI{}class iI{constructor(t=[],n){T(this,"features");T(this,"disabledFeatures");this.features=new Set(t),this.disabledFeatures=n||{}}*[Symbol.iterator](){yield*this.features}has(t){return!this.disabledFeatures[t]&&this.features.has(t)}}const Nl=class Nl{constructor(t){T(this,"id");T(this,"props");T(this,"userData",{});T(this,"statsManager",Vm);T(this,"_lumaData",{});T(this,"timestamp",0);this.props={...Nl.defaultProps,...t},this.id=this.props.id||yr(this[Symbol.toStringTag].toLowerCase())}get[Symbol.toStringTag](){return"Device"}isTextureFormatCompressed(t){return tI(t)}loseDevice(){return!1}getCanvasContext(){if(!this.canvasContext)throw new Error("Device has no CanvasContext");return this.canvasContext}createTexture(t){return(t instanceof Promise||typeof t=="string")&&(t={data:t}),this._createTexture(t)}createCommandEncoder(t={}){throw new Error("not implemented")}readPixelsToArrayWebGL(t,n){throw new Error("not implemented")}readPixelsToBufferWebGL(t,n){throw new Error("not implemented")}setParametersWebGL(t){throw new Error("not implemented")}getParametersWebGL(t){throw new Error("not implemented")}withParametersWebGL(t,n){throw new Error("not implemented")}clearWebGL(t){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError(t){this.props.onError(t)}_getBufferProps(t){(t instanceof ArrayBuffer||ArrayBuffer.isView(t))&&(t={data:t});const n={...t};return(t.usage||0)&fe.INDEX&&!t.indexType&&(t.data instanceof Uint32Array?n.indexType="uint32":t.data instanceof Uint16Array?n.indexType="uint16":ot.warn("indices buffer content must be of integer type")()),n}};T(Nl,"defaultProps",{id:null,canvas:null,container:null,manageState:!0,width:800,height:600,requestMaxLimits:!0,debug:!!ot.get("debug"),spector:!!(ot.get("spector")||ot.get("spectorjs")),break:[],initalizeFeatures:!0,disabledFeatures:{"compilation-status-async-webgl":!0},gl:null,onError:t=>ot.error(t.message)}),T(Nl,"VERSION",WN);let Fa=Nl;function Ht(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}const nl=new Map,wa=class wa{static registerDevices(t){for(const n of t)Ht(n.type&&n.isSupported&&n.create),nl.set(n.type,n)}static getAvailableDevices(){return Array.from(nl).map(t=>t.type)}static getSupportedDevices(){return Array.from(nl).filter(t=>t.isSupported()).map(t=>t.type)}static setDefaultDeviceProps(t){Object.assign(Fa.defaultProps,t)}static async attachDevice(t){const n=KE(t.devices)||nl;if(t.handle instanceof WebGL2RenderingContext){const s=n.get("webgl");if(s)return await s.attach(t.handle)}if(t.handle===null){const s=n.get("unknown");if(s)return await s.attach(null)}throw new Error("Failed to attach device. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.")}static async createDevice(t={}){var r,a;t={...wa.defaultProps,...t},t.gl&&(t.type="webgl");const n=KE(t.devices)||nl;let s,i;switch(t.type){case"webgpu":if(s=n.get("webgpu"),s)return await s.create(t);break;case"webgl":if(i=n.get("webgl"),i)return await i.create(t);break;case"unknown":const l=n.get("unknown");if(l)return await l.create(t);break;case"best-available":if(s=n.get("webgpu"),(r=s==null?void 0:s.isSupported)!=null&&r.call(s))return await s.create(t);if(i=n.get("webgl"),(a=i==null?void 0:i.isSupported)!=null&&a.call(i))return await i.create(t);break}throw new Error("No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.")}static enforceWebGL2(t=!0){const n=HTMLCanvasElement.prototype;if(!t&&n.originalGetContext){n.getContext=n.originalGetContext,n.originalGetContext=void 0;return}n.originalGetContext=n.getContext,n.getContext=function(s,i){return s==="webgl"||s==="experimental-webgl"?this.originalGetContext("webgl2",i):this.originalGetContext(s,i)}}};T(wa,"defaultProps",{...Fa.defaultProps,type:"best-available",devices:void 0}),T(wa,"stats",Vm),T(wa,"log",ot);let Oa=wa;function KE(e){if(!e||(e==null?void 0:e.length)===0)return null;const t=new Map;for(const n of e)t.set(n.type,n);return t}const rI=Ar()&&typeof document<"u",Nd=()=>rI&&document.readyState==="complete",oI={canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,colorSpace:"srgb",alphaMode:"opaque"};class Hm{constructor(t){T(this,"id");T(this,"props");T(this,"canvas");T(this,"htmlCanvas");T(this,"offscreenCanvas");T(this,"type");T(this,"width",1);T(this,"height",1);T(this,"resizeObserver");T(this,"_canvasSizeInfo",{clientWidth:0,clientHeight:0,devicePixelRatio:1});if(this.props={...oI,...t},t=this.props,!Ar()){this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,this.canvas=null;return}if(t.canvas)typeof t.canvas=="string"?this.canvas=lI(t.canvas):this.canvas=t.canvas;else{const n=uI(t),s=cI((t==null?void 0:t.container)||null);s.insertBefore(n,s.firstChild),this.canvas=n,t!=null&&t.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&t.autoResize&&(this.resizeObserver=new ResizeObserver(n=>{for(const s of n)s.target===this.canvas&&this.update()}),this.resizeObserver.observe(this.canvas))}static get isPageLoaded(){return Nd()}getDevicePixelRatio(t){return typeof OffscreenCanvas<"u"&&this.canvas instanceof OffscreenCanvas||(t=t===void 0?this.props.useDevicePixels:t,!t||t<=0)?1:t===!0?typeof window<"u"&&window.devicePixelRatio||1:t}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":const t=this.getDevicePixelRatio(),n=this.canvas;return n.parentElement?[n.clientWidth*t,n.clientHeight*t]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){const[t,n]=this.getPixelSize();return t/n}cssToDeviceRatio(){try{const[t]=this.getDrawingBufferSize(),{clientWidth:n}=this._canvasSizeInfo;return n?t/n:1}catch{return 1}}cssToDevicePixels(t,n=!0){const s=this.cssToDeviceRatio(),[i,r]=this.getDrawingBufferSize();return hI(t,s,i,r,n)}setDevicePixelRatio(t,n={}){if(!this.htmlCanvas)return;let s="width"in n?n.width:this.htmlCanvas.clientWidth,i="height"in n?n.height:this.htmlCanvas.clientHeight;(!s||!i)&&(ot.log(1,"Canvas clientWidth/clientHeight is 0")(),t=1,s=this.htmlCanvas.width||1,i=this.htmlCanvas.height||1);const r=this._canvasSizeInfo;if(r.clientWidth!==s||r.clientHeight!==i||r.devicePixelRatio!==t){let a=t;const l=Math.floor(s*a),h=Math.floor(i*a);this.htmlCanvas.width=l,this.htmlCanvas.height=h;const[d,g]=this.getDrawingBufferSize();(d!==l||g!==h)&&(a=Math.min(d/s,g/i),this.htmlCanvas.width=Math.floor(s*a),this.htmlCanvas.height=Math.floor(i*a),ot.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=s,this._canvasSizeInfo.clientHeight=i,this._canvasSizeInfo.devicePixelRatio=t}}getDrawingBufferSize(){const t=this.device.gl;if(!t)throw new Error("canvas size");return[t.drawingBufferWidth,t.drawingBufferHeight]}_setAutoCreatedCanvasId(t){var n;((n=this.htmlCanvas)==null?void 0:n.id)==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=t)}}T(Hm,"pageLoaded",aI());function aI(){return Nd()||typeof window>"u"?Promise.resolve():new Promise(e=>{window.addEventListener("load",()=>e())})}function cI(e){if(typeof e=="string"){const t=document.getElementById(e);if(!t&&!Nd())throw new Error(`Accessing '${e}' before page was loaded`);if(!t)throw new Error(`${e} is not an HTML element`);return t}else if(e)return e;return document.body}function lI(e){const t=document.getElementById(e);if(!t&&!Nd())throw new Error(`Accessing '${e}' before page was loaded`);if(!(t instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return t}function uI(e){const{width:t,height:n}=e,s=document.createElement("canvas");return s.id="lumagl-auto-created-canvas",s.width=t||1,s.height=n||1,s.style.width=Number.isFinite(t)?`${t}px`:"100%",s.style.height=Number.isFinite(n)?`${n}px`:"100%",s}function hI(e,t,n,s,i){const r=e,a=JE(r[0],t,n);let l=ZE(r[1],t,s,i),h=JE(r[0]+1,t,n);const d=h===n-1?h:h-1;h=ZE(r[1]+1,t,s,i);let g;return i?(h=h===0?h:h+1,g=l,l=h):g=h===s-1?h:h-1,{x:a,y:l,width:Math.max(d-a+1,1),height:Math.max(g-l+1,1)}}function JE(e,t,n){return Math.min(Math.round(e*t),n-1)}function ZE(e,t,n,s){return s?Math.max(0,n-1-Math.round(e*t)):Math.min(Math.round(e*t),n-1)}const mi=class mi extends Qt{constructor(n,s,i=mi.defaultProps){super(n,s,i);T(this,"dimension");T(this,"format");T(this,"width");T(this,"height");T(this,"depth");T(this,"updateTimestamp");this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.updateTimestamp=n.incrementTimestamp()}get[Symbol.toStringTag](){return"Texture"}};T(mi,"defaultProps",{...Qt.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!0,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,type:void 0,sampler:{},view:void 0}),T(mi,"COPY_SRC",1),T(mi,"COPY_DST",2),T(mi,"TEXTURE_BINDING",4),T(mi,"STORAGE_BINDING",8),T(mi,"RENDER_ATTACHMENT",16);let kn=mi;const gd=class gd extends Qt{get[Symbol.toStringTag](){return"TextureView"}constructor(t,n){super(t,n,gd.defaultProps)}};T(gd,"defaultProps",{...Qt.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0});let Hf=gd;function fI(e,t,n){let s="";const i=t.split(/\r?\n/),r=e.slice().sort((a,l)=>a.lineNum-l.lineNum);switch((n==null?void 0:n.showSourceCode)||"no"){case"all":let a=0;for(let l=1;l<=i.length;l++)for(s+=Q3(i[l-1],l,n);r.length>a&&r[a].lineNum===l;){const h=r[a++];s+=QE(h,i,h.lineNum,{...n,inlineSource:!1})}return s;case"issues":case"no":for(const l of e)s+=QE(l,i,l.lineNum,{inlineSource:(n==null?void 0:n.showSourceCode)!=="no"});return s}}function QE(e,t,n,s){if(s!=null&&s.inlineSource){const i=dI(t,n),r=e.linePos>0?`${" ".repeat(e.linePos+5)}^^^
`:"";return`
${i}${r}${e.type.toUpperCase()}: ${e.message}

`}return s!=null&&s.html?`<div class='luma-compiler-log-error' style="color:red;"><b> ${e.type.toUpperCase()}: ${e.message}</b></div>`:`${e.type.toUpperCase()}: ${e.message}`}function dI(e,t,n){let s="";for(let i=t-2;i<=t;i++){const r=e[i-1];r!==void 0&&(s+=Q3(r,t,n))}return s}function Q3(e,t,n){const s=n!=null&&n.html?pI(e):e;return`${gI(String(t),4)}: ${s}${n!=null&&n.html?"<br/>":`
`}`}function gI(e,t){let n="";for(let s=e.length;s<t;++s)n+=" ";return n+e}function pI(e){return e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function tR(e,t){return{name:_I(e,t),language:"glsl",version:mI(e)}}function _I(e,t="unnamed"){const s=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(e);return s?s[1]:t}function mI(e){let t=100;const n=e.match(/[^\s]+/g);if(n&&n.length>=2&&n[0]==="#version"){const s=parseInt(n[1],10);Number.isFinite(s)&&(t=s)}return t}const pd=class pd extends Qt{constructor(n,s){super(n,{id:AI(s),...s},pd.defaultProps);T(this,"stage");T(this,"source");T(this,"compilationStatus","pending");this.stage=this.props.stage,this.source=this.props.source}get[Symbol.toStringTag](){return"Shader"}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(n=this.props.debug){switch(n){case"never":return;case"errors":if(this.compilationStatus==="success")return;break}const s=await this.getCompilationInfo();this.props.debug==="warnings"&&(s==null?void 0:s.length)===0||this._displayShaderLog(s)}_displayShaderLog(n){var d;if(typeof document>"u"||!(document!=null&&document.createElement))return;const s=tR(this.source).name,i=`${this.stage} ${s}`;let r=fI(n,this.source,{showSourceCode:"all",html:!0});const a=this.getTranslatedSource();a&&(r+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${a}</pre></code>`);const l=document.createElement("Button");l.innerHTML=`
<h1>Shader Compilation Error in ${i}</h1><br /><br />
<code style="user-select:text;"><pre>
${r}
</pre></code>`,l.style.top="10px",l.style.left="10px",l.style.position="absolute",l.style.zIndex="9999",l.style.width="100%",l.style.textAlign="left",document.body.appendChild(l);const h=document.getElementsByClassName("luma-compiler-log-error");(d=h[0])!=null&&d.scrollIntoView&&h[0].scrollIntoView(),l.onclick=()=>{const g=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(g)}}};T(pd,"defaultProps",{...Qt.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debug:"errors"});let jf=pd;function AI(e){return tR(e.source).name||e.id||yr(`unnamed ${e.stage}-shader`)}const _d=class _d extends Qt{get[Symbol.toStringTag](){return"Sampler"}constructor(t,n){super(t,n,_d.defaultProps)}};T(_d,"defaultProps",{...Qt.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"nearest",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1});let $f=_d;const md=class md extends Qt{constructor(n,s={}){super(n,s,md.defaultProps);T(this,"width");T(this,"height");T(this,"colorAttachments",[]);T(this,"depthStencilAttachment",null);this.width=this.props.width,this.height=this.props.height}get[Symbol.toStringTag](){return"Framebuffer"}resize(n){let s=!n;if(n){const[i,r]=Array.isArray(n)?n:[n.width,n.height];s=s||r!==this.height||i!==this.width,this.width=i,this.height=r}s&&(ot.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map(s=>{if(typeof s=="string"){const i=this.createColorTexture(s);return this.attachResource(i),i.view}return s instanceof kn?s.view:s});const n=this.props.depthStencilAttachment;if(n)if(typeof n=="string"){const s=this.createDepthStencilTexture(n);this.attachResource(s),this.depthStencilAttachment=s.view}else n instanceof kn?this.depthStencilAttachment=n.view:this.depthStencilAttachment=n}createColorTexture(n){return this.device.createTexture({id:"color-attachment",usage:kn.RENDER_ATTACHMENT,format:n,width:this.width,height:this.height})}createDepthStencilTexture(n){return this.device.createTexture({id:"depth-stencil-attachment",usage:kn.RENDER_ATTACHMENT,format:n,width:this.width,height:this.height})}resizeAttachments(n,s){for(let i=0;i<this.colorAttachments.length;++i)if(this.colorAttachments[i]){const r=this.device._createTexture({...this.colorAttachments[i].props,width:n,height:s});this.destroyAttachedResource(this.colorAttachments[i]),this.colorAttachments[i]=r.view,this.attachResource(r.view)}if(this.depthStencilAttachment){const i=this.device._createTexture({...this.depthStencilAttachment.props,width:n,height:s});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=i.view,this.attachResource(i)}}};T(md,"defaultProps",{...Qt.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null});let Xf=md;const Ad=class Ad extends Qt{constructor(n,s){super(n,s,Ad.defaultProps);T(this,"shaderLayout");T(this,"bufferLayout");T(this,"linkStatus","pending");T(this,"hash","");this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}get[Symbol.toStringTag](){return"RenderPipeline"}setUniformsWebGL(n){throw new Error("Use uniform blocks")}};T(Ad,"defaultProps",{...Qt.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}});let Ua=Ad;const yd=class yd extends Qt{get[Symbol.toStringTag](){return"RenderPass"}constructor(t,n){super(t,n,yd.defaultProps)}};T(yd,"defaultProps",{...Qt.defaultProps,framebuffer:null,parameters:void 0,clearColor:[0,0,0,0],clearDepth:1,clearStencil:0,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0});let x0=yd;const Td=class Td extends Qt{constructor(n,s){super(n,s,Td.defaultProps);T(this,"hash","")}get[Symbol.toStringTag](){return"ComputePipeline"}};T(Td,"defaultProps",{...Qt.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0});let Gf=Td;const Ed=class Ed extends Qt{get[Symbol.toStringTag](){return"CommandEncoder"}constructor(t,n){super(t,n,Ed.defaultProps)}};T(Ed,"defaultProps",{...Qt.defaultProps,measureExecutionTime:void 0});let N0=Ed;const bd=class bd extends Qt{get[Symbol.toStringTag](){return"CommandBuffer"}constructor(t,n){super(t,n,bd.defaultProps)}};T(bd,"defaultProps",{...Qt.defaultProps});let I0=bd;function yI(e){const[t,n]=EI[e],s=t==="i32"||t==="u32",i=t!=="u32",r=bI[t]*n,a=TI(t,n);return{dataType:t,components:n,defaultVertexFormat:a,byteLength:r,integer:s,signed:i}}function TI(e,t){let n;switch(e){case"f32":n="float32";break;case"i32":n="sint32";break;case"u32":n="uint32";break;case"f16":return t<=2?"float16x2":"float16x4"}return t===1?n:`${n}x${t}`}const EI={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},bI={f32:4,f16:2,i32:4,u32:4};function eR(e){let t;e.endsWith("-webgl")&&(e.replace("-webgl",""),t=!0);const[n,s]=e.split("x"),i=n,r=s?parseInt(s):1,a=J3(i),l={type:i,components:r,byteLength:a.byteLength*r,integer:a.integer,signed:a.signed,normalized:a.normalized};return t&&(l.webglOnly=!0),l}function nR(e,t){const n={};for(const s of e.attributes)n[s.name]=RI(e,t,s.name);return n}function SI(e,t,n=16){const s=nR(e,t),i=new Array(n).fill(null);for(const r of Object.values(s))i[r.location]=r;return i}function RI(e,t,n){const s=vI(e,n),i=CI(t,n);if(!s)return null;const r=yI(s.type),a=(i==null?void 0:i.vertexFormat)||r.defaultVertexFormat,l=eR(a);return{attributeName:(i==null?void 0:i.attributeName)||s.name,bufferName:(i==null?void 0:i.bufferName)||s.name,location:s.location,shaderType:s.type,shaderDataType:r.dataType,shaderComponents:r.components,vertexFormat:a,bufferDataType:l.type,bufferComponents:l.components,normalized:l.normalized,integer:r.integer,stepMode:(i==null?void 0:i.stepMode)||s.stepMode,byteOffset:(i==null?void 0:i.byteOffset)||0,byteStride:(i==null?void 0:i.byteStride)||0}}function vI(e,t){const n=e.attributes.find(s=>s.name===t);return n||ot.warn(`shader layout attribute "${t}" not present in shader`),n||null}function CI(e,t){MI(e);let n=wI(e,t);return n||(n=OI(e,t),n)?n:(ot.warn(`layout for attribute "${t}" not present in buffer layout`),null)}function MI(e){for(const t of e)(t.attributes&&t.format||!t.attributes&&!t.format)&&ot.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function wI(e,t){for(const n of e)if(n.format&&n.name===t)return{attributeName:n.name,bufferName:t,stepMode:n.stepMode,vertexFormat:n.format,byteOffset:0,byteStride:n.byteStride||0};return null}function OI(e,t){var n;for(const s of e){let i=s.byteStride;if(typeof s.byteStride!="number")for(const a of s.attributes||[]){const l=eR(a.format);i+=l.byteLength}const r=(n=s.attributes)==null?void 0:n.find(a=>a.attribute===t);if(r)return{attributeName:r.attribute,bufferName:s.name,stepMode:s.stepMode,vertexFormat:r.format,byteOffset:r.byteOffset,byteStride:i}}return null}function BI(e,t){const n={...e,attributes:e.attributes.map(s=>({...s}))};for(const s of(t==null?void 0:t.attributes)||[]){const i=n.attributes.find(r=>r.name===s.name);i?(i.type=s.type||i.type,i.stepMode=s.stepMode||i.stepMode):ot.warn(`shader layout attribute ${s.name} not present in shader`)}return n}const Sd=class Sd extends Qt{constructor(n,s){super(n,s,Sd.defaultProps);T(this,"maxVertexAttributes");T(this,"attributeInfos");T(this,"indexBuffer",null);T(this,"attributes");this.maxVertexAttributes=n.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null),this.attributeInfos=SI(s.renderPipeline.shaderLayout,s.renderPipeline.bufferLayout,this.maxVertexAttributes)}get[Symbol.toStringTag](){return"VertexArray"}setConstantWebGL(n,s){throw new Error("constant attributes not supported")}};T(Sd,"defaultProps",{...Qt.defaultProps,renderPipeline:null});let D0=Sd;const Rd=class Rd extends Qt{get[Symbol.toStringTag](){return"TransformFeedback"}constructor(t,n){super(t,n,Rd.defaultProps)}};T(Rd,"defaultProps",{...Qt.defaultProps,layout:void 0,buffers:{}});let P0=Rd;const vd=class vd extends Qt{get[Symbol.toStringTag](){return"QuerySet"}constructor(t,n){super(t,n,vd.defaultProps)}};T(vd,"defaultProps",{...Qt.defaultProps,type:void 0,count:void 0});let F0=vd;const xI={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function NI(e){const t=xI[e];return Ht(e),t}function II(e,t){switch(t){case 1:return e;case 2:return e+e%2;default:return e+(4-e%4)%4}}let Rh;function sR(e){return(!Rh||Rh.byteLength<e)&&(Rh=new ArrayBuffer(e)),Rh}function DI(e,t){const n=sR(e.BYTES_PER_ELEMENT*t);return new e(n,0,t)}function PI(e){const{target:t,source:n,start:s=0,count:i=1}=e,r=n.length,a=i*r;let l=0;for(let h=s;l<r;l++)t[h++]=n[l];for(;l<a;)l<a-l?(t.copyWithin(s+l,s,s+l),l*=2):(t.copyWithin(s+l,s,s+a-l),l=a);return e.target}const tb=1024;class FI{constructor(t){T(this,"layout",{});T(this,"byteLength");let n=0;for(const[i,r]of Object.entries(t)){const a=NI(r),{type:l,components:h}=a;n=II(n,h);const d=n;n+=h,this.layout[i]={type:l,size:h,offset:d}}n+=(4-n%4)%4;const s=n*4;this.byteLength=Math.max(s,tb)}getData(t){const n=Math.max(this.byteLength,tb),s=sR(n),i={i32:new Int32Array(s),u32:new Uint32Array(s),f32:new Float32Array(s),f16:new Uint16Array(s)};for(const[r,a]of Object.entries(t)){const l=this.layout[r];if(!l){ot.warn(`Supplied uniform value ${r} not present in uniform block layout`)();continue}const{type:h,size:d,offset:g}=l,_=i[h];if(d===1){if(typeof a!="number"&&typeof a!="boolean"){ot.warn(`Supplied value for single component uniform ${r} is not a number: ${a}`)();continue}_[g]=Number(a)}else{const m=Dl(a);if(!m){ot.warn(`Supplied value for multi component / array uniform ${r} is not a numeric array: ${a}`)();continue}_.set(m,g)}}return new Uint8Array(s)}has(t){return!!this.layout[t]}get(t){return this.layout[t]}}function UI(e,t,n=16){if(e!==t)return!1;const s=Dl(e);if(!s)return!1;const i=Dl(t);if(i&&s.length===i.length){for(let r=0;r<s.length;++r)if(i[r]!==s[r])return!1}return!0}function LI(e){const t=Dl(e);return t?t.slice():e}class kI{constructor(t){T(this,"name");T(this,"uniforms",{});T(this,"modifiedUniforms",{});T(this,"modified",!0);T(this,"bindingLayout",{});T(this,"needsRedraw","initialized");var n;if(this.name=t==null?void 0:t.name,t!=null&&t.name&&(t!=null&&t.shaderLayout)){const s=(n=t==null?void 0:t.shaderLayout.bindings)==null?void 0:n.find(r=>r.type==="uniform"&&r.name===(t==null?void 0:t.name));if(!s)throw new Error(t==null?void 0:t.name);const i=s;for(const r of i.uniforms||[])this.bindingLayout[r.name]=r}}setUniforms(t){for(const[n,s]of Object.entries(t))this._setUniform(n,s),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${n}=${s}`)}setNeedsRedraw(t){this.needsRedraw=this.needsRedraw||t}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(t,n){UI(this.uniforms[t],n)||(this.uniforms[t]=LI(n),this.modifiedUniforms[t]=!0,this.modified=!0)}}class zI{constructor(t){T(this,"uniformBlocks",new Map);T(this,"uniformBufferLayouts",new Map);T(this,"uniformBuffers",new Map);for(const[n,s]of Object.entries(t)){const i=n,r=new FI(s.uniformTypes||{});this.uniformBufferLayouts.set(i,r);const a=new kI({name:n});a.setUniforms(s.defaultUniforms||{}),this.uniformBlocks.set(i,a)}}destroy(){for(const t of this.uniformBuffers.values())t.destroy()}setUniforms(t){for(const[n,s]of Object.entries(t))this.uniformBlocks.get(n).setUniforms(s);this.updateUniformBuffers()}getUniformBufferByteLength(t){return this.uniformBufferLayouts.get(t).byteLength}getUniformBufferData(t){const n=this.uniformBlocks.get(t).getAllUniforms();return this.uniformBufferLayouts.get(t).getData(n)}createUniformBuffer(t,n,s){s&&this.setUniforms(s);const i=this.getUniformBufferByteLength(n),r=t.createBuffer({usage:fe.UNIFORM|fe.COPY_DST,byteLength:i}),a=this.getUniformBufferData(n);return r.write(a),r}getManagedUniformBuffer(t,n){if(!this.uniformBuffers.get(n)){const s=this.getUniformBufferByteLength(n),i=t.createBuffer({usage:fe.UNIFORM|fe.COPY_DST,byteLength:s});this.uniformBuffers.set(n,i)}return this.uniformBuffers.get(n)}updateUniformBuffers(){let t=!1;for(const n of this.uniformBlocks.keys()){const s=this.updateUniformBuffer(n);t||(t=s)}return t&&ot.log(3,`UniformStore.updateUniformBuffers(): ${t}`)(),t}updateUniformBuffer(t){const n=this.uniformBlocks.get(t),s=this.uniformBuffers.get(t);let i=!1;if(s&&n.needsRedraw){i||(i=n.needsRedraw);const r=this.getUniformBufferData(t);this.uniformBuffers.get(t).write(r);const l=this.uniformBlocks.get(t).getAllUniforms();ot.log(4,`Writing to uniform buffer ${String(t)}`,r,l)()}return i}}function iR(e){const t=ArrayBuffer.isView(e)?e.constructor:e;switch(t){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(t.constructor.name)}}function rR(e){switch(e){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(e)}}function VI(e,t,n){if(!t||t>4)throw new Error(`size ${t}`);const s=t;let i=iR(e);if(i==="uint8"&&n&&s===1)return"unorm8-webgl";if(i==="uint8"&&n&&s===3)return"unorm8x3-webgl";if(i==="uint8"||i==="sint8"){if(s===1||s===3)throw new Error(`size: ${t}`);return n&&(i=i.replace("int","norm")),`${i}x${s}`}if(i==="uint16"||i==="sint16"){if(s===1||s===3)throw new Error(`size: ${t}`);return n&&(i=i.replace("int","norm")),`${i}x${s}`}return s===1?i:`${i}x${s}`}function HI(e){return Dl(e)!==null||typeof e=="number"||typeof e=="boolean"}function jm(e){const t={bindings:{},uniforms:{}};return Object.keys(e).forEach(n=>{const s=e[n];HI(s)?t.uniforms[n]=s:t.bindings[n]=s}),t}function jI(e,t,n){const{removedProps:s={},deprecatedProps:i={},replacedProps:r={}}=n;for(const l in s)if(l in t){const d=s[l]?`${e}.${s[l]}`:"N/A";ot.removed(`${e}.${l}`,d)()}for(const l in i)if(l in t){const h=i[l];ot.deprecated(`${e}.${l}`,`${e}.${h}`)()}let a=null;for(const[l,h]of Object.entries(r))l in t&&(ot.deprecated(`${e}.${l}`,`${e}.${h}`)(),a=a||Object.assign({},t),a[h]=t[l],delete a[l]);return a||t}let $I="";async function XI(e,t){return await new Promise((n,s)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>s(new Error(`Could not load image ${e}.`)),i.crossOrigin=(t==null?void 0:t.crossOrigin)||"anonymous",i.src=e.startsWith("http")?e:$I+e}catch(i){s(i)}})}async function oR(e,t){const n=document.getElementsByTagName("head")[0];if(!n)throw new Error("loadScript");const s=document.createElement("script");return s.setAttribute("type","text/javascript"),s.setAttribute("src",e),new Promise((i,r)=>{s.onload=i,s.onerror=a=>r(new Error(`Unable to load script '${e}': ${a}`)),n.appendChild(s)})}function U0(e,t,n){if(e===t)return!0;if(!n||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let s=0;s<e.length;s++)if(!U0(e[s],t[s],n-1))return!1;return!0}if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const s=Object.keys(e),i=Object.keys(t);if(s.length!==i.length)return!1;for(const r of s)if(!t.hasOwnProperty(r)||!U0(e[r],t[r],n-1))return!1;return!0}return!1}function GI(e){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60)}function WI(e){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e)}class qI{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class bi{constructor(){}get isAstNode(){return!0}get astNodeType(){return""}evaluate(t){throw new Error("Cannot evaluate node")}evaluateString(t){return this.evaluate(t).toString()}search(t){}searchBlock(t,n){if(t){n(Wf.instance);for(const s of t)s instanceof Array?this.searchBlock(s,n):s.search(n);n(qf.instance)}}}class Wf extends bi{}Wf.instance=new Wf;class qf extends bi{}qf.instance=new qf;class ue extends bi{constructor(){super()}}class L0 extends ue{constructor(t,n,s,i,r,a){super(),this.calls=new Set,this.name=t,this.args=n,this.returnType=s,this.body=i,this.startLine=r,this.endLine=a}get astNodeType(){return"function"}search(t){this.searchBlock(this.body,t)}}class YI extends ue{constructor(t){super(),this.expression=t}get astNodeType(){return"staticAssert"}search(t){this.expression.search(t)}}class KI extends ue{constructor(t,n){super(),this.condition=t,this.body=n}get astNodeType(){return"while"}search(t){this.condition.search(t),this.searchBlock(this.body,t)}}class JI extends ue{constructor(t){super(),this.body=t}get astNodeType(){return"continuing"}search(t){this.searchBlock(this.body,t)}}class ZI extends ue{constructor(t,n,s,i){super(),this.init=t,this.condition=n,this.increment=s,this.body=i}get astNodeType(){return"for"}search(t){var n,s,i;(n=this.init)===null||n===void 0||n.search(t),(s=this.condition)===null||s===void 0||s.search(t),(i=this.increment)===null||i===void 0||i.search(t),this.searchBlock(this.body,t)}}class Wr extends ue{constructor(t,n,s,i,r){super(),this.name=t,this.type=n,this.storage=s,this.access=i,this.value=r}get astNodeType(){return"var"}search(t){var n;t(this),(n=this.value)===null||n===void 0||n.search(t)}}class aR extends ue{constructor(t,n,s){super(),this.name=t,this.type=n,this.value=s}get astNodeType(){return"override"}search(t){var n;(n=this.value)===null||n===void 0||n.search(t)}}class k0 extends ue{constructor(t,n,s,i,r){super(),this.name=t,this.type=n,this.storage=s,this.access=i,this.value=r}get astNodeType(){return"let"}search(t){var n;t(this),(n=this.value)===null||n===void 0||n.search(t)}}class eb extends ue{constructor(t,n,s,i,r){super(),this.name=t,this.type=n,this.storage=s,this.access=i,this.value=r}get astNodeType(){return"const"}evaluate(t){return this.value.evaluate(t)}search(t){var n;t(this),(n=this.value)===null||n===void 0||n.search(t)}}var La;(function(e){e.increment="++",e.decrement="--"})(La||(La={}));(function(e){function t(n){const s=n;if(s=="parse")throw new Error("Invalid value for IncrementOperator");return e[s]}e.parse=t})(La||(La={}));class QI extends ue{constructor(t,n){super(),this.operator=t,this.variable=n}get astNodeType(){return"increment"}search(t){this.variable.search(t)}}var Pl;(function(e){e.assign="=",e.addAssign="+=",e.subtractAssin="-=",e.multiplyAssign="*=",e.divideAssign="/=",e.moduloAssign="%=",e.andAssign="&=",e.orAssign="|=",e.xorAssign="^=",e.shiftLeftAssign="<<=",e.shiftRightAssign=">>="})(Pl||(Pl={}));(function(e){function t(n){const s=n;if(s=="parse")throw new Error("Invalid value for AssignOperator");return s}e.parse=t})(Pl||(Pl={}));class tD extends ue{constructor(t,n,s){super(),this.operator=t,this.variable=n,this.value=s}get astNodeType(){return"assign"}search(t){this.variable.search(t),this.value.search(t)}}class cR extends ue{constructor(t,n){super(),this.name=t,this.args=n}get astNodeType(){return"call"}search(t){for(const n of this.args)n.search(t);t(this)}}class eD extends ue{constructor(t,n){super(),this.body=t,this.continuing=n}get astNodeType(){return"loop"}}class nD extends ue{constructor(t,n){super(),this.condition=t,this.body=n}get astNodeType(){return"body"}}class sD extends ue{constructor(t,n,s,i){super(),this.condition=t,this.body=n,this.elseif=s,this.else=i}get astNodeType(){return"if"}search(t){this.condition.search(t),this.searchBlock(this.body,t),this.searchBlock(this.elseif,t),this.searchBlock(this.else,t)}}class iD extends ue{constructor(t){super(),this.value=t}get astNodeType(){return"return"}search(t){var n;(n=this.value)===null||n===void 0||n.search(t)}}class rD extends ue{constructor(t){super(),this.name=t}get astNodeType(){return"enable"}}class oD extends ue{constructor(t){super(),this.extensions=t}get astNodeType(){return"requires"}}class aD extends ue{constructor(t,n){super(),this.severity=t,this.rule=n}get astNodeType(){return"diagnostic"}}class lR extends ue{constructor(t,n){super(),this.name=t,this.type=n}get astNodeType(){return"alias"}}class cD extends ue{constructor(){super()}get astNodeType(){return"discard"}}class lD extends ue{constructor(){super()}get astNodeType(){return"break"}}class uD extends ue{constructor(){super()}get astNodeType(){return"continue"}}class ho extends ue{constructor(t){super(),this.name=t}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}}class Gr extends ho{constructor(t,n,s,i){super(t),this.members=n,this.startLine=s,this.endLine=i}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(t){for(let n=0;n<this.members.length;n++)if(this.members[n].name==t)return n;return-1}}class uR extends ho{constructor(t,n,s){super(t),this.format=n,this.access=s}get astNodeType(){return"template"}}class hD extends ho{constructor(t,n,s,i){super(t),this.storage=n,this.type=s,this.access=i}get astNodeType(){return"pointer"}}class hR extends ho{constructor(t,n,s,i){super(t),this.attributes=n,this.format=s,this.count=i}get astNodeType(){return"array"}get isArray(){return!0}}class dl extends ho{constructor(t,n,s){super(t),this.format=n,this.access=s}get astNodeType(){return"sampler"}}class $s extends bi{constructor(){super()}}class fD extends $s{constructor(t){super(),this.value=t}get astNodeType(){return"stringExpr"}toString(){return this.value}evaluateString(){return this.value}}class Ta extends $s{constructor(t,n){super(),this.type=t,this.args=n}get astNodeType(){return"createExpr"}search(t){if(t(this),this.args)for(const n of this.args)n.search(t)}evaluate(t){return this.args[0].evaluate(t)}}class fR extends $s{constructor(t,n){super(),this.name=t,this.args=n}get astNodeType(){return"callExpr"}evaluate(t){switch(this.name){case"abs":return Math.abs(this.args[0].evaluate(t));case"acos":return Math.acos(this.args[0].evaluate(t));case"acosh":return Math.acosh(this.args[0].evaluate(t));case"asin":return Math.asin(this.args[0].evaluate(t));case"asinh":return Math.asinh(this.args[0].evaluate(t));case"atan":return Math.atan(this.args[0].evaluate(t));case"atan2":return Math.atan2(this.args[0].evaluate(t),this.args[1].evaluate(t));case"atanh":return Math.atanh(this.args[0].evaluate(t));case"ceil":return Math.ceil(this.args[0].evaluate(t));case"clamp":return Math.min(Math.max(this.args[0].evaluate(t),this.args[1].evaluate(t)),this.args[2].evaluate(t));case"cos":return Math.cos(this.args[0].evaluate(t));case"degrees":return this.args[0].evaluate(t)*180/Math.PI;case"distance":return Math.sqrt(Math.pow(this.args[0].evaluate(t)-this.args[1].evaluate(t),2));case"dot":case"exp":return Math.exp(this.args[0].evaluate(t));case"exp2":return Math.pow(2,this.args[0].evaluate(t));case"floor":return Math.floor(this.args[0].evaluate(t));case"fma":return this.args[0].evaluate(t)*this.args[1].evaluate(t)+this.args[2].evaluate(t);case"fract":return this.args[0].evaluate(t)-Math.floor(this.args[0].evaluate(t));case"inverseSqrt":return 1/Math.sqrt(this.args[0].evaluate(t));case"log":return Math.log(this.args[0].evaluate(t));case"log2":return Math.log2(this.args[0].evaluate(t));case"max":return Math.max(this.args[0].evaluate(t),this.args[1].evaluate(t));case"min":return Math.min(this.args[0].evaluate(t),this.args[1].evaluate(t));case"mix":return this.args[0].evaluate(t)*(1-this.args[2].evaluate(t))+this.args[1].evaluate(t)*this.args[2].evaluate(t);case"modf":return this.args[0].evaluate(t)-Math.floor(this.args[0].evaluate(t));case"pow":return Math.pow(this.args[0].evaluate(t),this.args[1].evaluate(t));case"radians":return this.args[0].evaluate(t)*Math.PI/180;case"round":return Math.round(this.args[0].evaluate(t));case"sign":return Math.sign(this.args[0].evaluate(t));case"sin":return Math.sin(this.args[0].evaluate(t));case"sinh":return Math.sinh(this.args[0].evaluate(t));case"saturate":return Math.min(Math.max(this.args[0].evaluate(t),0),1);case"smoothstep":return this.args[0].evaluate(t)*this.args[0].evaluate(t)*(3-2*this.args[0].evaluate(t));case"sqrt":return Math.sqrt(this.args[0].evaluate(t));case"step":return this.args[0].evaluate(t)<this.args[1].evaluate(t)?0:1;case"tan":return Math.tan(this.args[0].evaluate(t));case"tanh":return Math.tanh(this.args[0].evaluate(t));case"trunc":return Math.trunc(this.args[0].evaluate(t));default:throw new Error("Non const function: "+this.name)}}search(t){for(const n of this.args)n.search(t);t(this)}}class z0 extends $s{constructor(t){super(),this.name=t}get astNodeType(){return"varExpr"}search(t){t(this),this.postfix&&this.postfix.search(t)}evaluate(t){const n=t.constants.get(this.name);if(!n)throw new Error("Cannot evaluate node");return n.evaluate(t)}}class nb extends $s{constructor(t,n){super(),this.name=t,this.initializer=n}get astNodeType(){return"constExpr"}evaluate(t){var n,s;if(this.initializer instanceof Ta){const i=(n=this.postfix)===null||n===void 0?void 0:n.evaluateString(t),r=(s=this.initializer.type)===null||s===void 0?void 0:s.name,a=t.structs.get(r),l=a==null?void 0:a.getMemberIndex(i);return l!==void 0&&l!=-1?this.initializer.args[l].evaluate(t):this.initializer.evaluate(t)}return this.initializer.evaluate(t)}search(t){this.initializer.search(t)}}class sb extends $s{constructor(t){super(),this.value=t}get astNodeType(){return"literalExpr"}evaluate(){return this.value}}class dD extends $s{constructor(t,n){super(),this.type=t,this.value=n}get astNodeType(){return"bitcastExpr"}search(t){this.value.search(t)}}class ib extends $s{constructor(t){super(),this.contents=t}get astNodeType(){return"groupExpr"}evaluate(t){return this.contents[0].evaluate(t)}search(t){this.searchBlock(this.contents,t)}}class gD extends $s{constructor(t){super(),this.index=t}search(t){this.index.search(t)}}class dR extends $s{constructor(){super()}}class pD extends dR{constructor(t,n){super(),this.operator=t,this.right=n}get astNodeType(){return"unaryOp"}evaluate(t){switch(this.operator){case"+":return this.right.evaluate(t);case"-":return-this.right.evaluate(t);case"!":return this.right.evaluate(t)?0:1;case"~":return~this.right.evaluate(t);default:throw new Error("Unknown unary operator: "+this.operator)}}search(t){this.right.search(t)}}class Os extends dR{constructor(t,n,s){super(),this.operator=t,this.left=n,this.right=s}get astNodeType(){return"binaryOp"}evaluate(t){switch(this.operator){case"+":return this.left.evaluate(t)+this.right.evaluate(t);case"-":return this.left.evaluate(t)-this.right.evaluate(t);case"*":return this.left.evaluate(t)*this.right.evaluate(t);case"/":return this.left.evaluate(t)/this.right.evaluate(t);case"%":return this.left.evaluate(t)%this.right.evaluate(t);case"==":return this.left.evaluate(t)==this.right.evaluate(t)?1:0;case"!=":return this.left.evaluate(t)!=this.right.evaluate(t)?1:0;case"<":return this.left.evaluate(t)<this.right.evaluate(t)?1:0;case">":return this.left.evaluate(t)>this.right.evaluate(t)?1:0;case"<=":return this.left.evaluate(t)<=this.right.evaluate(t)?1:0;case">=":return this.left.evaluate(t)>=this.right.evaluate(t)?1:0;case"&&":return this.left.evaluate(t)&&this.right.evaluate(t)?1:0;case"||":return this.left.evaluate(t)||this.right.evaluate(t)?1:0;default:throw new Error(`Unknown operator ${this.operator}`)}}search(t){this.left.search(t),this.right.search(t)}}class gR extends bi{constructor(){super()}}class _D extends gR{constructor(t,n){super(),this.selector=t,this.body=n}get astNodeType(){return"case"}search(t){this.searchBlock(this.body,t)}}class mD extends gR{constructor(t){super(),this.body=t}get astNodeType(){return"default"}search(t){this.searchBlock(this.body,t)}}class AD extends bi{constructor(t,n,s){super(),this.name=t,this.type=n,this.attributes=s}get astNodeType(){return"argument"}}class yD extends bi{constructor(t,n){super(),this.condition=t,this.body=n}get astNodeType(){return"elseif"}search(t){this.condition.search(t),this.searchBlock(this.body,t)}}class TD extends bi{constructor(t,n,s){super(),this.name=t,this.type=n,this.attributes=s}get astNodeType(){return"member"}}let ED=class extends bi{constructor(t,n){super(),this.name=t,this.value=n}get astNodeType(){return"attribute"}};var j,k;(function(e){e[e.token=0]="token",e[e.keyword=1]="keyword",e[e.reserved=2]="reserved"})(k||(k={}));class z{constructor(t,n,s){this.name=t,this.type=n,this.rule=s}toString(){return this.name}}class B{}j=B;B.none=new z("",k.reserved,"");B.eof=new z("EOF",k.token,"");B.reserved={asm:new z("asm",k.reserved,"asm"),bf16:new z("bf16",k.reserved,"bf16"),do:new z("do",k.reserved,"do"),enum:new z("enum",k.reserved,"enum"),f16:new z("f16",k.reserved,"f16"),f64:new z("f64",k.reserved,"f64"),handle:new z("handle",k.reserved,"handle"),i8:new z("i8",k.reserved,"i8"),i16:new z("i16",k.reserved,"i16"),i64:new z("i64",k.reserved,"i64"),mat:new z("mat",k.reserved,"mat"),premerge:new z("premerge",k.reserved,"premerge"),regardless:new z("regardless",k.reserved,"regardless"),typedef:new z("typedef",k.reserved,"typedef"),u8:new z("u8",k.reserved,"u8"),u16:new z("u16",k.reserved,"u16"),u64:new z("u64",k.reserved,"u64"),unless:new z("unless",k.reserved,"unless"),using:new z("using",k.reserved,"using"),vec:new z("vec",k.reserved,"vec"),void:new z("void",k.reserved,"void")};B.keywords={array:new z("array",k.keyword,"array"),atomic:new z("atomic",k.keyword,"atomic"),bool:new z("bool",k.keyword,"bool"),f32:new z("f32",k.keyword,"f32"),i32:new z("i32",k.keyword,"i32"),mat2x2:new z("mat2x2",k.keyword,"mat2x2"),mat2x3:new z("mat2x3",k.keyword,"mat2x3"),mat2x4:new z("mat2x4",k.keyword,"mat2x4"),mat3x2:new z("mat3x2",k.keyword,"mat3x2"),mat3x3:new z("mat3x3",k.keyword,"mat3x3"),mat3x4:new z("mat3x4",k.keyword,"mat3x4"),mat4x2:new z("mat4x2",k.keyword,"mat4x2"),mat4x3:new z("mat4x3",k.keyword,"mat4x3"),mat4x4:new z("mat4x4",k.keyword,"mat4x4"),ptr:new z("ptr",k.keyword,"ptr"),sampler:new z("sampler",k.keyword,"sampler"),sampler_comparison:new z("sampler_comparison",k.keyword,"sampler_comparison"),struct:new z("struct",k.keyword,"struct"),texture_1d:new z("texture_1d",k.keyword,"texture_1d"),texture_2d:new z("texture_2d",k.keyword,"texture_2d"),texture_2d_array:new z("texture_2d_array",k.keyword,"texture_2d_array"),texture_3d:new z("texture_3d",k.keyword,"texture_3d"),texture_cube:new z("texture_cube",k.keyword,"texture_cube"),texture_cube_array:new z("texture_cube_array",k.keyword,"texture_cube_array"),texture_multisampled_2d:new z("texture_multisampled_2d",k.keyword,"texture_multisampled_2d"),texture_storage_1d:new z("texture_storage_1d",k.keyword,"texture_storage_1d"),texture_storage_2d:new z("texture_storage_2d",k.keyword,"texture_storage_2d"),texture_storage_2d_array:new z("texture_storage_2d_array",k.keyword,"texture_storage_2d_array"),texture_storage_3d:new z("texture_storage_3d",k.keyword,"texture_storage_3d"),texture_depth_2d:new z("texture_depth_2d",k.keyword,"texture_depth_2d"),texture_depth_2d_array:new z("texture_depth_2d_array",k.keyword,"texture_depth_2d_array"),texture_depth_cube:new z("texture_depth_cube",k.keyword,"texture_depth_cube"),texture_depth_cube_array:new z("texture_depth_cube_array",k.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new z("texture_depth_multisampled_2d",k.keyword,"texture_depth_multisampled_2d"),texture_external:new z("texture_external",k.keyword,"texture_external"),u32:new z("u32",k.keyword,"u32"),vec2:new z("vec2",k.keyword,"vec2"),vec3:new z("vec3",k.keyword,"vec3"),vec4:new z("vec4",k.keyword,"vec4"),bitcast:new z("bitcast",k.keyword,"bitcast"),block:new z("block",k.keyword,"block"),break:new z("break",k.keyword,"break"),case:new z("case",k.keyword,"case"),continue:new z("continue",k.keyword,"continue"),continuing:new z("continuing",k.keyword,"continuing"),default:new z("default",k.keyword,"default"),diagnostic:new z("diagnostic",k.keyword,"diagnostic"),discard:new z("discard",k.keyword,"discard"),else:new z("else",k.keyword,"else"),enable:new z("enable",k.keyword,"enable"),fallthrough:new z("fallthrough",k.keyword,"fallthrough"),false:new z("false",k.keyword,"false"),fn:new z("fn",k.keyword,"fn"),for:new z("for",k.keyword,"for"),function:new z("function",k.keyword,"function"),if:new z("if",k.keyword,"if"),let:new z("let",k.keyword,"let"),const:new z("const",k.keyword,"const"),loop:new z("loop",k.keyword,"loop"),while:new z("while",k.keyword,"while"),private:new z("private",k.keyword,"private"),read:new z("read",k.keyword,"read"),read_write:new z("read_write",k.keyword,"read_write"),return:new z("return",k.keyword,"return"),requires:new z("requires",k.keyword,"requires"),storage:new z("storage",k.keyword,"storage"),switch:new z("switch",k.keyword,"switch"),true:new z("true",k.keyword,"true"),alias:new z("alias",k.keyword,"alias"),type:new z("type",k.keyword,"type"),uniform:new z("uniform",k.keyword,"uniform"),var:new z("var",k.keyword,"var"),override:new z("override",k.keyword,"override"),workgroup:new z("workgroup",k.keyword,"workgroup"),write:new z("write",k.keyword,"write"),r8unorm:new z("r8unorm",k.keyword,"r8unorm"),r8snorm:new z("r8snorm",k.keyword,"r8snorm"),r8uint:new z("r8uint",k.keyword,"r8uint"),r8sint:new z("r8sint",k.keyword,"r8sint"),r16uint:new z("r16uint",k.keyword,"r16uint"),r16sint:new z("r16sint",k.keyword,"r16sint"),r16float:new z("r16float",k.keyword,"r16float"),rg8unorm:new z("rg8unorm",k.keyword,"rg8unorm"),rg8snorm:new z("rg8snorm",k.keyword,"rg8snorm"),rg8uint:new z("rg8uint",k.keyword,"rg8uint"),rg8sint:new z("rg8sint",k.keyword,"rg8sint"),r32uint:new z("r32uint",k.keyword,"r32uint"),r32sint:new z("r32sint",k.keyword,"r32sint"),r32float:new z("r32float",k.keyword,"r32float"),rg16uint:new z("rg16uint",k.keyword,"rg16uint"),rg16sint:new z("rg16sint",k.keyword,"rg16sint"),rg16float:new z("rg16float",k.keyword,"rg16float"),rgba8unorm:new z("rgba8unorm",k.keyword,"rgba8unorm"),rgba8unorm_srgb:new z("rgba8unorm_srgb",k.keyword,"rgba8unorm_srgb"),rgba8snorm:new z("rgba8snorm",k.keyword,"rgba8snorm"),rgba8uint:new z("rgba8uint",k.keyword,"rgba8uint"),rgba8sint:new z("rgba8sint",k.keyword,"rgba8sint"),bgra8unorm:new z("bgra8unorm",k.keyword,"bgra8unorm"),bgra8unorm_srgb:new z("bgra8unorm_srgb",k.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new z("rgb10a2unorm",k.keyword,"rgb10a2unorm"),rg11b10float:new z("rg11b10float",k.keyword,"rg11b10float"),rg32uint:new z("rg32uint",k.keyword,"rg32uint"),rg32sint:new z("rg32sint",k.keyword,"rg32sint"),rg32float:new z("rg32float",k.keyword,"rg32float"),rgba16uint:new z("rgba16uint",k.keyword,"rgba16uint"),rgba16sint:new z("rgba16sint",k.keyword,"rgba16sint"),rgba16float:new z("rgba16float",k.keyword,"rgba16float"),rgba32uint:new z("rgba32uint",k.keyword,"rgba32uint"),rgba32sint:new z("rgba32sint",k.keyword,"rgba32sint"),rgba32float:new z("rgba32float",k.keyword,"rgba32float"),static_assert:new z("static_assert",k.keyword,"static_assert")};B.tokens={decimal_float_literal:new z("decimal_float_literal",k.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?f?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+f?)|([0-9]+f)/),hex_float_literal:new z("hex_float_literal",k.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+f?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+f?))/),int_literal:new z("int_literal",k.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new z("uint_literal",k.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),ident:new z("ident",k.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new z("and",k.token,"&"),and_and:new z("and_and",k.token,"&&"),arrow:new z("arrow ",k.token,"->"),attr:new z("attr",k.token,"@"),forward_slash:new z("forward_slash",k.token,"/"),bang:new z("bang",k.token,"!"),bracket_left:new z("bracket_left",k.token,"["),bracket_right:new z("bracket_right",k.token,"]"),brace_left:new z("brace_left",k.token,"{"),brace_right:new z("brace_right",k.token,"}"),colon:new z("colon",k.token,":"),comma:new z("comma",k.token,","),equal:new z("equal",k.token,"="),equal_equal:new z("equal_equal",k.token,"=="),not_equal:new z("not_equal",k.token,"!="),greater_than:new z("greater_than",k.token,">"),greater_than_equal:new z("greater_than_equal",k.token,">="),shift_right:new z("shift_right",k.token,">>"),less_than:new z("less_than",k.token,"<"),less_than_equal:new z("less_than_equal",k.token,"<="),shift_left:new z("shift_left",k.token,"<<"),modulo:new z("modulo",k.token,"%"),minus:new z("minus",k.token,"-"),minus_minus:new z("minus_minus",k.token,"--"),period:new z("period",k.token,"."),plus:new z("plus",k.token,"+"),plus_plus:new z("plus_plus",k.token,"++"),or:new z("or",k.token,"|"),or_or:new z("or_or",k.token,"||"),paren_left:new z("paren_left",k.token,"("),paren_right:new z("paren_right",k.token,")"),semicolon:new z("semicolon",k.token,";"),star:new z("star",k.token,"*"),tilde:new z("tilde",k.token,"~"),underscore:new z("underscore",k.token,"_"),xor:new z("xor",k.token,"^"),plus_equal:new z("plus_equal",k.token,"+="),minus_equal:new z("minus_equal",k.token,"-="),times_equal:new z("times_equal",k.token,"*="),division_equal:new z("division_equal",k.token,"/="),modulo_equal:new z("modulo_equal",k.token,"%="),and_equal:new z("and_equal",k.token,"&="),or_equal:new z("or_equal",k.token,"|="),xor_equal:new z("xor_equal",k.token,"^="),shift_right_equal:new z("shift_right_equal",k.token,">>="),shift_left_equal:new z("shift_left_equal",k.token,"<<=")};B.simpleTokens={"@":j.tokens.attr,"{":j.tokens.brace_left,"}":j.tokens.brace_right,":":j.tokens.colon,",":j.tokens.comma,"(":j.tokens.paren_left,")":j.tokens.paren_right,";":j.tokens.semicolon};B.literalTokens={"&":j.tokens.and,"&&":j.tokens.and_and,"->":j.tokens.arrow,"/":j.tokens.forward_slash,"!":j.tokens.bang,"[":j.tokens.bracket_left,"]":j.tokens.bracket_right,"=":j.tokens.equal,"==":j.tokens.equal_equal,"!=":j.tokens.not_equal,">":j.tokens.greater_than,">=":j.tokens.greater_than_equal,">>":j.tokens.shift_right,"<":j.tokens.less_than,"<=":j.tokens.less_than_equal,"<<":j.tokens.shift_left,"%":j.tokens.modulo,"-":j.tokens.minus,"--":j.tokens.minus_minus,".":j.tokens.period,"+":j.tokens.plus,"++":j.tokens.plus_plus,"|":j.tokens.or,"||":j.tokens.or_or,"*":j.tokens.star,"~":j.tokens.tilde,_:j.tokens.underscore,"^":j.tokens.xor,"+=":j.tokens.plus_equal,"-=":j.tokens.minus_equal,"*=":j.tokens.times_equal,"/=":j.tokens.division_equal,"%=":j.tokens.modulo_equal,"&=":j.tokens.and_equal,"|=":j.tokens.or_equal,"^=":j.tokens.xor_equal,">>=":j.tokens.shift_right_equal,"<<=":j.tokens.shift_left_equal};B.regexTokens={decimal_float_literal:j.tokens.decimal_float_literal,hex_float_literal:j.tokens.hex_float_literal,int_literal:j.tokens.int_literal,uint_literal:j.tokens.uint_literal,ident:j.tokens.ident};B.storage_class=[j.keywords.function,j.keywords.private,j.keywords.workgroup,j.keywords.uniform,j.keywords.storage];B.access_mode=[j.keywords.read,j.keywords.write,j.keywords.read_write];B.sampler_type=[j.keywords.sampler,j.keywords.sampler_comparison];B.sampled_texture_type=[j.keywords.texture_1d,j.keywords.texture_2d,j.keywords.texture_2d_array,j.keywords.texture_3d,j.keywords.texture_cube,j.keywords.texture_cube_array];B.multisampled_texture_type=[j.keywords.texture_multisampled_2d];B.storage_texture_type=[j.keywords.texture_storage_1d,j.keywords.texture_storage_2d,j.keywords.texture_storage_2d_array,j.keywords.texture_storage_3d];B.depth_texture_type=[j.keywords.texture_depth_2d,j.keywords.texture_depth_2d_array,j.keywords.texture_depth_cube,j.keywords.texture_depth_cube_array,j.keywords.texture_depth_multisampled_2d];B.texture_external_type=[j.keywords.texture_external];B.any_texture_type=[...j.sampled_texture_type,...j.multisampled_texture_type,...j.storage_texture_type,...j.depth_texture_type,...j.texture_external_type];B.texel_format=[j.keywords.r8unorm,j.keywords.r8snorm,j.keywords.r8uint,j.keywords.r8sint,j.keywords.r16uint,j.keywords.r16sint,j.keywords.r16float,j.keywords.rg8unorm,j.keywords.rg8snorm,j.keywords.rg8uint,j.keywords.rg8sint,j.keywords.r32uint,j.keywords.r32sint,j.keywords.r32float,j.keywords.rg16uint,j.keywords.rg16sint,j.keywords.rg16float,j.keywords.rgba8unorm,j.keywords.rgba8unorm_srgb,j.keywords.rgba8snorm,j.keywords.rgba8uint,j.keywords.rgba8sint,j.keywords.bgra8unorm,j.keywords.bgra8unorm_srgb,j.keywords.rgb10a2unorm,j.keywords.rg11b10float,j.keywords.rg32uint,j.keywords.rg32sint,j.keywords.rg32float,j.keywords.rgba16uint,j.keywords.rgba16sint,j.keywords.rgba16float,j.keywords.rgba32uint,j.keywords.rgba32sint,j.keywords.rgba32float];B.const_literal=[j.tokens.int_literal,j.tokens.uint_literal,j.tokens.decimal_float_literal,j.tokens.hex_float_literal,j.keywords.true,j.keywords.false];B.literal_or_ident=[j.tokens.ident,j.tokens.int_literal,j.tokens.uint_literal,j.tokens.decimal_float_literal,j.tokens.hex_float_literal];B.element_count_expression=[j.tokens.int_literal,j.tokens.uint_literal,j.tokens.ident];B.template_types=[j.keywords.vec2,j.keywords.vec3,j.keywords.vec4,j.keywords.mat2x2,j.keywords.mat2x3,j.keywords.mat2x4,j.keywords.mat3x2,j.keywords.mat3x3,j.keywords.mat3x4,j.keywords.mat4x2,j.keywords.mat4x3,j.keywords.mat4x4,j.keywords.atomic,j.keywords.bitcast,...j.any_texture_type];B.attribute_name=[j.tokens.ident,j.keywords.block,j.keywords.diagnostic];B.assignment_operators=[j.tokens.equal,j.tokens.plus_equal,j.tokens.minus_equal,j.tokens.times_equal,j.tokens.division_equal,j.tokens.modulo_equal,j.tokens.and_equal,j.tokens.or_equal,j.tokens.xor_equal,j.tokens.shift_right_equal,j.tokens.shift_left_equal];B.increment_operators=[j.tokens.plus_plus,j.tokens.minus_minus];class rb{constructor(t,n,s){this.type=t,this.lexeme=n,this.line=s}toString(){return this.lexeme}isTemplateType(){return B.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==B.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class bD{constructor(t){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=t??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new rb(B.eof,"",this._line)),this._tokens}scanToken(){let t=this._advance();if(t==`
`)return this._line++,!0;if(this._isWhitespace(t))return!0;if(t=="/"){if(this._peekAhead()=="/"){for(;t!=`
`;){if(this._isAtEnd())return!0;t=this._advance()}return this._line++,!0}else if(this._peekAhead()=="*"){this._advance();let a=1;for(;a>0;){if(this._isAtEnd())return!0;if(t=this._advance(),t==`
`)this._line++;else if(t=="*"){if(this._peekAhead()=="/"&&(this._advance(),a--,a==0))return!0}else t=="/"&&this._peekAhead()=="*"&&(this._advance(),a++)}return!0}}const n=B.simpleTokens[t];if(n)return this._addToken(n),!0;let s=B.none;const i=this._isAlpha(t),r=t==="_";if(this._isAlphaNumeric(t)){let a=this._peekAhead();for(;this._isAlphaNumeric(a);)t+=this._advance(),a=this._peekAhead()}if(i){const a=B.keywords[t];if(a)return this._addToken(a),!0}if(i||r)return this._addToken(B.tokens.ident),!0;for(;;){let a=this._findType(t);const l=this._peekAhead();if(t=="-"&&this._tokens.length>0){if(l=="=")return this._current++,t+=l,this._addToken(B.tokens.minus_equal),!0;if(l=="-")return this._current++,t+=l,this._addToken(B.tokens.minus_minus),!0;const h=this._tokens.length-1;if((B.literal_or_ident.indexOf(this._tokens[h].type)!=-1||this._tokens[h].type==B.tokens.paren_right)&&l!=">")return this._addToken(a),!0}if(t==">"&&(l==">"||l=="=")){let h=!1,d=this._tokens.length-1;for(let g=0;g<5&&d>=0&&B.assignment_operators.indexOf(this._tokens[d].type)===-1;++g,--d)if(this._tokens[d].type===B.tokens.less_than){d>0&&this._tokens[d-1].isArrayOrTemplateType()&&(h=!0);break}if(h)return this._addToken(a),!0}if(a===B.none){let h=t,d=0;const g=2;for(let _=0;_<g;++_)if(h+=this._peekAhead(_),a=this._findType(h),a!==B.none){d=_;break}if(a===B.none)return s===B.none?!1:(this._current--,this._addToken(s),!0);t=h,this._current+=d+1}if(s=a,this._isAtEnd())break;t+=this._advance()}return s===B.none?!1:(this._addToken(s),!0)}_findType(t){for(const s in B.regexTokens){const i=B.regexTokens[s];if(this._match(t,i.rule))return i}const n=B.literalTokens[t];return n||B.none}_match(t,n){const s=n.exec(t);return s&&s.index==0&&s[0]==t}_isAtEnd(){return this._current>=this._source.length}_isAlpha(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"}_isAlphaNumeric(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"||t=="_"||t>="0"&&t<="9"}_isWhitespace(t){return t==" "||t=="	"||t=="\r"}_advance(t=0){let n=this._source[this._current];return t=t||0,t++,this._current+=t,n}_peekAhead(t=0){return t=t||0,this._current+t>=this._source.length?"\0":this._source[this._current+t]}_addToken(t){const n=this._source.substring(this._start,this._current);this._tokens.push(new rb(t,n,this._line))}}class SD{constructor(){this._tokens=[],this._current=0,this._currentLine=0,this._context=new qI,this._deferArrayCountEval=[]}parse(t){this._initialize(t),this._deferArrayCountEval.length=0;const n=[];for(;!this._isAtEnd();){const s=this._global_decl_or_directive();if(!s)break;n.push(s)}if(this._deferArrayCountEval.length>0){for(const s of this._deferArrayCountEval){const i=s.arrayType,r=s.countNode;if(r instanceof z0){const l=r.name,h=this._context.constants.get(l);if(h)try{const d=h.evaluate(this._context);i.count=d}catch{}}}this._deferArrayCountEval.length=0}return n}_initialize(t){if(t)if(typeof t=="string"){const n=new bD(t);this._tokens=n.scanTokens()}else this._tokens=t;else this._tokens=[];this._current=0}_error(t,n){return{token:t,message:n,toString:function(){return`${n}`}}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==B.eof}_match(t){if(t instanceof z)return this._check(t)?(this._advance(),!0):!1;for(let n=0,s=t.length;n<s;++n){const i=t[n];if(this._check(i))return this._advance(),!0}return!1}_consume(t,n){if(this._check(t))return this._advance();throw this._error(this._peek(),n)}_check(t){if(this._isAtEnd())return!1;const n=this._peek();if(t instanceof Array){const s=n.type;return t.indexOf(s)!=-1}return n.type==t}_advance(){var t,n;return this._currentLine=(n=(t=this._peek())===null||t===void 0?void 0:t.line)!==null&&n!==void 0?n:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(B.tokens.semicolon)&&!this._isAtEnd(););if(this._match(B.keywords.alias)){const n=this._type_alias();return this._consume(B.tokens.semicolon,"Expected ';'"),n}if(this._match(B.keywords.diagnostic)){const n=this._diagnostic();return this._consume(B.tokens.semicolon,"Expected ';'"),n}if(this._match(B.keywords.requires)){const n=this._requires_directive();return this._consume(B.tokens.semicolon,"Expected ';'"),n}if(this._match(B.keywords.enable)){const n=this._enable_directive();return this._consume(B.tokens.semicolon,"Expected ';'"),n}const t=this._attribute();if(this._check(B.keywords.var)){const n=this._global_variable_decl();return n!=null&&(n.attributes=t),this._consume(B.tokens.semicolon,"Expected ';'."),n}if(this._check(B.keywords.override)){const n=this._override_variable_decl();return n!=null&&(n.attributes=t),this._consume(B.tokens.semicolon,"Expected ';'."),n}if(this._check(B.keywords.let)){const n=this._global_let_decl();return n!=null&&(n.attributes=t),this._consume(B.tokens.semicolon,"Expected ';'."),n}if(this._check(B.keywords.const)){const n=this._global_const_decl();return n!=null&&(n.attributes=t),this._consume(B.tokens.semicolon,"Expected ';'."),n}if(this._check(B.keywords.struct)){const n=this._struct_decl();return n!=null&&(n.attributes=t),n}if(this._check(B.keywords.fn)){const n=this._function_decl();return n!=null&&(n.attributes=t),n}return null}_function_decl(){if(!this._match(B.keywords.fn))return null;const t=this._currentLine,n=this._consume(B.tokens.ident,"Expected function name.").toString();this._consume(B.tokens.paren_left,"Expected '(' for function arguments.");const s=[];if(!this._check(B.tokens.paren_right))do{if(this._check(B.tokens.paren_right))break;const l=this._attribute(),h=this._consume(B.tokens.ident,"Expected argument name.").toString();this._consume(B.tokens.colon,"Expected ':' for argument type.");const d=this._attribute(),g=this._type_decl();g!=null&&(g.attributes=d,s.push(new AD(h,g,l)))}while(this._match(B.tokens.comma));this._consume(B.tokens.paren_right,"Expected ')' after function arguments.");let i=null;if(this._match(B.tokens.arrow)){const l=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=l)}const r=this._compound_statement(),a=this._currentLine;return new L0(n,s,i,r,t,a)}_compound_statement(){const t=[];for(this._consume(B.tokens.brace_left,"Expected '{' for block.");!this._check(B.tokens.brace_right);){const n=this._statement();n!==null&&t.push(n)}return this._consume(B.tokens.brace_right,"Expected '}' for block."),t}_statement(){for(;this._match(B.tokens.semicolon)&&!this._isAtEnd(););if(this._check(B.tokens.attr)&&this._attribute(),this._check(B.keywords.if))return this._if_statement();if(this._check(B.keywords.switch))return this._switch_statement();if(this._check(B.keywords.loop))return this._loop_statement();if(this._check(B.keywords.for))return this._for_statement();if(this._check(B.keywords.while))return this._while_statement();if(this._check(B.keywords.continuing))return this._continuing_statement();if(this._check(B.keywords.static_assert))return this._static_assert_statement();if(this._check(B.tokens.brace_left))return this._compound_statement();let t=null;return this._check(B.keywords.return)?t=this._return_statement():this._check([B.keywords.var,B.keywords.let,B.keywords.const])?t=this._variable_statement():this._match(B.keywords.discard)?t=new cD:this._match(B.keywords.break)?t=new lD:this._match(B.keywords.continue)?t=new uD:t=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement(),t!=null&&this._consume(B.tokens.semicolon,"Expected ';' after statement."),t}_static_assert_statement(){if(!this._match(B.keywords.static_assert))return null;const t=this._optional_paren_expression();return new YI(t)}_while_statement(){if(!this._match(B.keywords.while))return null;const t=this._optional_paren_expression();this._check(B.tokens.attr)&&this._attribute();const n=this._compound_statement();return new KI(t,n)}_continuing_statement(){if(!this._match(B.keywords.continuing))return null;const t=this._compound_statement();return new JI(t)}_for_statement(){if(!this._match(B.keywords.for))return null;this._consume(B.tokens.paren_left,"Expected '('.");const t=this._check(B.tokens.semicolon)?null:this._for_init();this._consume(B.tokens.semicolon,"Expected ';'.");const n=this._check(B.tokens.semicolon)?null:this._short_circuit_or_expression();this._consume(B.tokens.semicolon,"Expected ';'.");const s=this._check(B.tokens.paren_right)?null:this._for_increment();this._consume(B.tokens.paren_right,"Expected ')'."),this._check(B.tokens.attr)&&this._attribute();const i=this._compound_statement();return new ZI(t,n,s,i)}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(B.keywords.var)){const t=this._variable_decl();if(t===null)throw this._error(this._peek(),"Variable declaration expected.");let n=null;return this._match(B.tokens.equal)&&(n=this._short_circuit_or_expression()),new Wr(t.name,t.type,t.storage,t.access,n)}if(this._match(B.keywords.let)){const t=this._consume(B.tokens.ident,"Expected name for let.").toString();let n=null;if(this._match(B.tokens.colon)){const i=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=i)}this._consume(B.tokens.equal,"Expected '=' for let.");const s=this._short_circuit_or_expression();return new k0(t,n,null,null,s)}if(this._match(B.keywords.const)){const t=this._consume(B.tokens.ident,"Expected name for const.").toString();let n=null;if(this._match(B.tokens.colon)){const i=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=i)}this._consume(B.tokens.equal,"Expected '=' for const.");const s=this._short_circuit_or_expression();return new eb(t,n,null,null,s)}return null}_increment_decrement_statement(){const t=this._current,n=this._unary_expression();if(n==null)return null;if(!this._check(B.increment_operators))return this._current=t,null;const s=this._consume(B.increment_operators,"Expected increment operator");return new QI(s.type===B.tokens.plus_plus?La.increment:La.decrement,n)}_assignment_statement(){let t=null;if(this._check(B.tokens.brace_right))return null;let n=this._match(B.tokens.underscore);if(n||(t=this._unary_expression()),!n&&t==null)return null;const s=this._consume(B.assignment_operators,"Expected assignment operator."),i=this._short_circuit_or_expression();return new tD(Pl.parse(s.lexeme),t,i)}_func_call_statement(){if(!this._check(B.tokens.ident))return null;const t=this._current,n=this._consume(B.tokens.ident,"Expected function name."),s=this._argument_expression_list();return s===null?(this._current=t,null):new cR(n.lexeme,s)}_loop_statement(){if(!this._match(B.keywords.loop))return null;this._check(B.tokens.attr)&&this._attribute(),this._consume(B.tokens.brace_left,"Expected '{' for loop.");const t=[];let n=this._statement();for(;n!==null;){if(Array.isArray(n))for(let i of n)t.push(i);else t.push(n);n=this._statement()}let s=null;return this._match(B.keywords.continuing)&&(s=this._compound_statement()),this._consume(B.tokens.brace_right,"Expected '}' for loop."),new eD(t,s)}_switch_statement(){if(!this._match(B.keywords.switch))return null;const t=this._optional_paren_expression();this._check(B.tokens.attr)&&this._attribute(),this._consume(B.tokens.brace_left,"Expected '{' for switch.");const n=this._switch_body();if(n==null||n.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(B.tokens.brace_right,"Expected '}' for switch."),new nD(t,n)}_switch_body(){const t=[];if(this._match(B.keywords.case)){const n=this._case_selectors();this._match(B.tokens.colon),this._check(B.tokens.attr)&&this._attribute(),this._consume(B.tokens.brace_left,"Exected '{' for switch case.");const s=this._case_body();this._consume(B.tokens.brace_right,"Exected '}' for switch case."),t.push(new _D(n,s))}if(this._match(B.keywords.default)){this._match(B.tokens.colon),this._check(B.tokens.attr)&&this._attribute(),this._consume(B.tokens.brace_left,"Exected '{' for switch default.");const n=this._case_body();this._consume(B.tokens.brace_right,"Exected '}' for switch default."),t.push(new mD(n))}if(this._check([B.keywords.default,B.keywords.case])){const n=this._switch_body();t.push(n[0])}return t}_case_selectors(){const t=[this._shift_expression()];for(;this._match(B.tokens.comma);)t.push(this._shift_expression());return t}_case_body(){if(this._match(B.keywords.fallthrough))return this._consume(B.tokens.semicolon,"Expected ';'"),[];let t=this._statement();if(t==null)return[];t instanceof Array||(t=[t]);const n=this._case_body();return n.length==0?t:[...t,n[0]]}_if_statement(){if(!this._match(B.keywords.if))return null;const t=this._optional_paren_expression();this._check(B.tokens.attr)&&this._attribute();const n=this._compound_statement();let s=[];this._match_elseif()&&(this._check(B.tokens.attr)&&this._attribute(),s=this._elseif_statement(s));let i=null;return this._match(B.keywords.else)&&(this._check(B.tokens.attr)&&this._attribute(),i=this._compound_statement()),new sD(t,n,s,i)}_match_elseif(){return this._tokens[this._current].type===B.keywords.else&&this._tokens[this._current+1].type===B.keywords.if?(this._advance(),this._advance(),!0):!1}_elseif_statement(t=[]){const n=this._optional_paren_expression(),s=this._compound_statement();return t.push(new yD(n,s)),this._match_elseif()&&(this._check(B.tokens.attr)&&this._attribute(),this._elseif_statement(t)),t}_return_statement(){if(!this._match(B.keywords.return))return null;const t=this._short_circuit_or_expression();return new iD(t)}_short_circuit_or_expression(){let t=this._short_circuit_and_expr();for(;this._match(B.tokens.or_or);)t=new Os(this._previous().toString(),t,this._short_circuit_and_expr());return t}_short_circuit_and_expr(){let t=this._inclusive_or_expression();for(;this._match(B.tokens.and_and);)t=new Os(this._previous().toString(),t,this._inclusive_or_expression());return t}_inclusive_or_expression(){let t=this._exclusive_or_expression();for(;this._match(B.tokens.or);)t=new Os(this._previous().toString(),t,this._exclusive_or_expression());return t}_exclusive_or_expression(){let t=this._and_expression();for(;this._match(B.tokens.xor);)t=new Os(this._previous().toString(),t,this._and_expression());return t}_and_expression(){let t=this._equality_expression();for(;this._match(B.tokens.and);)t=new Os(this._previous().toString(),t,this._equality_expression());return t}_equality_expression(){const t=this._relational_expression();return this._match([B.tokens.equal_equal,B.tokens.not_equal])?new Os(this._previous().toString(),t,this._relational_expression()):t}_relational_expression(){let t=this._shift_expression();for(;this._match([B.tokens.less_than,B.tokens.greater_than,B.tokens.less_than_equal,B.tokens.greater_than_equal]);)t=new Os(this._previous().toString(),t,this._shift_expression());return t}_shift_expression(){let t=this._additive_expression();for(;this._match([B.tokens.shift_left,B.tokens.shift_right]);)t=new Os(this._previous().toString(),t,this._additive_expression());return t}_additive_expression(){let t=this._multiplicative_expression();for(;this._match([B.tokens.plus,B.tokens.minus]);)t=new Os(this._previous().toString(),t,this._multiplicative_expression());return t}_multiplicative_expression(){let t=this._unary_expression();for(;this._match([B.tokens.star,B.tokens.forward_slash,B.tokens.modulo]);)t=new Os(this._previous().toString(),t,this._unary_expression());return t}_unary_expression(){return this._match([B.tokens.minus,B.tokens.bang,B.tokens.tilde,B.tokens.star,B.tokens.and])?new pD(this._previous().toString(),this._unary_expression()):this._singular_expression()}_singular_expression(){const t=this._primary_expression(),n=this._postfix_expression();return n&&(t.postfix=n),t}_postfix_expression(){if(this._match(B.tokens.bracket_left)){const t=this._short_circuit_or_expression();this._consume(B.tokens.bracket_right,"Expected ']'.");const n=new gD(t),s=this._postfix_expression();return s&&(n.postfix=s),n}if(this._match(B.tokens.period)){const t=this._consume(B.tokens.ident,"Expected member name."),n=this._postfix_expression(),s=new fD(t.lexeme);return n&&(s.postfix=n),s}return null}_getStruct(t){return this._context.aliases.has(t)?this._context.aliases.get(t).type:this._context.structs.has(t)?this._context.structs.get(t):null}_primary_expression(){if(this._match(B.tokens.ident)){const s=this._previous().toString();if(this._check(B.tokens.paren_left)){const i=this._argument_expression_list(),r=this._getStruct(s);return r!=null?new Ta(r,i):new fR(s,i)}if(this._context.constants.has(s)){const i=this._context.constants.get(s);return new nb(s,i.value)}return new z0(s)}if(this._match(B.const_literal))return new sb(parseFloat(this._previous().toString()));if(this._check(B.tokens.paren_left))return this._paren_expression();if(this._match(B.keywords.bitcast)){this._consume(B.tokens.less_than,"Expected '<'.");const s=this._type_decl();this._consume(B.tokens.greater_than,"Expected '>'.");const i=this._paren_expression();return new dD(s,i)}const t=this._type_decl(),n=this._argument_expression_list();return new Ta(t,n)}_argument_expression_list(){if(!this._match(B.tokens.paren_left))return null;const t=[];do{if(this._check(B.tokens.paren_right))break;const n=this._short_circuit_or_expression();t.push(n)}while(this._match(B.tokens.comma));return this._consume(B.tokens.paren_right,"Expected ')' for agument list"),t}_optional_paren_expression(){this._match(B.tokens.paren_left);const t=this._short_circuit_or_expression();return this._match(B.tokens.paren_right),new ib([t])}_paren_expression(){this._consume(B.tokens.paren_left,"Expected '('.");const t=this._short_circuit_or_expression();return this._consume(B.tokens.paren_right,"Expected ')'."),new ib([t])}_struct_decl(){if(!this._match(B.keywords.struct))return null;const t=this._currentLine,n=this._consume(B.tokens.ident,"Expected name for struct.").toString();this._consume(B.tokens.brace_left,"Expected '{' for struct body.");const s=[];for(;!this._check(B.tokens.brace_right);){const a=this._attribute(),l=this._consume(B.tokens.ident,"Expected variable name.").toString();this._consume(B.tokens.colon,"Expected ':' for struct member type.");const h=this._attribute(),d=this._type_decl();d!=null&&(d.attributes=h),this._check(B.tokens.brace_right)?this._match(B.tokens.comma):this._consume(B.tokens.comma,"Expected ',' for struct member."),s.push(new TD(l,d,a))}this._consume(B.tokens.brace_right,"Expected '}' after struct body.");const i=this._currentLine,r=new Gr(n,s,t,i);return this._context.structs.set(n,r),r}_global_variable_decl(){const t=this._variable_decl();return t&&this._match(B.tokens.equal)&&(t.value=this._const_expression()),t}_override_variable_decl(){const t=this._override_decl();return t&&this._match(B.tokens.equal)&&(t.value=this._const_expression()),t}_global_const_decl(){if(!this._match(B.keywords.const))return null;const t=this._consume(B.tokens.ident,"Expected variable name");let n=null;if(this._match(B.tokens.colon)){const r=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=r)}let s=null;if(this._match(B.tokens.equal)){const r=this._short_circuit_or_expression();if(r instanceof Ta)s=r;else if(r instanceof nb&&r.initializer instanceof Ta)s=r.initializer;else try{const a=r.evaluate(this._context);s=new sb(a)}catch{s=r}}const i=new eb(t.toString(),n,"","",s);return this._context.constants.set(i.name,i),i}_global_let_decl(){if(!this._match(B.keywords.let))return null;const t=this._consume(B.tokens.ident,"Expected variable name");let n=null;if(this._match(B.tokens.colon)){const i=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=i)}let s=null;return this._match(B.tokens.equal)&&(s=this._const_expression()),new k0(t.toString(),n,"","",s)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(B.keywords.var))return null;let t="",n="";this._match(B.tokens.less_than)&&(t=this._consume(B.storage_class,"Expected storage_class.").toString(),this._match(B.tokens.comma)&&(n=this._consume(B.access_mode,"Expected access_mode.").toString()),this._consume(B.tokens.greater_than,"Expected '>'."));const s=this._consume(B.tokens.ident,"Expected variable name");let i=null;if(this._match(B.tokens.colon)){const r=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=r)}return new Wr(s.toString(),i,t,n,null)}_override_decl(){if(!this._match(B.keywords.override))return null;const t=this._consume(B.tokens.ident,"Expected variable name");let n=null;if(this._match(B.tokens.colon)){const s=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=s)}return new aR(t.toString(),n,null)}_diagnostic(){this._consume(B.tokens.paren_left,"Expected '('");const t=this._consume(B.tokens.ident,"Expected severity control name.");this._consume(B.tokens.comma,"Expected ','");const n=this._consume(B.tokens.ident,"Expected diagnostic rule name.");return this._consume(B.tokens.paren_right,"Expected ')'"),new aD(t.toString(),n.toString())}_enable_directive(){const t=this._consume(B.tokens.ident,"identity expected.");return new rD(t.toString())}_requires_directive(){const t=[this._consume(B.tokens.ident,"identity expected.").toString()];for(;this._match(B.tokens.comma);){const n=this._consume(B.tokens.ident,"identity expected.");t.push(n.toString())}return new oD(t)}_type_alias(){const t=this._consume(B.tokens.ident,"identity expected.");this._consume(B.tokens.equal,"Expected '=' for type alias.");let n=this._type_decl();if(n===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(n.name)&&(n=this._context.aliases.get(n.name).type);const s=new lR(t.toString(),n);return this._context.aliases.set(s.name,s),s}_type_decl(){if(this._check([B.tokens.ident,...B.texel_format,B.keywords.bool,B.keywords.f32,B.keywords.i32,B.keywords.u32])){const s=this._advance(),i=s.toString();return this._context.structs.has(i)?this._context.structs.get(i):this._context.aliases.has(i)?this._context.aliases.get(i).type:new ho(s.toString())}let t=this._texture_sampler_types();if(t)return t;if(this._check(B.template_types)){let s=this._advance().toString(),i=null,r=null;return this._match(B.tokens.less_than)&&(i=this._type_decl(),r=null,this._match(B.tokens.comma)&&(r=this._consume(B.access_mode,"Expected access_mode for pointer").toString()),this._consume(B.tokens.greater_than,"Expected '>' for type.")),new uR(s,i,r)}if(this._match(B.keywords.ptr)){let s=this._previous().toString();this._consume(B.tokens.less_than,"Expected '<' for pointer.");const i=this._consume(B.storage_class,"Expected storage_class for pointer");this._consume(B.tokens.comma,"Expected ',' for pointer.");const r=this._type_decl();let a=null;return this._match(B.tokens.comma)&&(a=this._consume(B.access_mode,"Expected access_mode for pointer").toString()),this._consume(B.tokens.greater_than,"Expected '>' for pointer."),new hD(s,i.toString(),r,a)}const n=this._attribute();if(this._match(B.keywords.array)){let s=null,i=-1;const r=this._previous();let a=null;if(this._match(B.tokens.less_than)){s=this._type_decl(),this._context.aliases.has(s.name)&&(s=this._context.aliases.get(s.name).type);let h="";if(this._match(B.tokens.comma)){a=this._shift_expression();try{h=a.evaluate(this._context).toString(),a=null}catch{h="1"}}this._consume(B.tokens.greater_than,"Expected '>' for array."),i=h?parseInt(h):0}const l=new hR(r.toString(),n,s,i);return a&&this._deferArrayCountEval.push({arrayType:l,countNode:a}),l}return null}_texture_sampler_types(){if(this._match(B.sampler_type))return new dl(this._previous().toString(),null,null);if(this._match(B.depth_texture_type))return new dl(this._previous().toString(),null,null);if(this._match(B.sampled_texture_type)||this._match(B.multisampled_texture_type)){const t=this._previous();this._consume(B.tokens.less_than,"Expected '<' for sampler type.");const n=this._type_decl();return this._consume(B.tokens.greater_than,"Expected '>' for sampler type."),new dl(t.toString(),n,null)}if(this._match(B.storage_texture_type)){const t=this._previous();this._consume(B.tokens.less_than,"Expected '<' for sampler type.");const n=this._consume(B.texel_format,"Invalid texel format.").toString();this._consume(B.tokens.comma,"Expected ',' after texel format.");const s=this._consume(B.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(B.tokens.greater_than,"Expected '>' for sampler type."),new dl(t.toString(),n,s)}return null}_attribute(){let t=[];for(;this._match(B.tokens.attr);){const n=this._consume(B.attribute_name,"Expected attribute name"),s=new ED(n.toString(),null);if(this._match(B.tokens.paren_left)){if(s.value=this._consume(B.literal_or_ident,"Expected attribute value").toString(),this._check(B.tokens.comma)){this._advance();do{const i=this._consume(B.literal_or_ident,"Expected attribute value").toString();s.value instanceof Array||(s.value=[s.value]),s.value.push(i)}while(this._match(B.tokens.comma))}this._consume(B.tokens.paren_right,"Expected ')'")}t.push(s)}return t.length==0?null:t}}class Ba{constructor(t,n){this.name=t,this.attributes=n,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}}class ob{constructor(t,n,s){this.name=t,this.type=n,this.attributes=s,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray?this.type.format:this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class vh extends Ba{constructor(t,n){super(t,n),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class h_ extends Ba{constructor(t,n){super(t,n),this.count=0,this.stride=0}get isArray(){return!0}}class ab extends Ba{constructor(t,n,s,i){super(t,s),this.format=n,this.access=i}get isTemplate(){return!0}}var rr;(function(e){e[e.Uniform=0]="Uniform",e[e.Storage=1]="Storage",e[e.Texture=2]="Texture",e[e.Sampler=3]="Sampler",e[e.StorageTexture=4]="StorageTexture"})(rr||(rr={}));class Ch{constructor(t,n,s,i,r,a,l){this.name=t,this.type=n,this.group=s,this.binding=i,this.attributes=r,this.resourceType=a,this.access=l}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray?this.type.format:this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class RD{constructor(t,n){this.name=t,this.type=n}}class Mh{constructor(t,n){this.align=t,this.size=n}}class vD{constructor(t,n,s,i){this.name=t,this.type=n,this.locationType=s,this.location=i,this.interpolation=null}}class cb{constructor(t,n,s,i){this.name=t,this.type=n,this.locationType=s,this.location=i}}class CD{constructor(t,n,s,i){this.name=t,this.type=n,this.attributes=s,this.id=i}}class MD{constructor(t,n=null){this.stage=null,this.inputs=[],this.outputs=[],this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=t,this.stage=n}}class wD{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}class OD{constructor(t){this.resources=null,this.inUse=!1,this.info=null,this.node=t}}class Ai{constructor(t){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new wD,this.functions=[],this._types=new Map,this._functions=new Map,t&&this.update(t)}_isStorageTexture(t){return t.name=="texture_storage_1d"||t.name=="texture_storage_2d"||t.name=="texture_storage_2d_array"||t.name=="texture_storage_3d"}update(t){const s=new SD().parse(t);for(const i of s)i instanceof L0&&this._functions.set(i.name,new OD(i));for(const i of s)if(i instanceof Gr){const r=this._getTypeInfo(i,null);r instanceof vh&&this.structs.push(r)}for(const i of s){if(i instanceof lR){this.aliases.push(this._getAliasInfo(i));continue}if(i instanceof aR){const r=i,a=this._getAttributeNum(r.attributes,"id",0),l=r.type!=null?this._getTypeInfo(r.type,r.attributes):null;this.overrides.push(new CD(r.name,l,r.attributes,a));continue}if(this._isUniformVar(i)){const r=i,a=this._getAttributeNum(r.attributes,"group",0),l=this._getAttributeNum(r.attributes,"binding",0),h=this._getTypeInfo(r.type,r.attributes),d=new Ch(r.name,h,a,l,r.attributes,rr.Uniform,r.access);this.uniforms.push(d);continue}if(this._isStorageVar(i)){const r=i,a=this._getAttributeNum(r.attributes,"group",0),l=this._getAttributeNum(r.attributes,"binding",0),h=this._getTypeInfo(r.type,r.attributes),d=this._isStorageTexture(h),g=new Ch(r.name,h,a,l,r.attributes,d?rr.StorageTexture:rr.Storage,r.access);this.storage.push(g);continue}if(this._isTextureVar(i)){const r=i,a=this._getAttributeNum(r.attributes,"group",0),l=this._getAttributeNum(r.attributes,"binding",0),h=this._getTypeInfo(r.type,r.attributes),d=this._isStorageTexture(h),g=new Ch(r.name,h,a,l,r.attributes,d?rr.StorageTexture:rr.Texture,r.access);d?this.storage.push(g):this.textures.push(g);continue}if(this._isSamplerVar(i)){const r=i,a=this._getAttributeNum(r.attributes,"group",0),l=this._getAttributeNum(r.attributes,"binding",0),h=this._getTypeInfo(r.type,r.attributes),d=new Ch(r.name,h,a,l,r.attributes,rr.Sampler,r.access);this.samplers.push(d);continue}if(i instanceof L0){const r=this._getAttribute(i,"vertex"),a=this._getAttribute(i,"fragment"),l=this._getAttribute(i,"compute"),h=r||a||l,d=new MD(i.name,h==null?void 0:h.name);d.startLine=i.startLine,d.endLine=i.endLine,this.functions.push(d),this._functions.get(i.name).info=d,h&&(this._functions.get(i.name).inUse=!0,d.inUse=!0,d.resources=this._findResources(i,!!h),d.inputs=this._getInputs(i.args),d.outputs=this._getOutputs(i.returnType),this.entry[h.name].push(d));continue}}for(const i of this._functions.values())i.info&&(i.info.inUse=i.inUse,this._addCalls(i.node,i.info.calls));for(const i of this._functions.values())i.node.search(r=>{var a;if(r.astNodeType==="varExpr"){const l=r;for(const h of this.overrides)l.name==h.name&&((a=i.info)===null||a===void 0||a.overrides.push(h))}});for(const i of this.uniforms)this._markStructsInUse(i.type);for(const i of this.storage)this._markStructsInUse(i.type)}_markStructsInUse(t){if(t)if(t.isStruct){if(t.inUse=!0,t.members)for(const n of t.members)this._markStructsInUse(n.type)}else if(t.isArray)this._markStructsInUse(t.format);else if(t.isTemplate)t.format&&this._markStructsInUse(t.format);else{const n=this._getAlias(t.name);n&&this._markStructsInUse(n)}}_addCalls(t,n){var s;for(const i of t.calls){const r=(s=this._functions.get(i.name))===null||s===void 0?void 0:s.info;r&&n.add(r)}}findResource(t,n){for(const s of this.uniforms)if(s.group==t&&s.binding==n)return s;for(const s of this.storage)if(s.group==t&&s.binding==n)return s;for(const s of this.textures)if(s.group==t&&s.binding==n)return s;for(const s of this.samplers)if(s.group==t&&s.binding==n)return s;return null}_findResource(t){for(const n of this.uniforms)if(n.name==t)return n;for(const n of this.storage)if(n.name==t)return n;for(const n of this.textures)if(n.name==t)return n;for(const n of this.samplers)if(n.name==t)return n;return null}_markStructsFromAST(t){const n=this._getTypeInfo(t,null);this._markStructsInUse(n)}_findResources(t,n){const s=[],i=this,r=[];return t.search(a=>{if(a instanceof Wf)r.push({});else if(a instanceof qf)r.pop();else if(a instanceof Wr){const l=a;n&&l.type!==null&&this._markStructsFromAST(l.type),r.length>0&&(r[r.length-1][l.name]=l)}else if(a instanceof Ta){const l=a;n&&l.type!==null&&this._markStructsFromAST(l.type)}else if(a instanceof k0){const l=a;n&&l.type!==null&&this._markStructsFromAST(l.type),r.length>0&&(r[r.length-1][l.name]=l)}else if(a instanceof z0){const l=a;if(r.length>0&&r[r.length-1][l.name])return;const h=i._findResource(l.name);h&&s.push(h)}else if(a instanceof fR){const l=a,h=i._functions.get(l.name);h&&(n&&(h.inUse=!0),t.calls.add(h.node),h.resources===null&&(h.resources=i._findResources(h.node,n)),s.push(...h.resources))}else if(a instanceof cR){const l=a,h=i._functions.get(l.name);h&&(n&&(h.inUse=!0),t.calls.add(h.node),h.resources===null&&(h.resources=i._findResources(h.node,n)),s.push(...h.resources))}}),[...new Map(s.map(a=>[a.name,a])).values()]}getBindGroups(){const t=[];function n(s,i){s>=t.length&&(t.length=s+1),t[s]===void 0&&(t[s]=[]),i>=t[s].length&&(t[s].length=i+1)}for(const s of this.uniforms){n(s.group,s.binding);const i=t[s.group];i[s.binding]=s}for(const s of this.storage){n(s.group,s.binding);const i=t[s.group];i[s.binding]=s}for(const s of this.textures){n(s.group,s.binding);const i=t[s.group];i[s.binding]=s}for(const s of this.samplers){n(s.group,s.binding);const i=t[s.group];i[s.binding]=s}return t}_getOutputs(t,n=void 0){if(n===void 0&&(n=[]),t instanceof Gr)this._getStructOutputs(t,n);else{const s=this._getOutputInfo(t);s!==null&&n.push(s)}return n}_getStructOutputs(t,n){for(const s of t.members)if(s.type instanceof Gr)this._getStructOutputs(s.type,n);else{const i=this._getAttribute(s,"location")||this._getAttribute(s,"builtin");if(i!==null){const r=this._getTypeInfo(s.type,s.type.attributes),a=this._parseInt(i.value),l=new cb(s.name,r,i.name,a);n.push(l)}}}_getOutputInfo(t){const n=this._getAttribute(t,"location")||this._getAttribute(t,"builtin");if(n!==null){const s=this._getTypeInfo(t,t.attributes),i=this._parseInt(n.value);return new cb("",s,n.name,i)}return null}_getInputs(t,n=void 0){n===void 0&&(n=[]);for(const s of t)if(s.type instanceof Gr)this._getStructInputs(s.type,n);else{const i=this._getInputInfo(s);i!==null&&n.push(i)}return n}_getStructInputs(t,n){for(const s of t.members)if(s.type instanceof Gr)this._getStructInputs(s.type,n);else{const i=this._getInputInfo(s);i!==null&&n.push(i)}}_getInputInfo(t){const n=this._getAttribute(t,"location")||this._getAttribute(t,"builtin");if(n!==null){const s=this._getAttribute(t,"interpolation"),i=this._getTypeInfo(t.type,t.attributes),r=this._parseInt(n.value),a=new vD(t.name,i,n.name,r);return s!==null&&(a.interpolation=this._parseString(s.value)),a}return null}_parseString(t){return t instanceof Array&&(t=t[0]),t}_parseInt(t){t instanceof Array&&(t=t[0]);const n=parseInt(t);return isNaN(n)?t:n}_getAlias(t){for(const n of this.aliases)if(n.name==t)return n.type;return null}_getAliasInfo(t){return new RD(t.name,this._getTypeInfo(t.type,null))}_getTypeInfo(t,n){if(this._types.has(t))return this._types.get(t);if(t instanceof hR){const i=t,r=i.format?this._getTypeInfo(i.format,i.attributes):null,a=new h_(i.name,n);return a.format=r,a.count=i.count,this._types.set(t,a),this._updateTypeInfo(a),a}if(t instanceof Gr){const i=t,r=new vh(i.name,n);r.startLine=i.startLine,r.endLine=i.endLine;for(const a of i.members){const l=this._getTypeInfo(a.type,a.attributes);r.members.push(new ob(a.name,l,a.attributes))}return this._types.set(t,r),this._updateTypeInfo(r),r}if(t instanceof dl){const i=t,r=i.format instanceof ho,a=i.format?r?this._getTypeInfo(i.format,null):new Ba(i.format,null):null,l=new ab(i.name,a,n,i.access);return this._types.set(t,l),this._updateTypeInfo(l),l}if(t instanceof uR){const i=t,r=i.format?this._getTypeInfo(i.format,null):null,a=new ab(i.name,r,n,i.access);return this._types.set(t,a),this._updateTypeInfo(a),a}const s=new Ba(t.name,n);return this._types.set(t,s),this._updateTypeInfo(s),s}_updateTypeInfo(t){var n,s;const i=this._getTypeSize(t);if(t.size=(n=i==null?void 0:i.size)!==null&&n!==void 0?n:0,t instanceof h_&&t.format){const r=this._getTypeSize(t.format);t.stride=(s=r==null?void 0:r.size)!==null&&s!==void 0?s:0,this._updateTypeInfo(t.format)}t instanceof vh&&this._updateStructInfo(t)}_updateStructInfo(t){var n;let s=0,i=0,r=0,a=0;for(let l=0,h=t.members.length;l<h;++l){const d=t.members[l],g=this._getTypeSize(d);if(!g)continue;(n=this._getAlias(d.type.name))!==null&&n!==void 0||d.type;const _=g.align,m=g.size;s=this._roundUp(_,s+i),i=m,r=s,a=Math.max(a,_),d.offset=s,d.size=m,this._updateTypeInfo(d.type)}t.size=this._roundUp(a,r+i),t.align=a}_getTypeSize(t){var n,s;if(t==null)return null;const i=this._getAttributeNum(t.attributes,"size",0),r=this._getAttributeNum(t.attributes,"align",0);if(t instanceof ob&&(t=t.type),t instanceof Ba){const a=this._getAlias(t.name);a!==null&&(t=a)}{const a=Ai._typeInfo[t.name];if(a!==void 0){const l=((n=t.format)===null||n===void 0?void 0:n.name)==="f16"?2:1;return new Mh(Math.max(r,a.align/l),Math.max(i,a.size/l))}}{const a=Ai._typeInfo[t.name.substring(0,t.name.length-1)];if(a){const l=t.name[t.name.length-1]==="h"?2:1;return new Mh(Math.max(r,a.align/l),Math.max(i,a.size/l))}}if(t instanceof h_){let a=t,l=8,h=8;const d=this._getTypeSize(a.format);d!==null&&(h=d.size,l=d.align);const g=a.count,_=this._getAttributeNum((s=t==null?void 0:t.attributes)!==null&&s!==void 0?s:null,"stride",this._roundUp(l,h));return h=g*_,i&&(h=i),new Mh(Math.max(r,l),Math.max(i,h))}if(t instanceof vh){let a=0,l=0,h=0,d=0,g=0;for(const _ of t.members){const m=this._getTypeSize(_.type);m!==null&&(a=Math.max(m.align,a),h=this._roundUp(m.align,h+d),d=m.size,g=h)}return l=this._roundUp(a,g+d),new Mh(Math.max(r,a),Math.max(i,l))}return null}_isUniformVar(t){return t instanceof Wr&&t.storage=="uniform"}_isStorageVar(t){return t instanceof Wr&&t.storage=="storage"}_isTextureVar(t){return t instanceof Wr&&t.type!==null&&Ai._textureTypes.indexOf(t.type.name)!=-1}_isSamplerVar(t){return t instanceof Wr&&t.type!==null&&Ai._samplerTypes.indexOf(t.type.name)!=-1}_getAttribute(t,n){const s=t;if(!s||!s.attributes)return null;const i=s.attributes;for(let r of i)if(r.name==n)return r;return null}_getAttributeNum(t,n,s){if(t===null)return s;for(let i of t)if(i.name==n){let r=i!==null&&i.value!==null?i.value:s;return r instanceof Array&&(r=r[0]),typeof r=="number"?r:typeof r=="string"?parseInt(r):s}return s}_roundUp(t,n){return Math.ceil(n/t)*t}}Ai._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}};Ai._textureTypes=B.any_texture_type.map(e=>e.name);Ai._samplerTypes=B.sampler_type.map(e=>e.name);function BD(e){var r;const t={attributes:[],bindings:[]};let n;try{n=xD(e)}catch(a){return ot.error(a.message)(),t}for(const a of n.uniforms){const l=[];for(const h of((r=a.type)==null?void 0:r.members)||[])l.push({name:h.name,type:lb(h.type)});t.bindings.push({type:"uniform",name:a.name,location:a.binding,group:a.group,members:l})}const s=n.entry.vertex[0],i=(s==null?void 0:s.inputs.length)||0;for(let a=0;a<i;a++){const l=s.inputs[a];if(l.locationType==="location"){const h=lb(l.type);t.attributes.push({name:l.name,location:Number(l.location),type:h})}}return t}function lb(e){return e.format?`${e.name}<${e.format.name}>`:e.name}function xD(e){try{return new Ai(e)}catch(t){if(t instanceof Error)throw t;let n="WGSL parse error";throw typeof t=="object"&&(t!=null&&t.message)&&(n+=`: ${t.message} `),typeof t=="object"&&(t!=null&&t.token)&&(n+=t.token.line||""),new Error(n,{cause:t})}}const ND=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;
const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;
const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;
const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;
float sin_taylor_fp32(float a) {
float r, s, t, x;
if (a == 0.0) {
return 0.0;
}
x = -a * a;
s = a;
r = a;
r = r * x;
t = r * INVERSE_FACTORIAL_3;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_5;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_7;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_9;
s = s + t;
return s;
}
void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
if (a == 0.0) {
sin_t = 0.0;
cos_t = 1.0;
}
sin_t = sin_taylor_fp32(a);
cos_t = sqrt(1.0 - sin_t * sin_t);
}
float tan_taylor_fp32(float a) {
float sin_a;
float cos_a;
if (a == 0.0) {
return 0.0;
}
float z = floor(a / TWO_PI);
float r = a - TWO_PI * z;
float t;
float q = floor(r / PI_2 + 0.5);
int j = int(q);
if (j < -2 || j > 2) {
return 1.0 / 0.0;
}
t = r - PI_2 * q;
q = floor(t / PI_16 + 0.5);
int k = int(q);
int abs_k = int(abs(float(k)));
if (abs_k > 4) {
return 1.0 / 0.0;
} else {
t = t - PI_16 * q;
}
float u = 0.0;
float v = 0.0;
float sin_t, cos_t;
float s, c;
sincos_taylor_fp32(t, sin_t, cos_t);
if (k == 0) {
s = sin_t;
c = cos_t;
} else {
if (abs(float(abs_k) - 1.0) < 0.5) {
u = COS_TABLE_0;
v = SIN_TABLE_0;
} else if (abs(float(abs_k) - 2.0) < 0.5) {
u = COS_TABLE_1;
v = SIN_TABLE_1;
} else if (abs(float(abs_k) - 3.0) < 0.5) {
u = COS_TABLE_2;
v = SIN_TABLE_2;
} else if (abs(float(abs_k) - 4.0) < 0.5) {
u = COS_TABLE_3;
v = SIN_TABLE_3;
}
if (k > 0) {
s = u * sin_t + v * cos_t;
c = u * cos_t - v * sin_t;
} else {
s = u * sin_t - v * cos_t;
c = u * cos_t + v * sin_t;
}
}
if (j == 0) {
sin_a = s;
cos_a = c;
} else if (j == 1) {
sin_a = c;
cos_a = -s;
} else if (j == -1) {
sin_a = -c;
cos_a = s;
} else {
sin_a = -s;
cos_a = -c;
}
return sin_a / cos_a;
}
#endif
float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
return tan_taylor_fp32(a);
#else
return tan(a);
#endif
}
`,ID={name:"fp32",vs:ND},DD=[0,1,1,1],PD=`uniform pickingUniforms {
float isActive;
float isAttribute;
float isHighlightActive;
float useFloatColors;
vec3 highlightedObjectColor;
vec4 highlightColor;
} picking;
out vec4 picking_vRGBcolor_Avalid;
vec3 picking_normalizeColor(vec3 color) {
return picking.useFloatColors > 0.5 ? color : color / 255.0;
}
vec4 picking_normalizeColor(vec4 color) {
return picking.useFloatColors > 0.5 ? color : color / 255.0;
}
bool picking_isColorZero(vec3 color) {
return dot(color, vec3(1.0)) < 0.00001;
}
bool picking_isColorValid(vec3 color) {
return dot(color, vec3(1.0)) > 0.00001;
}
bool isVertexHighlighted(vec3 vertexColor) {
vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
return
bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}
void picking_setPickingColor(vec3 pickingColor) {
pickingColor = picking_normalizeColor(pickingColor);
if (bool(picking.isActive)) {
picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));
if (!bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rgb = pickingColor;
}
} else {
picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
}
}
void picking_setPickingAttribute(float value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.r = value;
}
}
void picking_setPickingAttribute(vec2 value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rg = value;
}
}
void picking_setPickingAttribute(vec3 value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rgb = value;
}
}
`,FD=`uniform pickingUniforms {
float isActive;
float isAttribute;
float isHighlightActive;
float useFloatColors;
vec3 highlightedObjectColor;
vec4 highlightColor;
} picking;
in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
if (picking.isActive > 0.5) {
return color;
}
bool selected = bool(picking_vRGBcolor_Avalid.a);
if (selected) {
float highLightAlpha = picking.highlightColor.a;
float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
float highLightRatio = highLightAlpha / blendedAlpha;
vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
return vec4(blendedRGB, blendedAlpha);
} else {
return color;
}
}
vec4 picking_filterPickingColor(vec4 color) {
if (bool(picking.isActive)) {
if (picking_vRGBcolor_Avalid.a == 0.0) {
discard;
}
return picking_vRGBcolor_Avalid;
}
return color;
}
vec4 picking_filterColor(vec4 color) {
vec4 highlightColor = picking_filterHighlightColor(color);
return picking_filterPickingColor(highlightColor);
}
`,ub={name:"picking",vs:PD,fs:FD,uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:DD},getUniforms:UD};function UD(e={},t){const n={};if(e.highlightedObjectColor!==void 0)if(e.highlightedObjectColor===null)n.isHighlightActive=!1;else{n.isHighlightActive=!0;const s=e.highlightedObjectColor.slice(0,3);n.highlightedObjectColor=s}if(e.highlightColor){const s=Array.from(e.highlightColor,i=>i/255);Number.isFinite(s[3])||(s[3]=1),n.highlightColor=s}return e.isActive!==void 0&&(n.isActive=!!e.isActive,n.isAttribute=!!e.isAttribute),e.useFloatColors!==void 0&&(n.useFloatColors=!!e.useFloatColors),n}function pR(e,t=[],n=0){const s=Math.fround(e),i=e-s;return t[n]=s,t[n+1]=i,t}function LD(e){return e-Math.fround(e)}function kD(e){const t=new Float32Array(32);for(let n=0;n<4;++n)for(let s=0;s<4;++s){const i=n*4+s;pR(e[s*4+n],t,i*2)}return t}const zD=`uniform float ONE;
vec2 split(float a) {
const float SPLIT = 4097.0;
float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float a_hi = t * ONE - (t - a);
float a_lo = a * ONE - a_hi;
#else
float a_hi = t - (t - a);
float a_lo = a - a_hi;
#endif
return vec2(a_hi, a_lo);
}
vec2 split2(vec2 a) {
vec2 b = split(a.x);
b.y += a.y;
return b;
}
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float sum = (a + b) * ONE;
float err = b - (sum - a) * ONE;
#else
float sum = a + b;
float err = b - (sum - a);
#endif
return vec2(sum, err);
}
vec2 twoSum(float a, float b) {
float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float v = (s * ONE - a) * ONE;
float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);
#else
float v = s - a;
float err = (a - (s - v)) + (b - v);
#endif
return vec2(s, err);
}
vec2 twoSub(float a, float b) {
float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float v = (s * ONE - a) * ONE;
float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);
#else
float v = s - a;
float err = (a - (s - v)) - (b + v);
#endif
return vec2(s, err);
}
vec2 twoSqr(float a) {
float prod = a * a;
vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *
a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;
#else
float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
return vec2(prod, err);
}
vec2 twoProd(float a, float b) {
float prod = a * b;
vec2 a_fp64 = split(a);
vec2 b_fp64 = split(b);
float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
return vec2(prod, err);
}
vec2 sum_fp64(vec2 a, vec2 b) {
vec2 s, t;
s = twoSum(a.x, b.x);
t = twoSum(a.y, b.y);
s.y += t.x;
s = quickTwoSum(s.x, s.y);
s.y += t.y;
s = quickTwoSum(s.x, s.y);
return s;
}
vec2 sub_fp64(vec2 a, vec2 b) {
vec2 s, t;
s = twoSub(a.x, b.x);
t = twoSub(a.y, b.y);
s.y += t.x;
s = quickTwoSum(s.x, s.y);
s.y += t.y;
s = quickTwoSum(s.x, s.y);
return s;
}
vec2 mul_fp64(vec2 a, vec2 b) {
vec2 prod = twoProd(a.x, b.x);
prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
prod = split2(prod);
#endif
prod = quickTwoSum(prod.x, prod.y);
prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
prod = split2(prod);
#endif
prod = quickTwoSum(prod.x, prod.y);
return prod;
}
vec2 div_fp64(vec2 a, vec2 b) {
float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
vec2 yn = a * xn;
#endif
float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
vec2 prod = twoProd(xn, diff);
return sum_fp64(yn, prod);
}
vec2 sqrt_fp64(vec2 a) {
if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);
float x = 1.0 / sqrt(a.x);
float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
vec2 yn_sqr = twoSqr(yn) * ONE;
#else
vec2 yn_sqr = twoSqr(yn);
#endif
float diff = sub_fp64(a, yn_sqr).x;
vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
return sum_fp64(split(yn), prod);
#else
return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`,VD={ONE:1};function HD(){return VD}const jD={name:"fp64-arithmetic",vs:zD,getUniforms:HD,fp64ify:pR,fp64LowPart:LD,fp64ifyMatrix4:kD},$D={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...$D}};const yn=globalThis.mathgl.config;function XD(e,{precision:t=yn.precision}={}){return e=GD(e),`${parseFloat(e.toPrecision(t))}`}function io(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function cr(e,t,n){return qD(e,s=>Math.max(t,Math.min(n,s)))}function Yf(e,t,n){return io(e)?e.map((s,i)=>Yf(s,t[i],n)):n*t+(1-n)*e}function Fl(e,t,n){const s=yn.EPSILON;try{if(e===t)return!0;if(io(e)&&io(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!Fl(e[i],t[i]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<=yn.EPSILON*Math.max(1,Math.abs(e),Math.abs(t)):!1}finally{yn.EPSILON=s}}function GD(e){return Math.round(e/yn.EPSILON)*yn.EPSILON}function WD(e){return e.clone?e.clone():new Array(e.length)}function qD(e,t,n){if(io(e)){const s=e;n=n||WD(s);for(let i=0;i<n.length&&i<s.length;++i){const r=typeof e=="number"?e:e[i];n[i]=t(r,i,n)}return n}return t(e)}let $m=class extends Array{clone(){return new this.constructor().copy(this)}fromArray(t,n=0){for(let s=0;s<this.ELEMENTS;++s)this[s]=t[s+n];return this.check()}toArray(t=[],n=0){for(let s=0;s<this.ELEMENTS;++s)t[n+s]=this[s];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:io(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(yn)}formatString(t){let n="";for(let s=0;s<this.ELEMENTS;++s)n+=(s>0?", ":"")+XD(this[s],t);return`${t.printTypes?this.constructor.name:""}[${n}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Fl(this[n],t[n]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==t[n])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,n,s){if(s===void 0)return this.lerp(this,t,n);for(let i=0;i<this.ELEMENTS;++i){const r=t[i],a=typeof n=="number"?n:n[i];this[i]=r+s*(a-r)}return this.check()}min(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(t[n],this[n]);return this.check()}max(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(t[n],this[n]);return this.check()}clamp(t,n){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t[s]),n[s]);return this.check()}add(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]+=n[s];return this.check()}subtract(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]-=n[s];return this.check()}scale(t){if(typeof t=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;else for(let n=0;n<this.ELEMENTS&&n<t.length;++n)this[n]*=t[n];return this.check()}multiplyByScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;return this.check()}check(){if(yn.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)t=t&&Number.isFinite(this[n]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=t;return this.check()}addScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,n){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t),n);return this.check()}get elements(){return this}};function YD(e,t){if(e.length!==t)return!1;for(let n=0;n<e.length;++n)if(!Number.isFinite(e[n]))return!1;return!0}function ee(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function Ef(e,t,n=""){if(yn.debug&&!YD(e,t))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return e}function hb(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}let _R=class extends $m{get x(){return this[0]}set x(t){this[0]=ee(t)}get y(){return this[1]}set y(t){this[1]=ee(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*this[n];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let n=0;for(let s=0;s<this.ELEMENTS;++s){const i=this[s]-t[s];n+=i*i}return ee(n)}dot(t){let n=0;for(let s=0;s<this.ELEMENTS;++s)n+=this[s]*t[s];return ee(n)}normalize(){const t=this.magnitude();if(t!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=t;return this.check()}multiply(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]*=n[s];return this.check()}divide(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]/=n[s];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return hb(t>=0&&t<this.ELEMENTS,"index is out of range"),ee(this[t])}setComponent(t,n){return hb(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=n,this.check()}addVectors(t,n){return this.copy(t).add(n)}subVectors(t,n){return this.copy(t).subtract(n)}multiplyVectors(t,n){return this.copy(t).multiply(n)}addScaledVector(t,n){return this.add(new this.constructor(t).multiplyScalar(n))}};const El=1e-6;let ps=typeof Float32Array<"u"?Float32Array:Array;function KD(){const e=new ps(2);return ps!=Float32Array&&(e[0]=0,e[1]=0),e}function fb(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function JD(e,t){return e[0]=-t[0],e[1]=-t[1],e}function ZD(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[4]*i+n[12],e[1]=n[1]*s+n[5]*i+n[13],e}(function(){const e=KD();return function(t,n,s,i,r,a){let l,h;for(n||(n=2),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],r(e,e,a),t[l]=e[0],t[l+1]=e[1];return t}})();function QD(e,t,n){const s=t[0],i=t[1],r=n[3]*s+n[7]*i||1;return e[0]=(n[0]*s+n[4]*i)/r,e[1]=(n[1]*s+n[5]*i)/r,e}function mR(e,t,n){const s=t[0],i=t[1],r=t[2],a=n[3]*s+n[7]*i+n[11]*r||1;return e[0]=(n[0]*s+n[4]*i+n[8]*r)/a,e[1]=(n[1]*s+n[5]*i+n[9]*r)/a,e[2]=(n[2]*s+n[6]*i+n[10]*r)/a,e}function tP(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[2]*i,e[1]=n[1]*s+n[3]*i,e[2]=t[2],e}function eP(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[2]*i,e[1]=n[1]*s+n[3]*i,e[2]=t[2],e[3]=t[3],e}function nP(e,t,n){const s=t[0],i=t[1],r=t[2];return e[0]=n[0]*s+n[3]*i+n[6]*r,e[1]=n[1]*s+n[4]*i+n[7]*r,e[2]=n[2]*s+n[5]*i+n[8]*r,e[3]=t[3],e}function AR(){const e=new ps(3);return ps!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function sP(e){const t=e[0],n=e[1],s=e[2];return Math.sqrt(t*t+n*n+s*s)}function db(e,t,n){const s=new ps(3);return s[0]=e,s[1]=t,s[2]=n,s}function iP(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function rP(e,t){const n=t[0],s=t[1],i=t[2];let r=n*n+s*s+i*i;return r>0&&(r=1/Math.sqrt(r)),e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function yR(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function bf(e,t,n){const s=t[0],i=t[1],r=t[2],a=n[0],l=n[1],h=n[2];return e[0]=i*h-r*l,e[1]=r*a-s*h,e[2]=s*l-i*a,e}function Xm(e,t,n){const s=t[0],i=t[1],r=t[2];let a=n[3]*s+n[7]*i+n[11]*r+n[15];return a=a||1,e[0]=(n[0]*s+n[4]*i+n[8]*r+n[12])/a,e[1]=(n[1]*s+n[5]*i+n[9]*r+n[13])/a,e[2]=(n[2]*s+n[6]*i+n[10]*r+n[14])/a,e}function oP(e,t,n){const s=t[0],i=t[1],r=t[2];return e[0]=s*n[0]+i*n[3]+r*n[6],e[1]=s*n[1]+i*n[4]+r*n[7],e[2]=s*n[2]+i*n[5]+r*n[8],e}function TR(e,t,n){const s=n[0],i=n[1],r=n[2],a=n[3],l=t[0],h=t[1],d=t[2];let g=i*d-r*h,_=r*l-s*d,m=s*h-i*l,y=i*m-r*_,E=r*g-s*m,b=s*_-i*g;const R=a*2;return g*=R,_*=R,m*=R,y*=2,E*=2,b*=2,e[0]=l+g+y,e[1]=h+_+E,e[2]=d+m+b,e}function aP(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[0],r[1]=i[1]*Math.cos(s)-i[2]*Math.sin(s),r[2]=i[1]*Math.sin(s)+i[2]*Math.cos(s),e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function cP(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[2]*Math.sin(s)+i[0]*Math.cos(s),r[1]=i[1],r[2]=i[2]*Math.cos(s)-i[0]*Math.sin(s),e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function lP(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[0]*Math.cos(s)-i[1]*Math.sin(s),r[1]=i[0]*Math.sin(s)+i[1]*Math.cos(s),r[2]=i[2],e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function uP(e,t){const n=e[0],s=e[1],i=e[2],r=t[0],a=t[1],l=t[2],h=Math.sqrt((n*n+s*s+i*i)*(r*r+a*a+l*l)),d=h&&yR(e,t)/h;return Math.acos(Math.min(Math.max(d,-1),1))}const hP=iP,fP=sP;(function(){const e=AR();return function(t,n,s,i,r,a){let l,h;for(n||(n=3),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],r(e,e,a),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2];return t}})();const f_=[0,0,0];let wh,Tn=class ER extends _R{static get ZERO(){return wh||(wh=new ER(0,0,0),Object.freeze(wh)),wh}constructor(t=0,n=0,s=0){super(-0,-0,-0),arguments.length===1&&io(t)?this.copy(t):(yn.debug&&(ee(t),ee(n),ee(s)),this[0]=t,this[1]=n,this[2]=s)}set(t,n,s){return this[0]=t,this[1]=n,this[2]=s,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return yn.debug&&(ee(t.x),ee(t.y),ee(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=ee(t)}angle(t){return uP(this,t)}cross(t){return bf(this,this,t),this.check()}rotateX({radians:t,origin:n=f_}){return aP(this,this,n,t),this.check()}rotateY({radians:t,origin:n=f_}){return cP(this,this,n,t),this.check()}rotateZ({radians:t,origin:n=f_}){return lP(this,this,n,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return Xm(this,this,t),this.check()}transformAsVector(t){return mR(this,this,t),this.check()}transformByMatrix3(t){return oP(this,this,t),this.check()}transformByMatrix2(t){return tP(this,this,t),this.check()}transformByQuaternion(t){return TR(this,this,t),this.check()}},Oh,dP=class bR extends _R{static get ZERO(){return Oh||(Oh=new bR(0,0,0,0),Object.freeze(Oh)),Oh}constructor(t=0,n=0,s=0,i=0){super(-0,-0,-0,-0),io(t)&&arguments.length===1?this.copy(t):(yn.debug&&(ee(t),ee(n),ee(s),ee(i)),this[0]=t,this[1]=n,this[2]=s,this[3]=i)}set(t,n,s,i){return this[0]=t,this[1]=n,this[2]=s,this[3]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return yn.debug&&(ee(t.x),ee(t.y),ee(t.z),ee(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=ee(t)}get w(){return this[3]}set w(t){this[3]=ee(t)}transform(t){return Xm(this,this,t),this.check()}transformByMatrix3(t){return nP(this,this,t),this.check()}transformByMatrix2(t){return eP(this,this,t),this.check()}transformByQuaternion(t){return TR(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}},gP=class extends $m{toString(){let t="[";if(yn.printRowMajor){t+="row-major:";for(let n=0;n<this.RANK;++n)for(let s=0;s<this.RANK;++s)t+=` ${this[s*this.RANK+n]}`}else{t+="column-major:";for(let n=0;n<this.ELEMENTS;++n)t+=` ${this[n]}`}return t+="]",t}getElementIndex(t,n){return n*this.RANK+t}getElement(t,n){return this[n*this.RANK+t]}setElement(t,n,s){return this[n*this.RANK+t]=ee(s),this}getColumn(t,n=new Array(this.RANK).fill(-0)){const s=t*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[s+i];return n}setColumn(t,n){const s=t*this.RANK;for(let i=0;i<this.RANK;++i)this[s+i]=n[i];return this}};function pP(){const e=new ps(9);return ps!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function _P(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function mP(e,t){if(e===t){const n=t[1],s=t[2],i=t[3],r=t[6],a=t[7],l=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=s,e[9]=r,e[11]=t[14],e[12]=i,e[13]=a,e[14]=l}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function V0(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=t[4],l=t[5],h=t[6],d=t[7],g=t[8],_=t[9],m=t[10],y=t[11],E=t[12],b=t[13],R=t[14],M=t[15],N=n*l-s*a,O=n*h-i*a,x=n*d-r*a,I=s*h-i*l,P=s*d-r*l,J=i*d-r*h,et=g*b-_*E,q=g*R-m*E,Q=g*M-y*E,rt=_*R-m*b,ct=_*M-y*b,ft=m*M-y*R;let Y=N*ft-O*ct+x*rt+I*Q-P*q+J*et;return Y?(Y=1/Y,e[0]=(l*ft-h*ct+d*rt)*Y,e[1]=(i*ct-s*ft-r*rt)*Y,e[2]=(b*J-R*P+M*I)*Y,e[3]=(m*P-_*J-y*I)*Y,e[4]=(h*Q-a*ft-d*q)*Y,e[5]=(n*ft-i*Q+r*q)*Y,e[6]=(R*x-E*J-M*O)*Y,e[7]=(g*J-m*x+y*O)*Y,e[8]=(a*ct-l*Q+d*et)*Y,e[9]=(s*Q-n*ct-r*et)*Y,e[10]=(E*P-b*x+M*N)*Y,e[11]=(_*x-g*P-y*N)*Y,e[12]=(l*q-a*rt-h*et)*Y,e[13]=(n*rt-s*q+i*et)*Y,e[14]=(b*O-E*I-R*N)*Y,e[15]=(g*I-_*O+m*N)*Y,e):null}function AP(e){const t=e[0],n=e[1],s=e[2],i=e[3],r=e[4],a=e[5],l=e[6],h=e[7],d=e[8],g=e[9],_=e[10],m=e[11],y=e[12],E=e[13],b=e[14],R=e[15],M=t*a-n*r,N=t*l-s*r,O=n*l-s*a,x=d*E-g*y,I=d*b-_*y,P=g*b-_*E,J=t*P-n*I+s*x,et=r*P-a*I+l*x,q=d*O-g*N+_*M,Q=y*O-E*N+b*M;return h*J-i*et+R*q-m*Q}function no(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=t[4],h=t[5],d=t[6],g=t[7],_=t[8],m=t[9],y=t[10],E=t[11],b=t[12],R=t[13],M=t[14],N=t[15];let O=n[0],x=n[1],I=n[2],P=n[3];return e[0]=O*s+x*l+I*_+P*b,e[1]=O*i+x*h+I*m+P*R,e[2]=O*r+x*d+I*y+P*M,e[3]=O*a+x*g+I*E+P*N,O=n[4],x=n[5],I=n[6],P=n[7],e[4]=O*s+x*l+I*_+P*b,e[5]=O*i+x*h+I*m+P*R,e[6]=O*r+x*d+I*y+P*M,e[7]=O*a+x*g+I*E+P*N,O=n[8],x=n[9],I=n[10],P=n[11],e[8]=O*s+x*l+I*_+P*b,e[9]=O*i+x*h+I*m+P*R,e[10]=O*r+x*d+I*y+P*M,e[11]=O*a+x*g+I*E+P*N,O=n[12],x=n[13],I=n[14],P=n[15],e[12]=O*s+x*l+I*_+P*b,e[13]=O*i+x*h+I*m+P*R,e[14]=O*r+x*d+I*y+P*M,e[15]=O*a+x*g+I*E+P*N,e}function SR(e,t,n){const s=n[0],i=n[1],r=n[2];let a,l,h,d,g,_,m,y,E,b,R,M;return t===e?(e[12]=t[0]*s+t[4]*i+t[8]*r+t[12],e[13]=t[1]*s+t[5]*i+t[9]*r+t[13],e[14]=t[2]*s+t[6]*i+t[10]*r+t[14],e[15]=t[3]*s+t[7]*i+t[11]*r+t[15]):(a=t[0],l=t[1],h=t[2],d=t[3],g=t[4],_=t[5],m=t[6],y=t[7],E=t[8],b=t[9],R=t[10],M=t[11],e[0]=a,e[1]=l,e[2]=h,e[3]=d,e[4]=g,e[5]=_,e[6]=m,e[7]=y,e[8]=E,e[9]=b,e[10]=R,e[11]=M,e[12]=a*s+g*i+E*r+t[12],e[13]=l*s+_*i+b*r+t[13],e[14]=h*s+m*i+R*r+t[14],e[15]=d*s+y*i+M*r+t[15]),e}function RR(e,t,n){const s=n[0],i=n[1],r=n[2];return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function yP(e,t,n,s){let i=s[0],r=s[1],a=s[2],l=Math.sqrt(i*i+r*r+a*a),h,d,g,_,m,y,E,b,R,M,N,O,x,I,P,J,et,q,Q,rt,ct,ft,Y,Tt;return l<El?null:(l=1/l,i*=l,r*=l,a*=l,d=Math.sin(n),h=Math.cos(n),g=1-h,_=t[0],m=t[1],y=t[2],E=t[3],b=t[4],R=t[5],M=t[6],N=t[7],O=t[8],x=t[9],I=t[10],P=t[11],J=i*i*g+h,et=r*i*g+a*d,q=a*i*g-r*d,Q=i*r*g-a*d,rt=r*r*g+h,ct=a*r*g+i*d,ft=i*a*g+r*d,Y=r*a*g-i*d,Tt=a*a*g+h,e[0]=_*J+b*et+O*q,e[1]=m*J+R*et+x*q,e[2]=y*J+M*et+I*q,e[3]=E*J+N*et+P*q,e[4]=_*Q+b*rt+O*ct,e[5]=m*Q+R*rt+x*ct,e[6]=y*Q+M*rt+I*ct,e[7]=E*Q+N*rt+P*ct,e[8]=_*ft+b*Y+O*Tt,e[9]=m*ft+R*Y+x*Tt,e[10]=y*ft+M*Y+I*Tt,e[11]=E*ft+N*Y+P*Tt,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function TP(e,t,n){const s=Math.sin(n),i=Math.cos(n),r=t[4],a=t[5],l=t[6],h=t[7],d=t[8],g=t[9],_=t[10],m=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=r*i+d*s,e[5]=a*i+g*s,e[6]=l*i+_*s,e[7]=h*i+m*s,e[8]=d*i-r*s,e[9]=g*i-a*s,e[10]=_*i-l*s,e[11]=m*i-h*s,e}function EP(e,t,n){const s=Math.sin(n),i=Math.cos(n),r=t[0],a=t[1],l=t[2],h=t[3],d=t[8],g=t[9],_=t[10],m=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=r*i-d*s,e[1]=a*i-g*s,e[2]=l*i-_*s,e[3]=h*i-m*s,e[8]=r*s+d*i,e[9]=a*s+g*i,e[10]=l*s+_*i,e[11]=h*s+m*i,e}function bP(e,t,n){const s=Math.sin(n),i=Math.cos(n),r=t[0],a=t[1],l=t[2],h=t[3],d=t[4],g=t[5],_=t[6],m=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=r*i+d*s,e[1]=a*i+g*s,e[2]=l*i+_*s,e[3]=h*i+m*s,e[4]=d*i-r*s,e[5]=g*i-a*s,e[6]=_*i-l*s,e[7]=m*i-h*s,e}function SP(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=n+n,l=s+s,h=i+i,d=n*a,g=s*a,_=s*l,m=i*a,y=i*l,E=i*h,b=r*a,R=r*l,M=r*h;return e[0]=1-_-E,e[1]=g+M,e[2]=m-R,e[3]=0,e[4]=g-M,e[5]=1-d-E,e[6]=y+b,e[7]=0,e[8]=m+R,e[9]=y-b,e[10]=1-d-_,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function RP(e,t,n,s,i,r,a){const l=1/(n-t),h=1/(i-s),d=1/(r-a);return e[0]=r*2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r*2*h,e[6]=0,e[7]=0,e[8]=(n+t)*l,e[9]=(i+s)*h,e[10]=(a+r)*d,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*r*2*d,e[15]=0,e}function vP(e,t,n,s,i){const r=1/Math.tan(t/2);if(e[0]=r/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0){const a=1/(s-i);e[10]=(i+s)*a,e[14]=2*i*s*a}else e[10]=-1,e[14]=-2*s;return e}const CP=vP;function MP(e,t,n,s,i,r,a){const l=1/(t-n),h=1/(s-i),d=1/(r-a);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*h,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*d,e[11]=0,e[12]=(t+n)*l,e[13]=(i+s)*h,e[14]=(a+r)*d,e[15]=1,e}const wP=MP;function OP(e,t,n,s){let i,r,a,l,h,d,g,_,m,y;const E=t[0],b=t[1],R=t[2],M=s[0],N=s[1],O=s[2],x=n[0],I=n[1],P=n[2];return Math.abs(E-x)<El&&Math.abs(b-I)<El&&Math.abs(R-P)<El?_P(e):(_=E-x,m=b-I,y=R-P,i=1/Math.sqrt(_*_+m*m+y*y),_*=i,m*=i,y*=i,r=N*y-O*m,a=O*_-M*y,l=M*m-N*_,i=Math.sqrt(r*r+a*a+l*l),i?(i=1/i,r*=i,a*=i,l*=i):(r=0,a=0,l=0),h=m*l-y*a,d=y*r-_*l,g=_*a-m*r,i=Math.sqrt(h*h+d*d+g*g),i?(i=1/i,h*=i,d*=i,g*=i):(h=0,d=0,g=0),e[0]=r,e[1]=h,e[2]=_,e[3]=0,e[4]=a,e[5]=d,e[6]=m,e[7]=0,e[8]=l,e[9]=g,e[10]=y,e[11]=0,e[12]=-(r*E+a*b+l*R),e[13]=-(h*E+d*b+g*R),e[14]=-(_*E+m*b+y*R),e[15]=1,e)}function BP(){const e=new ps(4);return ps!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function xP(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function NP(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function IP(e){const t=e[0],n=e[1],s=e[2],i=e[3];return Math.sqrt(t*t+n*n+s*s+i*i)}function DP(e){const t=e[0],n=e[1],s=e[2],i=e[3];return t*t+n*n+s*s+i*i}function PP(e,t){const n=t[0],s=t[1],i=t[2],r=t[3];let a=n*n+s*s+i*i+r*r;return a>0&&(a=1/Math.sqrt(a)),e[0]=n*a,e[1]=s*a,e[2]=i*a,e[3]=r*a,e}function FP(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function UP(e,t,n,s){const i=t[0],r=t[1],a=t[2],l=t[3];return e[0]=i+s*(n[0]-i),e[1]=r+s*(n[1]-r),e[2]=a+s*(n[2]-a),e[3]=l+s*(n[3]-l),e}function Id(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3];return e[0]=n[0]*s+n[4]*i+n[8]*r+n[12]*a,e[1]=n[1]*s+n[5]*i+n[9]*r+n[13]*a,e[2]=n[2]*s+n[6]*i+n[10]*r+n[14]*a,e[3]=n[3]*s+n[7]*i+n[11]*r+n[15]*a,e}function LP(e,t,n){const s=t[0],i=t[1],r=t[2],a=n[0],l=n[1],h=n[2],d=n[3],g=d*s+l*r-h*i,_=d*i+h*s-a*r,m=d*r+a*i-l*s,y=-a*s-l*i-h*r;return e[0]=g*d+y*-a+_*-h-m*-l,e[1]=_*d+y*-l+m*-a-g*-h,e[2]=m*d+y*-h+g*-l-_*-a,e[3]=t[3],e}(function(){const e=BP();return function(t,n,s,i,r,a){let l,h;for(n||(n=4),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],e[3]=t[l+3],r(e,e,a),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2],t[l+3]=e[3];return t}})();var H0;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"})(H0||(H0={}));const kP=45*Math.PI/180,zP=1,d_=.1,g_=500,VP=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);let nn=class extends gP{static get IDENTITY(){return jP()}static get ZERO(){return HP()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return H0}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,n,s,i,r,a,l,h,d,g,_,m,y,E,b,R){return this[0]=t,this[1]=n,this[2]=s,this[3]=i,this[4]=r,this[5]=a,this[6]=l,this[7]=h,this[8]=d,this[9]=g,this[10]=_,this[11]=m,this[12]=y,this[13]=E,this[14]=b,this[15]=R,this.check()}setRowMajor(t,n,s,i,r,a,l,h,d,g,_,m,y,E,b,R){return this[0]=t,this[1]=r,this[2]=d,this[3]=y,this[4]=n,this[5]=a,this[6]=g,this[7]=E,this[8]=s,this[9]=l,this[10]=_,this[11]=b,this[12]=i,this[13]=h,this[14]=m,this[15]=R,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(VP)}fromObject(t){return this.check()}fromQuaternion(t){return SP(this,t),this.check()}frustum(t){const{left:n,right:s,bottom:i,top:r,near:a=d_,far:l=g_}=t;return l===1/0?$P(this,n,s,i,r,a):RP(this,n,s,i,r,a,l),this.check()}lookAt(t){const{eye:n,center:s=[0,0,0],up:i=[0,1,0]}=t;return OP(this,n,s,i),this.check()}ortho(t){const{left:n,right:s,bottom:i,top:r,near:a=d_,far:l=g_}=t;return wP(this,n,s,i,r,a,l),this.check()}orthographic(t){const{fovy:n=kP,aspect:s=zP,focalDistance:i=1,near:r=d_,far:a=g_}=t;gb(n);const l=n/2,h=i*Math.tan(l),d=h*s;return this.ortho({left:-d,right:d,bottom:-h,top:h,near:r,far:a})}perspective(t){const{fovy:n=45*Math.PI/180,aspect:s=1,near:i=.1,far:r=500}=t;return gb(n),CP(this,n,s,i,r),this.check()}determinant(){return AP(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,n){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const s=this.getScale(n),i=1/s[0],r=1/s[1],a=1/s[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*a,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*r,t[6]=this[6]*a,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*r,t[10]=this[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,n){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const s=this.getScale(n),i=1/s[0],r=1/s[1],a=1/s[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*a,t[3]=this[4]*i,t[4]=this[5]*r,t[5]=this[6]*a,t[6]=this[8]*i,t[7]=this[9]*r,t[8]=this[10]*a,t}transpose(){return mP(this,this),this.check()}invert(){return V0(this,this),this.check()}multiplyLeft(t){return no(this,t,this),this.check()}multiplyRight(t){return no(this,this,t),this.check()}rotateX(t){return TP(this,this,t),this.check()}rotateY(t){return EP(this,this,t),this.check()}rotateZ(t){return bP(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,n){return yP(this,this,t,n),this.check()}scale(t){return RR(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return SR(this,this,t),this.check()}transform(t,n){return t.length===4?(n=Id(n||[-0,-0,-0,-0],t,this),Ef(n,4),n):this.transformAsPoint(t,n)}transformAsPoint(t,n){const{length:s}=t;let i;switch(s){case 2:i=ZD(n||[-0,-0],t,this);break;case 3:i=Xm(n||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Ef(i,t.length),i}transformAsVector(t,n){let s;switch(t.length){case 2:s=QD(n||[-0,-0],t,this);break;case 3:s=mR(n||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Ef(s,t.length),s}transformPoint(t,n){return this.transformAsPoint(t,n)}transformVector(t,n){return this.transformAsPoint(t,n)}transformDirection(t,n){return this.transformAsVector(t,n)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,n,s){return this.identity().translate([t,n,s])}},Bh,xh;function HP(){return Bh||(Bh=new nn([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Bh)),Bh}function jP(){return xh||(xh=new nn,Object.freeze(xh)),xh}function gb(e){if(e>Math.PI*2)throw Error("expected radians")}function $P(e,t,n,s,i,r){const a=2*r/(n-t),l=2*r/(i-s),h=(n+t)/(n-t),d=(i+s)/(i-s),g=-1,_=-1,m=-2*r;return e[0]=a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=h,e[9]=d,e[10]=g,e[11]=_,e[12]=0,e[13]=0,e[14]=m,e[15]=0,e}function pb(){const e=new ps(4);return ps!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function XP(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function vR(e,t,n){n=n*.5;const s=Math.sin(n);return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=Math.cos(n),e}function _b(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=n[0],h=n[1],d=n[2],g=n[3];return e[0]=s*g+a*l+i*d-r*h,e[1]=i*g+a*h+r*l-s*d,e[2]=r*g+a*d+s*h-i*l,e[3]=a*g-s*l-i*h-r*d,e}function GP(e,t,n){n*=.5;const s=t[0],i=t[1],r=t[2],a=t[3],l=Math.sin(n),h=Math.cos(n);return e[0]=s*h+a*l,e[1]=i*h+r*l,e[2]=r*h-i*l,e[3]=a*h-s*l,e}function WP(e,t,n){n*=.5;const s=t[0],i=t[1],r=t[2],a=t[3],l=Math.sin(n),h=Math.cos(n);return e[0]=s*h-r*l,e[1]=i*h+a*l,e[2]=r*h+s*l,e[3]=a*h-i*l,e}function qP(e,t,n){n*=.5;const s=t[0],i=t[1],r=t[2],a=t[3],l=Math.sin(n),h=Math.cos(n);return e[0]=s*h+i*l,e[1]=i*h-s*l,e[2]=r*h+a*l,e[3]=a*h-r*l,e}function YP(e,t){const n=t[0],s=t[1],i=t[2];return e[0]=n,e[1]=s,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-s*s-i*i)),e}function Sf(e,t,n,s){const i=t[0],r=t[1],a=t[2],l=t[3];let h=n[0],d=n[1],g=n[2],_=n[3],m,y,E,b,R;return m=i*h+r*d+a*g+l*_,m<0&&(m=-m,h=-h,d=-d,g=-g,_=-_),1-m>El?(y=Math.acos(m),R=Math.sin(y),E=Math.sin((1-s)*y)/R,b=Math.sin(s*y)/R):(E=1-s,b=s),e[0]=E*i+b*h,e[1]=E*r+b*d,e[2]=E*a+b*g,e[3]=E*l+b*_,e}function KP(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=n*n+s*s+i*i+r*r,l=a?1/a:0;return e[0]=-n*l,e[1]=-s*l,e[2]=-i*l,e[3]=r*l,e}function JP(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function CR(e,t){const n=t[0]+t[4]+t[8];let s;if(n>0)s=Math.sqrt(n+1),e[3]=.5*s,s=.5/s,e[0]=(t[5]-t[7])*s,e[1]=(t[6]-t[2])*s,e[2]=(t[1]-t[3])*s;else{let i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);const r=(i+1)%3,a=(i+2)%3;s=Math.sqrt(t[i*3+i]-t[r*3+r]-t[a*3+a]+1),e[i]=.5*s,s=.5/s,e[3]=(t[r*3+a]-t[a*3+r])*s,e[r]=(t[r*3+i]+t[i*3+r])*s,e[a]=(t[a*3+i]+t[i*3+a])*s}return e}const ZP=xP,QP=NP,tF=FP,eF=UP,nF=IP,sF=DP,MR=PP,iF=function(){const e=AR(),t=db(1,0,0),n=db(0,1,0);return function(s,i,r){const a=yR(i,r);return a<-.999999?(bf(e,t,i),fP(e)<1e-6&&bf(e,n,i),rP(e,e),vR(s,e,Math.PI),s):a>.999999?(s[0]=0,s[1]=0,s[2]=0,s[3]=1,s):(bf(e,i,r),s[0]=e[0],s[1]=e[1],s[2]=e[2],s[3]=1+a,MR(s,s))}}();(function(){const e=pb(),t=pb();return function(n,s,i,r,a,l){return Sf(e,s,a,l),Sf(t,i,r,l),Sf(n,e,t,2*l*(1-l)),n}})();(function(){const e=pP();return function(t,n,s,i){return e[0]=s[0],e[3]=s[1],e[6]=s[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],MR(t,CR(t,e))}})();const rF=[0,0,0,1];let oF=class extends $m{constructor(t=0,n=0,s=0,i=1){super(-0,-0,-0,-0),Array.isArray(t)&&arguments.length===1?this.copy(t):this.set(t,n,s,i)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,n,s,i){return this[0]=t,this[1]=n,this[2]=s,this[3]=i,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return CR(this,t),this.check()}fromAxisRotation(t,n){return vR(this,t,n),this.check()}identity(){return XP(this),this.check()}setAxisAngle(t,n){return this.fromAxisRotation(t,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=ee(t)}get y(){return this[1]}set y(t){this[1]=ee(t)}get z(){return this[2]}set z(t){this[2]=ee(t)}get w(){return this[3]}set w(t){this[3]=ee(t)}len(){return nF(this)}lengthSquared(){return sF(this)}dot(t){return tF(this,t)}rotationTo(t,n){return iF(this,t,n),this.check()}add(t){return ZP(this,this,t),this.check()}calculateW(){return YP(this,this),this.check()}conjugate(){return JP(this,this),this.check()}invert(){return KP(this,this),this.check()}lerp(t,n,s){return s===void 0?this.lerp(this,t,n):(eF(this,t,n,s),this.check())}multiplyRight(t){return _b(this,this,t),this.check()}multiplyLeft(t){return _b(this,t,this),this.check()}normalize(){const t=this.len(),n=t>0?1/t:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,t===0&&(this[3]=1),this.check()}rotateX(t){return GP(this,this,t),this.check()}rotateY(t){return WP(this,this,t),this.check()}rotateZ(t){return qP(this,this,t),this.check()}scale(t){return QP(this,this,t),this.check()}slerp(t,n,s){let i,r,a;switch(arguments.length){case 1:({start:i=rF,target:r,ratio:a}=t);break;case 2:i=this,r=t,a=n;break;default:i=t,r=n,a=s}return Sf(this,i,r,a),this.check()}transformVector4(t,n=new dP){return LP(n,t,this),Ef(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,n){return this.setAxisAngle(t,n)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}};const mb=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
vec3 color;
};
struct PointLight {
vec3 color;
vec3 position;
vec3 attenuation;
};
struct DirectionalLight {
vec3 color;
vec3 direction;
};
uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;
uniform bool lighting_uEnabled;
float getPointLightAttenuation(PointLight pointLight, float distance) {
return pointLight.attenuation.x
+ pointLight.attenuation.y * distance
+ pointLight.attenuation.z * distance * distance;
}
#endif
`,aF={lightSources:{}};function p_(e={}){const{color:t=[0,0,0],intensity:n=1}=e;return t.map(s=>s*n/255)}function cF({ambientLight:e,pointLights:t=[],directionalLights:n=[]}){const s={};return e?s["lighting_uAmbientLight.color"]=p_(e):s["lighting_uAmbientLight.color"]=[0,0,0],t.forEach((i,r)=>{s[`lighting_uPointLight[${r}].color`]=p_(i),s[`lighting_uPointLight[${r}].position`]=i.position,s[`lighting_uPointLight[${r}].attenuation`]=i.attenuation||[1,0,0]}),s.lighting_uPointLightCount=t.length,n.forEach((i,r)=>{s[`lighting_uDirectionalLight[${r}].color`]=p_(i),s[`lighting_uDirectionalLight[${r}].direction`]=i.direction}),s.lighting_uDirectionalLightCount=n.length,s}function wR(e=aF){var t,n;if("lightSources"in e){const{ambientLight:s,pointLights:i,directionalLights:r}=e.lightSources||{};return s||i&&i.length>0||r&&r.length>0?Object.assign({},cF({ambientLight:s,pointLights:i,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in e){const s={pointLights:[],directionalLights:[]};for(const i of e.lights||[])switch(i.type){case"ambient":s.ambientLight=i;break;case"directional":(t=s.directionalLights)==null||t.push(i);break;case"point":(n=s.pointLights)==null||n.push(i);break}return wR({lightSources:s})}return{}}const Gm={name:"lights",vs:mb,fs:mb,getUniforms:wR,defines:{MAX_LIGHTS:3}},OR=`uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;
vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
vec3 halfway_direction = normalize(light_direction + view_direction);
float lambertian = dot(light_direction, normal_worldspace);
float specular = 0.0;
if (lambertian > 0.0) {
float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
specular = pow(specular_angle, lighting_uShininess);
}
lambertian = max(lambertian, 0.0);
return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}
vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
vec3 lightColor = surfaceColor;
if (lighting_uEnabled) {
vec3 view_direction = normalize(cameraPosition - position_worldspace);
lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uPointLightCount) {
break;
}
PointLight pointLight = lighting_uPointLight[i];
vec3 light_position_worldspace = pointLight.position;
vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
}
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uDirectionalLightCount) {
break;
}
DirectionalLight directionalLight = lighting_uDirectionalLight[i];
lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
}
}
return lightColor;
}
vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
vec3 lightColor = vec3(0, 0, 0);
vec3 surfaceColor = vec3(0, 0, 0);
if (lighting_uEnabled) {
vec3 view_direction = normalize(cameraPosition - position_worldspace);
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uPointLightCount) {
break;
}
PointLight pointLight = lighting_uPointLight[i];
vec3 light_position_worldspace = pointLight.position;
vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
}
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uDirectionalLightCount) {
break;
}
DirectionalLight directionalLight = lighting_uDirectionalLight[i];
lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
}
}
return lightColor;
}
`,lF={};function uF(e){const{ambient:t=.35,diffuse:n=.6,shininess:s=32,specularColor:i=[30,30,30]}=e;return{lighting_uAmbient:t,lighting_uDiffuse:n,lighting_uShininess:s,lighting_uSpecularColor:i.map(r=>r/255)}}function BR(e=lF){if(!("material"in e))return{};const{material:t}=e;return t?uF(t):{lighting_uEnabled:!1}}const hF={name:"gouraud-lighting",dependencies:[Gm],vs:OR,defines:{LIGHTING_VERTEX:1},getUniforms:BR},fF={name:"phong-lighting",dependencies:[Gm],fs:OR,defines:{LIGHTING_FRAGMENT:1},getUniforms:BR},dF=`uniform mat4 u_MVPMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_NormalMatrix;
out vec3 pbr_vPosition;
out vec2 pbr_vUV;
#ifdef HAS_NORMALS
# ifdef HAS_TANGENTS
out mat3 pbr_vTBN;
# else
out vec3 pbr_vNormal;
# endif
#endif
void pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)
{
vec4 pos = u_ModelMatrix * position;
pbr_vPosition = vec3(pos.xyz) / pos.w;
#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));
vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));
vec3 bitangentW = cross(normalW, tangentW) * tangent.w;
pbr_vTBN = mat3(tangentW, bitangentW, normalW);
#else
pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));
#endif
#endif
#ifdef HAS_UV
pbr_vUV = uv;
#else
pbr_vUV = vec2(0.,0.);
#endif
}
`,gF=`precision highp float;
uniform bool pbr_uUnlit;
#ifdef USE_IBL
uniform samplerCube u_DiffuseEnvSampler;
uniform samplerCube u_SpecularEnvSampler;
uniform sampler2D u_brdfLUT;
uniform vec2 u_ScaleIBLAmbient;
#endif
#ifdef HAS_BASECOLORMAP
uniform sampler2D u_BaseColorSampler;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D u_NormalSampler;
uniform float u_NormalScale;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D u_EmissiveSampler;
uniform vec3 u_EmissiveFactor;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D u_MetallicRoughnessSampler;
#endif
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D u_OcclusionSampler;
uniform float u_OcclusionStrength;
#endif
#ifdef ALPHA_CUTOFF
uniform float u_AlphaCutoff;
#endif
uniform vec2 u_MetallicRoughnessValues;
uniform vec4 u_BaseColorFactor;
uniform vec3 u_Camera;
#ifdef PBR_DEBUG
uniform vec4 u_ScaleDiffBaseMR;
uniform vec4 u_ScaleFGDSpec;
#endif
in vec3 pbr_vPosition;
in vec2 pbr_vUV;
#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
in mat3 pbr_vTBN;
#else
in vec3 pbr_vNormal;
#endif
#endif
struct PBRInfo
{
float NdotL;
float NdotV;
float NdotH;
float LdotH;
float VdotH;
float perceptualRoughness;
float metalness;
vec3 reflectance0;
vec3 reflectance90;
float alphaRoughness;
vec3 diffuseColor;
vec3 specularColor;
vec3 n;
vec3 v;
};
const float M_PI = 3.141592653589793;
const float c_MinRoughness = 0.04;
vec4 SRGBtoLINEAR(vec4 srgbIn)
{
#ifdef MANUAL_SRGB
#ifdef SRGB_FAST_APPROXIMATION
vec3 linOut = pow(srgbIn.xyz,vec3(2.2));
#else
vec3 bLess = step(vec3(0.04045),srgbIn.xyz);
vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );
#endif
return vec4(linOut,srgbIn.w);;
#else
return srgbIn;
#endif
}
vec3 getNormal()
{
#ifndef HAS_TANGENTS
vec3 pos_dx = dFdx(pbr_vPosition);
vec3 pos_dy = dFdy(pbr_vPosition);
vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));
vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));
vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);
#ifdef HAS_NORMALS
vec3 ng = normalize(pbr_vNormal);
#else
vec3 ng = cross(pos_dx, pos_dy);
#endif
t = normalize(t - ng * dot(ng, t));
vec3 b = normalize(cross(ng, t));
mat3 tbn = mat3(t, b, ng);
#else
mat3 tbn = pbr_vTBN;
#endif
#ifdef HAS_NORMALMAP
vec3 n = texture(u_NormalSampler, pbr_vUV).rgb;
n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));
#else
vec3 n = normalize(tbn[2].xyz);
#endif
return n;
}
#ifdef USE_IBL
vec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)
{
float mipCount = 9.0;
float lod = (pbrInputs.perceptualRoughness * mipCount);
vec3 brdf = SRGBtoLINEAR(texture(u_brdfLUT,
vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;
vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;
#ifdef USE_TEX_LOD
vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;
#else
vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;
#endif
vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;
vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);
diffuse *= u_ScaleIBLAmbient.x;
specular *= u_ScaleIBLAmbient.y;
return diffuse + specular;
}
#endif
vec3 diffuse(PBRInfo pbrInputs)
{
return pbrInputs.diffuseColor / M_PI;
}
vec3 specularReflection(PBRInfo pbrInputs)
{
return pbrInputs.reflectance0 +
(pbrInputs.reflectance90 - pbrInputs.reflectance0) *
pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);
}
float geometricOcclusion(PBRInfo pbrInputs)
{
float NdotL = pbrInputs.NdotL;
float NdotV = pbrInputs.NdotV;
float r = pbrInputs.alphaRoughness;
float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));
float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));
return attenuationL * attenuationV;
}
float microfacetDistribution(PBRInfo pbrInputs)
{
float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;
float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;
return roughnessSq / (M_PI * f * f);
}
void PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {
pbrInputs.NdotL = 1.0;
pbrInputs.NdotH = 0.0;
pbrInputs.LdotH = 0.0;
pbrInputs.VdotH = 1.0;
}
void PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {
vec3 n = pbrInputs.n;
vec3 v = pbrInputs.v;
vec3 l = normalize(lightDirection);
vec3 h = normalize(l+v);
pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);
pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);
pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);
pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);
}
void PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {
vec3 light_direction = normalize(pointLight.position - pbr_vPosition);
PBRInfo_setDirectionalLight(pbrInputs, light_direction);
}
vec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {
vec3 F = specularReflection(pbrInputs);
float G = geometricOcclusion(pbrInputs);
float D = microfacetDistribution(pbrInputs);
vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);
vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);
return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);
}
vec4 pbr_filterColor(vec4 colorUnused)
{
#ifdef HAS_BASECOLORMAP
vec4 baseColor = SRGBtoLINEAR(texture(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;
#else
vec4 baseColor = u_BaseColorFactor;
#endif
#ifdef ALPHA_CUTOFF
if (baseColor.a < u_AlphaCutoff) {
discard;
}
#endif
vec3 color = vec3(0, 0, 0);
if(pbr_uUnlit){
color.rgb = baseColor.rgb;
}
else{
float perceptualRoughness = u_MetallicRoughnessValues.y;
float metallic = u_MetallicRoughnessValues.x;
#ifdef HAS_METALROUGHNESSMAP
vec4 mrSample = texture(u_MetallicRoughnessSampler, pbr_vUV);
perceptualRoughness = mrSample.g * perceptualRoughness;
metallic = mrSample.b * metallic;
#endif
perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);
metallic = clamp(metallic, 0.0, 1.0);
float alphaRoughness = perceptualRoughness * perceptualRoughness;
vec3 f0 = vec3(0.04);
vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);
diffuseColor *= 1.0 - metallic;
vec3 specularColor = mix(f0, baseColor.rgb, metallic);
float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);
float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);
vec3 specularEnvironmentR0 = specularColor.rgb;
vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;
vec3 n = getNormal();
vec3 v = normalize(u_Camera - pbr_vPosition);
float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);
vec3 reflection = -normalize(reflect(v, n));
PBRInfo pbrInputs = PBRInfo(
0.0,
NdotV,
0.0,
0.0,
0.0,
perceptualRoughness,
metallic,
specularEnvironmentR0,
specularEnvironmentR90,
alphaRoughness,
diffuseColor,
specularColor,
n,
v
);
#ifdef USE_LIGHTS
PBRInfo_setAmbientLight(pbrInputs);
color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);
for(int i = 0; i < lighting_uDirectionalLightCount; i++) {
if (i < lighting_uDirectionalLightCount) {
PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);
color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);
}
}
for(int i = 0; i < lighting_uPointLightCount; i++) {
if (i < lighting_uPointLightCount) {
PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);
float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));
color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);
}
}
#endif
#ifdef USE_IBL
color += getIBLContribution(pbrInputs, n, reflection);
#endif
#ifdef HAS_OCCLUSIONMAP
float ao = texture(u_OcclusionSampler, pbr_vUV).r;
color = mix(color, color * ao, u_OcclusionStrength);
#endif
#ifdef HAS_EMISSIVEMAP
vec3 emissive = SRGBtoLINEAR(texture(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;
color += emissive;
#endif
#ifdef PBR_DEBUG
color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);
color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);
color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);
#endif
}
return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);
}
`,Wm={name:"pbr",vs:dF,fs:gF,defines:{LIGHTING_FRAGMENT:1},dependencies:[Gm]},xR="#define SMOOTH_EDGE_RADIUS 0.5",pF=`
${xR}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,_F=`
${xR}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,mF={name:"geometry",vs:pF,fs:_F},Nt={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Nt,"IDENTITY",{get:()=>(kt.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Vs={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},j0={common:0,meters:1,pixels:2},$0={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},AF=Object.keys(Nt).map(e=>`const int COORDINATE_SYSTEM_${e} = ${Nt[e]};`).join(""),yF=Object.keys(Vs).map(e=>`const int PROJECTION_MODE_${e} = ${Vs[e]};`).join(""),TF=Object.keys(j0).map(e=>`const int UNIT_${e.toUpperCase()} = ${j0[e]};`).join(""),EF=`${AF}
${yF}
${TF}
uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project_uPseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project_uCommonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project_uCommonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project_uCommonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project_uWrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project_uModelMatrix * position;
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project_uCoordinateOrigin;
}
}
if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
(project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project_uCoordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
return offset * project_uFocalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project_uScale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project_uScale;
}
`;function bF(e,t){if(e===t)return!0;if(Array.isArray(e)){const n=e.length;if(!t||t.length!==n)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s])return!1;return!0}return!1}function Zl(e){let t={},n;return s=>{for(const i in s)if(!bF(s[i],t[i])){n=e(s),t=s;break}return n}}const Ab=[0,0,0,0],SF=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],NR=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],RF=[0,0,0],IR=[0,0,0],vF=Zl(wF);function DR(e,t,n=IR){n.length<3&&(n=[n[0],n[1],0]);let s=n,i,r=!0;switch(t===Nt.LNGLAT_OFFSETS||t===Nt.METER_OFFSETS?i=n:i=e.isGeospatial?[Math.fround(e.longitude),Math.fround(e.latitude),0]:null,e.projectionMode){case Vs.WEB_MERCATOR:(t===Nt.LNGLAT||t===Nt.CARTESIAN)&&(i=[0,0,0],r=!1);break;case Vs.WEB_MERCATOR_AUTO_OFFSET:t===Nt.LNGLAT?s=i:t===Nt.CARTESIAN&&(s=[Math.fround(e.center[0]),Math.fround(e.center[1]),0],i=e.unprojectPosition(s),s[0]-=n[0],s[1]-=n[1],s[2]-=n[2]);break;case Vs.IDENTITY:s=e.position.map(Math.fround),s[2]=s[2]||0;break;case Vs.GLOBE:r=!1,i=null;break;default:r=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:s,offsetMode:r}}function CF(e,t,n){const{viewMatrixUncentered:s,projectionMatrix:i}=e;let{viewMatrix:r,viewProjectionMatrix:a}=e,l=Ab,h=Ab,d=e.cameraPosition;const{geospatialOrigin:g,shaderCoordinateOrigin:_,offsetMode:m}=DR(e,t,n);return m&&(h=e.projectPosition(g||_),d=[d[0]-h[0],d[1]-h[1],d[2]-h[2]],h[3]=1,l=Id([],h,a),r=s||r,a=no([],i,r),a=no([],a,SF)),{viewMatrix:r,viewProjectionMatrix:a,projectionCenter:l,originCommon:h,cameraPosCommon:d,shaderCoordinateOrigin:_,geospatialOrigin:g}}function MF({viewport:e,devicePixelRatio:t=1,modelMatrix:n=null,coordinateSystem:s=Nt.DEFAULT,coordinateOrigin:i=IR,autoWrapLongitude:r=!1}){s===Nt.DEFAULT&&(s=e.isGeospatial?Nt.LNGLAT:Nt.CARTESIAN);const a=vF({viewport:e,devicePixelRatio:t,coordinateSystem:s,coordinateOrigin:i});return a.project_uWrapLongitude=r,a.project_uModelMatrix=n||NR,a}function wF({viewport:e,devicePixelRatio:t,coordinateSystem:n,coordinateOrigin:s}){const{projectionCenter:i,viewProjectionMatrix:r,originCommon:a,cameraPosCommon:l,shaderCoordinateOrigin:h,geospatialOrigin:d}=CF(e,n,s),g=e.getDistanceScales(),_=[e.width*t,e.height*t],m=Id([],[0,0,-e.focalDistance,1],e.projectionMatrix)[3]||1,y={project_uCoordinateSystem:n,project_uProjectionMode:e.projectionMode,project_uCoordinateOrigin:h,project_uCommonOrigin:a.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!e._pseudoMeters,project_uViewportSize:_,project_uDevicePixelRatio:t,project_uFocalDistance:m,project_uCommonUnitsPerMeter:g.unitsPerMeter,project_uCommonUnitsPerWorldUnit:g.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:RF,project_uScale:e.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:r,project_uModelMatrix:NR,project_uCameraPosition:l};if(d){const E=e.getDistanceScales(d);switch(n){case Nt.METER_OFFSETS:y.project_uCommonUnitsPerWorldUnit=E.unitsPerMeter,y.project_uCommonUnitsPerWorldUnit2=E.unitsPerMeter2;break;case Nt.LNGLAT:case Nt.LNGLAT_OFFSETS:e._pseudoMeters||(y.project_uCommonUnitsPerMeter=E.unitsPerMeter),y.project_uCommonUnitsPerWorldUnit=E.unitsPerDegree,y.project_uCommonUnitsPerWorldUnit2=E.unitsPerDegree2;break;case Nt.CARTESIAN:y.project_uCommonUnitsPerWorldUnit=[1,1,E.unitsPerMeter[2]],y.project_uCommonUnitsPerWorldUnit2=[0,0,E.unitsPerMeter2[2]];break}}return y}const OF={};function BF(e=OF){return"viewport"in e?MF(e):{}}const qm={name:"project",dependencies:[ID,mF],vs:EF,getUniforms:BF},xF=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Ym={name:"project32",dependencies:[qm],vs:xF};let ka=typeof Float32Array<"u"?Float32Array:Array;function NF(){const e=new ka(2);return ka!=Float32Array&&(e[0]=0,e[1]=0),e}function PR(e,t,n,s){const i=t[0],r=t[1];return e[0]=i+s*(n[0]-i),e[1]=r+s*(n[1]-r),e}(function(){const e=NF();return function(t,n,s,i,r,a){let l,h;for(n||(n=2),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],r(e,e,a),t[l]=e[0],t[l+1]=e[1];return t}})();function IF(){const e=new ka(3);return ka!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function DF(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}(function(){const e=IF();return function(t,n,s,i,r,a){let l,h;for(n||(n=3),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],r(e,e,a),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2];return t}})();function yb(e,t,n){const s=n[0],i=n[1],r=n[2];let a,l,h,d,g,_,m,y,E,b,R,M;return t===e?(e[12]=t[0]*s+t[4]*i+t[8]*r+t[12],e[13]=t[1]*s+t[5]*i+t[9]*r+t[13],e[14]=t[2]*s+t[6]*i+t[10]*r+t[14],e[15]=t[3]*s+t[7]*i+t[11]*r+t[15]):(a=t[0],l=t[1],h=t[2],d=t[3],g=t[4],_=t[5],m=t[6],y=t[7],E=t[8],b=t[9],R=t[10],M=t[11],e[0]=a,e[1]=l,e[2]=h,e[3]=d,e[4]=g,e[5]=_,e[6]=m,e[7]=y,e[8]=E,e[9]=b,e[10]=R,e[11]=M,e[12]=a*s+g*i+E*r+t[12],e[13]=l*s+_*i+b*r+t[13],e[14]=h*s+m*i+R*r+t[14],e[15]=d*s+y*i+M*r+t[15]),e}function PF(e,t,n){const s=n[0],i=n[1],r=n[2];return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function FF(e,t,n){const s=Math.sin(n),i=Math.cos(n),r=t[4],a=t[5],l=t[6],h=t[7],d=t[8],g=t[9],_=t[10],m=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=r*i+d*s,e[5]=a*i+g*s,e[6]=l*i+_*s,e[7]=h*i+m*s,e[8]=d*i-r*s,e[9]=g*i-a*s,e[10]=_*i-l*s,e[11]=m*i-h*s,e}function UF(e,t,n){const s=Math.sin(n),i=Math.cos(n),r=t[0],a=t[1],l=t[2],h=t[3],d=t[4],g=t[5],_=t[6],m=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=r*i+d*s,e[1]=a*i+g*s,e[2]=l*i+_*s,e[3]=h*i+m*s,e[4]=d*i-r*s,e[5]=g*i-a*s,e[6]=_*i-l*s,e[7]=m*i-h*s,e}function LF(){const e=new ka(4);return ka!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function kF(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function zF(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3];return e[0]=n[0]*s+n[4]*i+n[8]*r+n[12]*a,e[1]=n[1]*s+n[5]*i+n[9]*r+n[13]*a,e[2]=n[2]*s+n[6]*i+n[10]*r+n[14]*a,e[3]=n[3]*s+n[7]*i+n[11]*r+n[15]*a,e}(function(){const e=LF();return function(t,n,s,i,r,a){let l,h;for(n||(n=4),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],e[3]=t[l+3],r(e,e,a),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2],t[l+3]=e[3];return t}})();function VF(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function xa(e,t){const n=zF([],t,e);return kF(n,n,1/n[3]),n}function Tb(e,t){const n=e%t;return n<0?t+n:n}function X0(e,t,n){return e<t?t:e>n?n:e}function HF(e){return Math.log(e)*Math.LOG2E}const Km=Math.log2||HF;function Ei(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}const hs=Math.PI,FR=hs/4,ts=hs/180,G0=180/hs,za=512,Kf=4003e4,Eb=85.051129,jF=1.5;function $F(e){return Km(e)}function Ul(e){const[t,n]=e;Ei(Number.isFinite(t)),Ei(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const s=t*ts,i=n*ts,r=za*(s+hs)/(2*hs),a=za*(hs+Math.log(Math.tan(FR+i*.5)))/(2*hs);return[r,a]}function Va(e){const[t,n]=e,s=t/za*(2*hs)-hs,i=2*(Math.atan(Math.exp(n/za*(2*hs)-hs))-FR);return[s*G0,i*G0]}function XF(e){const{latitude:t}=e;Ei(Number.isFinite(t));const n=Math.cos(t*ts);return $F(Kf*n)-9}function Rf(e){const t=Math.cos(e*ts);return za/Kf/t}function W0(e){const{latitude:t,longitude:n,highPrecision:s=!1}=e;Ei(Number.isFinite(t)&&Number.isFinite(n));const i=za,r=Math.cos(t*ts),a=i/360,l=a/r,h=i/Kf/r,d={unitsPerMeter:[h,h,h],metersPerUnit:[1/h,1/h,1/h],unitsPerDegree:[a,l,h],degreesPerUnit:[1/a,1/l,1/h]};if(s){const g=ts*Math.tan(t*ts)/r,_=a*g/2,m=i/Kf*g,y=m/l*h;d.unitsPerDegree2=[0,_,m],d.unitsPerMeter2=[y,0,y]}return d}function UR(e,t){const[n,s,i]=e,[r,a,l]=t,{unitsPerMeter:h,unitsPerMeter2:d}=W0({longitude:n,latitude:s,highPrecision:!0}),g=Ul(e);g[0]+=r*(h[0]+d[0]*a),g[1]+=a*(h[1]+d[1]*a);const _=Va(g),m=(i||0)+(l||0);return Number.isFinite(i)||Number.isFinite(l)?[_[0],_[1],m]:_}function GF(e){const{height:t,pitch:n,bearing:s,altitude:i,scale:r,center:a}=e,l=VF();yb(l,l,[0,0,-i]),FF(l,l,-n*ts),UF(l,l,s*ts);const h=r/t;return PF(l,l,[h,h,h]),a&&yb(l,l,DF([],a)),l}function WF(e){const{width:t,height:n,altitude:s,pitch:i=0,offset:r,center:a,scale:l,nearZMultiplier:h=1,farZMultiplier:d=1}=e;let{fovy:g=Jf(jF)}=e;s!==void 0&&(g=Jf(s));const _=g*ts,m=i*ts,y=LR(g);let E=y;a&&(E+=a[2]*l/Math.cos(m)/n);const b=_*(.5+(r?r[1]:0)/n),R=Math.sin(b)*E/Math.sin(X0(Math.PI/2-m-b,.01,Math.PI-.01)),M=Math.sin(m)*R+E,N=E*10,O=Math.min(M*d,N);return{fov:_,aspect:t/n,focalDistance:y,near:h,far:O}}function Jf(e){return 2*Math.atan(.5/e)*G0}function LR(e){return .5/Math.tan(.5*e*ts)}function kR(e,t){const[n,s,i=0]=e;return Ei(Number.isFinite(n)&&Number.isFinite(s)&&Number.isFinite(i)),xa(t,[n,s,i,1])}function Jm(e,t,n=0){const[s,i,r]=e;if(Ei(Number.isFinite(s)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(r))return xa(t,[s,i,r,1]);const a=xa(t,[s,i,0,1]),l=xa(t,[s,i,1,1]),h=a[2],d=l[2],g=h===d?0:((n||0)-h)/(d-h);return PR([],a,l,g)}function qF(e){const{width:t,height:n,bounds:s,minExtent:i=0,maxZoom:r=24,offset:a=[0,0]}=e,[[l,h],[d,g]]=s,_=YF(e.padding),m=Ul([l,X0(g,-85.051129,Eb)]),y=Ul([d,X0(h,-85.051129,Eb)]),E=[Math.max(Math.abs(y[0]-m[0]),i),Math.max(Math.abs(y[1]-m[1]),i)],b=[t-_.left-_.right-Math.abs(a[0])*2,n-_.top-_.bottom-Math.abs(a[1])*2];Ei(b[0]>0&&b[1]>0);const R=b[0]/E[0],M=b[1]/E[1],N=(_.right-_.left)/2/R,O=(_.top-_.bottom)/2/M,x=[(y[0]+m[0])/2+N,(y[1]+m[1])/2+O],I=Va(x),P=Math.min(r,Km(Math.abs(Math.min(R,M))));return Ei(Number.isFinite(P)),{longitude:I[0],latitude:I[1],zoom:P}}function YF(e=0){return typeof e=="number"?{top:e,bottom:e,left:e,right:e}:(Ei(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e)}const bb=Math.PI/180;function KF(e,t=0){const{width:n,height:s,unproject:i}=e,r={targetZ:t},a=i([0,s],r),l=i([n,s],r);let h,d;const g=e.fovy?.5*e.fovy*bb:Math.atan(.5/e.altitude),_=(90-e.pitch)*bb;return g>_-.01?(h=Sb(e,0,t),d=Sb(e,n,t)):(h=i([0,0],r),d=i([n,0],r)),[a,l,d,h]}function Sb(e,t,n){const{pixelUnprojectionMatrix:s}=e,i=xa(s,[t,0,1,1]),r=xa(s,[t,e.height,1,1]),l=(n*e.distanceScales.unitsPerMeter[2]-i[2])/(r[2]-i[2]),h=PR([],i,r,l),d=Va(h);return d.push(n),d}const Rb=512;function JF(e){const{width:t,height:n,pitch:s=0}=e;let{longitude:i,latitude:r,zoom:a,bearing:l=0}=e;(i<-180||i>180)&&(i=Tb(i+180,360)-180),(l<-180||l>180)&&(l=Tb(l+180,360)-180);const h=Km(n/Rb);if(a<=h)a=h,r=0;else{const d=n/2/Math.pow(2,a),g=Va([0,d])[1];if(r<g)r=g;else{const _=Va([0,Rb-d])[1];r>_&&(r=_)}}return{width:t,height:n,longitude:i,latitude:r,zoom:a,pitch:s,bearing:l}}const ZF=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,QF=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,tU=Zl(rU),eU=Zl(oU),nU=[0,0,0,1],sU=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function iU(e,t){const[n,s,i]=e,r=Jm([n,s,i],t);return Number.isFinite(i)?r:[r[0],r[1],0]}function rU({viewport:e,center:t}){return new nn(e.viewProjectionMatrix).invert().transform(t)}function oU({viewport:e,shadowMatrices:t}){const n=[],s=e.pixelUnprojectionMatrix,i=e.isGeospatial?void 0:1,r=[[0,0,i],[e.width,0,i],[0,e.height,i],[e.width,e.height,i],[0,0,-1],[e.width,0,-1],[0,e.height,-1],[e.width,e.height,-1]].map(a=>iU(a,s));for(const a of t){const l=a.clone().translate(new Tn(e.center).negate()),h=r.map(g=>l.transform(g)),d=new nn().ortho({left:Math.min(...h.map(g=>g[0])),right:Math.max(...h.map(g=>g[0])),bottom:Math.min(...h.map(g=>g[1])),top:Math.max(...h.map(g=>g[1])),near:Math.min(...h.map(g=>-g[2])),far:Math.max(...h.map(g=>-g[2]))});n.push(d.multiplyRight(a))}return n}function aU(e,t){const{shadowEnabled:n=!0}=e;if(!n||!e.shadowMatrices||!e.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1,shadow_uShadowMap0:e.dummyShadowMap,shadow_uShadowMap1:e.dummyShadowMap};const s={shadow_uDrawShadowMap:!!e.drawToShadowMap,shadow_uUseShadowMap:e.shadowMaps?e.shadowMaps.length>0:!1,shadow_uColor:e.shadowColor||nU,shadow_uLightId:e.shadowLightId||0,shadow_uLightCount:e.shadowMatrices.length},i=tU({viewport:e.viewport,center:t.project_uCenter}),r=[],a=eU({shadowMatrices:e.shadowMatrices,viewport:e.viewport}).slice();for(let l=0;l<e.shadowMatrices.length;l++){const h=a[l],d=h.clone().translate(new Tn(e.viewport.center).negate());t.project_uCoordinateSystem===Nt.LNGLAT&&t.project_uProjectionMode===Vs.WEB_MERCATOR?(a[l]=d,r[l]=i):(a[l]=h.clone().multiplyRight(sU),r[l]=d.transform(i))}for(let l=0;l<a.length;l++)s[`shadow_uViewProjectionMatrices[${l}]`]=a[l],s[`shadow_uProjectCenters[${l}]`]=r[l];for(let l=0;l<2;l++)s[`shadow_uShadowMap${l}`]=e.shadowMaps&&e.shadowMaps[l]||e.dummyShadowMap;return s}const vb={name:"shadow",dependencies:[qm],vs:ZF,fs:QF,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(e={},t={})=>"viewport"in e&&(e.drawToShadowMap||e.shadowMaps&&e.shadowMaps.length>0)?aU(e,t):{}},Zm={...ub,defaultUniforms:{...ub.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}},cU=[qm],lU=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function uU(){const e=zf.getDefaultShaderAssembler();for(const t of cU)e.addDefaultModule(t);for(const t of lU)e.addShaderHook(t);return e}const hU=[255,255,255],fU=1;let dU=0;class gU{constructor(t={}){this.type="ambient";const{color:n=hU}=t,{intensity:s=fU}=t;this.id=t.id||`ambient-${dU++}`,this.color=n,this.intensity=s}}const pU=[255,255,255],_U=1,mU=[0,0,-1];let AU=0;class Cb{constructor(t={}){this.type="directional";const{color:n=pU}=t,{intensity:s=_U}=t,{direction:i=mU}=t,{_shadow:r=!1}=t;this.id=t.id||`directional-${AU++}`,this.color=n,this.intensity=s,this.type="directional",this.direction=new Tn(i).normalize().toArray(),this.shadow=r}getProjectedLight(t){return this}}class yU{constructor(t,n={id:"pass"}){const{id:s}=n;this.id=s,this.device=t,this.props={...n}}setProps(t){Object.assign(this.props,t)}render(t){}cleanup(){}}class Qm extends yU{constructor(){super(...arguments),this._lastRenderIndex=-1}render(t){const[n,s]=this.device.canvasContext.getDrawingBufferSize(),i=t.clearCanvas??!0,r=t.clearColor??(i?[0,0,0,0]:!1),a=i?1:!1,l=i?0:!1,h=t.colorMask??15,d={viewport:[0,0,n,s]};t.colorMask&&(d.colorMask=h),t.scissorRect&&(d.scissorRect=t.scissorRect);const g=this.device.beginRenderPass({framebuffer:t.target,parameters:d,clearColor:r,clearDepth:a,clearStencil:l});try{return this._drawLayers(g,t)}finally{g.end()}}_drawLayers(t,n){const{target:s,moduleParameters:i,viewports:r,views:a,onViewportActive:l,clearStack:h=!0}=n;n.pass=n.pass||"unknown",h&&(this._lastRenderIndex=-1);const d=[];for(const g of r){const _=a&&a[g.id];l==null||l(g);const m=this._getDrawLayerParams(g,n),y=g.subViewports||[g];for(const E of y){const b=this._drawLayersInViewport(t,{target:s,moduleParameters:i,viewport:E,view:_,pass:n.pass,layers:n.layers},m);d.push(b)}}return d}_getDrawLayerParams(t,{layers:n,pass:s,isPicking:i=!1,layerFilter:r,cullRect:a,effects:l,moduleParameters:h},d=!1){var E;const g=[],_=zR(this._lastRenderIndex+1),m={layer:n[0],viewport:t,isPicking:i,renderPass:s,cullRect:a},y={};for(let b=0;b<n.length;b++){const R=n[b],M=this._shouldDrawLayer(R,m,r,y),N={shouldDrawLayer:M};M&&!d&&(N.layerRenderIndex=_(R,M),N.moduleParameters=this._getModuleParameters(R,l,s,h),N.layerParameters={...(E=R.context.deck)==null?void 0:E.props.parameters,...this.getLayerParameters(R,b,t)}),g[b]=N}return g}_drawLayersInViewport(t,{layers:n,moduleParameters:s,pass:i,target:r,viewport:a,view:l},h){const d=TU(this.device,{moduleParameters:s,target:r,viewport:a});if(l&&l.props.clear){const _=l.props.clear===!0?{color:!0,depth:!0}:l.props.clear;this.device.withParametersWebGL({scissorTest:!0,scissor:d},()=>this.device.clearWebGL(_))}const g={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};t.setParameters({viewport:d});for(let _=0;_<n.length;_++){const m=n[_],{shouldDrawLayer:y,layerRenderIndex:E,moduleParameters:b,layerParameters:R}=h[_];if(y&&m.props.pickable&&g.pickableCount++,m.isComposite)g.compositeCount++;else if(y){g.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,E),b.viewport=a,m.context.renderPass=t;try{m._drawLayer({renderPass:t,moduleParameters:b,uniforms:{layerIndex:E},parameters:R})}catch(M){m.raiseError(M,`drawing ${m} to ${i}`)}}}return g}shouldDrawLayer(t){return!0}getModuleParameters(t,n){return null}getLayerParameters(t,n,s){return t.props.parameters}_shouldDrawLayer(t,n,s,i){if(!(t.props.visible&&this.shouldDrawLayer(t)))return!1;n.layer=t;let a=t.parent;for(;a;){if(!a.props.visible||!a.filterSubLayer(n))return!1;n.layer=a,a=a.parent}if(s){const l=n.layer.id;if(l in i||(i[l]=s(n)),!i[l])return!1}return t.activateViewport(n.viewport),!0}_getModuleParameters(t,n,s,i){var l,h;const r=this.device.canvasContext.cssToDeviceRatio(),a=Object.assign(Object.create(((l=t.internalState)==null?void 0:l.propsInTransition)||t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,picking:{isActive:0},devicePixelRatio:r});if(n)for(const d of n)Object.assign(a,(h=d.getModuleParameters)==null?void 0:h.call(d,t));return Object.assign(a,this.getModuleParameters(t,n),i)}}function zR(e=0,t={}){const n={},s=(i,r)=>{const a=i.props._offset,l=i.id,h=i.parent&&i.parent.id;let d;if(h&&!(h in t)&&s(i.parent,!1),h in n){const g=n[h]=n[h]||zR(t[h],t);d=g(i,r),n[l]=g}else Number.isFinite(a)?(d=a+(t[h]||0),n[l]=null):d=e;return r&&d>=e&&(e=d+1),t[l]=d,d};return s}function TU(e,{moduleParameters:t,target:n,viewport:s}){const i=t&&t.devicePixelRatio||e.canvasContext.cssToDeviceRatio(),[,r]=e.canvasContext.getDrawingBufferSize(),a=n?n.height:r,l=s;return[l.x*i,a-(l.y+l.height)*i,l.width*i,l.height*i]}class EU extends Qm{constructor(t,n){super(t,n),this.shadowMap=t.createTexture({width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}}),this.depthBuffer=t.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1,dataFormat:6402,type:5125}),this.fbo=t.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[this.shadowMap],depthStencilAttachment:this.depthBuffer})}render(t){const n=this.fbo,s=this.device.canvasContext.cssToDeviceRatio(),i=t.viewports[0],r=i.width*s,a=i.height*s,l=[1,1,1,1];(r!==n.width||a!==n.height)&&n.resize({width:r,height:a}),super.render({...t,clearColor:l,target:n,pass:"shadow"})}getLayerParameters(t,n,s){return{...t.props.parameters,blend:!1,depthRange:[0,1],depthTest:!0}}shouldDrawLayer(t){return t.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null),this.shadowMap&&(this.shadowMap.destroy(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.destroy(),this.depthBuffer=null)}}const bU={color:[255,255,255],intensity:1},Mb=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],SU=[0,0,0,200/255];class VR{constructor(t={}){this.id="lighting-effect",this.shadowColor=SU,this.shadow=!1,this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.setProps(t)}setup(t){this.context=t;const{device:n,deck:s}=t;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(n),s._addDefaultShaderModule(vb),this.dummyShadowMap=n.createTexture({width:1,height:1}))}setProps(t){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in t){const s=t[n];switch(s.type){case"ambient":this.ambientLight=s;break;case"directional":this.directionalLights.push(s);break;case"point":this.pointLights.push(s);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.context&&this.setup(this.context),this.props=t}preRender({layers:t,layerFilter:n,viewports:s,onViewportActive:i,views:r}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:t,layerFilter:n,viewports:s,onViewportActive:i,views:r,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(t){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(s=>s.getProjectedLight({layer:t})),pointLights:this.pointLights.map(s=>s.getProjectedLight({layer:t}))},n}cleanup(t){for(const n of this.shadowPasses)n.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,t.deck._removeDefaultShaderModule(vb))}_calculateMatrices(){const t=[];for(const n of this.directionalLights){const s=new nn().lookAt({eye:new Tn(n.direction).negate()});t.push(s)}return t}_createShadowPasses(t){for(let n=0;n<this.directionalLights.length;n++){const s=new EU(t);this.shadowPasses[n]=s,this.shadowMaps[n]=s.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:n,directionalLights:s}=this;!t&&n.length===0&&s.length===0&&(this.ambientLight=new gU(bU),this.directionalLights.push(new Cb(Mb[0]),new Cb(Mb[1])))}}class RU{constructor(t={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(t)}setOptions(t){Object.assign(this.opts,t)}allocate(t,n,{size:s=1,type:i,padding:r=0,copy:a=!1,initialize:l=!1,maxCount:h}){const d=i||t&&t.constructor||Float32Array,g=n*s+r;if(ArrayBuffer.isView(t)){if(g<=t.length)return t;if(g*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new d(t.buffer,0,g)}let _=1/0;h&&(_=h*s+r);const m=this._allocate(d,g,l,_);return t&&a?m.set(t):l||m.fill(0,0,4),this._release(t),m}release(t){this._release(t)}_allocate(t,n,s,i){let r=Math.max(Math.ceil(n*this.opts.overAlloc),1);r>i&&(r=i);const a=this._pool,l=t.BYTES_PER_ELEMENT*r,h=a.findIndex(d=>d.byteLength>=l);if(h>=0){const d=new t(a.splice(h,1)[0],0,r);return s&&d.fill(0),d}return new t(r)}_release(t){if(!ArrayBuffer.isView(t))return;const n=this._pool,{buffer:s}=t,{byteLength:i}=s,r=n.findIndex(a=>a.byteLength>=i);r<0?n.push(s):(r>0||n.length<this.opts.poolSize)&&n.splice(r,0,s),n.length>this.opts.poolSize&&n.shift()}}const Ll=new RU;function gl(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function vU(e){return[e[12],e[13],e[14]]}function CU(e){return{left:fa(e[3]+e[0],e[7]+e[4],e[11]+e[8],e[15]+e[12]),right:fa(e[3]-e[0],e[7]-e[4],e[11]-e[8],e[15]-e[12]),bottom:fa(e[3]+e[1],e[7]+e[5],e[11]+e[9],e[15]+e[13]),top:fa(e[3]-e[1],e[7]-e[5],e[11]-e[9],e[15]-e[13]),near:fa(e[3]+e[2],e[7]+e[6],e[11]+e[10],e[15]+e[14]),far:fa(e[3]-e[2],e[7]-e[6],e[11]-e[10],e[15]-e[14])}}const wb=new Tn;function fa(e,t,n,s){wb.set(e,t,n);const i=wb.len();return{distance:s/i,normal:new Tn(-e/i,-t/i,-n/i)}}function MU(e){return e-Math.fround(e)}let sl;function __(e,t){const{size:n=1,startIndex:s=0}=t,i=t.endIndex!==void 0?t.endIndex:e.length,r=(i-s)/n;sl=Ll.allocate(sl,r,{type:Float32Array,size:n*2});let a=s,l=0;for(;a<i;){for(let h=0;h<n;h++){const d=e[a++];sl[l+h]=d,sl[l+h+n]=MU(d)}l+=n*2}return sl.subarray(0,r*n*2)}function wU(e){let t=null,n=!1;for(const s of e)s&&(t?(n||(t=[[t[0][0],t[0][1]],[t[1][0],t[1][1]]],n=!0),t[0][0]=Math.min(t[0][0],s[0][0]),t[0][1]=Math.min(t[0][1],s[0][1]),t[1][0]=Math.max(t[1][0],s[1][0]),t[1][1]=Math.max(t[1][1],s[1][1])):t=s);return t}const OU=Math.PI/180,BU=gl(),Ob=[0,0,0],xU={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function NU({width:e,height:t,orthographic:n,fovyRadians:s,focalDistance:i,padding:r,near:a,far:l}){const h=e/t,d=n?new nn().orthographic({fovy:s,aspect:h,focalDistance:i,near:a,far:l}):new nn().perspective({fovy:s,aspect:h,near:a,far:l});if(r){const{left:g=0,right:_=0,top:m=0,bottom:y=0}=r,E=cr((g+e-_)/2,0,e)-e/2,b=cr((m+t-y)/2,0,t)-t/2;d[8]-=E*2/e,d[9]+=b*2/t}return d}class Ql{constructor(t={}){this._frustumPlanes={},this.id=t.id||this.constructor.displayName||"viewport",this.x=t.x||0,this.y=t.y||0,this.width=t.width||1,this.height=t.height||1,this.zoom=t.zoom||0,this.padding=t.padding,this.distanceScales=t.distanceScales||xU,this.focalDistance=t.focalDistance||1,this.position=t.position||Ob,this.modelMatrix=t.modelMatrix||null;const{longitude:n,latitude:s}=t;this.isGeospatial=Number.isFinite(s)&&Number.isFinite(n),this._initProps(t),this._initMatrices(t),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Vs.WEB_MERCATOR:Vs.WEB_MERCATOR_AUTO_OFFSET:Vs.IDENTITY}equals(t){return t instanceof Ql?this===t?!0:t.width===this.width&&t.height===this.height&&t.scale===this.scale&&Fl(t.projectionMatrix,this.projectionMatrix)&&Fl(t.viewMatrix,this.viewMatrix):!1}project(t,{topLeft:n=!0}={}){const s=this.projectPosition(t),i=kR(s,this.pixelProjectionMatrix),[r,a]=i,l=n?a:this.height-a;return t.length===2?[r,l]:[r,l,i[2]]}unproject(t,{topLeft:n=!0,targetZ:s}={}){const[i,r,a]=t,l=n?r:this.height-r,h=s&&s*this.distanceScales.unitsPerMeter[2],d=Jm([i,l,a],this.pixelUnprojectionMatrix,h),[g,_,m]=this.unprojectPosition(d);return Number.isFinite(a)?[g,_,m]:Number.isFinite(s)?[g,_,s]:[g,_]}projectPosition(t){const[n,s]=this.projectFlat(t),i=(t[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,s,i]}unprojectPosition(t){const[n,s]=this.unprojectFlat(t),i=(t[2]||0)*this.distanceScales.metersPerUnit[2];return[n,s,i]}projectFlat(t){if(this.isGeospatial){const n=Ul(t);return n[1]=cr(n[1],-318,830),n}return t}unprojectFlat(t){return this.isGeospatial?Va(t):t}getBounds(t={}){const n={targetZ:t.z||0},s=this.unproject([0,0],n),i=this.unproject([this.width,0],n),r=this.unproject([0,this.height],n),a=this.unproject([this.width,this.height],n);return[Math.min(s[0],i[0],r[0],a[0]),Math.min(s[1],i[1],r[1],a[1]),Math.max(s[0],i[0],r[0],a[0]),Math.max(s[1],i[1],r[1],a[1])]}getDistanceScales(t){return t?W0({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:n,width:s=1,height:i=1}){return t<this.x+this.width&&this.x<t+s&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,CU(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(t,n){return null}_initProps(t){const n=t.longitude,s=t.latitude;this.isGeospatial&&(Number.isFinite(t.zoom)||(this.zoom=XF({latitude:s})+Math.log2(this.focalDistance)),this.distanceScales=t.distanceScales||W0({latitude:s,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:r,modelMatrix:a}=t;let l=Ob;if(r&&(l=a?new nn(a).transformAsVector(r,[]):r),this.isGeospatial){const h=this.projectPosition([n,s,0]);this.center=new Tn(l).scale(this.distanceScales.unitsPerMeter).add(h)}else this.center=this.projectPosition(l)}_initMatrices(t){const{viewMatrix:n=BU,projectionMatrix:s=null,orthographic:i=!1,fovyRadians:r,fovy:a=75,near:l=.1,far:h=1e3,padding:d=null,focalDistance:g=1}=t;this.viewMatrixUncentered=n,this.viewMatrix=new nn().multiplyRight(n).translate(new Tn(this.center).negate()),this.projectionMatrix=s||NU({width:this.width,height:this.height,orthographic:i,fovyRadians:r||a*OU,focalDistance:g,padding:d,near:l,far:h});const _=gl();no(_,_,this.projectionMatrix),no(_,_,this.viewMatrix),this.viewProjectionMatrix=_,this.viewMatrixInverse=V0([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=vU(this.viewMatrixInverse);const m=gl(),y=gl();RR(m,m,[this.width/2,-this.height/2,1]),SR(m,m,[1,-1,0]),no(y,m,this.viewProjectionMatrix),this.pixelProjectionMatrix=y,this.pixelUnprojectionMatrix=V0(gl(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||kt.warn("Pixel project matrix not invertible")()}}Ql.displayName="Viewport";class ro extends Ql{constructor(t={}){const{latitude:n=0,longitude:s=0,zoom:i=0,pitch:r=0,bearing:a=0,nearZMultiplier:l=.1,farZMultiplier:h=1.01,nearZ:d,farZ:g,orthographic:_=!1,projectionMatrix:m,repeat:y=!1,worldOffset:E=0,position:b,padding:R,legacyMeterSizes:M=!1}=t;let{width:N,height:O,altitude:x=1.5}=t;const I=Math.pow(2,i);N=N||1,O=O||1;let P,J=null;if(m)x=m[5]/2,P=Jf(x);else{t.fovy?(P=t.fovy,x=LR(P)):P=Jf(x);let q;if(R){const{top:Q=0,bottom:rt=0}=R;q=[0,cr((Q+O-rt)/2,0,O)-O/2]}J=WF({width:N,height:O,scale:I,center:b&&[0,0,b[2]*Rf(n)],offset:q,pitch:r,fovy:P,nearZMultiplier:l,farZMultiplier:h}),Number.isFinite(d)&&(J.near=d),Number.isFinite(g)&&(J.far=g)}let et=GF({height:O,pitch:r,bearing:a,scale:I,altitude:x});E&&(et=new nn().translate([512*E,0,0]).multiplyLeft(et)),super({...t,width:N,height:O,viewMatrix:et,longitude:s,latitude:n,zoom:i,...J,fovy:P,focalDistance:x}),this.latitude=n,this.longitude=s,this.zoom=i,this.pitch=r,this.bearing=a,this.altitude=x,this.fovy=P,this.orthographic=_,this._subViewports=y?[]:null,this._pseudoMeters=M,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),n=Math.floor((t[0]+180)/360),s=Math.ceil((t[2]-180)/360);for(let i=n;i<=s;i++){const r=i?new ro({...this,worldOffset:i}):this;this._subViewports.push(r)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);const[n,s]=this.projectFlat(t),i=(t[2]||0)*Rf(t[1]);return[n,s,i]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);const[n,s]=this.unprojectFlat(t),i=(t[2]||0)/Rf(s);return[n,s,i]}addMetersToLngLat(t,n){return UR(t,n)}panByPosition(t,n){const s=Jm(n,this.pixelUnprojectionMatrix),i=this.projectFlat(t),r=fb([],i,JD([],s)),a=fb([],this.center,r),[l,h]=this.unprojectFlat(a);return{longitude:l,latitude:h}}getBounds(t={}){const n=KF(this,t.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(t,n={}){const{width:s,height:i}=this,{longitude:r,latitude:a,zoom:l}=qF({width:s,height:i,bounds:t,...n});return new ro({width:s,height:i,longitude:r,latitude:a,zoom:l})}}ro.displayName="WebMercatorViewport";const Bb=[0,0,0];function m_(e,t,n=!1){const s=t.projectPosition(e);if(n&&t instanceof ro){const[i,r,a=0]=e,l=t.getDistanceScales([i,r]);s[2]=a*l.unitsPerMeter[2]}return s}function IU(e){const{viewport:t,modelMatrix:n,coordinateOrigin:s}=e;let{coordinateSystem:i,fromCoordinateSystem:r,fromCoordinateOrigin:a}=e;return i===Nt.DEFAULT&&(i=t.isGeospatial?Nt.LNGLAT:Nt.CARTESIAN),r===void 0&&(r=i),a===void 0&&(a=s),{viewport:t,coordinateSystem:i,coordinateOrigin:s,modelMatrix:n,fromCoordinateSystem:r,fromCoordinateOrigin:a}}function HR(e,{viewport:t,modelMatrix:n,coordinateSystem:s,coordinateOrigin:i,offsetMode:r}){let[a,l,h=0]=e;switch(n&&([a,l,h]=Id([],[a,l,h,1],n)),s){case Nt.LNGLAT:return m_([a,l,h],t,r);case Nt.LNGLAT_OFFSETS:return m_([a+i[0],l+i[1],h+(i[2]||0)],t,r);case Nt.METER_OFFSETS:return m_(UR(i,[a,l,h]),t,r);case Nt.CARTESIAN:default:return t.isGeospatial?[a+i[0],l+i[1],h+i[2]]:t.projectPosition([a,l,h])}}function DU(e,t){const{viewport:n,coordinateSystem:s,coordinateOrigin:i,modelMatrix:r,fromCoordinateSystem:a,fromCoordinateOrigin:l}=IU(t),{autoOffset:h=!0}=t,{geospatialOrigin:d=Bb,shaderCoordinateOrigin:g=Bb,offsetMode:_=!1}=h?DR(n,s,i):{},m=HR(e,{viewport:n,modelMatrix:r,coordinateSystem:a,coordinateOrigin:l,offsetMode:_});if(_){const y=n.projectPosition(d||g);hP(m,m,y)}return m}let PU=1,FU=1;class jR{constructor(){T(this,"time",0);T(this,"channels",new Map);T(this,"animations",new Map);T(this,"playing",!1);T(this,"lastEngineTime",-1)}addChannel(t){const{delay:n=0,duration:s=Number.POSITIVE_INFINITY,rate:i=1,repeat:r=1}=t,a=PU++,l={time:0,delay:n,duration:s,rate:i,repeat:r};return this._setChannelTime(l,this.time),this.channels.set(a,l),a}removeChannel(t){this.channels.delete(t);for(const[n,s]of this.animations)s.channel===t&&this.detachAnimation(n)}isFinished(t){const n=this.channels.get(t);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(t){if(t===void 0)return this.time;const n=this.channels.get(t);return n===void 0?-1:n.time}setTime(t){this.time=Math.max(0,t);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const s=this.animations.values();for(const i of s){const{animation:r,channel:a}=i;r.setTime(this.getTime(a))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,n){const s=FU++;return this.animations.set(s,{animation:t,channel:n}),t.setTime(this.getTime(n)),s}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,n){const s=n-t.delay,i=t.duration*t.repeat;s>=i?t.time=t.duration*t.rate:(t.time=Math.max(0,s)%t.duration,t.time*=t.rate)}}let UU=0;const LU={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>console.error(e),stats:Oa.stats.get(`animation-loop-${UU++}`),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1};class kU{constructor(t){T(this,"device",null);T(this,"canvas",null);T(this,"props");T(this,"animationProps",null);T(this,"timeline",null);T(this,"stats");T(this,"cpuTime");T(this,"gpuTime");T(this,"frameRate");T(this,"display");T(this,"needsRedraw","initialized");T(this,"_initialized",!1);T(this,"_running",!1);T(this,"_animationFrameId",null);T(this,"_nextFramePromise",null);T(this,"_resolveNextFrame",null);T(this,"_cpuStartTime",0);if(this.props={...LU,...t},t=this.props,!t.device)throw new Error("No device provided");const{useDevicePixels:n=!0}=this.props;this.stats=t.stats||new Za({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:t.autoResizeViewport,autoResizeDrawingBuffer:t.autoResizeDrawingBuffer,useDevicePixels:n}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setNeedsRedraw(t){return this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.props.autoResizeViewport=t.autoResizeViewport||!1),"autoResizeDrawingBuffer"in t&&(this.props.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer||!1),"useDevicePixels"in t&&(this.props.useDevicePixels=t.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let t;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(t!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(t){const n=t instanceof Error?t:new Error("Unknown error");throw this.props.onError(n),n}}stop(){return this._running&&(this.animationProps&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){var t;return(t=this.device)!=null&&t.isLost?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(t=>{this._resolveNextFrame=t})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(t){this.display&&(this.display.destroy(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_requestAnimationFrame(){this._running&&(this._animationFrameId=GI(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(WI(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(t){if(this.display){this.display._renderFrame(t);return}this.props.onRender(this._getAnimationProps()),this.device.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){var t,n;if(!this.device)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:(n=(t=this.device)==null?void 0:t.canvasContext)==null?void 0:n.canvas,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:t,height:n,aspect:s}=this._getSizeAndAspect();(t!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),s!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=n,this.animationProps.aspect=s,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){var t;if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=((t=this.device.canvasContext)==null?void 0:t.canvas)||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",this.canvas instanceof HTMLCanvasElement&&t.appendChild(this.canvas),t.appendChild(n);const s=this.props.onAddHTML(n);s&&(n.innerHTML=s)}}_getSizeAndAspect(){var r,a,l,h;if(!this.device)return{width:1,height:1,aspect:1};const[t,n]=((a=(r=this.device)==null?void 0:r.canvasContext)==null?void 0:a.getPixelSize())||[1,1];let s=1;const i=(h=(l=this.device)==null?void 0:l.canvasContext)==null?void 0:h.canvas;return i&&i.clientHeight?s=i.clientWidth/i.clientHeight:t>0&&n>0&&(s=t/n),{width:t,height:n,aspect:s}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){var t,n;this.props.autoResizeDrawingBuffer&&((n=(t=this.device)==null?void 0:t.canvasContext)==null||n.resize({useDevicePixels:this.props.useDevicePixels}))}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(t){t instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[t.offsetX,t.offsetY])}_onMouseleave(t){this._getAnimationProps()._mousePosition=null}}class xb{constructor(t){T(this,"id");T(this,"userData",{});T(this,"topology");T(this,"bufferLayout",[]);T(this,"vertexCount");T(this,"indices");T(this,"attributes");this.id=t.id||yr("geometry"),this.topology=t.topology,this.indices=t.indices||null,this.attributes=t.attributes,this.vertexCount=t.vertexCount,this.bufferLayout=t.bufferLayout||[],this.indices&&Ht(this.indices.usage===fe.INDEX)}destroy(){var t;(t=this.indices)==null||t.destroy();for(const n of Object.values(this.attributes))n.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices}_calculateVertexCount(t){return t.byteLength/12}}function zU(e,t){if(t instanceof xb)return t;const n=VU(e,t),{attributes:s,bufferLayout:i}=HU(e,t);return new xb({topology:t.topology||"triangle-list",bufferLayout:i,vertexCount:t.vertexCount,indices:n,attributes:s})}function VU(e,t){if(!t.indices)return;const n=t.indices.value;return e.createBuffer({usage:fe.INDEX,data:n})}function HU(e,t){const n=[],s={};for(const[r,a]of Object.entries(t.attributes)){let l=r;switch(r){case"POSITION":l="positions";break;case"NORMAL":l="normals";break;case"TEXCOORD_0":l="texCoords";break;case"COLOR_0":l="colors";break}s[l]=e.createBuffer({data:a.value,id:`${r}-buffer`});const{value:h,size:d,normalized:g}=a;n.push({name:l,format:VI(h,d,g)})}const i=t._calculateVertexCount(t.attributes,t.indices);return{attributes:s,bufferLayout:n,vertexCount:i}}class jU{constructor(t){T(this,"modules");T(this,"moduleUniforms");T(this,"moduleBindings");T(this,"moduleUniformsChanged");const n=xd(Object.values(t).filter(s=>s.dependencies));for(const s of n)t[s.name]=s;ot.log(1,"Creating ShaderInputs with modules",Object.keys(t))(),this.modules=t,this.moduleUniforms={},this.moduleBindings={};for(const[s,i]of Object.entries(t)){const r=s;this.moduleUniforms[r]=i.defaultUniforms||{},this.moduleBindings[r]={}}}destroy(){}setProps(t){var n;for(const s of Object.keys(t)){const i=s,r=t[i],a=this.modules[i];if(!a){ot.warn(`Module ${s} not found`)();continue}const l=this.moduleUniforms[i],h=this.moduleBindings[i],d=((n=a.getUniforms)==null?void 0:n.call(a,r,l))||r,{uniforms:g,bindings:_}=jm(d);this.moduleUniforms[i]={...l,...g},this.moduleBindings[i]={...h,..._}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindings(){const t={};for(const n of Object.values(this.moduleBindings))Object.assign(t,n);return t}getDebugTable(){var n;const t={};for(const[s,i]of Object.entries(this.moduleUniforms))for(const[r,a]of Object.entries(i))t[`${s}.${r}`]={type:(n=this.modules[s].uniformTypes)==null?void 0:n[r],value:String(a)};return t}}const Cd=class Cd{constructor(t){T(this,"device");T(this,"_hashCounter",0);T(this,"_hashes",{});T(this,"_renderPipelineCache",{});T(this,"_computePipelineCache",{});this.device=t}static getDefaultPipelineFactory(t){return t._lumaData.defaultPipelineFactory=t._lumaData.defaultPipelineFactory||new Cd(t),t._lumaData.defaultPipelineFactory}createRenderPipeline(t){const n={...Ua.defaultProps,...t},s=this._hashRenderPipeline(n);if(!this._renderPipelineCache[s]){const i=this.device.createRenderPipeline({...n,id:n.id?`${n.id}-cached`:void 0});i.hash=s,this._renderPipelineCache[s]={pipeline:i,useCount:0}}return this._renderPipelineCache[s].useCount++,this._renderPipelineCache[s].pipeline}createComputePipeline(t){const n={...Gf.defaultProps,...t},s=this._hashComputePipeline(n);if(!this._computePipelineCache[s]){const i=this.device.createComputePipeline({...n,id:n.id?`${n.id}-cached`:void 0});i.hash=s,this._computePipelineCache[s]={pipeline:i,useCount:0}}return this._computePipelineCache[s].useCount++,this._computePipelineCache[s].pipeline}release(t){const n=t.hash,s=t instanceof Gf?this._computePipelineCache:this._renderPipelineCache;s[n].useCount--,s[n].useCount===0&&(s[n].pipeline.destroy(),delete s[n])}_hashComputePipeline(t){return`${this._getHash(t.shader.source)}`}_hashRenderPipeline(t){const n=this._getHash(t.vs.source),s=t.fs?this._getHash(t.fs.source):0,i="-",r=this._getHash(JSON.stringify(t.bufferLayout));switch(this.device.type){case"webgl":return`${n}/${s}V${i}BL${r}`;default:const a=this._getHash(JSON.stringify(t.parameters));return`${n}/${s}V${i}T${t.topology}P${a}BL${r}`}}_getHash(t){return this._hashes[t]===void 0&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}};T(Cd,"defaultProps",{...Ua.defaultProps});let q0=Cd;const Md=class Md{constructor(t){T(this,"device");T(this,"_cache",{});this.device=t}static getDefaultShaderFactory(t){var n;return(n=t._lumaData).defaultShaderFactory||(n.defaultShaderFactory=new Md(t)),t._lumaData.defaultShaderFactory}createShader(t){const n=this._hashShader(t);let s=this._cache[n];if(!s){const i=this.device.createShader({...t,id:t.id?`${t.id}-cached`:void 0});this._cache[n]=s={shader:i,useCount:0}}return s.useCount++,s.shader}release(t){const n=this._hashShader(t),s=this._cache[n];s&&(s.useCount--,s.useCount===0&&(delete this._cache[n],s.shader.destroy()))}_hashShader(t){return`${t.stage}:${t.source}`}};T(Md,"defaultProps",{...jf.defaultProps});let Y0=Md;function $U(e,t){var i;const n={},s="Values";if(e.attributes.length===0&&!((i=e.varyings)!=null&&i.length))return{"No attributes or varyings":{[s]:"N/A"}};for(const r of e.attributes)if(r){const a=`${r.location} ${r.name}: ${r.type}`;n[`in ${a}`]={[s]:r.stepMode||"vertex"}}for(const r of e.varyings||[]){const a=`${r.location} ${r.name}`;n[`out ${a}`]={[s]:JSON.stringify(r.accessor)}}return n}let Fe=null,A_=null;function XU(e,{id:t,minimap:n,opaque:s,top:i="0",left:r="0",rgbaScale:a=1}){Fe||(Fe=document.createElement("canvas"),Fe.id=t,Fe.title=t,Fe.style.zIndex="100",Fe.style.position="absolute",Fe.style.top=i,Fe.style.left=r,Fe.style.border="blue 1px solid",Fe.style.transform="scaleY(-1)",document.body.appendChild(Fe),A_=Fe.getContext("2d")),(Fe.width!==e.width||Fe.height!==e.height)&&(Fe.width=e.width/2,Fe.height=e.height/2,Fe.style.width="400px",Fe.style.height="400px");const l=e.device.readPixelsToArrayWebGL(e),h=A_.createImageData(e.width,e.height),d=0;for(let g=0;g<l.length;g+=4)h.data[d+g+0]=l[g+0]*a,h.data[d+g+1]=l[g+1]*a,h.data[d+g+2]=l[g+2]*a,h.data[d+g+3]=s?255:l[g+3]*a;A_.putImageData(h,0,0)}const da=2,GU=1e4,wd=class wd{constructor(t,n){T(this,"device");T(this,"id");T(this,"source");T(this,"vs");T(this,"fs");T(this,"pipelineFactory");T(this,"shaderFactory");T(this,"userData",{});T(this,"parameters");T(this,"topology");T(this,"bufferLayout");T(this,"isInstanced");T(this,"instanceCount",0);T(this,"vertexCount");T(this,"indexBuffer",null);T(this,"bufferAttributes",{});T(this,"constantAttributes",{});T(this,"bindings",{});T(this,"uniforms",{});T(this,"vertexArray");T(this,"transformFeedback",null);T(this,"pipeline");T(this,"shaderInputs");T(this,"_uniformStore");T(this,"_attributeInfos",{});T(this,"_gpuGeometry",null);T(this,"_getModuleUniforms");T(this,"props");T(this,"_pipelineNeedsUpdate","newly created");T(this,"_needsRedraw","initializing");T(this,"_destroyed",!1);T(this,"_lastDrawTimestamp",-1);T(this,"_lastLogTime",0);T(this,"_logOpen",!1);T(this,"_drawCount",0);var l,h,d,g;this.props={...wd.defaultProps,...n},n=this.props,this.id=n.id||yr("model"),this.device=t,Object.assign(this.userData,n.userData);const s=Object.fromEntries(((l=this.props.modules)==null?void 0:l.map(_=>[_.name,_]))||[]);this.setShaderInputs(n.shaderInputs||new jU(s));const i=WU(t),r=(((h=this.props.modules)==null?void 0:h.length)>0?this.props.modules:(d=this.shaderInputs)==null?void 0:d.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){(g=this.props).shaderLayout||(g.shaderLayout=BD(this.props.source));const{source:_,getUniforms:m}=this.props.shaderAssembler.assembleShader({platformInfo:i,...this.props,modules:r});this.source=_,this._getModuleUniforms=m}else{const{vs:_,fs:m,getUniforms:y}=this.props.shaderAssembler.assembleShaderPair({platformInfo:i,...this.props,modules:r});this.vs=_,this.fs=m,this._getModuleUniforms=y}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,n.geometry&&this.setGeometry(n.geometry),this.pipelineFactory=n.pipelineFactory||q0.getDefaultPipelineFactory(this.device),this.shaderFactory=n.shaderFactory||Y0.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=t.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in n&&(this.isInstanced=n.isInstanced),n.instanceCount&&this.setInstanceCount(n.instanceCount),n.vertexCount&&this.setVertexCount(n.vertexCount),n.indexBuffer&&this.setIndexBuffer(n.indexBuffer),n.attributes&&this.setAttributes(n.attributes),n.constantAttributes&&this.setConstantAttributes(n.constantAttributes),n.bindings&&this.setBindings(n.bindings),n.uniforms&&this.setUniforms(n.uniforms),n.moduleSettings&&this.updateModuleSettings(n.moduleSettings),n.transformFeedback&&(this.transformFeedback=n.transformFeedback),Object.seal(this)}destroy(){var t;this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),(t=this._gpuGeometry)==null||t.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const t=this._needsRedraw;return this._needsRedraw=!1,t}setNeedsRedraw(t){this._needsRedraw||(this._needsRedraw=t)}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(t){this.predraw();let n;try{this._logDrawCallStart(),this.pipeline=this._updatePipeline(),this.pipeline.setBindings(this.bindings,{disableWarnings:this.props.disableWarnings}),Vf(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);const{indexBuffer:s}=this.vertexArray,i=s?s.byteLength/(s.indexType==="uint32"?4:2):void 0;n=this.pipeline.draw({renderPass:t,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:i,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{this._logDrawCallEnd()}return this._logFramebuffer(t),n?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",n}setGeometry(t){var s;(s=this._gpuGeometry)==null||s.destroy();const n=t&&zU(this.device,t);n&&(this.setTopology(n.topology||"triangle-list"),this.bufferLayout=Nb(n.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(n)),this._gpuGeometry=n}setTopology(t){t!==this.topology&&(this.topology=t,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(t){this.bufferLayout=this._gpuGeometry?Nb(t,this._gpuGeometry.bufferLayout):t,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(t){U0(t,this.parameters,2)||(this.parameters=t,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(t){this.instanceCount=t,this.isInstanced===void 0&&t>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(t){this.vertexCount=t,this.setNeedsRedraw("vertexCount")}setShaderInputs(t){this.shaderInputs=t,this._uniformStore=new zI(this.shaderInputs.modules);for(const n of Object.keys(this.shaderInputs.modules)){const s=this._uniformStore.getManagedUniformBuffer(this.device,n);this.bindings[`${n}Uniforms`]=s}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindings()),this.setNeedsRedraw("shaderInputs")}setBindings(t){Object.assign(this.bindings,t),this.setNeedsRedraw("bindings")}setTransformFeedback(t){this.transformFeedback=t,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(t){this.vertexArray.setIndexBuffer(t),this.setNeedsRedraw("indexBuffer")}setAttributes(t,n){t.indices&&ot.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)();for(const[s,i]of Object.entries(t)){const r=this.bufferLayout.find(h=>Ib(h).includes(s));if(!r){ot.warn(`Model(${this.id}): Missing layout for buffer "${s}".`)();continue}const a=Ib(r);let l=!1;for(const h of a){const d=this._attributeInfos[h];d&&(this.vertexArray.setBuffer(d.location,i),l=!0)}!l&&!((n==null?void 0:n.disableWarnings)??this.props.disableWarnings)&&ot.warn(`Model(${this.id}): Ignoring buffer "${i.id}" for unknown attribute "${s}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(t,n){for(const[s,i]of Object.entries(t)){const r=this._attributeInfos[s];r?this.vertexArray.setConstantWebGL(r.location,i):((n==null?void 0:n.disableWarnings)??this.props.disableWarnings)||ot.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${s}"`)()}this.setNeedsRedraw("constants")}setUniforms(t){Vf(t)||(this.pipeline.setUniformsWebGL(t),Object.assign(this.uniforms,t)),this.setNeedsRedraw("uniforms")}updateModuleSettings(t){const{bindings:n,uniforms:s}=jm(this._getModuleUniforms(t));Object.assign(this.bindings,n),Object.assign(this.uniforms,s),this.setNeedsRedraw("moduleSettings")}_getBindingsUpdateTimestamp(){let t=0;for(const n of Object.values(this.bindings))n instanceof Hf?t=Math.max(t,n.texture.updateTimestamp):n instanceof fe||n instanceof kn?t=Math.max(t,n.updateTimestamp):n instanceof $f||(t=Math.max(t,n.buffer.updateTimestamp));return t}_setGeometryAttributes(t){const n={...t.attributes};for(const[s]of Object.entries(n))!this.pipeline.shaderLayout.attributes.find(i=>i.name===s)&&s!=="positions"&&delete n[s];this.vertexCount=t.vertexCount,this.setIndexBuffer(t.indices||null),this.setAttributes(t.attributes,{disableWarnings:!0}),this.setAttributes(n,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(t){this._pipelineNeedsUpdate||(this._pipelineNeedsUpdate=t),this.setNeedsRedraw(t)}_updatePipeline(){if(this._pipelineNeedsUpdate){let t=null,n=null;this.pipeline&&(ot.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),t=this.pipeline.vs,n=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const s=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debug:this.props.debugShaders});let i=null;this.source?i=s:this.fs&&(i=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debug:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,vs:s,fs:i}),this._attributeInfos=nR(this.pipeline.shaderLayout,this.bufferLayout),t&&this.shaderFactory.release(t),n&&this.shaderFactory.release(n)}return this.pipeline}_logDrawCallStart(){const t=ot.level>3?0:GU;ot.level<2||Date.now()-this._lastLogTime<t||(this._lastLogTime=Date.now(),this._logOpen=!0,ot.group(da,`>>> DRAWING MODEL ${this.id}`,{collapsed:ot.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const t=$U(this.pipeline.shaderLayout,this.id);ot.table(da,t)();const n=this.shaderInputs.getDebugTable();for(const[i,r]of Object.entries(this.uniforms))n[i]={value:r};ot.table(da,n)();const s=this._getAttributeDebugTable();ot.table(da,this._attributeInfos)(),ot.table(da,s)(),ot.groupEnd(da)(),this._logOpen=!1}}_logFramebuffer(t){const n=ot.get("framebuffer");if(this._drawCount++,!n||this._drawCount++>3&&this._drawCount%60)return;const s=t.props.framebuffer;s&&XU(s,{id:s.id,minimap:!0})}_getAttributeDebugTable(){const t={};for(const[n,s]of Object.entries(this._attributeInfos))t[s.location]={name:n,type:s.shaderType,values:this._getBufferOrConstantValues(this.vertexArray.attributes[s.location],s.bufferDataType)};if(this.vertexArray.indexBuffer){const{indexBuffer:n}=this.vertexArray,s=n.indexType==="uint32"?new Uint32Array(n.debugData):new Uint16Array(n.debugData);t.indices={name:"indices",type:n.indexType,values:s.toString()}}return t}_getBufferOrConstantValues(t,n){const s=rR(n);return(t instanceof fe?new s(t.debugData):t).toString()}};T(wd,"defaultProps",{...Ua.defaultProps,source:null,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:zf.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0});let pr=wd;function Nb(e,t){const n=[...e];for(const s of t){const i=n.findIndex(r=>r.name===s.name);i<0?n.push(s):n[i]=s}return n}function WU(e){return{type:e.type,shaderLanguage:e.info.shadingLanguage,shaderLanguageVersion:e.info.shadingLanguageVersion,gpu:e.info.gpu,features:e.features}}function Ib(e){var t;return e.attributes?(t=e.attributes)==null?void 0:t.map(n=>n.attribute):[e.name]}class kl{constructor(t,n=pr.defaultProps){T(this,"device");T(this,"model");T(this,"transformFeedback");Ht(kl.isSupported(t),"BufferTransform not yet implemented on WebGPU"),this.device=t,this.model=new pr(this.device,{id:n.id||"buffer-transform-model",fs:n.fs||HN(),topology:n.topology||"point-list",...n}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:n.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}static isSupported(t){var n;return((n=t==null?void 0:t.info)==null?void 0:n.type)==="webgl"}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(t){const n=this.device.beginRenderPass(t);this.model.draw(n),n.end()}update(...t){console.warn("TextureTransform#update() not implemented")}getBuffer(t){return this.transformFeedback.getBuffer(t)}readAsync(t){const n=this.getBuffer(t);if(n instanceof fe)return n.readAsync();const{buffer:s,byteOffset:i=0,byteLength:r=s.byteLength}=n;return s.readAsync(i,r)}}class Na{constructor(t){T(this,"id");T(this,"topology");T(this,"vertexCount");T(this,"indices");T(this,"attributes");T(this,"userData",{});const{attributes:n={},indices:s=null,vertexCount:i=null}=t;this.id=t.id||yr("geometry"),this.topology=t.topology,s&&(this.indices=ArrayBuffer.isView(s)?{value:s,size:1}:s),this.attributes={};for(const[r,a]of Object.entries(n)){const l=ArrayBuffer.isView(a)?{value:a}:a;Ht(ArrayBuffer.isView(l.value),`${this._print(r)}: must be typed array or object with value as typed array`),(r==="POSITION"||r==="positions")&&!l.size&&(l.size=3),r==="indices"?(Ht(!this.indices),this.indices=l):this.attributes[r]=l}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=i||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return`Geometry ${this.id} attribute ${t}`}_setAttributes(t,n){return this}_calculateVertexCount(t,n){if(n)return n.value.length;let s=1/0;for(const i of Object.values(t)){const{value:r,size:a,constant:l}=i;!l&&r&&a>=1&&(s=Math.min(s,r.length/a))}return Ht(Number.isFinite(s)),s}}class Zf{constructor(t={}){T(this,"id");T(this,"matrix",new nn);T(this,"display",!0);T(this,"position",new Tn);T(this,"rotation",new Tn);T(this,"scale",new Tn(1,1,1));T(this,"userData",{});T(this,"props",{});const{id:n}=t;this.id=n||yr(this.constructor.name),this._setScenegraphNodeProps(t)}getBounds(){return null}destroy(){}delete(){this.destroy()}setProps(t){return this._setScenegraphNodeProps(t),this}toString(){return`{type: ScenegraphNode, id: ${this.id})}`}setPosition(t){return Ht(t.length===3,"setPosition requires vector argument"),this.position=t,this}setRotation(t){return Ht(t.length===3,"setRotation requires vector argument"),this.rotation=t,this}setScale(t){return Ht(t.length===3,"setScale requires vector argument"),this.scale=t,this}setMatrix(t,n=!0){n?this.matrix.copy(t):this.matrix=t}setMatrixComponents(t){const{position:n,rotation:s,scale:i,update:r=!0}=t;return n&&this.setPosition(n),s&&this.setRotation(s),i&&this.setScale(i),r&&this.updateMatrix(),this}updateMatrix(){const t=this.position,n=this.rotation,s=this.scale;return this.matrix.identity(),this.matrix.translate(t),this.matrix.rotateXYZ(n),this.matrix.scale(s),this}update(t={}){const{position:n,rotation:s,scale:i}=t;return n&&this.setPosition(n),s&&this.setRotation(s),i&&this.setScale(i),this.updateMatrix(),this}getCoordinateUniforms(t,n){Ht(t),n=n||this.matrix;const s=new nn(t).multiplyRight(n),i=s.invert(),r=i.transpose();return{viewMatrix:t,modelMatrix:n,objectMatrix:n,worldMatrix:s,worldInverseMatrix:i,worldInverseTransposeMatrix:r}}_setScenegraphNodeProps(t){"display"in t&&(this.display=t.display),"position"in t&&this.setPosition(t.position),"rotation"in t&&this.setRotation(t.rotation),"scale"in t&&this.setScale(t.scale),"matrix"in t&&this.setMatrix(t.matrix),Object.assign(this.props,t)}}class Ia extends Zf{constructor(n={}){n=Array.isArray(n)?{children:n}:n;const{children:s=[]}=n;ot.assert(s.every(i=>i instanceof Zf),"every child must an instance of ScenegraphNode");super(n);T(this,"children");this.children=s}getBounds(){const n=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];return this.traverse((s,{worldMatrix:i})=>{const r=s.getBounds();if(!r)return;const[a,l]=r,h=new Tn(a).add(l).divide([2,2,2]);i.transformAsPoint(h,h);const d=new Tn(l).subtract(a).divide([2,2,2]);i.transformAsVector(d,d);for(let g=0;g<8;g++){const _=new Tn(g&1?-1:1,g&2?-1:1,g&4?-1:1).multiply(d).add(h);for(let m=0;m<3;m++)n[0][m]=Math.min(n[0][m],_[m]),n[1][m]=Math.max(n[1][m],_[m])}}),Number.isFinite(n[0][0])?n:null}destroy(){this.children.forEach(n=>n.destroy()),this.removeAll(),super.destroy()}add(...n){for(const s of n)Array.isArray(s)?this.add(...s):this.children.push(s);return this}remove(n){const s=this.children,i=s.indexOf(n);return i>-1&&s.splice(i,1),this}removeAll(){return this.children=[],this}traverse(n,{worldMatrix:s=new nn}={}){const i=new nn(s).multiplyRight(this.matrix);for(const r of this.children)r instanceof Ia?r.traverse(n,{worldMatrix:i}):n(r,{worldMatrix:i})}}class K0 extends Zf{constructor(n){super(n);T(this,"model");T(this,"bounds",null);T(this,"managedResources");this.model=n.model,this.managedResources=n.managedResources||[],this.bounds=n.bounds||null,this.setProps(n)}getBounds(){return this.bounds}destroy(){this.model&&(this.model.destroy(),this.model=null),this.managedResources.forEach(n=>n.destroy()),this.managedResources=[]}draw(n){return this.model.draw(n)}}const qU={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"};class $R extends Qm{constructor(){super(...arguments),this._colorEncoderState=null}render(t){return"pickingFBO"in t?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer({layers:t,layerFilter:n,views:s,viewports:i,onViewportActive:r,pickingFBO:a,deviceRect:{x:l,y:h,width:d,height:g},cullRect:_,effects:m,pass:y="picking",pickZ:E,moduleParameters:b}){this.pickZ=E;const R=this._resetColorEncoder(E),M=[l,h,d,g],N=super.render({target:a,layers:t,layerFilter:n,views:s,viewports:i,onViewportActive:r,cullRect:_,effects:m==null?void 0:m.filter(x=>x.useInPicking),pass:y,isPicking:!0,moduleParameters:b,clearColor:[0,0,0,0],colorMask:15,scissorRect:M});return this._colorEncoderState=null,{decodePickingColor:R&&KU.bind(null,R),stats:N}}shouldDrawLayer(t){const{pickable:n,operation:s}=t.props;return n&&s.includes("draw")||s.includes("terrain")||s.includes("mask")}getModuleParameters(){return{picking:{isActive:1,isAttribute:this.pickZ},lightSources:{}}}getLayerParameters(t,n,s){const i={depthMask:!0,depthTest:!0,depthRange:[0,1],...t.props.parameters},{pickable:r,operation:a}=t.props;return!this._colorEncoderState||a.includes("terrain")?i.blend=!1:r&&a.includes("draw")&&(Object.assign(i,qU),i.blend=!0,i.blendColor=YU(this._colorEncoderState,t,s)),i}_resetColorEncoder(t){return this._colorEncoderState=t?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function YU(e,t,n){const{byLayer:s,byAlpha:i}=e;let r,a=s.get(t);return a?(a.viewports.push(n),r=a.a):(r=s.size+1,r<=255?(a={a:r,layer:t,viewports:[n]},s.set(t,a),i[r]=a):(kt.warn("Too many pickable layers, only picking the first 255")(),r=0)),[0,0,0,r/255]}function KU(e,t){const n=e.byAlpha[t[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(t)}}const Aa={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},Qf=Symbol.for("component"),hr=Symbol.for("propTypes"),y_=Symbol.for("deprecatedProps"),Da=Symbol.for("asyncPropDefaults"),oo=Symbol.for("asyncPropOriginal"),lr=Symbol.for("asyncPropResolved");function Ha(e,t=()=>!0){return Array.isArray(e)?XR(e,t,[]):t(e)?[e]:[]}function XR(e,t,n){let s=-1;for(;++s<e.length;){const i=e[s];Array.isArray(i)?XR(i,t,n):t(i)&&n.push(i)}return n}function JU({target:e,source:t,start:n=0,count:s=1}){const i=t.length,r=s*i;let a=0;for(let l=n;a<i;a++)e[l++]=t[a];for(;a<r;)a<r-a?(e.copyWithin(n+a,n,n+a),a*=2):(e.copyWithin(n+a,n,n+r-a),a=r);return e}class ZU{constructor(t,n,s){this._loadCount=0,this._subscribers=new Set,this.id=t,this.context=s,this.setData(n)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(t,n){if(t===this._data&&!n)return;this._data=t;const s=++this._loadCount;let i=t;typeof t=="string"&&(i=gr(t)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(r=>{this._loadCount===s&&(this.isLoaded=!0,this._error=void 0,this._content=r)}).catch(r=>{this._loadCount===s&&(this.isLoaded=!0,this._error=r||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=t);for(const r of this._subscribers)r.onChange(this.getData())}}class QU{constructor(t){var n;this.protocol=t.protocol||"resource://",this._context={device:t.device,gl:(n=t.device)==null?void 0:n.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return t.startsWith(this.protocol)?!0:t in this._resources}add({resourceId:t,data:n,forceUpdate:s=!1,persistent:i=!0}){let r=this._resources[t];r?r.setData(n,s):(r=new ZU(t,n,this._context),this._resources[t]=r),r.persistent=i}remove(t){const n=this._resources[t];n&&(n.delete(),delete this._resources[t])}unsubscribe({consumerId:t}){const n=this._consumers[t];if(n){for(const s in n){const i=n[s],r=this._resources[i.resourceId];r&&r.unsubscribe(i)}delete this._consumers[t],this.prune()}}subscribe({resourceId:t,onChange:n,consumerId:s,requestId:i="default"}){const{_resources:r,protocol:a}=this;t.startsWith(a)&&(t=t.replace(a,""),r[t]||this.add({resourceId:t,data:null,persistent:!1}));const l=r[t];if(this._track(s,i,l,n),l)return l.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,n,s,i){const r=this._consumers,a=r[t]=r[t]||{};let l=a[n];const h=l&&l.resourceId&&this._resources[l.resourceId];h&&(h.unsubscribe(l),this.prune()),s&&(l?(l.onChange=i,l.resourceId=s.id):l={onChange:i,resourceId:s.id},a[n]=l,s.subscribe(l))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const n=this._resources[t];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[t])}}}const t4="layerManager.setLayers",e4="layerManager.activateViewport";class n4{constructor(t,n){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=l=>{Qe(e4,this,l),l&&(this.context.viewport=l)};const{deck:s,stats:i,viewport:r,timeline:a}=n||{};this.layers=[],this.resourceManager=new QU({device:t,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:t,gl:t==null?void 0:t.gl,deck:s,shaderAssembler:uU(),defaultShaderModules:[],renderPass:void 0,stats:i||new Za({id:"deck.gl"}),viewport:r||new Ql({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:a||new jR,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(t={clearRedrawFlags:!1}){let n=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const s of this.layers){const i=s.getNeedsRedraw(t);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers({layerIds:t}={}){return t?this.layers.filter(n=>t.find(s=>n.id.indexOf(s)===0)):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,n){Qe(t4,this,n,t),this._lastRenderedLayers=t;const s=Ha(t,Boolean);for(const i of s)i.context=this.context;this._updateLayers(this.layers,s)}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw(`updating layers: ${t}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,t)),this._nextLayers=null}addDefaultShaderModule(t){const{defaultShaderModules:n}=this.context;n.find(s=>s.name===t.name)||(n.push(t),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(t){const{defaultShaderModules:n}=this.context,s=n.findIndex(i=>i.name===t.name);s>=0&&(n.splice(s,1),this._defaultShaderModulesChanged=!0)}_handleError(t,n,s){s.raiseError(n,`${t} of ${s}`)}_updateLayers(t,n){const s={};for(const a of t)s[a.id]?kt.warn(`Multiple old layers with same id ${a.id}`)():s[a.id]=a;if(this._defaultShaderModulesChanged){for(const a of t)a.setNeedsUpdate(),a.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const i=[];this._updateSublayersRecursively(n,s,i),this._finalizeOldLayers(s);let r=!1;for(const a of i)if(a.hasUniformTransition()){r=`Uniform transition in ${a}`;break}this._needsUpdate=r,this.layers=i}_updateSublayersRecursively(t,n,s){for(const i of t){i.context=this.context;const r=n[i.id];r===null&&kt.warn(`Multiple new layers with same id ${i.id}`)(),n[i.id]=null;let a=null;try{this._debug&&r!==i&&i.validateProps(),r?(this._transferLayerState(r,i),this._updateLayer(i)):this._initializeLayer(i),s.push(i),a=i.isComposite?i.getSubLayers():null}catch(l){this._handleError("matching",l,i)}a&&this._updateSublayersRecursively(a,n,s)}}_finalizeOldLayers(t){for(const n in t){const s=t[n];s&&this._finalizeLayer(s)}}_initializeLayer(t){try{t._initialize(),t.lifecycle=Aa.INITIALIZED}catch(n){this._handleError("initialization",n,t)}}_transferLayerState(t,n){n._transferState(t),n.lifecycle=Aa.MATCHED,n!==t&&(t.lifecycle=Aa.AWAITING_GC)}_updateLayer(t){try{t._update()}catch(n){this._handleError("update",n,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||`finalized ${t}`,t.lifecycle=Aa.AWAITING_FINALIZATION;try{t._finalize(),t.lifecycle=Aa.FINALIZED}catch(n){this._handleError("finalization",n,t)}}}function fs(e,t,n){if(e===t)return!0;if(!n||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let s=0;s<e.length;s++)if(!fs(e[s],t[s],n-1))return!1;return!0}if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const s=Object.keys(e),i=Object.keys(t);if(s.length!==i.length)return!1;for(const r of s)if(!t.hasOwnProperty(r)||!fs(e[r],t[r],n-1))return!1;return!0}return!1}class s4{constructor(t){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers){const n=this.controllers[t];n&&n.finalize()}this.controllers={}}needsRedraw(t={clearRedrawFlags:!1}){const n=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const n=this.controllers[t];n&&n.updateTransition()}}getViewports(t){return t?this._viewports.filter(n=>n.containsPixel(t)):this._viewports}getViews(){const t={};return this.views.forEach(n=>{t[n.id]=n}),t}getView(t){return this.views.find(n=>n.id===t)}getViewState(t){const n=typeof t=="string"?this.getView(t):t,s=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(s):s}getViewport(t){return this._viewportMap[t]}unproject(t,n){const s=this.getViewports(),i={x:t[0],y:t[1]};for(let r=s.length-1;r>=0;--r){const a=s[r];if(a.containsPixel(i)){const l=t.slice();return l[0]-=a.x,l[1]-=a.y,a.unproject(l,n)}}return null}setProps(t){t.views&&this._setViews(t.views),t.viewState&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,n){(t!==this.width||n!==this.height)&&(this.width=t,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(t){t=Ha(t,Boolean),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){t?(!fs(t,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):kt.warn("missing `viewState` or `initialViewState`")()}_createController(t,n){const s=n.type;return new s({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:r=>{var a;return(a=this.getView(t.id))==null?void 0:a.makeViewport({viewState:r,width:this.width,height:this.height})}})}_updateController(t,n,s,i){const r=t.controller;if(r&&s){const a={...n,...r,id:t.id,x:s.x,y:s.y,width:s.width,height:s.height};return(!i||i.constructor!==r.type)&&(i=this._createController(t,a)),i&&i.setProps(a),i}return null}_rebuildViewports(){const{views:t}=this,n=this.controllers;this._viewports=[],this.controllers={};let s=!1;for(let i=t.length;i--;){const r=t[i],a=this.getViewState(r),l=r.makeViewport({viewState:a,width:this.width,height:this.height});let h=n[r.id];const d=!!r.controller;d&&!h&&(s=!0),(s||!d)&&h&&(h.finalize(),h=null),this.controllers[r.id]=this._updateController(r,a,l,h),l&&this._viewports.unshift(l)}for(const i in n){const r=n[i];r&&!this.controllers[i]&&r.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)})}_diffViews(t,n){return t.length!==n.length?!0:t.some((s,i)=>!t[i].equals(n[i]))}}const i4=/([0-9]+\.?[0-9]*)(%|px)/;function Qi(e){switch(typeof e){case"number":return{position:e,relative:!1};case"string":const t=i4.exec(e);if(t&&t.length>=3){const n=t[2]==="%",s=parseFloat(t[1]);return{position:n?s/100:s,relative:n}}default:throw new Error(`Could not parse position string ${e}`)}}function tr(e,t){return e.relative?Math.round(e.position*t):e.position}class r4{constructor(t){const{id:n,x:s=0,y:i=0,width:r="100%",height:a="100%",padding:l=null}=t;this.id=n||this.constructor.displayName||"view",this.props={...t,id:this.id},this._x=Qi(s),this._y=Qi(i),this._width=Qi(r),this._height=Qi(a),this._padding=l&&{left:Qi(l.left||0),right:Qi(l.right||0),top:Qi(l.top||0),bottom:Qi(l.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t?!0:this.ViewportType===t.ViewportType&&fs(this.props,t.props,2)}makeViewport({width:t,height:n,viewState:s}){s=this.filterViewState(s);const i=this.getDimensions({width:t,height:n});return!i.height||!i.width?null:new this.ViewportType({...s,...this.props,...i})}getViewStateId(){const{viewState:t}=this.props;return typeof t=="string"?t:(t==null?void 0:t.id)||this.id}filterViewState(t){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...t};for(const s in this.props.viewState)s!=="id"&&(n[s]=this.props.viewState[s]);return n}return t}getDimensions({width:t,height:n}){const s={x:tr(this._x,t),y:tr(this._y,n),width:tr(this._width,t),height:tr(this._height,n)};return this._padding&&(s.padding={left:tr(this._padding.left,t),top:tr(this._padding.top,n),right:tr(this._padding.right,t),bottom:tr(this._padding.bottom,n)}),s}get controller(){const t=this.props.controller;return t?t===!0?{type:this.ControllerType}:typeof t=="function"?{type:t}:{type:this.ControllerType,...t}:null}}class Dd{constructor(t){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=t}get inProgress(){return this._inProgress}start(t){var n,s;this.cancel(),this.settings=t,this._inProgress=!0,(s=(n=this.settings).onStart)==null||s.call(n,this)}end(){var t,n;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(n=(t=this.settings).onEnd)==null||n.call(t,this))}cancel(){var t,n;this._inProgress&&((n=(t=this.settings).onInterrupt)==null||n.call(t,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var t,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:s,settings:i}=this;this._handle=s.addChannel({delay:s.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(n=(t=this.settings).onUpdate)==null||n.call(t,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Db=()=>{},J0={BREAK:1,SNAP_TO_END:2,IGNORE:3},o4=e=>e,a4=J0.BREAK;class c4{constructor(t){this._onTransitionUpdate=n=>{const{time:s,settings:{interpolator:i,startProps:r,endProps:a,duration:l,easing:h}}=n,d=h(s/l),g=i.interpolateProps(r,a,d);this.propsInTransition=this.getControllerState({...this.props,...g}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=t.getControllerState,this.propsInTransition=null,this.transition=new Dd(t.timeline),this.onViewStateChange=t.onViewStateChange||Db,this.onStateChange=t.onStateChange||Db}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let n=!1;const s=this.props;if(this.props=t,!s||this._shouldIgnoreViewportChange(s,t))return!1;if(this._isTransitionEnabled(t)){let i=s;if(this.transition.inProgress){const{interruption:r,endProps:a}=this.transition.settings;i={...s,...r===J0.SNAP_TO_END?a:this.propsInTransition||s}}this._triggerTransition(i,t),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:n,transitionInterpolator:s}=t;return(n>0||n==="auto")&&!!s}_isUpdateDueToCurrentTransition(t){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition):!1}_shouldIgnoreViewportChange(t,n){return this.transition.inProgress?this.transition.settings.interruption===J0.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(t,n):!0}_triggerTransition(t,n){const s=this.getControllerState(t),i=this.getControllerState(n).shortestPathFrom(s),r=n.transitionInterpolator,a=r.getDuration?r.getDuration(t,n):n.transitionDuration;if(a===0)return;const l=r.initializeProps(t,i);this.propsInTransition={};const h={duration:a,easing:n.transitionEasing||o4,interpolator:r,interruption:n.transitionInterruption||a4,startProps:l.start,endProps:l.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(h),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),t==null||t(n)}}}function Be(e,t){if(!e)throw new Error(t||"deck.gl: assertion failed.")}class l4{constructor(t){const{compare:n,extract:s,required:i}=t;this._propsToCompare=n,this._propsToExtract=s||n,this._requiredProps=i}arePropsEqual(t,n){for(const s of this._propsToCompare)if(!(s in t)||!(s in n)||!Fl(t[s],n[s]))return!1;return!0}initializeProps(t,n){const s={},i={};for(const r of this._propsToExtract)(r in t||r in n)&&(s[r]=t[r],i[r]=n[r]);return this._checkRequiredProps(s),this._checkRequiredProps(i),{start:s,end:i}}getDuration(t,n){return n.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach(n=>{const s=t[n];Be(Number.isFinite(s)||Array.isArray(s),`${n} is required for transition`)})}}const u4=["longitude","latitude","zoom","bearing","pitch"],h4=["longitude","latitude","zoom"];class GR extends l4{constructor(t={}){const n=Array.isArray(t)?t:t.transitionProps,s=Array.isArray(t)?{}:t;s.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:u4,required:h4},super(s.transitionProps),this.opts=s}initializeProps(t,n){const s=super.initializeProps(t,n),{makeViewport:i,around:r}=this.opts;if(i&&r){const a=i(t),l=i(n),h=a.unproject(r);s.start.around=r,Object.assign(s.end,{around:l.project(h),aroundPosition:h,width:n.width,height:n.height})}return s}interpolateProps(t,n,s){const i={};for(const r of this._propsToExtract)i[r]=Yf(t[r]||0,n[r]||0,s);if(n.aroundPosition&&this.opts.makeViewport){const r=this.opts.makeViewport({...n,...i});Object.assign(i,r.panByPosition(n.aroundPosition,Yf(t.around,n.around,s)))}return i}}const er={transitionDuration:0},f4=300,Nh=e=>1-(1-e)*(1-e),ga={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},jr={};class d4{constructor(t){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new c4({...t,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=t.eventManager,this.onViewStateChange=t.onViewStateChange||(()=>{}),this.onStateChange=t.onStateChange||(()=>{}),this.makeViewport=t.makeViewport}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.props&&this.setProps(this.props)}finalize(){var t;for(const n in this._events)this._events[n]&&((t=this.eventManager)==null||t.off(n,this.handleEvent));this.transitionManager.finalize()}handleEvent(t){this._controllerState=void 0;const n=this._eventStartBlocked;switch(t.type){case"panstart":return n?!1:this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return n?!1:this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return n?!1:this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(t){const{x:n,y:s}=this.props,{offsetCenter:i}=t;return[i.x-n,i.y-s]}isPointInBounds(t,n){const{width:s,height:i}=this.props;if(n&&n.handled)return!1;const r=t[0]>=0&&t[0]<=s&&t[1]>=0&&t[1]<=i;return r&&n&&n.stopPropagation(),r}isFunctionKeyPressed(t){const{srcEvent:n}=t;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(t){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},t);this._eventStartBlocked=n}setProps(t){t.dragMode&&(this.dragMode=t.dragMode),this.props=t,"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);const{inertia:n}=t;this.inertia=Number.isFinite(n)?n:n===!0?f4:0;const{scrollZoom:s=!0,dragPan:i=!0,dragRotate:r=!0,doubleClickZoom:a=!0,touchZoom:l=!0,touchRotate:h=!1,keyboard:d=!0}=t,g=!!this.onViewStateChange;this.toggleEvents(ga.WHEEL,g&&s),this.toggleEvents(ga.PAN,g),this.toggleEvents(ga.PINCH,g&&(l||h)),this.toggleEvents(ga.TRIPLE_PAN,g&&h),this.toggleEvents(ga.DOUBLE_TAP,g&&a),this.toggleEvents(ga.KEYBOARD,g&&d),this.scrollZoom=s,this.dragPan=i,this.dragRotate=r,this.doubleClickZoom=a,this.touchZoom=l,this.touchRotate=h,this.keyboard=d}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,n){this.eventManager&&t.forEach(s=>{this._events[s]!==n&&(this._events[s]=n,n?this.eventManager.on(s,this.handleEvent):this.eventManager.off(s,this.handleEvent))})}updateViewport(t,n=null,s={}){const i={...t.getViewportProps(),...n},r=this.controllerState!==t;if(this.state=t.getState(),this._setInteractionState(s),r){const a=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:a,viewId:this.props.id})}}_onTransition(t){this.onViewStateChange({...t,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange(this._interactionState)}_onPanStart(t){const n=this.getCenter(t);if(!this.isPointInBounds(n,t))return!1;let s=this.isFunctionKeyPressed(t)||t.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(s=!s);const i=this.controllerState[s?"panStart":"rotateStart"]({pos:n});return this._panMove=s,this.updateViewport(i,er,{isDragging:!0}),!0}_onPan(t){return this.isDragging()?this._panMove?this._onPanMove(t):this._onPanRotate(t):!1}_onPanEnd(t){return this.isDragging()?this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t):!1}_onPanMove(t){if(!this.dragPan)return!1;const n=this.getCenter(t),s=this.controllerState.pan({pos:n});return this.updateViewport(s,er,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:n}=this;if(this.dragPan&&n&&t.velocity){const s=this.getCenter(t),i=[s[0]+t.velocityX*n/2,s[1]+t.velocityY*n/2],r=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Nh},{isDragging:!1,isPanning:!0})}else{const s=this.controllerState.panEnd();this.updateViewport(s,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const n=this.getCenter(t),s=this.controllerState.rotate({pos:n});return this.updateViewport(s,er,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:n}=this;if(this.dragRotate&&n&&t.velocity){const s=this.getCenter(t),i=[s[0]+t.velocityX*n/2,s[1]+t.velocityY*n/2],r=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Nh},{isDragging:!1,isRotating:!0})}else{const s=this.controllerState.rotateEnd();this.updateViewport(s,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;const n=this.getCenter(t);if(!this.isPointInBounds(n,t))return!1;t.srcEvent.preventDefault();const{speed:s=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:r}=t;let a=2/(1+Math.exp(-Math.abs(r*s)));r<0&&a!==0&&(a=1/a);const l=this.controllerState.zoom({pos:n,scale:a});return this.updateViewport(l,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const n=this.getCenter(t);if(!this.isPointInBounds(n,t))return!1;const s=this.controllerState.rotateStart({pos:n});return this.updateViewport(s,er,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(t);n[0]-=t.deltaX;const s=this.controllerState.rotate({pos:n});return this.updateViewport(s,er,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&t.velocityY){const s=this.getCenter(t),i=[s[0],s[1]+=t.velocityY*n/2],r=this.controllerState.rotate({pos:i});this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Nh},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const s=this.controllerState.rotateEnd();this.updateViewport(s,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const n=this.getCenter(t);if(!this.isPointInBounds(n,t))return!1;const s=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return jr._startPinchRotation=t.rotation,jr._lastPinchEvent=t,this.updateViewport(s,er,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:s}=t,i=this.getCenter(t);n=n.zoom({pos:i,scale:s})}if(this.touchRotate){const{rotation:s}=t;n=n.rotate({deltaAngleX:jr._startPinchRotation-s})}return this.updateViewport(n,er,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),jr._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:s}=jr;if(this.touchZoom&&n&&s&&t.scale!==s.scale){const i=this.getCenter(t);let r=this.controllerState.rotateEnd();const a=Math.log2(t.scale),l=(a-Math.log2(s.scale))/(t.deltaTime-s.deltaTime),h=Math.pow(2,a+l*n/2);r=r.zoom({pos:i,scale:h}).zoomEnd(),this.updateViewport(r,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:Nh},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return jr._startPinchRotation=null,jr._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const n=this.getCenter(t);if(!this.isPointInBounds(n,t))return!1;const s=this.isFunctionKeyPressed(t),i=this.controllerState.zoom({pos:n,scale:s?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(t),{zoomSpeed:s,moveSpeed:i,rotateSpeedX:r,rotateSpeedY:a}=this.keyboard===!0?{}:this.keyboard,{controllerState:l}=this;let h;const d={};switch(t.srcEvent.code){case"Minus":h=n?l.zoomOut(s).zoomOut(s):l.zoomOut(s),d.isZooming=!0;break;case"Equal":h=n?l.zoomIn(s).zoomIn(s):l.zoomIn(s),d.isZooming=!0;break;case"ArrowLeft":n?(h=l.rotateLeft(r),d.isRotating=!0):(h=l.moveLeft(i),d.isPanning=!0);break;case"ArrowRight":n?(h=l.rotateRight(r),d.isRotating=!0):(h=l.moveRight(i),d.isPanning=!0);break;case"ArrowUp":n?(h=l.rotateUp(a),d.isRotating=!0):(h=l.moveUp(i),d.isPanning=!0);break;case"ArrowDown":n?(h=l.rotateDown(a),d.isRotating=!0):(h=l.moveDown(i),d.isPanning=!0);break;default:return!1}return this.updateViewport(h,this._getTransitionProps(),d),!0}_getTransitionProps(t){const{transition:n}=this;return!n||!n.transitionInterpolator?er:t?{...n,transitionInterpolator:new GR({...t,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class g4{constructor(t,n){this._viewportProps=this.applyConstraints(t),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const Pb=5,p4=1.2;class _4 extends g4{constructor(t){const{width:n,height:s,latitude:i,longitude:r,zoom:a,bearing:l=0,pitch:h=0,altitude:d=1.5,position:g=[0,0,0],maxZoom:_=20,minZoom:m=0,maxPitch:y=60,minPitch:E=0,startPanLngLat:b,startZoomLngLat:R,startRotatePos:M,startBearing:N,startPitch:O,startZoom:x,normalize:I=!0}=t;Be(Number.isFinite(r)),Be(Number.isFinite(i)),Be(Number.isFinite(a)),super({width:n,height:s,latitude:i,longitude:r,zoom:a,bearing:l,pitch:h,altitude:d,maxZoom:_,minZoom:m,maxPitch:y,minPitch:E,normalize:I,position:g},{startPanLngLat:b,startZoomLngLat:R,startRotatePos:M,startBearing:N,startPitch:O,startZoom:x}),this.makeViewport=t.makeViewport}panStart({pos:t}){return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:n}){const s=this.getState().startPanLngLat||this._unproject(n);if(!s)return this;const r=this.makeViewport(this.getViewportProps()).panByPosition(s,t);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:t,deltaAngleX:n=0,deltaAngleY:s=0}){const{startRotatePos:i,startBearing:r,startPitch:a}=this.getState();if(!i||r===void 0||a===void 0)return this;let l;return t?l=this._getNewRotation(t,i,a,r):l={bearing:r+n,pitch:a+s},this._getUpdatedState(l)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom({pos:t,startPos:n,scale:s}){let{startZoom:i,startZoomLngLat:r}=this.getState();if(r||(i=this.getViewportProps().zoom,r=this._unproject(n)||this._unproject(t)),!r)return this;const{maxZoom:a,minZoom:l}=this.getViewportProps();let h=i+Math.log2(s);h=cr(h,l,a);const d=this.makeViewport({...this.getViewportProps(),zoom:h});return this._getUpdatedState({zoom:h,...d.panByPosition(r,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(t=2){return this._zoomFromCenter(t)}zoomOut(t=2){return this._zoomFromCenter(1/t)}moveLeft(t=100){return this._panFromCenter([t,0])}moveRight(t=100){return this._panFromCenter([-t,0])}moveUp(t=100){return this._panFromCenter([0,t])}moveDown(t=100){return this._panFromCenter([0,-t])}rotateLeft(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}shortestPathFrom(t){const n=t.getViewportProps(),s={...this.getViewportProps()},{bearing:i,longitude:r}=s;return Math.abs(i-n.bearing)>180&&(s.bearing=i<0?i+360:i-360),Math.abs(r-n.longitude)>180&&(s.longitude=r<0?r+360:r-360),s}applyConstraints(t){const{maxZoom:n,minZoom:s,zoom:i}=t;t.zoom=cr(i,s,n);const{maxPitch:r,minPitch:a,pitch:l}=t;t.pitch=cr(l,a,r);const{normalize:h=!0}=t;return h&&Object.assign(t,JF(t)),t}_zoomFromCenter(t){const{width:n,height:s}=this.getViewportProps();return this.zoom({pos:[n/2,s/2],scale:t})}_panFromCenter(t){const{width:n,height:s}=this.getViewportProps();return this.pan({startPos:[n/2,s/2],pos:[n/2+t[0],s/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}_unproject(t){const n=this.makeViewport(this.getViewportProps());return t&&n.unproject(t)}_getNewRotation(t,n,s,i){const r=t[0]-n[0],a=t[1]-n[1],l=t[1],h=n[1],{width:d,height:g}=this.getViewportProps(),_=r/d;let m=0;a>0?Math.abs(g-h)>Pb&&(m=a/(h-g)*p4):a<0&&h>Pb&&(m=1-l/h),m=cr(m,-1,1);const{minPitch:y,maxPitch:E}=this.getViewportProps(),b=i+180*_;let R=s;return m>0?R=s+m*(E-s):m<0&&(R=s-m*(y-s)),{pitch:R,bearing:b}}}class m4 extends d4{constructor(){super(...arguments),this.ControllerState=_4,this.transition={transitionDuration:300,transitionInterpolator:new GR({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(t){t.position=t.position||[0,0,0];const n=this.props;super.setProps(t),(!n||n.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...t,...this.state}))}}class t1 extends r4{constructor(t={}){super(t)}get ViewportType(){return ro}get ControllerType(){return m4}}t1.displayName="MapView";const A4=new VR;function y4(e,t){const n=e.order??1/0,s=t.order??1/0;return n-s}class T4{constructor(t){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=t,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(t){const n=this._defaultEffects;if(!n.find(s=>s.id===t.id)){const s=n.findIndex(i=>y4(i,t)>0);s<0?n.push(t):n.splice(s,0,t),t.setup(this._context),this._setEffects(this.effects)}}setProps(t){"effects"in t&&(fs(t.effects,this.effects,1)||this._setEffects(t.effects))}needsRedraw(t={clearRedrawFlags:!1}){const n=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(t){const n={};for(const i of this.effects)n[i.id]=i;const s=[];for(const i of t){const r=n[i.id];let a=i;r&&r!==i?r.setProps?(r.setProps(i.props),a=r):r.cleanup(this._context):r||i.setup(this._context),s.push(a),delete n[i.id]}for(const i in n)n[i].cleanup(this._context);this.effects=s,this._resolvedEffects=s.concat(this._defaultEffects),t.some(i=>i instanceof VR)||this._resolvedEffects.push(A4),this._needsRedraw="effects changed"}finalize(){for(const t of this._resolvedEffects)t.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class E4 extends Qm{shouldDrawLayer(t){const{operation:n}=t.props;return n.includes("draw")||n.includes("terrain")}}const b4="deckRenderer.renderLayers";class S4{constructor(t){this.device=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new E4(t),this.pickLayersPass=new $R(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){if(!t.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,s={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...t};s.effects&&this._preRender(s.effects,s);const i=this.lastPostProcessEffect?this.renderBuffers[0]:s.target;this.lastPostProcessEffect&&(s.clearColor=[0,0,0,0],s.clearCanvas=!0);const r=n.render({...s,target:i});s.effects&&this._postRender(s.effects,s),this.renderCount++,Qe(b4,this,r,t)}needsRedraw(t={clearRedrawFlags:!1}){const n=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:t}=this;for(const n of t)n.delete();t.length=0}_preRender(t,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const s of t)n.preRenderStats[s.id]=s.preRender(n),s.postRender&&(this.lastPostProcessEffect=s.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:t}=this,n=this.device.canvasContext.getDrawingBufferSize();t.length===0&&[0,1].map(s=>{const i=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});t.push(this.device.createFramebuffer({id:`deck-renderbuffer-${s}`,colorAttachments:[i]}))});for(const s of t)s.resize(n)}_postRender(t,n){const{renderBuffers:s}=this,i={...n,inputBuffer:s[0],swapBuffer:s[1]};for(const r of t)if(r.postRender){i.target=r.id===this.lastPostProcessEffect?n.target:void 0;const a=r.postRender(i);i.inputBuffer=a,i.swapBuffer=a===s[0]?s[1]:s[0]}}}const R4={pickedColor:null,pickedObjectIndex:-1};function v4({pickedColors:e,decodePickingColor:t,deviceX:n,deviceY:s,deviceRadius:i,deviceRect:r}){const{x:a,y:l,width:h,height:d}=r;let g=i*i,_=-1,m=0;for(let y=0;y<d;y++){const E=y+l-s,b=E*E;if(b>g)m+=4*h;else for(let R=0;R<h;R++){if(e[m+3]-1>=0){const N=R+a-n,O=N*N+b;O<=g&&(g=O,_=m)}m+=4}}if(_>=0){const y=e.slice(_,_+4),E=t(y);if(E){const b=Math.floor(_/4/h),R=_/4-b*h;return{...E,pickedColor:y,pickedX:a+R,pickedY:l+b}}kt.error("Picked non-existent layer. Is picking buffer corrupt?")()}return R4}function C4({pickedColors:e,decodePickingColor:t}){const n=new Map;if(e){for(let s=0;s<e.length;s+=4)if(e[s+3]-1>=0){const r=e.slice(s,s+4),a=r.join(",");if(!n.has(a)){const l=t(r);l?n.set(a,{...l,color:r}):kt.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function WR({pickInfo:e,viewports:t,pixelRatio:n,x:s,y:i,z:r}){let a=t[0];t.length>1&&(a=w4((e==null?void 0:e.pickedViewports)||t,{x:s,y:i}));let l;if(a){const h=[s-a.x,i-a.y];r!==void 0&&(h[2]=r),l=a.unproject(h)}return{color:null,layer:null,viewport:a,index:-1,picked:!1,x:s,y:i,pixel:[s,i],coordinate:l,devicePixel:e&&"pickedX"in e?[e.pickedX,e.pickedY]:void 0,pixelRatio:n}}function M4(e){const{pickInfo:t,lastPickedInfo:n,mode:s,layers:i}=e,{pickedColor:r,pickedLayer:a,pickedObjectIndex:l}=t,h=a?[a]:[];if(s==="hover"){const _=n.index,m=n.layerId,y=a?a.props.id:null;if(y!==m||l!==_){if(y!==m){const E=i.find(b=>b.props.id===m);E&&h.unshift(E)}n.layerId=y,n.index=l,n.info=null}}const d=WR(e),g=new Map;return g.set(null,d),h.forEach(_=>{let m={...d};_===a&&(m.color=r,m.index=l,m.picked=!0),m=qR({layer:_,info:m,mode:s});const y=m.layer;_===a&&s==="hover"&&(n.info=m),g.set(y.id,m),s==="hover"&&y.updateAutoHighlight(m)}),g}function qR({layer:e,info:t,mode:n}){for(;e&&t;){const s=t.layer||null;t.sourceLayer=s,t.layer=e,t=e.getPickingInfo({info:t,mode:n,sourceLayer:s}),e=e.parent}return t}function w4(e,t){for(let n=e.length-1;n>=0;n--){const s=e[n];if(s.containsPixel(t))return s}return e[0]}class O4{constructor(t){this._pickable=!0,this.device=t,this.pickLayersPass=new $R(t),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject({x:t,y:n,layers:s,viewports:i},r=this.lastPickedInfo.info){const a=r&&r.layer&&r.layer.id,l=r&&r.viewport&&r.viewport.id,h=a?s.find(m=>m.id===a):null,d=l&&i.find(m=>m.id===l)||i[0],g=d&&d.unproject([t-d.x,n-d.y]);return{...r,...{x:t,y:n,viewport:d,coordinate:g,layer:h}}}_resizeBuffer(){var n,s;if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const i=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=i}const{canvas:t}=this.device.getCanvasContext();(n=this.pickingFBO)==null||n.resize({width:t.width,height:t.height}),(s=this.depthFBO)==null||s.resize({width:t.width,height:t.height})}_getPickable(t){if(this._pickable===!1)return null;const n=t.filter(s=>this.pickLayersPass.shouldDrawLayer(s)&&!s.isComposite);return n.length?n:null}_pickClosestObject({layers:t,views:n,viewports:s,x:i,y:r,radius:a=0,depth:l=1,mode:h="query",unproject3D:d,onViewportActive:g,effects:_}){const m=this.device.canvasContext.cssToDeviceRatio(),y=this._getPickable(t);if(!y||s.length===0)return{result:[],emptyInfo:WR({viewports:s,x:i,y:r,pixelRatio:m})};this._resizeBuffer();const E=this.device.canvasContext.cssToDevicePixels([i,r],!0),b=[E.x+Math.floor(E.width/2),E.y+Math.floor(E.height/2)],R=Math.round(a*m),{width:M,height:N}=this.pickingFBO,O=this._getPickingRect({deviceX:b[0],deviceY:b[1],deviceRadius:R,deviceWidth:M,deviceHeight:N}),x={x:i-a,y:r-a,width:a*2+1,height:a*2+1};let I;const P=[],J=new Set;for(let et=0;et<l;et++){let q;if(O){const rt=this._drawAndSample({layers:y,views:n,viewports:s,onViewportActive:g,deviceRect:O,cullRect:x,effects:_,pass:`picking:${h}`});q=v4({...rt,deviceX:b[0],deviceY:b[1],deviceRadius:R,deviceRect:O})}else q={pickedColor:null,pickedObjectIndex:-1};let Q;if(q.pickedLayer&&d&&this.depthFBO){const{pickedColors:rt}=this._drawAndSample({layers:[q.pickedLayer],views:n,viewports:s,onViewportActive:g,deviceRect:{x:q.pickedX,y:q.pickedY,width:1,height:1},cullRect:x,effects:_,pass:`picking:${h}:z`},!0);rt[3]&&(Q=rt[0])}q.pickedLayer&&et+1<l&&(J.add(q.pickedLayer),q.pickedLayer.disablePickingIndex(q.pickedObjectIndex)),I=M4({pickInfo:q,lastPickedInfo:this.lastPickedInfo,mode:h,layers:y,viewports:s,x:i,y:r,z:Q,pixelRatio:m});for(const rt of I.values())rt.layer&&P.push(rt);if(!q.pickedColor)break}for(const et of J)et.restorePickingColors();return{result:P,emptyInfo:I.get(null)}}_pickVisibleObjects({layers:t,views:n,viewports:s,x:i,y:r,width:a=1,height:l=1,mode:h="query",maxObjects:d=null,onViewportActive:g,effects:_}){const m=this._getPickable(t);if(!m||s.length===0)return[];this._resizeBuffer();const y=this.device.canvasContext.cssToDeviceRatio(),E=this.device.canvasContext.cssToDevicePixels([i,r],!0),b=E.x,R=E.y+E.height,M=this.device.canvasContext.cssToDevicePixels([i+a,r+l],!0),N=M.x+M.width,O=M.y,x={x:b,y:O,width:N-b,height:R-O},I=this._drawAndSample({layers:m,views:n,viewports:s,onViewportActive:g,deviceRect:x,cullRect:{x:i,y:r,width:a,height:l},effects:_,pass:`picking:${h}`}),P=C4(I),J=new Map,et=[],q=Number.isFinite(d);for(let Q=0;Q<P.length&&!(q&&et.length>=d);Q++){const rt=P[Q];let ct={color:rt.pickedColor,layer:null,index:rt.pickedObjectIndex,picked:!0,x:i,y:r,pixelRatio:y};ct=qR({layer:rt.pickedLayer,info:ct,mode:h});const ft=ct.layer.id;J.has(ft)||J.set(ft,new Set);const Y=J.get(ft),Tt=ct.object??ct.index;Y.has(Tt)||(Y.add(Tt),et.push(ct))}return et}_drawAndSample({layers:t,views:n,viewports:s,onViewportActive:i,deviceRect:r,cullRect:a,effects:l,pass:h},d=!1){const g=d?this.depthFBO:this.pickingFBO,_={layers:t,layerFilter:this.layerFilter,views:n,viewports:s,onViewportActive:i,pickingFBO:g,deviceRect:r,cullRect:a,effects:l,pass:h,pickZ:d,preRenderStats:{}};for(const N of l)N.useInPicking&&(_.preRenderStats[N.id]=N.preRender(_));const{decodePickingColor:m}=this.pickLayersPass.render(_),{x:y,y:E,width:b,height:R}=r,M=new(d?Float32Array:Uint8Array)(b*R*4);return this.device.readPixelsToArrayWebGL(g,{sourceX:y,sourceY:E,sourceWidth:b,sourceHeight:R,target:M}),{pickedColors:M,decodePickingColor:m}}_getPickingRect({deviceX:t,deviceY:n,deviceRadius:s,deviceWidth:i,deviceHeight:r}){const a=Math.max(0,t-s),l=Math.max(0,n-s),h=Math.min(i,t+s+1)-a,d=Math.min(r,n+s+1)-l;return h<=0||d<=0?null:{x:a,y:l,width:h,height:d}}}const B4={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},x4="top-left",Fb="__root";class N4{constructor({deck:t,parentElement:n}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=t,this.parentElement=n}getWidgets(){return this.resolvedWidgets}setProps(t){t.widgets&&!fs(t.widgets,this.widgets,1)&&this._setWidgets(t.widgets)}finalize(){for(const t of this.getWidgets())this._remove(t);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const t in this.containers)this.containers[t].remove()}addDefault(t){this.defaultWidgets.find(n=>n.id===t.id)||(this._add(t),this.defaultWidgets.push(t),this._setWidgets(this.widgets))}_setWidgets(t){const n={};for(const s of this.resolvedWidgets)n[s.id]=s;this.resolvedWidgets.length=0;for(const s of this.defaultWidgets)n[s.id]=null,this.resolvedWidgets.push(s);for(let s of t){const i=n[s.id];i?i.viewId!==s.viewId||i.placement!==s.placement?(this._remove(i),this._add(s)):s!==i&&(i.setProps(s.props),s=i):this._add(s),n[s.id]=null,this.resolvedWidgets.push(s)}for(const s in n){const i=n[s];i&&this._remove(i)}this.widgets=t}_add(t){const{viewId:n=null,placement:s=x4}=t,i=t.onAdd({deck:this.deck,viewId:n});i&&this._getContainer(n,s).append(i),t._element=i}_remove(t){t.onRemove(),t._element&&t._element.remove(),t._element=void 0}_getContainer(t,n){var a;const s=t||Fb;let i=this.containers[s];i||(i=document.createElement("div"),i.style.pointerEvents="none",i.style.position="absolute",i.style.overflow="hidden",(a=this.parentElement)==null||a.append(i),this.containers[s]=i);let r=i.querySelector(`.${n}`);return r||(r=document.createElement("div"),r.className=n,r.style.position="absolute",r.style.zIndex="2",Object.assign(r.style,B4[n]),i.append(r)),r}_updateContainers(){const t=this.deck.width,n=this.deck.height;for(const s in this.containers){const i=this.lastViewports[s]||null,r=s===Fb||i,a=this.containers[s];r?(a.style.display="block",a.style.left=`${i?i.x:0}px`,a.style.top=`${i?i.y:0}px`,a.style.width=`${i?i.width:t}px`,a.style.height=`${i?i.height:n}px`):a.style.display="none"}}onRedraw({viewports:t,layers:n}){var r,a;const s=t.reduce((l,h)=>(l[h.id]=h,l),{}),{lastViewports:i}=this;for(const l of this.getWidgets()){const{viewId:h}=l;if(h){const d=s[h];d&&(l.onViewportChange&&!d.equals(i[h])&&l.onViewportChange(d),(r=l.onRedraw)==null||r.call(l,{viewports:[d],layers:n}))}else{if(l.onViewportChange)for(const d of t)d.equals(i[d.id])||l.onViewportChange(d);(a=l.onRedraw)==null||a.call(l,{viewports:t,layers:n})}}this.lastViewports=s,this._updateContainers()}onHover(t,n){var s,i;for(const r of this.getWidgets()){const{viewId:a}=r;(!a||a===((s=t.viewport)==null?void 0:s.id))&&((i=r.onHover)==null||i.call(r,t,n))}}onEvent(t,n){var i,r;const s=$0[n.type];if(s)for(const a of this.getWidgets()){const{viewId:l}=a;(!l||l===((i=t.viewport)==null?void 0:i.id))&&((r=a[s.handler])==null||r.call(a,t,n))}}}const I4={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class D4{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd({deck:t}){const n=document.createElement("div");return n.className="deck-tooltip",Object.assign(n.style,I4),this.deck=t,this.element=n,n}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(t){var n;this.isVisible&&t.id===((n=this.lastViewport)==null?void 0:n.id)&&t!==this.lastViewport&&this.setTooltip(null)}onHover(t){const{deck:n}=this,s=n&&n.props.getTooltip;if(!s)return;const i=s(t);this.lastViewport=t.viewport,this.setTooltip(i,t.x,t.y)}setTooltip(t,n,s){const i=this.element;if(i){if(typeof t=="string")i.innerText=t;else if(t)t.text&&(i.innerText=t.text),t.html&&(i.innerHTML=t.html),t.className&&(i.className=t.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform=`translate(${n}px, ${s}px)`,t&&typeof t=="object"&&"style"in t&&Object.assign(i.style,t.style)}}}var Ea;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",e[e.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.CULL_FACE=2884]="CULL_FACE",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.BLEND=3042]="BLEND",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.DITHER=3024]="DITHER",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DOUBLE=5130]="DOUBLE",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",e[e.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.READ_BUFFER=3074]="READ_BUFFER",e[e.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",e[e.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",e[e.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",e[e.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",e[e.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",e[e.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",e[e.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",e[e.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",e[e.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",e[e.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",e[e.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",e[e.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",e[e.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",e[e.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",e[e.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",e[e.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",e[e.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",e[e.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",e[e.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",e[e.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",e[e.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",e[e.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",e[e.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",e[e.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",e[e.RED=6403]="RED",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB10_A2=32857]="RGB10_A2",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",e[e.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",e[e.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",e[e.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",e[e.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",e[e.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",e[e.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",e[e.SRGB=35904]="SRGB",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",e[e.RGBA32F=34836]="RGBA32F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.RGB16F=34843]="RGB16F",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R16F=33325]="R16F",e[e.R32F=33326]="R32F",e[e.RG16F=33327]="RG16F",e[e.RG32F=33328]="RG32F",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2UI=36975]="RGB10_A2UI",e[e.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",e[e.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.RG=33319]="RG",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",e[e.CURRENT_QUERY=34917]="CURRENT_QUERY",e[e.QUERY_RESULT=34918]="QUERY_RESULT",e[e.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",e[e.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",e[e.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",e[e.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",e[e.DRAW_BUFFER0=34853]="DRAW_BUFFER0",e[e.DRAW_BUFFER1=34854]="DRAW_BUFFER1",e[e.DRAW_BUFFER2=34855]="DRAW_BUFFER2",e[e.DRAW_BUFFER3=34856]="DRAW_BUFFER3",e[e.DRAW_BUFFER4=34857]="DRAW_BUFFER4",e[e.DRAW_BUFFER5=34858]="DRAW_BUFFER5",e[e.DRAW_BUFFER6=34859]="DRAW_BUFFER6",e[e.DRAW_BUFFER7=34860]="DRAW_BUFFER7",e[e.DRAW_BUFFER8=34861]="DRAW_BUFFER8",e[e.DRAW_BUFFER9=34862]="DRAW_BUFFER9",e[e.DRAW_BUFFER10=34863]="DRAW_BUFFER10",e[e.DRAW_BUFFER11=34864]="DRAW_BUFFER11",e[e.DRAW_BUFFER12=34865]="DRAW_BUFFER12",e[e.DRAW_BUFFER13=34866]="DRAW_BUFFER13",e[e.DRAW_BUFFER14=34867]="DRAW_BUFFER14",e[e.DRAW_BUFFER15=34868]="DRAW_BUFFER15",e[e.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e[e.MAX_SAMPLES=36183]="MAX_SAMPLES",e[e.SAMPLER_BINDING=35097]="SAMPLER_BINDING",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",e[e.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",e[e.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",e[e.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",e[e.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",e[e.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",e[e.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",e[e.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",e[e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",e[e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",e[e.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",e[e.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",e[e.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",e[e.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",e[e.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",e[e.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",e[e.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",e[e.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",e[e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",e[e.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",e[e.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",e[e.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",e[e.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",e[e.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",e[e.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",e[e.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",e[e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",e[e.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",e[e.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",e[e.UNIFORM_TYPE=35383]="UNIFORM_TYPE",e[e.UNIFORM_SIZE=35384]="UNIFORM_SIZE",e[e.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",e[e.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",e[e.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",e[e.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",e[e.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",e[e.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",e[e.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",e[e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",e[e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS",e[e.SYNC_FENCE=37142]="SYNC_FENCE",e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED",e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED",e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STREAM_COPY=35042]="STREAM_COPY",e[e.STATIC_READ=35045]="STATIC_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e[e.INVALID_INDEX=4294967295]="INVALID_INDEX",e[e.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",e[e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",e[e.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",e[e.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",e[e.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",e[e.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",e[e.R16_EXT=33322]="R16_EXT",e[e.RG16_EXT=33324]="RG16_EXT",e[e.RGB16_EXT=32852]="RGB16_EXT",e[e.RGBA16_EXT=32859]="RGBA16_EXT",e[e.R16_SNORM_EXT=36760]="R16_SNORM_EXT",e[e.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",e[e.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",e[e.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",e[e.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",e[e.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",e[e.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",e[e.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",e[e.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",e[e.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",e[e.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",e[e.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",e[e.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",e[e.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",e[e.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",e[e.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",e[e.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",e[e.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",e[e.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",e[e.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",e[e.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",e[e.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",e[e.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",e[e.LINE_WEBGL=6913]="LINE_WEBGL",e[e.FILL_WEBGL=6914]="FILL_WEBGL",e[e.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",e[e.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",e[e.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",e[e.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",e[e.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",e[e.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",e[e.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",e[e.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",e[e.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",e[e.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",e[e.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",e[e.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",e[e.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",e[e.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",e[e.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",e[e.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",e[e.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",e[e.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",e[e.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",e[e.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",e[e.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",e[e.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",e[e.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",e[e.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(Ea||(Ea={}));const e1={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Se=(e,t,n)=>t?e.enable(n):e.disable(n),Ub=(e,t,n)=>e.hint(n,t),In=(e,t,n)=>e.pixelStorei(n,t),Lb=(e,t,n)=>{const s=n===36006?36009:36008;return e.bindFramebuffer(s,t)},il=(e,t,n)=>{const i={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[n];e.bindBuffer(i,t)};function T_(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}const P4={3042:Se,32773:(e,t)=>e.blendColor(...t),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(e,t)=>e.clearColor(...t),3107:(e,t)=>e.colorMask(...t),2884:Se,2885:(e,t)=>e.cullFace(t),2929:Se,2931:(e,t)=>e.clearDepth(t),2932:(e,t)=>e.depthFunc(t),2928:(e,t)=>e.depthRange(...t),2930:(e,t)=>e.depthMask(t),3024:Se,35723:Ub,35725:(e,t)=>e.useProgram(t),36007:(e,t)=>e.bindRenderbuffer(36161,t),36389:(e,t)=>{var n;return(n=e.bindTransformFeedback)==null?void 0:n.call(e,36386,t)},34229:(e,t)=>e.bindVertexArray(t),36006:Lb,36010:Lb,34964:il,36662:il,36663:il,35053:il,35055:il,2886:(e,t)=>e.frontFace(t),33170:Ub,2849:(e,t)=>e.lineWidth(t),32823:Se,32824:"polygonOffset",10752:"polygonOffset",35977:Se,32926:Se,32928:Se,32938:"sampleCoverage",32939:"sampleCoverage",3089:Se,3088:(e,t)=>e.scissor(...t),2960:Se,2961:(e,t)=>e.clearStencil(t),2968:(e,t)=>e.stencilMaskSeparate(1028,t),36005:(e,t)=>e.stencilMaskSeparate(1029,t),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(e,t)=>e.viewport(...t),34383:Se,10754:Se,12288:Se,12289:Se,12290:Se,12291:Se,12292:Se,12293:Se,12294:Se,12295:Se,3333:In,3317:In,37440:In,37441:In,37443:In,3330:In,3332:In,3331:In,3314:In,32878:In,3316:In,3315:In,32877:In,framebuffer:(e,t)=>{const n=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(36160,n)},blend:(e,t)=>t?e.enable(3042):e.disable(3042),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{const n=typeof t=="number"?[t,t]:t;e.blendEquationSeparate(...n)},blendFunc:(e,t)=>{const n=(t==null?void 0:t.length)===2?[...t,...t]:t;e.blendFuncSeparate(...n)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(2884):e.disable(2884),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(2929):e.disable(2929),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(3024):e.disable(3024),derivativeHint:(e,t)=>{e.hint(35723,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(33170,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(32823):e.disable(32823),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(...t),scissorTest:(e,t)=>t?e.enable(3089):e.disable(3089),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(2960):e.disable(2960),stencilMask:(e,t)=>{t=T_(t)?t:[t,t];const[n,s]=t;e.stencilMaskSeparate(1028,n),e.stencilMaskSeparate(1029,s)},stencilFunc:(e,t)=>{t=T_(t)&&t.length===3?[...t,...t]:t;const[n,s,i,r,a,l]=t;e.stencilFuncSeparate(1028,n,s,i),e.stencilFuncSeparate(1029,r,a,l)},stencilOp:(e,t)=>{t=T_(t)&&t.length===3?[...t,...t]:t;const[n,s,i,r,a,l]=t;e.stencilOpSeparate(1028,n,s,i),e.stencilOpSeparate(1029,r,a,l)},viewport:(e,t)=>e.viewport(...t)};function _e(e,t,n){return t[e]!==void 0?t[e]:n[e]}const F4={blendEquation:(e,t,n)=>e.blendEquationSeparate(_e(32777,t,n),_e(34877,t,n)),blendFunc:(e,t,n)=>e.blendFuncSeparate(_e(32969,t,n),_e(32968,t,n),_e(32971,t,n),_e(32970,t,n)),polygonOffset:(e,t,n)=>e.polygonOffset(_e(32824,t,n),_e(10752,t,n)),sampleCoverage:(e,t,n)=>e.sampleCoverage(_e(32938,t,n),_e(32939,t,n)),stencilFuncFront:(e,t,n)=>e.stencilFuncSeparate(1028,_e(2962,t,n),_e(2967,t,n),_e(2963,t,n)),stencilFuncBack:(e,t,n)=>e.stencilFuncSeparate(1029,_e(34816,t,n),_e(36003,t,n),_e(36004,t,n)),stencilOpFront:(e,t,n)=>e.stencilOpSeparate(1028,_e(2964,t,n),_e(2965,t,n),_e(2966,t,n)),stencilOpBack:(e,t,n)=>e.stencilOpSeparate(1029,_e(34817,t,n),_e(34818,t,n),_e(34819,t,n))},kb={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,n)=>e({[t]:n}),hint:(e,t,n)=>e({[t]:n}),useProgram:(e,t)=>e({35725:t}),bindRenderbuffer:(e,t,n)=>e({36007:n}),bindTransformFeedback:(e,t,n)=>e({36389:n}),bindVertexArray:(e,t)=>e({34229:t}),bindFramebuffer:(e,t,n)=>{switch(t){case 36160:return e({36006:n,36010:n});case 36009:return e({36006:n});case 36008:return e({36010:n});default:return null}},bindBuffer:(e,t,n)=>{const s={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[t];return s?e({[s]:n}):{valueChanged:!0}},blendColor:(e,t,n,s,i)=>e({32773:new Float32Array([t,n,s,i])}),blendEquation:(e,t)=>e({32777:t,34877:t}),blendEquationSeparate:(e,t,n)=>e({32777:t,34877:n}),blendFunc:(e,t,n)=>e({32969:t,32968:n,32971:t,32970:n}),blendFuncSeparate:(e,t,n,s,i)=>e({32969:t,32968:n,32971:s,32970:i}),clearColor:(e,t,n,s,i)=>e({3106:new Float32Array([t,n,s,i])}),clearDepth:(e,t)=>e({2931:t}),clearStencil:(e,t)=>e({2961:t}),colorMask:(e,t,n,s,i)=>e({3107:[t,n,s,i]}),cullFace:(e,t)=>e({2885:t}),depthFunc:(e,t)=>e({2932:t}),depthRange:(e,t,n)=>e({2928:new Float32Array([t,n])}),depthMask:(e,t)=>e({2930:t}),frontFace:(e,t)=>e({2886:t}),lineWidth:(e,t)=>e({2849:t}),polygonOffset:(e,t,n)=>e({32824:t,10752:n}),sampleCoverage:(e,t,n)=>e({32938:t,32939:n}),scissor:(e,t,n,s,i)=>e({3088:new Int32Array([t,n,s,i])}),stencilMask:(e,t)=>e({2968:t,36005:t}),stencilMaskSeparate:(e,t,n)=>e({[t===1028?2968:36005]:n}),stencilFunc:(e,t,n,s)=>e({2962:t,2967:n,2963:s,34816:t,36003:n,36004:s}),stencilFuncSeparate:(e,t,n,s,i)=>e({[t===1028?2962:34816]:n,[t===1028?2967:36003]:s,[t===1028?2963:36004]:i}),stencilOp:(e,t,n,s)=>e({2964:t,2965:n,2966:s,34817:t,34818:n,34819:s}),stencilOpSeparate:(e,t,n,s,i)=>e({[t===1028?2964:34817]:n,[t===1028?2965:34818]:s,[t===1028?2966:34819]:i}),viewport:(e,t,n,s,i)=>e({2978:[t,n,s,i]})},Bs=(e,t)=>e.isEnabled(t),zb={3042:Bs,2884:Bs,2929:Bs,3024:Bs,32823:Bs,32926:Bs,32928:Bs,3089:Bs,2960:Bs,35977:Bs},U4=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function Qa(e,t){if(k4(t))return;const n={};for(const i in t){const r=Number(i),a=P4[i];a&&(typeof a=="string"?n[a]=!0:a(e,t[i],r))}const s=e.state&&e.state.cache;if(s)for(const i in n){const r=F4[i];r(e,t,s)}}function YR(e,t=e1){if(typeof t=="number"){const i=t,r=zb[i];return r?r(e,i):e.getParameter(i)}const n=Array.isArray(t)?t:Object.keys(t),s={};for(const i of n){const r=zb[i];s[i]=r?r(e,Number(i)):e.getParameter(Number(i))}return s}function L4(e){Qa(e,e1)}function k4(e){for(const t in e)return!1;return!0}function z4(e,t){if(e===t)return!0;const n=Array.isArray(e)||ArrayBuffer.isView(e),s=Array.isArray(t)||ArrayBuffer.isView(t);if(n&&s&&e.length===t.length){for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}return!1}class V4{constructor(t,{copyState:n=!1,log:s=()=>{}}={}){T(this,"gl");T(this,"program",null);T(this,"stateStack",[]);T(this,"enable",!0);T(this,"cache");T(this,"log");this.gl=t,this.cache=n?YR(t):Object.assign({},e1),this.log=s,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(t={}){this.stateStack.push({})}pop(){Ht(this.stateStack.length>0);const t=this.stateStack[this.stateStack.length-1];Qa(this.gl,t),this.stateStack.pop()}_updateCache(t){let n=!1,s;const i=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const r in t){Ht(r!==void 0);const a=t[r],l=this.cache[r];z4(a,l)||(n=!0,s=l,i&&!(r in i)&&(i[r]=l),this.cache[r]=a)}return{valueChanged:n,oldValue:s}}}function ao(e){return e.state}function KR(e,t){const{enable:n=!0,copyState:s}=t;if(Ht(s!==void 0),!e.state){e.state=new V4(e,{copyState:s}),j4(e);for(const r in kb){const a=kb[r];H4(e,r,a)}Vb(e,"getParameter"),Vb(e,"isEnabled")}const i=ao(e);return i.enable=n,e}function Pd(e){let t=ao(e);t||(KR(e,{copyState:!1}),t=ao(e)),t.push()}function zl(e){const t=ao(e);Ht(t),t.pop()}function Vb(e,t){const n=e[t].bind(e);e[t]=function(i){if(i===void 0||U4.has(i))return n(i);const r=ao(e);return i in r.cache||(r.cache[i]=n(i)),r.enable?r.cache[i]:n(i)},Object.defineProperty(e[t],"name",{value:`${t}-from-cache`,configurable:!1})}function H4(e,t,n){if(!e[t])return;const s=e[t].bind(e);e[t]=function(...r){const a=ao(e),{valueChanged:l,oldValue:h}=n(a._updateCache,...r);return l&&s(...r),h},Object.defineProperty(e[t],"name",{value:`${t}-to-cache`,configurable:!1})}function j4(e){const t=e.useProgram.bind(e);e.useProgram=function(s){const i=ao(e);i.program!==s&&(t(s),i.program=s)}}const $4={powerPreference:"high-performance",onContextLost:()=>console.error("WebGL context lost"),onContextRestored:()=>console.info("WebGL context restored")};function X4(e,t){t={...$4,...t};let n=null;const s=r=>n=r.statusMessage||n;e.addEventListener("webglcontextcreationerror",s,!1);let i=null;if(i||(i=e.getContext("webgl2",t)),e.removeEventListener("webglcontextcreationerror",s,!1),!i)throw new Error(`Failed to create WebGL context: ${n||"Unknown error"}`);if(t.onContextLost){const{onContextLost:r}=t;e.addEventListener("webglcontextlost",a=>r(a),!1)}if(t.onContextRestored){const{onContextRestored:r}=t;e.addEventListener("webglcontextrestored",a=>r(a),!1)}return i}function _r(e,t,n){return n[t]===void 0&&(n[t]=e.getExtension(t)||null),n[t]}function G4(e,t){const n=e.getParameter(7936),s=e.getParameter(7937);_r(e,"WEBGL_debug_renderer_info",t);const i=t.WEBGL_debug_renderer_info,r=e.getParameter(i?i.UNMASKED_VENDOR_WEBGL:7936),a=e.getParameter(i?i.UNMASKED_RENDERER_WEBGL:7937),l=r||n,h=a||s,d=e.getParameter(7938),g=JR(l,h),_=W4(l,h),m=q4(l,h);return{type:"webgl",gpu:g,gpuType:m,gpuBackend:_,vendor:l,renderer:h,version:d,shadingLanguage:"glsl",shadingLanguageVersion:300}}function JR(e,t){return/NVIDIA/i.exec(e)||/NVIDIA/i.exec(t)?"nvidia":/INTEL/i.exec(e)||/INTEL/i.exec(t)?"intel":/Apple/i.exec(e)||/Apple/i.exec(t)?"apple":/AMD/i.exec(e)||/AMD/i.exec(t)||/ATI/i.exec(e)||/ATI/i.exec(t)?"amd":/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t)?"software":"unknown"}function W4(e,t){return/Metal/i.exec(e)||/Metal/i.exec(t)?"metal":/ANGLE/i.exec(e)||/ANGLE/i.exec(t)?"opengl":"unknown"}function q4(e,t){if(/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t))return"cpu";switch(JR(e,t)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function ZR(e){switch(e){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(e))}const Ze="texture-compression-bc",Jt="texture-compression-astc",xs="texture-compression-etc2",Y4="texture-compression-etc1-webgl",Ih="texture-compression-pvrtc-webgl",E_="texture-compression-atc-webgl",rl="float32-renderable-webgl",b_="float16-renderable-webgl",K4="rgb9e5ufloat_renderable-webgl",S_="snorm8-renderable-webgl",ol="norm16-renderable-webgl",R_="snorm16-renderable-webgl",Dh="float32-filterable",Hb="float16-filterable-webgl",pl="WEBGL_compressed_texture_s3tc",_l="WEBGL_compressed_texture_s3tc_srgb",ba="EXT_texture_compression_rgtc",Sa="EXT_texture_compression_bptc",J4="WEBGL_compressed_texture_etc",Z4="WEBGL_compressed_texture_astc",Q4="WEBGL_compressed_texture_etc1",tL="WEBGL_compressed_texture_pvrtc",eL="WEBGL_compressed_texture_atc",jb="EXT_texture_norm16",$b="EXT_render_snorm",nL="EXT_color_buffer_float",n1={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat_renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[$b],"norm16-renderable-webgl":[jb],"snorm16-renderable-webgl":[jb,$b],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[pl,_l,ba,Sa],"texture-compression-bc5-webgl":[ba],"texture-compression-bc7-webgl":[Sa],"texture-compression-etc2":[J4],"texture-compression-astc":[Z4],"texture-compression-etc1-webgl":[Q4],"texture-compression-pvrtc-webgl":[tL],"texture-compression-atc-webgl":[eL]};function sL(e){return e in n1}function iL(e,t,n){return(n1[t]||[]).every(i=>_r(e,i,n))}const Fd={"rgb8unorm-unsized":{gl:6407,b:4,c:2,bpp:4,dataFormat:6407,types:[5121,33635]},"rgba8unorm-unsized":{gl:6408,b:4,c:2,bpp:4,dataFormat:6408,types:[5121,32819,32820]},r8unorm:{gl:33321,b:1,c:1,rb:!0},r8snorm:{gl:36756,b:1,c:1,render:S_},r8uint:{gl:33330,b:1,c:1,rb:!0},r8sint:{gl:33329,b:1,c:1,rb:!0},rg8unorm:{gl:33323,b:2,c:2,rb:!0},rg8snorm:{gl:36757,b:2,c:2,render:S_},rg8uint:{gl:33336,b:2,c:2,rb:!0},rg8sint:{gl:33335,b:2,c:2,rb:!0},r16uint:{gl:33332,b:2,c:1,rb:!0},r16sint:{gl:33331,b:2,c:1,rb:!0},r16float:{gl:33325,b:2,c:1,render:b_,filter:"float16-filterable-webgl",rb:!0},"r16unorm-webgl":{gl:33322,b:2,c:1,f:ol,rb:!0},"r16snorm-webgl":{gl:36760,b:2,c:1,f:R_},"rgba4unorm-webgl":{gl:32854,b:2,c:4,wgpu:!1,rb:!0},"rgb565unorm-webgl":{gl:36194,b:2,c:4,wgpu:!1,rb:!0},"rgb5a1unorm-webgl":{gl:32855,b:2,c:4,wgpu:!1,rb:!0},"rgb8unorm-webgl":{gl:32849,b:3,c:3,wgpu:!1},"rgb8snorm-webgl":{gl:36758,b:3,c:3,wgpu:!1},rgba8unorm:{gl:32856,b:4,c:2,bpp:4},"rgba8unorm-srgb":{gl:35907,b:4,c:4,bpp:4},rgba8snorm:{gl:36759,b:4,c:4,render:S_},rgba8uint:{gl:36220,b:4,c:4,bpp:4},rgba8sint:{gl:36238,b:4,c:4,bpp:4},bgra8unorm:{b:4,c:4},"bgra8unorm-srgb":{b:4,c:4},rg16uint:{gl:33338,b:4,c:1,bpp:4},rg16sint:{gl:33337,b:4,c:2,bpp:4},rg16float:{gl:33327,bpp:4,b:4,c:2,render:b_,filter:Hb,rb:!0},"rg16unorm-webgl":{gl:33324,b:2,c:2,render:ol},"rg16snorm-webgl":{gl:36761,b:2,c:2,render:R_},r32uint:{gl:33334,b:4,c:1,bpp:4,rb:!0},r32sint:{gl:33333,b:4,c:1,bpp:4,rb:!0},r32float:{gl:33326,bpp:4,b:4,c:1,render:rl,filter:Dh},rgb9e5ufloat:{gl:35901,b:4,c:3,p:1,render:K4},rg11b10ufloat:{gl:35898,b:4,c:3,p:1,render:rl,rb:!0},rgb10a2unorm:{gl:32857,b:4,c:4,p:1,rb:!0},"rgb10a2uint-webgl":{b:4,c:4,gl:36975,p:1,wgpu:!1,bpp:4,rb:!0},"rgb16unorm-webgl":{gl:32852,b:2,c:3,f:ol},"rgb16snorm-webgl":{gl:36762,b:2,c:3,f:ol},rg32uint:{gl:33340,b:8,c:2,rb:!0},rg32sint:{gl:33339,b:8,c:2,rb:!0},rg32float:{gl:33328,b:8,c:2,render:rl,filter:Dh,rb:!0},rgba16uint:{gl:36214,b:8,c:4,rb:!0},rgba16sint:{gl:36232,b:8,c:4,rb:!0},rgba16float:{gl:34842,b:8,c:4,render:b_,filter:Hb},"rgba16unorm-webgl":{gl:32859,b:2,c:4,render:ol,rb:!0},"rgba16snorm-webgl":{gl:36763,b:2,c:4,render:R_},"rgb32float-webgl":{gl:34837,render:rl,filter:Dh,gl2ext:nL,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,b:16,c:4,rb:!0},rgba32sint:{gl:36226,b:16,c:4,rb:!0},rgba32float:{gl:34836,b:16,c:4,render:rl,filter:Dh,rb:!0},stencil8:{gl:36168,b:1,c:1,attachment:36128,rb:!0},depth16unorm:{gl:33189,b:2,c:1,attachment:36096,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,b:3,c:1,attachment:36096,dataFormat:6402,types:[5125]},depth32float:{gl:36012,b:4,c:1,attachment:36096,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,b:4,c:2,p:1,attachment:33306,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth24unorm-stencil8":{gl:35056,b:4,c:2,p:1,attachment:33306,dataFormat:34041,types:[34042],rb:!0},"depth32float-stencil8":{gl:36013,b:5,c:2,p:1,attachment:33306,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:pl,f:Ze},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:_l,f:Ze},"bc1-rgba-unorm":{gl:33777,x:pl,f:Ze},"bc1-rgba-unorm-srgb":{gl:35916,x:_l,f:Ze},"bc2-rgba-unorm":{gl:33778,x:pl,f:Ze},"bc2-rgba-unorm-srgb":{gl:35918,x:_l,f:Ze},"bc3-rgba-unorm":{gl:33779,x:pl,f:Ze},"bc3-rgba-unorm-srgb":{gl:35919,x:_l,f:Ze},"bc4-r-unorm":{gl:36283,x:ba,f:Ze},"bc4-r-snorm":{gl:36284,x:ba,f:Ze},"bc5-rg-unorm":{gl:36285,x:ba,f:Ze},"bc5-rg-snorm":{gl:36286,x:ba,f:Ze},"bc6h-rgb-ufloat":{gl:36495,x:Sa,f:Ze},"bc6h-rgb-float":{gl:36494,x:Sa,f:Ze},"bc7-rgba-unorm":{gl:36492,x:Sa,f:Ze},"bc7-rgba-unorm-srgb":{gl:36493,x:Sa,f:Ze},"etc2-rgb8unorm":{gl:37492,f:xs},"etc2-rgb8unorm-srgb":{gl:37494,f:xs},"etc2-rgb8a1unorm":{gl:37496,f:xs},"etc2-rgb8a1unorm-srgb":{gl:37497,f:xs},"etc2-rgba8unorm":{gl:37493,f:xs},"etc2-rgba8unorm-srgb":{gl:37495,f:xs},"eac-r11unorm":{gl:37488,f:xs},"eac-r11snorm":{gl:37489,f:xs},"eac-rg11unorm":{gl:37490,f:xs},"eac-rg11snorm":{gl:37491,f:xs},"astc-4x4-unorm":{gl:37808,f:Jt},"astc-4x4-unorm-srgb":{gl:37840,f:Jt},"astc-5x4-unorm":{gl:37809,f:Jt},"astc-5x4-unorm-srgb":{gl:37841,f:Jt},"astc-5x5-unorm":{gl:37810,f:Jt},"astc-5x5-unorm-srgb":{gl:37842,f:Jt},"astc-6x5-unorm":{gl:37811,f:Jt},"astc-6x5-unorm-srgb":{gl:37843,f:Jt},"astc-6x6-unorm":{gl:37812,f:Jt},"astc-6x6-unorm-srgb":{gl:37844,f:Jt},"astc-8x5-unorm":{gl:37813,f:Jt},"astc-8x5-unorm-srgb":{gl:37845,f:Jt},"astc-8x6-unorm":{gl:37814,f:Jt},"astc-8x6-unorm-srgb":{gl:37846,f:Jt},"astc-8x8-unorm":{gl:37815,f:Jt},"astc-8x8-unorm-srgb":{gl:37847,f:Jt},"astc-10x5-unorm":{gl:37819,f:Jt},"astc-10x5-unorm-srgb":{gl:37851,f:Jt},"astc-10x6-unorm":{gl:37817,f:Jt},"astc-10x6-unorm-srgb":{gl:37849,f:Jt},"astc-10x8-unorm":{gl:37818,f:Jt},"astc-10x8-unorm-srgb":{gl:37850,f:Jt},"astc-10x10-unorm":{gl:37819,f:Jt},"astc-10x10-unorm-srgb":{gl:37851,f:Jt},"astc-12x10-unorm":{gl:37820,f:Jt},"astc-12x10-unorm-srgb":{gl:37852,f:Jt},"astc-12x12-unorm":{gl:37821,f:Jt},"astc-12x12-unorm-srgb":{gl:37853,f:Jt},"pvrtc-rgb4unorm-webgl":{gl:35840,f:Ih},"pvrtc-rgba4unorm-webgl":{gl:35842,f:Ih},"pvrtc-rbg2unorm-webgl":{gl:35841,f:Ih},"pvrtc-rgba2unorm-webgl":{gl:35843,f:Ih},"etc1-rbg-unorm-webgl":{gl:36196,f:Y4},"atc-rgb-unorm-webgl":{gl:35986,f:E_},"atc-rgba-unorm-webgl":{gl:35986,f:E_},"atc-rgbai-unorm-webgl":{gl:34798,f:E_}},rL={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},oL={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function s1(e,t,n){const s=Fd[t];if(!s||s.gl===void 0)return!1;const i=s.x||s.gl2ext;return i?!!_r(e,i,n):!0}function QR(e){const t=Fd[e],n=t==null?void 0:t.gl;if(n===void 0)throw new Error(`Unsupported texture format ${e}`);return n}function aL(e,t,n){if(!s1(e,t,n)||t.startsWith("depth")||t.startsWith("stencil"))return!1;try{if(Z3(t).signed)return!1}catch{return!1}return t.endsWith("32float")?!!_r(e,"OES_texture_float_linear, extensions",n):t.endsWith("16float")?!!_r(e,"OES_texture_half_float_linear, extensions",n):!0}function cL(e,t,n){return!(!s1(e,t,n)||typeof t=="number")}function td(e){var i;const t=Fd[e],n=QR(e),s=Z3(e);return{format:n,dataFormat:(t==null?void 0:t.dataFormat)||uL(s.format,s.integer,s.normalized,n),type:s.dataType?ZR(s.dataType):((i=t==null?void 0:t.types)==null?void 0:i[0])||5121,compressed:s.compressed}}function lL(e){const t=Fd[e];if(!(t!=null&&t.attachment))throw new Error(`${e} is not a depth stencil format`);return t.attachment}function Xb(e){const t=td(e),n=rL[t.dataFormat]||4,s=oL[t.type]||1;return n*s}function uL(e,t,n,s){if(s===6408||s===6407)return s;switch(e){case"r":return t&&!n?36244:6403;case"rg":return t&&!n?33320:33319;case"rgb":return t&&!n?36248:6407;case"rgba":return t&&!n?36249:6408;default:return 6408}}const Gb={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class hL extends iI{constructor(n,s,i){super([],i);T(this,"gl");T(this,"extensions");T(this,"testedFeatures",new Set);this.gl=n,this.extensions=s,_r(n,"EXT_color_buffer_float",s)}*[Symbol.iterator](){const n=this.getFeatures();for(const s of n)this.has(s)&&(yield s);return[]}has(n){return this.disabledFeatures[n]?!1:(this.testedFeatures.has(n)||(this.testedFeatures.add(n),sL(n)&&iL(this.gl,n,this.extensions)&&this.features.add(n),this.getWebGLFeature(n)&&this.features.add(n)),this.features.has(n))}initializeFeatures(){const n=this.getFeatures().filter(s=>s!=="polygon-mode-webgl");for(const s of n)this.has(s)}getFeatures(){return[...Object.keys(Gb),...Object.keys(n1)]}getWebGLFeature(n){const s=Gb[n];return typeof s=="string"?!!_r(this.gl,s,this.extensions):!!s}}class fL extends sI{constructor(n){super();T(this,"gl");T(this,"limits",{});this.gl=n}get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}getParameter(n){return this.limits[n]===void 0&&(this.limits[n]=this.gl.getParameter(n)),this.limits[n]}}function ur(e,t,n){if(dL(t))return n(e);const{nocatch:s=!0}=t;Pd(e),Qa(e,t);let i;if(s)i=n(e),zl(e);else try{i=n(e)}finally{zl(e)}return i}function dL(e){for(const t in e)return!1;return!0}function gL(e,t,n,s){if(Vf(t))return s(e);const i=e;Pd(i.gl);try{return pL(e,t),Qa(i.gl,n),s(e)}finally{zl(i.gl)}}function pL(e,t){const n=e,{gl:s}=n;if(t.cullMode)switch(t.cullMode){case"none":s.disable(2884);break;case"front":s.enable(2884),s.cullFace(1028);break;case"back":s.enable(2884),s.cullFace(1029);break}if(t.frontFace&&s.frontFace(so("frontFace",t.frontFace,{ccw:2305,cw:2304})),t.unclippedDepth&&e.features.has("depth-clip-control")&&s.enable(34383),t.depthBias!==void 0&&(s.enable(32823),s.polygonOffset(t.depthBias,t.depthBiasSlopeScale||0)),t.provokingVertex&&e.features.has("provoking-vertex-webgl")){const r=n.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,a=so("provokingVertex",t.provokingVertex,{first:36429,last:36430});r==null||r.provokingVertexWEBGL(a)}if((t.polygonMode||t.polygonOffsetLine)&&e.features.has("polygon-mode-webgl")){if(t.polygonMode){const r=n.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,a=so("polygonMode",t.polygonMode,{fill:6914,line:6913});r==null||r.polygonModeWEBGL(1028,a),r==null||r.polygonModeWEBGL(1029,a)}t.polygonOffsetLine&&s.enable(10754)}if(e.features.has("shader-clip-cull-distance-webgl")&&(t.clipDistance0&&s.enable(12288),t.clipDistance1&&s.enable(12289),t.clipDistance2&&s.enable(12290),t.clipDistance3&&s.enable(12291),t.clipDistance4&&s.enable(12292),t.clipDistance5&&s.enable(12293),t.clipDistance6&&s.enable(12294),t.clipDistance7&&s.enable(12295)),t.depthWriteEnabled!==void 0&&s.depthMask(mL("depthWriteEnabled",t.depthWriteEnabled)),t.depthCompare&&(t.depthCompare!=="always"?s.enable(2929):s.disable(2929),s.depthFunc(Z0("depthCompare",t.depthCompare))),t.stencilWriteMask){const i=t.stencilWriteMask;s.stencilMaskSeparate(1028,i),s.stencilMaskSeparate(1029,i)}if(t.stencilReadMask&&ot.warn("stencilReadMask not supported under WebGL"),t.stencilCompare){const i=t.stencilReadMask||4294967295,r=Z0("depthCompare",t.stencilCompare);t.stencilCompare!=="always"?s.enable(2960):s.disable(2960),s.stencilFuncSeparate(1028,r,0,i),s.stencilFuncSeparate(1029,r,0,i)}if(t.stencilPassOperation&&t.stencilFailOperation&&t.stencilDepthFailOperation){const i=v_("stencilPassOperation",t.stencilPassOperation),r=v_("stencilFailOperation",t.stencilFailOperation),a=v_("stencilDepthFailOperation",t.stencilDepthFailOperation);s.stencilOpSeparate(1028,r,a,i),s.stencilOpSeparate(1029,r,a,i)}if(t.blendColorOperation||t.blendAlphaOperation){s.enable(3042);const i=Wb("blendColorOperation",t.blendColorOperation||"add"),r=Wb("blendAlphaOperation",t.blendAlphaOperation||"add");s.blendEquationSeparate(i,r);const a=Ph("blendColorSrcFactor",t.blendColorSrcFactor||"one"),l=Ph("blendColorDstFactor",t.blendColorDstFactor||"zero"),h=Ph("blendAlphaSrcFactor",t.blendAlphaSrcFactor||"one"),d=Ph("blendAlphaDstFactor",t.blendAlphaDstFactor||"zero");s.blendFuncSeparate(a,l,h,d)}}function Z0(e,t){return so(e,t,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function v_(e,t){return so(e,t,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function Wb(e,t){return so(e,t,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function Ph(e,t){return so(e,t,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function _L(e,t){return`Illegal parameter ${t} for ${e}`}function so(e,t,n){if(!(t in n))throw new Error(_L(e,t));return n[t]}function mL(e,t){return t}function tv(e){const t={};return e.addressModeU&&(t[10242]=C_(e.addressModeU)),e.addressModeV&&(t[10243]=C_(e.addressModeV)),e.addressModeW&&(t[32882]=C_(e.addressModeW)),e.magFilter&&(t[10240]=ev(e.magFilter)),(e.minFilter||e.mipmapFilter)&&(t[10241]=AL(e.minFilter||"linear",e.mipmapFilter)),e.lodMinClamp!==void 0&&(t[33082]=e.lodMinClamp),e.lodMaxClamp!==void 0&&(t[33083]=e.lodMaxClamp),e.type==="comparison-sampler"&&(t[34892]=34894),e.compare&&(t[34893]=Z0("compare",e.compare)),e.maxAnisotropy&&(t[34046]=e.maxAnisotropy),t}function C_(e){switch(e){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function ev(e){switch(e){case"nearest":return 9728;case"linear":return 9729}}function AL(e,t){if(!t)return ev(e);switch(e){case"nearest":return t==="nearest"?9984:9986;case"linear":return t==="nearest"?9985:9987}}class fr extends fe{constructor(n,s={}){super(n,s);T(this,"device");T(this,"gl");T(this,"handle");T(this,"glTarget");T(this,"glUsage");T(this,"glIndexType",5123);T(this,"byteLength");T(this,"bytesUsed");this.device=n,this.gl=this.device.gl;const i=typeof s=="object"?s.handle:void 0;this.handle=i||this.gl.createBuffer(),n.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=yL(this.props.usage),this.glUsage=TL(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,s.data?this._initWithData(s.data,s.byteOffset,s.byteLength):this._initWithByteLength(s.byteLength||0)}_initWithData(n,s=0,i=n.byteLength+s){const r=this.glTarget;this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.glUsage),this.gl.bufferSubData(r,s,n),this.gl.bindBuffer(r,null),this.bytesUsed=i,this.byteLength=i,this._setDebugData(n,s,i),this.trackAllocatedMemory(i)}_initWithByteLength(n){Ht(n>=0);let s=n;n===0&&(s=new Float32Array(0));const i=this.glTarget;return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,s,this.glUsage),this.gl.bindBuffer(i,null),this.bytesUsed=n,this.byteLength=n,this._setDebugData(null,0,n),this.trackAllocatedMemory(n),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(n,s=0){this.gl.bindBuffer(36663,this.handle),this.gl.bufferSubData(36663,s,n),this.gl.bindBuffer(36663,null),this._setDebugData(n,s,n.byteLength)}async readAsync(n=0,s){return this.readSyncWebGL(n,s)}readSyncWebGL(n=0,s){s=s??this.byteLength-n;const i=new Uint8Array(s),r=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,i,r,s),this.gl.bindBuffer(36662,null),this._setDebugData(i,n,s),i}}function yL(e){return e&fe.INDEX?34963:e&fe.VERTEX?34962:e&fe.UNIFORM?35345:34962}function TL(e){return e&fe.INDEX||e&fe.VERTEX?35044:e&fe.UNIFORM?35048:35044}class Q0 extends $f{constructor(n,s){super(n,s);T(this,"device");T(this,"handle");T(this,"parameters");this.device=n,this.parameters=tv(s),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(n){for(const[s,i]of Object.entries(n)){const r=Number(s);switch(r){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,r,i);break;default:this.device.gl.samplerParameteri(this.handle,r,i);break}}}}class Ra extends Hf{constructor(n,s){super(n,{...kn.defaultProps,...s});T(this,"device");T(this,"gl");T(this,"handle");T(this,"texture");this.device=n,this.gl=this.device.gl,this.handle=null,this.texture=s.texture}}const EL={parameters:{},pixelStore:{},pixels:null,border:0,dataFormat:void 0,textureUnit:void 0,target:void 0},Il=class Il extends kn{constructor(n,s){var i;super(n,{...EL,format:"rgba8unorm",...s});T(this,"MAX_ATTRIBUTES");T(this,"device");T(this,"gl");T(this,"handle");T(this,"sampler");T(this,"view");T(this,"glFormat");T(this,"type");T(this,"dataFormat");T(this,"mipmaps");T(this,"target");T(this,"textureUnit");T(this,"loaded",!1);T(this,"_video");this.device=n,this.gl=this.device.gl,this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glFormat=6408,this.target=bL(this.props),this.loaded=!1,typeof((i=this.props)==null?void 0:i.data)=="string"&&Object.assign(this.props,{data:XI(this.props.data)}),this.initialize(this.props),Object.seal(this)}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}toString(){return`Texture(${this.id},${this.width}x${this.height})`}createView(n){return new Ra(this.device,{...n,texture:this})}initialize(n={}){if(this.props.dimension==="cube")return this.initializeCube(n);let s=n.data;if(s instanceof Promise)return s.then(M=>this.initialize(Object.assign({},n,{pixels:M,data:M}))),this;const i=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement;if(i&&s.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,s.addEventListener("loadeddata",()=>this.initialize(n)),this;const{parameters:r={}}=n,{pixels:a=null,pixelStore:l={},textureUnit:h=void 0,mipmaps:d=!0}=n;s||(s=a);let{width:g,height:_,dataFormat:m,type:y,compressed:E=!1}=n;const{depth:b=0}=n,R=QR(n.format);return{width:g,height:_,compressed:E,dataFormat:m,type:y}=this._deduceParameters({format:n.format,type:y,dataFormat:m,compressed:E,data:s,width:g,height:_}),this.width=g,this.height=_,this.glFormat=R,this.type=y,this.dataFormat=m,this.textureUnit=h,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),this.mipmaps=d,this.setImageData({data:s,width:g,height:_,depth:b,format:n.format,type:y,dataFormat:m,parameters:l,compressed:E}),this.setSampler(n.sampler),this._setSamplerParameters(r),this.view=this.createView({...this.props,mipLevelCount:1,arrayLayerCount:1}),d&&this.device.isTextureFormatFilterable(n.format)&&this.generateMipmap(),i&&(this._video={video:s,parameters:r,lastTime:s.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?s.currentTime:-1}),this}initializeCube(n){const{mipmaps:s=!0,parameters:i={}}=n;return this.setCubeMapImageData(n).then(()=>{this.loaded=!0,s&&this.generateMipmap(n),this.setSampler(n.sampler),this._setSamplerParameters(i)}),this}setSampler(n={}){let s;n instanceof Q0?(this.sampler=n,s=n.props):(this.sampler=new Q0(this.device,n),s=n);const i=tv(s);return this._setSamplerParameters(i),this}resize(n){const{height:s,width:i,mipmaps:r=!1}=n;return i!==this.width||s!==this.height?this.initialize({width:i,height:s,format:this.format,type:this.type,dataFormat:this.dataFormat,mipmaps:r}):this}update(){if(this._video){const{video:n,parameters:s,lastTime:i}=this._video;if(i===n.currentTime||n.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:n,parameters:s}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=n.currentTime}}generateMipmap(n={}){return this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),ur(this.gl,n,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this}setImageData(n){if(this.props.dimension==="3d"||this.props.dimension==="2d-array")return this.setImageData3D(n);this.trackDeallocatedMemory("Texture");const{target:s=this.target,pixels:i=null,level:r=0,glFormat:a=this.glFormat,offset:l=0,parameters:h={}}=n;let{data:d=null,type:g=this.type,width:_=this.width,height:m=this.height,dataFormat:y=this.dataFormat,compressed:E=!1}=n;d||(d=i),{type:g,dataFormat:y,compressed:E,width:_,height:m}=this._deduceParameters({format:this.props.format,type:g,dataFormat:y,compressed:E,data:d,width:_,height:m});const{gl:b}=this;b.bindTexture(this.target,this.handle);let R=null;if({data:d,dataType:R}=this._getDataType({data:d,compressed:E}),ur(this.gl,h,()=>{switch(R){case"null":b.texImage2D(s,r,a,_,m,0,y,g,d);break;case"typed-array":b.texImage2D(s,r,a,_,m,0,y,g,d,l);break;case"buffer":this.device.gl.bindBuffer(35052,d.handle||d),this.device.gl.texImage2D(s,r,a,_,m,0,y,g,l),this.device.gl.bindBuffer(35052,null);break;case"browser-object":b.texImage2D(s,r,a,_,m,0,y,g,d);break;case"compressed":for(const[M,N]of d.entries())b.compressedTexImage2D(s,M,N.format,N.width,N.height,0,N.data);break;default:Ht(!1,"Unknown image data type")}}),d&&d.byteLength)this.trackAllocatedMemory(d.byteLength,"Texture");else{const M=Xb(this.props.format);this.trackAllocatedMemory(this.width*this.height*M,"Texture")}return this.loaded=!0,this}setSubImageData({target:n=this.target,pixels:s=null,data:i=null,x:r=0,y:a=0,width:l=this.width,height:h=this.height,level:d=0,glFormat:g=this.glFormat,type:_=this.type,dataFormat:m=this.dataFormat,compressed:y=!1,offset:E=0,parameters:b={}}){if({type:_,dataFormat:m,compressed:y,width:l,height:h}=this._deduceParameters({format:this.props.format,type:_,dataFormat:m,compressed:y,data:i,width:l,height:h}),Ht(this.depth===1,"texSubImage not supported for 3D textures"),i||(i=s),i&&i.data){const R=i;i=R.data,l=R.shape[0],h=R.shape[1]}i instanceof fr&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),ur(this.gl,b,()=>{y?this.gl.compressedTexSubImage2D(n,d,r,a,l,h,g,i):i===null?this.gl.texSubImage2D(n,d,r,a,l,h,m,_,null):ArrayBuffer.isView(i)?this.gl.texSubImage2D(n,d,r,a,l,h,m,_,i,E):typeof WebGLBuffer<"u"&&i instanceof WebGLBuffer?(this.device.gl.bindBuffer(35052,i),this.device.gl.texSubImage2D(n,d,r,a,l,h,m,_,E),this.device.gl.bindBuffer(35052,null)):this.device.gl.texSubImage2D(n,d,r,a,l,h,m,_,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(n={}){return ot.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(n=this.textureUnit){const{gl:s}=this;return n!==void 0&&(this.textureUnit=n,s.activeTexture(33984+n)),s.bindTexture(this.target,this.handle),n}unbind(n=this.textureUnit){const{gl:s}=this;return n!==void 0&&(this.textureUnit=n,s.activeTexture(33984+n)),s.bindTexture(this.target,null),n}_getDataType({data:n,compressed:s=!1}){return s?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof fr?{data:n.handle,dataType:"buffer"}:typeof WebGLBuffer<"u"&&n instanceof WebGLBuffer?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(n){const{format:s,data:i}=n;let{width:r,height:a,dataFormat:l,type:h,compressed:d}=n;const g=td(s);return l=l||g.dataFormat,h=h||g.type,d=d||g.compressed,{width:r,height:a}=this._deduceImageSize(i,r,a),{dataFormat:l,type:h,compressed:d,width:r,height:a,format:s,data:i}}_deduceImageSize(n,s,i){let r;return typeof ImageData<"u"&&n instanceof ImageData?r={width:n.width,height:n.height}:typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement?r={width:n.naturalWidth,height:n.naturalHeight}:typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement?r={width:n.width,height:n.height}:typeof ImageBitmap<"u"&&n instanceof ImageBitmap?r={width:n.width,height:n.height}:typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement?r={width:n.videoWidth,height:n.videoHeight}:n?r={width:s,height:i}:r={width:s>=0?s:1,height:i>=0?i:1},Ht(r,"Could not deduced texture size"),Ht(s===void 0||r.width===s,"Deduced texture width does not match supplied width"),Ht(i===void 0||r.height===i,"Deduced texture height does not match supplied height"),r}async setCubeMapImageData(n){const{gl:s}=this,{width:i,height:r,pixels:a,data:l,format:h=6408,type:d=5121}=n,g=a||l,_=await Promise.all(Il.FACES.map(m=>{const y=g[m];return Promise.all(Array.isArray(y)?y:[y])}));this.bind(),Il.FACES.forEach((m,y)=>{_[y].length>1&&this.props.mipmaps!==!1&&ot.warn(`${this.id} has mipmap and multiple LODs.`)(),_[y].forEach((E,b)=>{i&&r?s.texImage2D(m,b,h,i,r,0,h,d,E):s.texImage2D(m,b,h,h,d,E)})}),this.unbind()}setImageDataForFace(n){const{face:s,width:i,height:r,pixels:a,data:l,format:h=6408,type:d=5121}=n,{gl:g}=this,_=a||l;return this.bind(),_ instanceof Promise?_.then(m=>this.setImageDataForFace(Object.assign({},n,{face:s,data:m,pixels:m}))):this.width||this.height?g.texImage2D(s,0,h,i,r,0,h,d,_):g.texImage2D(s,0,h,h,d,_),this}setImageData3D(n){const{level:s=0,dataFormat:i,format:r,type:a,width:l,height:h,depth:d=1,offset:g=0,data:_,parameters:m={}}=n;this.trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle);const y=td(r);if(ur(this.gl,m,()=>{ArrayBuffer.isView(_)&&this.gl.texImage3D(this.target,s,y.format,l,h,d,0,y.dataFormat,y.type,_),_ instanceof fr&&(this.gl.bindBuffer(35052,_.handle),this.gl.texImage3D(this.target,s,i,l,h,d,0,r,a,g))}),_&&_.byteLength)this.trackAllocatedMemory(_.byteLength,"Texture");else{const E=Xb(this.props.format);this.trackAllocatedMemory(this.width*this.height*this.depth*E,"Texture")}return this.loaded=!0,this}_setSamplerParameters(n){if(!Vf(n)){SL(n),this.gl.bindTexture(this.target,this.handle);for(const[s,i]of Object.entries(n)){const r=Number(s),a=i;switch(r){case 33082:case 33083:this.gl.texParameterf(this.target,r,a);break;default:this.gl.texParameteri(this.target,r,a);break}}this.gl.bindTexture(this.target,null)}}};T(Il,"FACES",[34069,34070,34071,34072,34073,34074]);let Hs=Il;function bL(e){switch(e.dimension){case"2d":return 3553;case"cube":return 34067;case"2d-array":return 35866;case"3d":return 32879;case"1d":case"cube-array":default:throw new Error(e.dimension)}}function SL(e){ot.log(1,"texture sampler parameters",e)()}class bl extends Xf{constructor(n,s){super(n,s);T(this,"device");T(this,"gl");T(this,"handle");const i=s.handle===null;if(this.device=n,this.gl=n.gl,this.handle=this.props.handle||i?this.props.handle:this.gl.createFramebuffer(),!i){n.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures();const r=this.gl.bindFramebuffer(36160,this.handle);for(let a=0;a<this.colorAttachments.length;++a){const l=this.colorAttachments[a],h=36064+a;l&&this._attachOne(h,l)}if(this.depthStencilAttachment&&this._attachOne(lL(this.depthStencilAttachment.props.format),this.depthStencilAttachment),s.check!==!1){const a=this.gl.checkFramebufferStatus(36160);if(a!==36053)throw new Error(`Framebuffer ${vL(a)}`)}this.gl.bindFramebuffer(36160,r)}}get texture(){return this.colorAttachments[0]}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}createDepthStencilTexture(n){return new Hs(this.device,{id:`${this.id}-depth-stencil`,format:n,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(n,s){if(this.handle===null)return this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),s===void 0&&(s=this.gl.drawingBufferHeight);for(const i of this.colorAttachments)i.texture.resize({width:n,height:s});return this.depthStencilAttachment&&this.depthStencilAttachment.texture.resize({width:n,height:s}),this}_attachOne(n,s){if(Array.isArray(s)){const[i,r=0,a=0]=s;return this._attachTexture(n,i,r,a),i}if(s instanceof Hs)return this._attachTexture(n,s,0,0),s;if(s instanceof Ra){const i=s;return this._attachTexture(n,i.texture,i.props.baseMipLevel,i.props.baseArrayLayer),s.texture}throw new Error("attach")}_attachTexture(n,s,i,r){const{gl:a}=this.device;switch(a.bindTexture(s.target,s.handle),s.target){case 35866:case 32879:a.framebufferTextureLayer(36160,n,s.target,r,i);break;case 34067:const l=RL(i);a.framebufferTexture2D(36160,n,l,s.handle,r);break;case 3553:a.framebufferTexture2D(36160,n,3553,s.handle,r);break;default:Ht(!1,"Illegal texture type")}a.bindTexture(s.target,null)}}function RL(e){return e<34069?e+34069:e}function vL(e){switch(e){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${e}`}}class CL extends Hm{constructor(n,s){super(s);T(this,"device");T(this,"presentationSize");T(this,"_framebuffer",null);this.device=n,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new bl(this.device,{handle:null}),this._framebuffer}update(){const n=this.getPixelSize();(n[0]!==this.presentationSize[0]||n[1]!==this.presentationSize[1])&&(this.presentationSize=n,this.resize())}resize(n){if(this.device.gl&&this.canvas){const s=this.getDevicePixelRatio(n==null?void 0:n.useDevicePixels);this.setDevicePixelRatio(s,n);return}}commit(){}}const ML={spector:ot.get("spector")||ot.get("spectorjs")},wL="https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",OL=1;let Zt=null,qb=!1;async function BL(e){if(!globalThis.SPECTOR)try{await oR(wL)}catch(t){ot.warn(String(t))}}function xL(e){if(e={...ML,...e},!(e!=null&&e.spector)||(!Zt&&globalThis.SPECTOR&&(ot.probe(OL,"SPECTOR found and initialized")(),Zt=new globalThis.SPECTOR.Spector,globalThis.luma&&(globalThis.luma.spector=Zt)),!Zt))return null;if(qb||(qb=!0,Zt.spyCanvases(),Zt==null||Zt.onCaptureStarted.add(t=>ot.info("Spector capture started:",t)()),Zt==null||Zt.onCapture.add(t=>{ot.info("Spector capture complete:",t)(),Zt==null||Zt.getResultUI(),Zt==null||Zt.resultView.display(),Zt==null||Zt.resultView.addCapture(t)})),e!=null&&e.canvas){if(typeof e.spector=="string"&&e.spector!==e.canvas.id)return Zt;Zt==null||Zt.startCapture(e==null?void 0:e.canvas,500),new Promise(t=>setTimeout(t,2e3)).then(t=>{ot.info("Spector capture stopped after 2 seconds")(),Zt==null||Zt.stopCapture()})}return Zt}const NL="https://unpkg.com/webgl-debug@2.0.1/index.js";function nv(e){return e.luma=e.luma||{},e.luma}async function IL(){Ar()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await oR(NL))}function DL(e,t={}){return e?t.debug?FL(e,t):PL(e):null}function PL(e){const t=nv(e);return t.realContext?t.realContext:e}function FL(e,t){if(!globalThis.WebGLDebugUtils)return ot.warn("webgl-debug not loaded")(),e;const n=nv(e);if(n.debugContext)return n.debugContext;globalThis.WebGLDebugUtils.init({...Ea,...e});const s=globalThis.WebGLDebugUtils.makeDebugContext(e,UL.bind(null,t),LL.bind(null,t));for(const a in Ea)!(a in s)&&typeof Ea[a]=="number"&&(s[a]=Ea[a]);class i{}Object.setPrototypeOf(s,Object.getPrototypeOf(e)),Object.setPrototypeOf(i,s);const r=Object.create(i);return n.realContext=e,n.debugContext=r,r.debug=!0,r}function M_(e,t){t=Array.from(t).map(s=>s===void 0?"undefined":s);let n=globalThis.WebGLDebugUtils.glFunctionArgsToString(e,t);return n=`${n.slice(0,100)}${n.length>100?"...":""}`,`gl.${e}(${n})`}function UL(e,t,n,s){s=Array.from(s).map(l=>l===void 0?"undefined":l);const i=globalThis.WebGLDebugUtils.glEnumToString(t),r=globalThis.WebGLDebugUtils.glFunctionArgsToString(n,s),a=`${i} in gl.${n}(${r})`;ot.error(a)();debugger;if(e.throwOnError)throw new Error(a)}function LL(e,t,n){let s="";if(ot.level>=1&&(s=M_(t,n),ot.log(1,s)()),e.break&&e.break.length>0&&(s=s||M_(t,n),e.break.every(r=>s.indexOf(r)!==-1)))debugger;for(const i of n)if(i===void 0){if(s=s||M_(t,n),e.throwOnError)throw new Error(`Undefined argument: ${s}`);ot.error(`Undefined argument: ${s}`)();debugger}}function kL(e){const t=e.split(/\r?\n/),n=[];for(const s of t){if(s.length<=1)continue;const i=s.split(":");if(i.length===2){const[_,m]=i;n.push({message:m.trim(),type:Yb(_),lineNum:0,linePos:0});continue}const[r,a,l,...h]=i;let d=parseInt(l,10);isNaN(d)&&(d=0);let g=parseInt(a,10);isNaN(g)&&(g=0),n.push({message:h.join(":").trim(),type:Yb(r),lineNum:d,linePos:g})}return n}function Yb(e){const t=["warning","error","info"],n=e.toLowerCase();return t.includes(n)?n:"info"}class zL extends jf{constructor(n,s){super(n,s);T(this,"device");T(this,"handle");switch(this.device=n,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const n=this.device.gl.getShaderInfoLog(this.handle);return kL(n)}getTranslatedSource(){const s=this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders;return s==null?void 0:s.getTranslatedShaderSource(this.handle)}async _compile(n){n=(r=>r.startsWith("#version ")?r:`#version 100
${r}`)(n);const{gl:i}=this.device;if(i.shaderSource(this.handle,n),i.compileShader(this.handle),ot.level===0){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}ot.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),ot.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){const n=async r=>await new Promise(a=>setTimeout(a,r));if(!this.device.features.has("compilation-status-async-webgl")){await n(10);return}const{gl:i}=this.device;for(;;){if(i.getShaderParameter(this.handle,37297))return;await n(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}const VL=256,HL=1024,jL=16384,w_=6144,$L=[1,2,4,8];class XL extends x0{constructor(n,s){super(n,s);T(this,"device");T(this,"glParameters");this.device=n,Pd(this.device.gl),this.setParameters(this.props.parameters),this.clear()}end(){zl(this.device.gl)}pushDebugGroup(n){}popDebugGroup(){}insertDebugMarker(n){}setParameters(n={}){const s={...this.glParameters};this.props.framebuffer&&(s.framebuffer=this.props.framebuffer),this.props.depthReadOnly&&(s.depthMask=!this.props.depthReadOnly),s.stencilMask=this.props.stencilReadOnly?0:1,s[35977]=this.props.discard,n.viewport&&(n.viewport.length>=6?(s.viewport=n.viewport.slice(0,4),s.depthRange=[n.viewport[4],n.viewport[5]]):s.viewport=n.viewport),n.scissorRect&&(s.scissorTest=!0,s.scissor=n.scissorRect),n.blendConstant&&(s.blendColor=n.blendConstant),n.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),n[2967]=n.stencilReference),n.colorMask&&(s.colorMask=$L.map(i=>!!(i&n.colorMask))),this.glParameters=s,Qa(this.device.gl,s)}beginOcclusionQuery(n){const s=this.props.occlusionQuerySet;s==null||s.beginOcclusionQuery()}endOcclusionQuery(){const n=this.props.occlusionQuerySet;n==null||n.endOcclusionQuery()}clear(){const n={...this.glParameters};let s=0;this.props.clearColor!==!1&&(s|=jL,n.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(s|=VL,n.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(s|=HL,n.clearStencil=this.props.clearStencil),s!==0&&ur(this.device.gl,n,()=>{this.device.gl.clear(s)})}clearColorBuffer(n=0,s=[0,0,0,0]){ur(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(s.constructor){case Int32Array:this.device.gl.clearBufferiv(w_,n,s);break;case Uint32Array:this.device.gl.clearBufferuiv(w_,n,s);break;case Float32Array:default:this.device.gl.clearBufferfv(w_,n,s);break}})}}const WL="Failed to deduce GL constant from typed array";function qL(e){switch(ArrayBuffer.isView(e)?e.constructor:e){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(WL)}}function tm(e,t){const{clamped:n=!0}=t||{};switch(e){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return n?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}const YL={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},KL={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Sl{constructor(...t){T(this,"offset");T(this,"stride");T(this,"type");T(this,"size");T(this,"divisor");T(this,"normalized");T(this,"integer");T(this,"buffer");T(this,"index");t.forEach(n=>this._assign(n)),Object.freeze(this)}static getBytesPerElement(t){return tm(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(t){return Ht(t.size),tm(t.type||5126).BYTES_PER_ELEMENT*t.size}static resolve(...t){return new Sl(YL,...t)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Sl.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Sl.getBytesPerVertex(this)}_assign(t={}){return t=jI("Accessor",t,KL),t.type!==void 0&&(this.type=t.type,(t.type===5124||t.type===5125)&&(this.integer=!0)),t.size!==void 0&&(this.size=t.size),t.offset!==void 0&&(this.offset=t.offset),t.stride!==void 0&&(this.stride=t.stride),t.normalize!==void 0&&(this.normalized=t.normalize),t.normalized!==void 0&&(this.normalized=t.normalized),t.integer!==void 0&&(this.integer=t.integer),t.divisor!==void 0&&(this.divisor=t.divisor),t.buffer!==void 0&&(this.buffer=t.buffer),t.index!==void 0&&(typeof t.index=="boolean"?this.index=t.index?1:0:this.index=t.index),t.instanced!==void 0&&(this.divisor=t.instanced?1:0),t.isInstanced!==void 0&&(this.divisor=t.isInstanced?1:0),this.offset===void 0&&delete this.offset,this.stride===void 0&&delete this.stride,this.type===void 0&&delete this.type,this.size===void 0&&delete this.size,this.divisor===void 0&&delete this.divisor,this.normalized===void 0&&delete this.normalized,this.integer===void 0&&delete this.integer,this.buffer===void 0&&delete this.buffer,this.index===void 0&&delete this.index,this}}function JL(e){return ZL.includes(e)}const ZL=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],sv={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function iv(e){const t=sv[e];if(!t)throw new Error("uniform");const[n,s,,i]=t;return{format:i,components:s,glType:n}}function QL(e){const t=sv[e];if(!t)throw new Error("attribute");const[,n,,s,i]=t;return{attributeType:s,vertexFormat:i,components:n}}function t6(e,t){const n={attributes:[],bindings:[]};n.attributes=e6(e,t);const s=i6(e,t);for(const l of s){const h=l.uniforms.map(d=>({name:d.name,format:d.format,byteOffset:d.byteOffset,byteStride:d.byteStride,arrayLength:d.arrayLength}));n.bindings.push({type:"uniform",name:l.name,location:l.location,visibility:(l.vertex?1:0)&(l.fragment?2:0),minBindingSize:l.byteLength,uniforms:h})}const i=s6(e,t);let r=0;for(const l of i)if(JL(l.type)){const{viewDimension:h,sampleType:d}=o6(l.type);n.bindings.push({type:"texture",name:l.name,location:r,viewDimension:h,sampleType:d}),l.textureUnit=r,r+=1}i.length&&(n.uniforms=i);const a=n6(e,t);return a!=null&&a.length&&(n.varyings=a),n}function e6(e,t){const n=[],s=e.getProgramParameter(t,35721);for(let i=0;i<s;i++){const r=e.getActiveAttrib(t,i);if(!r)throw new Error("activeInfo");const{name:a,type:l}=r,h=e.getAttribLocation(t,a);if(h>=0){const{attributeType:d}=QL(l),g=/instance/i.test(a)?"instance":"vertex";n.push({name:a,location:h,stepMode:g,type:d})}}return n.sort((i,r)=>i.location-r.location),n}function n6(e,t){const n=[],s=e.getProgramParameter(t,35971);for(let i=0;i<s;i++){const r=e.getTransformFeedbackVarying(t,i);if(!r)throw new Error("activeInfo");const{name:a,type:l,size:h}=r,{glType:d,components:g}=iv(l),_=new Sl({type:d,size:h*g}),m={location:i,name:a,accessor:_};n.push(m)}return n.sort((i,r)=>i.location-r.location),n}function s6(e,t){const n=[],s=e.getProgramParameter(t,35718);for(let i=0;i<s;i++){const r=e.getActiveUniform(t,i);if(!r)throw new Error("activeInfo");const{name:a,size:l,type:h}=r,{name:d,isArray:g}=a6(a);let _=e.getUniformLocation(t,d);const m={location:_,name:d,size:l,type:h,isArray:g};if(n.push(m),m.size>1)for(let y=0;y<m.size;y++){const E=`${d}[${y}]`;_=e.getUniformLocation(t,E);const b={...m,name:E,location:_};n.push(b)}}return n}function i6(e,t){const n=(r,a)=>e.getActiveUniformBlockParameter(t,r,a),s=[],i=e.getProgramParameter(t,35382);for(let r=0;r<i;r++){const a={name:e.getActiveUniformBlockName(t,r)||"",location:n(r,35391),byteLength:n(r,35392),vertex:n(r,35396),fragment:n(r,35398),uniformCount:n(r,35394),uniforms:[]},l=n(r,35395)||[],h=e.getActiveUniforms(t,l,35383),d=e.getActiveUniforms(t,l,35384),g=e.getActiveUniforms(t,l,35387),_=e.getActiveUniforms(t,l,35388);for(let m=0;m<a.uniformCount;++m){const y=e.getActiveUniform(t,l[m]);if(!y)throw new Error("activeInfo");a.uniforms.push({name:y.name,format:iv(h[m]).format,type:h[m],arrayLength:d[m],byteOffset:g[m],byteStride:_[m]})}s.push(a)}return s.sort((r,a)=>r.location-a.location),s}const r6={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function o6(e){const t=r6[e];if(!t)throw new Error("sampler");const[n,s]=t;return{viewDimension:n,sampleType:s}}function a6(e){if(e[e.length-1]!=="]")return{name:e,length:1,isArray:!1};const n=/([^[]*)(\[[0-9]+\])?/.exec(e);if(!n||n.length<2)throw new Error(`Failed to parse GLSL uniform name ${e}`);return{name:n[1],length:n[2]?1:0,isArray:!!n[2]}}function c6(e,t,n,s){const i=e;let r=s;r===!0&&(r=1),r===!1&&(r=0);const a=typeof r=="number"?[r]:r;switch(n){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof s!="number")throw new Error("samplers must be set to integers");return e.uniform1i(t,s);case 5126:return e.uniform1fv(t,a);case 35664:return e.uniform2fv(t,a);case 35665:return e.uniform3fv(t,a);case 35666:return e.uniform4fv(t,a);case 5124:return e.uniform1iv(t,a);case 35667:return e.uniform2iv(t,a);case 35668:return e.uniform3iv(t,a);case 35669:return e.uniform4iv(t,a);case 35670:return e.uniform1iv(t,a);case 35671:return e.uniform2iv(t,a);case 35672:return e.uniform3iv(t,a);case 35673:return e.uniform4iv(t,a);case 5125:return i.uniform1uiv(t,a,1);case 36294:return i.uniform2uiv(t,a,2);case 36295:return i.uniform3uiv(t,a,3);case 36296:return i.uniform4uiv(t,a,4);case 35674:return e.uniformMatrix2fv(t,!1,a);case 35675:return e.uniformMatrix3fv(t,!1,a);case 35676:return e.uniformMatrix4fv(t,!1,a);case 35685:return i.uniformMatrix2x3fv(t,!1,a);case 35686:return i.uniformMatrix2x4fv(t,!1,a);case 35687:return i.uniformMatrix3x2fv(t,!1,a);case 35688:return i.uniformMatrix3x4fv(t,!1,a);case 35689:return i.uniformMatrix4x2fv(t,!1,a);case 35690:return i.uniformMatrix4x3fv(t,!1,a)}throw new Error("Illegal uniform")}function l6(e){switch(e){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"line-loop-webgl":return 2;case"triangle-list":return 4;case"triangle-strip":return 5;case"triangle-fan-webgl":return 6;default:throw new Error(e)}}function u6(e){switch(e){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"line-loop-webgl":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;case"triangle-fan-webgl":return 4;default:throw new Error(e)}}const Kb=4;class h6 extends Ua{constructor(n,s){super(n,s);T(this,"device");T(this,"handle");T(this,"vs");T(this,"fs");T(this,"introspectedLayout");T(this,"uniforms",{});T(this,"bindings",{});T(this,"varyings",null);T(this,"_uniformCount",0);T(this,"_uniformSetters",{});this.device=n,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=s.vs,this.fs=s.fs;const{varyings:i,bufferMode:r=35981}=s;switch(i&&i.length>0&&(this.varyings=i,this.device.gl.transformFeedbackVaryings(this.handle,i,r)),this._linkShaders(),ot.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=t6(this.device.gl,this.handle),ot.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=BI(this.introspectedLayout,s.shaderLayout),this.props.topology){case"triangle-fan-webgl":case"line-loop-webgl":ot.warn(`Primitive topology ${this.props.topology} is deprecated and will be removed in v9.1`);break}}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(n,s){for(const[i,r]of Object.entries(n)){const a=this.shaderLayout.bindings.find(l=>l.name===i)||this.shaderLayout.bindings.find(l=>l.name===`${i}Uniforms`);if(!a){const l=this.shaderLayout.bindings.map(h=>`"${h.name}"`).join(", ");s!=null&&s.disableWarnings||ot.warn(`Unknown binding "${i}" in render pipeline "${this.id}", expected one of ${l}`)();continue}switch(r||ot.warn(`Unsetting binding "${i}" in render pipeline "${this.id}"`)(),a.type){case"uniform":if(!(r instanceof fr)&&!(r.buffer instanceof fr))throw new Error("buffer value");break;case"texture":if(!(r instanceof Ra||r instanceof Hs||r instanceof bl))throw new Error("texture value");break;case"sampler":ot.warn(`Ignoring sampler ${i}`)();break;default:throw new Error(a.type)}this.bindings[i]=r}}draw(n){var R;const{renderPass:s,parameters:i=this.props.parameters,topology:r=this.props.topology,vertexArray:a,vertexCount:l,instanceCount:h,isInstanced:d=!1,firstVertex:g=0,transformFeedback:_}=n,m=l6(r),y=!!a.indexBuffer,E=(R=a.indexBuffer)==null?void 0:R.glIndexType;if(this.linkStatus!=="success")return ot.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable()||l===0)return ot.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;if(l===0)return ot.info(2,`RenderPipeline:${this.id}.draw() aborted - no vertices to draw`)(),!0;this.device.gl.useProgram(this.handle),a.bindBeforeRender(s),_&&_.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const b=s;return gL(this.device,i,b.glParameters,()=>{y&&d?this.device.gl.drawElementsInstanced(m,l||0,E,g,h||0):y?this.device.gl.drawElements(m,l||0,E,g):d?this.device.gl.drawArraysInstanced(m,g,l||0,h||0):this.device.gl.drawArrays(m,g,l||0),_&&_.end()}),a.unbindAfterRender(s),!0}setUniformsWebGL(n){const{bindings:s}=jm(n);Object.keys(s).forEach(i=>{ot.warn(`Unsupported value "${JSON.stringify(s[i])}" used in setUniforms() for key ${i}. Use setBindings() instead?`)()}),Object.assign(this.uniforms,n)}async _linkShaders(){const{gl:n}=this.device;if(n.attachShader(this.handle,this.vs.handle),n.attachShader(this.handle,this.fs.handle),ot.time(Kb,`linkProgram for ${this.id}`)(),n.linkProgram(this.handle),ot.timeEnd(Kb,`linkProgram for ${this.id}`)(),ot.level,!this.device.features.has("compilation-status-async-webgl")){const i=this._getLinkStatus();this._reportLinkStatus(i);return}ot.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),ot.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const s=this._getLinkStatus();this._reportLinkStatus(s)}_reportLinkStatus(n){var s;switch(n){case"success":return;default:throw this.vs.compilationStatus==="error"?(this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`)):((s=this.fs)==null?void 0:s.compilationStatus)==="error"?(this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`)):new Error(`Error during ${n}: ${this.device.gl.getProgramInfoLog(this.handle)}`)}}_getLinkStatus(){const{gl:n}=this.device;return n.getProgramParameter(this.handle,35714)?(n.validateProgram(this.handle),n.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")):(this.linkStatus="error","linking")}async _waitForLinkComplete(){const n=async r=>await new Promise(a=>setTimeout(a,r));if(!this.device.features.has("compilation-status-async-webgl")){await n(10);return}const{gl:i}=this.device;for(;;){if(i.getProgramParameter(this.handle,37297))return;await n(10)}}_areTexturesRenderable(){let n=!0;for(const[,s]of Object.entries(this.bindings))s instanceof Hs&&(s.update(),n=n&&s.loaded);return n}_applyBindings(){if(this.linkStatus!=="success")return;const{gl:n}=this.device;n.useProgram(this.handle);let s=0,i=0;for(const r of this.shaderLayout.bindings){const a=this.bindings[r.name]||this.bindings[r.name.replace(/Uniforms$/,"")];if(!a)throw new Error(`No value for binding ${r.name} in ${this.id}`);switch(r.type){case"uniform":const{name:l}=r,h=n.getUniformBlockIndex(this.handle,l);if(h===4294967295)throw new Error(`Invalid uniform block name ${l}`);n.uniformBlockBinding(this.handle,i,h),a instanceof fr?n.bindBufferBase(35345,i,a.handle):n.bindBufferRange(35345,i,a.buffer.handle,a.offset||0,a.size||a.buffer.byteLength-a.offset),i+=1;break;case"texture":if(!(a instanceof Ra||a instanceof Hs||a instanceof bl))throw new Error("texture");let d;if(a instanceof Ra)d=a.texture;else if(a instanceof Hs)d=a;else if(a instanceof bl&&a.colorAttachments[0]instanceof Ra)ot.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),d=a.colorAttachments[0].texture;else throw new Error("No texture");n.activeTexture(33984+s),n.bindTexture(d.target,d.handle),s+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${r.type}' not supported in WebGL`)}}}_applyUniforms(){for(const n of this.shaderLayout.uniforms||[]){const{name:s,location:i,type:r,textureUnit:a}=n,l=this.uniforms[s]??a;l!==void 0&&c6(this.device.gl,i,r,l)}}}class f6 extends I0{constructor(n){super(n,{});T(this,"device");T(this,"commands",[]);this.device=n}submitCommands(n=this.commands){for(const s of n)switch(s.name){case"copy-buffer-to-buffer":d6(this.device,s.options);break;case"copy-buffer-to-texture":g6(this.device,s.options);break;case"copy-texture-to-buffer":p6(this.device,s.options);break;case"copy-texture-to-texture":_6(this.device,s.options);break}}}function d6(e,t){const n=t.source,s=t.destination;e.gl.bindBuffer(36662,n.handle),e.gl.bindBuffer(36663,s.handle),e.gl.copyBufferSubData(36662,36663,t.sourceOffset??0,t.destinationOffset??0,t.size),e.gl.bindBuffer(36662,null),e.gl.bindBuffer(36663,null)}function g6(e,t){throw new Error("Not implemented")}function p6(e,t){const{source:n,mipLevel:s=0,aspect:i="all",width:r=t.source.width,height:a=t.source.height,depthOrArrayLayers:l=0,origin:h=[0,0],destination:d,byteOffset:g=0,bytesPerRow:_,rowsPerImage:m}=t;if(i!=="all")throw new Error("not supported");if(s!==0||l!==0||_||m)throw new Error("not implemented");const{framebuffer:y,destroyFramebuffer:E}=rv(n);let b;try{const R=d,M=r||y.width,N=a||y.height,O=td(y.texture.props.format),x=O.dataFormat,I=O.type;e.gl.bindBuffer(35051,R.handle),b=e.gl.bindFramebuffer(36160,y.handle),e.gl.readPixels(h[0],h[1],M,N,x,I,g)}finally{e.gl.bindBuffer(35051,null),b!==void 0&&e.gl.bindFramebuffer(36160,b),E&&y.destroy()}}function _6(e,t){const{source:n,destinationMipLevel:s=0,origin:i=[0,0],destinationOrigin:r=[0,0],destination:a}=t;let{width:l=t.destination.width,height:h=t.destination.height}=t;const{framebuffer:d,destroyFramebuffer:g}=rv(n),[_,m]=i,[y,E,b]=r,R=e.gl.bindFramebuffer(36160,d.handle);let M=null,N;if(a instanceof Hs)M=a,l=Number.isFinite(l)?l:M.width,h=Number.isFinite(h)?h:M.height,M.bind(0),N=M.target;else throw new Error("invalid destination");switch(N){case 3553:case 34067:e.gl.copyTexSubImage2D(N,s,y,E,_,m,l,h);break;case 35866:case 32879:e.gl.copyTexSubImage3D(N,s,y,E,b,_,m,l,h);break}M&&M.unbind(),e.gl.bindFramebuffer(36160,R),g&&d.destroy()}function rv(e){if(e instanceof kn){const{width:t,height:n,id:s}=e;return{framebuffer:e.device.createFramebuffer({id:`framebuffer-for-${s}`,width:t,height:n,colorAttachments:[e]}),destroyFramebuffer:!0}}return{framebuffer:e,destroyFramebuffer:!1}}class m6 extends N0{constructor(n,s){super(n,s);T(this,"device");T(this,"commandBuffer");this.device=n,this.commandBuffer=new f6(n)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(n){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:n})}copyBufferToTexture(n){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:n})}copyTextureToBuffer(n){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:n})}copyTextureToTexture(n){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:n})}pushDebugGroup(n){}popDebugGroup(){}insertDebugMarker(n){}resolveQuerySet(n,s,i){}}class i1 extends D0{constructor(n,s){super(n,s);T(this,"device");T(this,"handle");T(this,"buffer",null);T(this,"bufferValue",null);this.device=n,this.handle=this.device.gl.createVertexArray()}get[Symbol.toStringTag](){return"VertexArray"}static isConstantAttributeZeroSupported(n){return qO()==="Chrome"}destroy(){var n;super.destroy(),this.buffer&&((n=this.buffer)==null||n.destroy()),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(n){const s=n;if(s&&s.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,s?s.handle:null),this.indexBuffer=s,this.device.gl.bindVertexArray(null)}setBuffer(n,s){const i=s;if(i.glTarget===34963)throw new Error("Use .setIndexBuffer()");const{size:r,type:a,stride:l,offset:h,normalized:d,integer:g,divisor:_}=this._getAccessor(n);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,i.handle),g?this.device.gl.vertexAttribIPointer(n,r,a,l,h):this.device.gl.vertexAttribPointer(n,r,a,d,l,h),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(n),this.device.gl.vertexAttribDivisor(n,_||0),this.attributes[n]=i,this.device.gl.bindVertexArray(null)}setConstantWebGL(n,s){this._enable(n,!1),this.attributes[n]=s}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let n=0;n<this.maxVertexAttributes;++n){const s=this.attributes[n];ArrayBuffer.isView(s)&&this.device.setConstantAttributeWebGL(n,s)}}_getAccessor(n){const s=this.attributeInfos[n];if(!s)throw new Error(`Unknown attribute location ${n}`);const i=ZR(s.bufferDataType);return{size:s.bufferComponents,type:i,stride:s.byteStride,offset:s.byteOffset,normalized:s.normalized,integer:s.integer,divisor:s.stepMode==="instance"?1:0}}_enable(n,s=!0){const r=i1.isConstantAttributeZeroSupported(this.device)||n!==0;(s||r)&&(n=Number(n),this.device.gl.bindVertexArray(this.handle),s?this.device.gl.enableVertexAttribArray(n):this.device.gl.disableVertexAttribArray(n),this.device.gl.bindVertexArray(null))}getConstantBuffer(n,s){const i=A6(s),r=i.byteLength*n,a=i.length*n;if(this.buffer&&r!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${r} !== ${this.buffer.byteLength}.`);let l=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:r}),l=l||!y6(i,this.bufferValue),l){const h=DI(s.constructor,a);PI({target:h,source:i,start:0,count:a}),this.buffer.write(h),this.bufferValue=s}return this.buffer}}function A6(e){return Array.isArray(e)?new Float32Array(e):e}function y6(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}class T6 extends P0{constructor(n,s){super(n,s);T(this,"device");T(this,"gl");T(this,"handle");T(this,"layout");T(this,"buffers",{});T(this,"unusedBuffers",{});T(this,"bindOnUse",!0);T(this,"_bound",!1);this.device=n,this.gl=n.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,s.buffers&&this.setBuffers(s.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(n="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(u6(n))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(n){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const s in n)this.setBuffer(s,n[s])})}setBuffer(n,s){const i=this._getVaryingIndex(n),{buffer:r,byteLength:a,byteOffset:l}=this._getBufferRange(s);if(i<0){this.unusedBuffers[n]=r,ot.warn(`${this.id} unusedBuffers varying buffer ${n}`)();return}this.buffers[i]={buffer:r,byteLength:a,byteOffset:l},this.bindOnUse||this._bindBuffer(i,r,l,a)}getBuffer(n){if(Jb(n))return this.buffers[n]||null;const s=this._getVaryingIndex(n);return s>=0?this.buffers[s]:null}bind(n=this.handle){if(typeof n!="function")return this.gl.bindTransformFeedback(36386,n),this;let s;return this._bound?s=n():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,s=n(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),s}unbind(){this.bind(null)}_getBufferRange(n){if(n instanceof fr)return{buffer:n,byteOffset:0,byteLength:n.byteLength};const{buffer:s,byteOffset:i=0,byteLength:r=n.buffer.byteLength}=n;return{buffer:s,byteOffset:i,byteLength:r}}_getVaryingIndex(n){if(Jb(n))return Number(n);for(const s of this.layout.varyings)if(n===s.name)return s.location;return-1}_bindBuffers(){for(const n in this.buffers){const{buffer:s,byteLength:i,byteOffset:r}=this._getBufferRange(this.buffers[n]);this._bindBuffer(Number(n),s,r,i)}}_unbindBuffers(){for(const n in this.buffers)this.gl.bindBufferBase(35982,Number(n),null)}_bindBuffer(n,s,i=0,r){const a=s&&s.handle;!a||r===void 0?this.gl.bindBufferBase(35982,n,a):this.gl.bindBufferRange(35982,n,a,i,r)}}function Jb(e){return typeof e=="number"?Number.isInteger(e):/^\d+$/.test(e)}class E6 extends F0{constructor(n,s){super(n,s);T(this,"device");T(this,"handle");T(this,"target",null);T(this,"_queryPending",!1);T(this,"_pollingPromise",null);if(this.device=n,s.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}get[Symbol.toStringTag](){return"Query"}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(n){return this._begin(n!=null&&n.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(n){this._queryPending||(this.target=n,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const n=this.device.gl.getQueryParameter(this.handle,34919);return n&&(this._queryPending=!1),n}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(n=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let s=0;return this._pollingPromise=new Promise((i,r)=>{const a=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):s++>n?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(a)};requestAnimationFrame(a)}),this._pollingPromise}}function ov(e){switch(e){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Ht(!1),0}}function b6(e){switch(e){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return Ht(!1),0}}function S6(e,t){var R,M;const{sourceX:n=0,sourceY:s=0,sourceFormat:i=6408,sourceAttachment:r=36064}=t||{};let{target:a=null,sourceWidth:l,sourceHeight:h,sourceType:d}=t||{};const{framebuffer:g,deleteFramebuffer:_}=av(e);Ht(g);const{gl:m,handle:y}=g;l=l||g.width,h=h||g.height;const E=r-36064;d=d||((M=(R=g.colorAttachments[E])==null?void 0:R.texture)==null?void 0:M.type)||5121,a=C6(a,d,i,l,h),d=d||qL(a);const b=m.bindFramebuffer(36160,y);return m.readPixels(n,s,l,h,i,d,a),m.bindFramebuffer(36160,b||null),_&&g.destroy(),a}function R6(e,t){const{target:n,sourceX:s=0,sourceY:i=0,sourceFormat:r=6408,targetByteOffset:a=0}=t||{};let{sourceWidth:l,sourceHeight:h,sourceType:d}=t||{};const{framebuffer:g,deleteFramebuffer:_}=av(e);Ht(g),l=l||g.width,h=h||g.height;const m=g;d=d||5121;let y=n;if(!y){const b=ov(r),R=b6(d),M=a+l*h*b*R;y=m.device.createBuffer({byteLength:M})}const E=e.device.createCommandEncoder();return E.copyTextureToBuffer({source:e,width:l,height:h,origin:[s,i],destination:y,byteOffset:a}),E.destroy(),_&&g.destroy(),y}function av(e){return e instanceof Xf?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:v6(e),deleteFramebuffer:!0}}function v6(e,t){const{device:n,width:s,height:i,id:r}=e;return n.createFramebuffer({...t,id:`framebuffer-for-${r}`,width:s,height:i,colorAttachments:[e]})}function C6(e,t,n,s,i){if(e)return e;t=t||5121;const r=tm(t,{clamped:!1}),a=ov(n);return new r(s*i*a)}const M6=256,w6=1024,O6=16384,B6="clear: bad arguments";function x6(e,t){const{framebuffer:n=null,color:s=null,depth:i=null,stencil:r=null}=t||{},a={};n&&(a.framebuffer=n);let l=0;s&&(l|=O6,s!==!0&&(a.clearColor=s)),i&&(l|=M6,i!==!0&&(a.clearDepth=i)),r&&(l|=w6,i!==!0&&(a.clearStencil=i)),Ht(l!==0,B6);const h=e.gl;ur(h,a,()=>{h.clear(l)})}const al=1,Yr=class Yr extends Fa{constructor(n){var h,d;super({...n,id:n.id||yr("webgl-device")});T(this,"type","webgl");T(this,"handle");T(this,"features");T(this,"limits");T(this,"info");T(this,"canvasContext");T(this,"lost");T(this,"_resolveContextLost");T(this,"renderPass",null);T(this,"gl");T(this,"debug",!1);T(this,"_canvasSizeInfo",{clientWidth:0,clientHeight:0,devicePixelRatio:1});T(this,"_extensions",{});T(this,"_polyfilled",!1);T(this,"spectorJS");T(this,"_constants");const s=(h=n.gl)==null?void 0:h.device;if(s)throw new Error(`WebGL context already attached to device ${s.id}`);const i=((d=n.gl)==null?void 0:d.canvas)||n.canvas;this.canvasContext=new CL(this,{...n,canvas:i}),this.lost=new Promise(g=>{this._resolveContextLost=g});let r=n.gl||null;if(r||(r=X4(this.canvasContext.canvas,{...n,onContextLost:g=>{var _;return(_=this._resolveContextLost)==null?void 0:_.call(this,{reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."})}})),!r)throw new Error("WebGL context creation failed");this.handle=r,this.gl=r,this.gl.device=this,this.gl._version=2,n.spector&&(this.spectorJS=xL({...this.props,canvas:this.handle.canvas})),this.info=G4(this.gl,this._extensions),this.limits=new fL(this.gl),this.features=new hL(this.gl,this._extensions,this.props.disabledFeatures),this.props.initalizeFeatures&&this.features.initializeFeatures(),this.canvasContext.resize();const{enable:a=!0,copyState:l=!1}=n;KR(this.gl,{enable:a,copyState:l}),n.debug&&(this.gl=DL(this.gl,{...n,throwOnError:!0}),this.debug=!0,ot.level=Math.max(ot.level,1),ot.warn("WebGL debug mode activated. Performance reduced.")())}static isSupported(){return typeof WebGL2RenderingContext<"u"}static attach(n){if(n instanceof Yr)return n;if((n==null?void 0:n.device)instanceof Fa)return n.device;if(!N6(n))throw new Error("Invalid WebGL2RenderingContext");return new Yr({gl:n})}static async create(n={}){var l;ot.groupCollapsed(al,"WebGLDevice created")();const s=[];n.debug&&s.push(IL()),n.spector&&s.push(BL()),typeof n.canvas=="string"&&s.push(Hm.pageLoaded);const i=await Promise.allSettled(s);for(const h of i)h.status==="rejected"&&ot.error(`Failed to initialize debug libraries ${h.reason}`)();if(ot.probe(al+1,"DOM is loaded")(),(l=n.gl)!=null&&l.device)return ot.warn("reattaching existing device")(),Yr.attach(n.gl);const r=new Yr(n),a=`Created ${r.type}${r.debug?" debug":""} context: ${r.info.vendor}, ${r.info.renderer} for canvas: ${r.canvasContext.id}`;return ot.probe(al,a)(),ot.table(al,r.info)(),ot.groupEnd(al)(),r}destroy(){}get isLost(){return this.gl.isContextLost()}getSize(){return[this.gl.drawingBufferWidth,this.gl.drawingBufferHeight]}isTextureFormatSupported(n){return s1(this.gl,n,this._extensions)}isTextureFormatFilterable(n){return aL(this.gl,n,this._extensions)}isTextureFormatRenderable(n){return cL(this.gl,n,this._extensions)}createCanvasContext(n){throw new Error("WebGL only supports a single canvas")}createBuffer(n){const s=this._getBufferProps(n);return new fr(this,s)}_createTexture(n){return new Hs(this,n)}createExternalTexture(n){throw new Error("createExternalTexture() not implemented")}createSampler(n){return new Q0(this,n)}createShader(n){return new zL(this,n)}createFramebuffer(n){return new bl(this,n)}createVertexArray(n){return new i1(this,n)}createTransformFeedback(n){return new T6(this,n)}createQuerySet(n){return new E6(this,n)}createRenderPipeline(n){return new h6(this,n)}beginRenderPass(n){return new XL(this,n)}createComputePipeline(n){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(n){throw new Error("ComputePass not supported in WebGL")}createCommandEncoder(n){return new m6(this,n)}submit(){var n;(n=this.renderPass)==null||n.end(),this.renderPass=null}readPixelsToArrayWebGL(n,s){return S6(n,s)}readPixelsToBufferWebGL(n,s){return R6(n,s)}setParametersWebGL(n){Qa(this.gl,n)}getParametersWebGL(n){return YR(this.gl,n)}withParametersWebGL(n,s){return ur(this.gl,n,s)}clearWebGL(n){x6(this,n)}resetWebGL(){ot.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),L4(this.gl)}loseDevice(){var r;let n=!1;const i=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return i&&(n=!0,i.loseContext()),(r=this._resolveContextLost)==null||r.call(this,{reason:"destroyed",message:"Application triggered context loss"}),n}pushState(){Pd(this.gl)}popState(){zl(this.gl)}setSpectorMetadata(n,s){n.__SPECTOR_Metadata=s}getGLKey(n,s){s=s||this.gl2||this.gl;const i=Number(n);for(const r in s)if(s[r]===i)return`GL.${r}`;return String(n)}setConstantAttributeWebGL(n,s){const i=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(i).fill(null);const r=this._constants[n];switch(r&&F6(r,s)&&ot.info(1,`setConstantAttributeWebGL(${n}) could have been skipped, value unchanged`)(),this._constants[n]=s,s.constructor){case Float32Array:I6(this,n,s);break;case Int32Array:D6(this,n,s);break;case Uint32Array:P6(this,n,s);break;default:Ht(!1)}}getExtension(n){return _r(this.gl,n,this._extensions),this._extensions}};T(Yr,"type","webgl");let Rl=Yr;function N6(e){return typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext?!0:!!(e&&Number.isFinite(e._version))}function I6(e,t,n){switch(n.length){case 1:e.gl.vertexAttrib1fv(t,n);break;case 2:e.gl.vertexAttrib2fv(t,n);break;case 3:e.gl.vertexAttrib3fv(t,n);break;case 4:e.gl.vertexAttrib4fv(t,n);break;default:Ht(!1)}}function D6(e,t,n){e.gl.vertexAttribI4iv(t,n)}function P6(e,t,n){e.gl.vertexAttribI4uiv(t,n)}function F6(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}var O_={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */var Zb;function U6(){return Zb||(Zb=1,function(e){(function(t,n,s,i){var r=["","webkit","Moz","MS","ms","o"],a=n.createElement("div"),l="function",h=Math.round,d=Math.abs,g=Date.now;function _(v,w,F){return setTimeout(O(v,F),w)}function m(v,w,F){return Array.isArray(v)?(y(v,F[w],F),!0):!1}function y(v,w,F){var G;if(v)if(v.forEach)v.forEach(w,F);else if(v.length!==i)for(G=0;G<v.length;)w.call(F,v[G],G,v),G++;else for(G in v)v.hasOwnProperty(G)&&w.call(F,v[G],G,v)}function E(v,w,F){var G="DEPRECATED METHOD: "+w+`
`+F+` AT 
`;return function(){var it=new Error("get-stack-trace"),dt=it&&it.stack?it.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Mt=t.console&&(t.console.warn||t.console.log);return Mt&&Mt.call(t.console,G,dt),v.apply(this,arguments)}}var b;typeof Object.assign!="function"?b=function(w){if(w===i||w===null)throw new TypeError("Cannot convert undefined or null to object");for(var F=Object(w),G=1;G<arguments.length;G++){var it=arguments[G];if(it!==i&&it!==null)for(var dt in it)it.hasOwnProperty(dt)&&(F[dt]=it[dt])}return F}:b=Object.assign;var R=E(function(w,F,G){for(var it=Object.keys(F),dt=0;dt<it.length;)(!G||G&&w[it[dt]]===i)&&(w[it[dt]]=F[it[dt]]),dt++;return w},"extend","Use `assign`."),M=E(function(w,F){return R(w,F,!0)},"merge","Use `assign`.");function N(v,w,F){var G=w.prototype,it;it=v.prototype=Object.create(G),it.constructor=v,it._super=G,F&&b(it,F)}function O(v,w){return function(){return v.apply(w,arguments)}}function x(v,w){return typeof v==l?v.apply(w&&w[0]||i,w):v}function I(v,w){return v===i?w:v}function P(v,w,F){y(Q(w),function(G){v.addEventListener(G,F,!1)})}function J(v,w,F){y(Q(w),function(G){v.removeEventListener(G,F,!1)})}function et(v,w){for(;v;){if(v==w)return!0;v=v.parentNode}return!1}function q(v,w){return v.indexOf(w)>-1}function Q(v){return v.trim().split(/\s+/g)}function rt(v,w,F){if(v.indexOf&&!F)return v.indexOf(w);for(var G=0;G<v.length;){if(F&&v[G][F]==w||!F&&v[G]===w)return G;G++}return-1}function ct(v){return Array.prototype.slice.call(v,0)}function ft(v,w,F){for(var G=[],it=[],dt=0;dt<v.length;){var Mt=v[dt][w];rt(it,Mt)<0&&G.push(v[dt]),it[dt]=Mt,dt++}return G=G.sort(function(de,Me){return de[w]>Me[w]}),G}function Y(v,w){for(var F,G,it=w[0].toUpperCase()+w.slice(1),dt=0;dt<r.length;){if(F=r[dt],G=F?F+it:w,G in v)return G;dt++}return i}var Tt=1;function K(){return Tt++}function lt(v){var w=v.ownerDocument||v;return w.defaultView||w.parentWindow||t}var At=/mobile|tablet|ip(ad|hone|od)|android/i,Pt="ontouchstart"in t,U=Y(t,"PointerEvent")!==i,st=Pt&&At.test(navigator.userAgent),ut="touch",ht="pen",_t="mouse",It="kinect",vt=25,jt=1,Ut=2,$t=4,xe=8,Xs=1,Gs=2,Ws=4,qs=8,Er=16,Vn=Gs|Ws,Ne=qs|Er,cu=Vn|Ne,ec=["x","y"],br=["clientX","clientY"];function ke(v,w){var F=this;this.manager=v,this.callback=w,this.element=v.element,this.target=v.options.inputTarget,this.domHandler=function(G){x(v.options.enable,[v])&&F.handler(G)},this.init()}ke.prototype={handler:function(){},init:function(){this.evEl&&P(this.element,this.evEl,this.domHandler),this.evTarget&&P(this.target,this.evTarget,this.domHandler),this.evWin&&P(lt(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&J(this.element,this.evEl,this.domHandler),this.evTarget&&J(this.target,this.evTarget,this.domHandler),this.evWin&&J(lt(this.element),this.evWin,this.domHandler)}};function Wd(v){var w,F=v.options.inputClass;return F?w=F:U?w=sc:st?w=me:Pt?w=rc:w=Ao,new w(v,lu)}function lu(v,w,F){var G=F.pointers.length,it=F.changedPointers.length,dt=w&jt&&G-it===0,Mt=w&($t|xe)&&G-it===0;F.isFirst=!!dt,F.isFinal=!!Mt,dt&&(v.session={}),F.eventType=w,qd(v,F),v.emit("hammer.input",F),v.recognize(F),v.session.prevInput=F}function qd(v,w){var F=v.session,G=w.pointers,it=G.length;F.firstInput||(F.firstInput=Ge(w)),it>1&&!F.firstMultiple?F.firstMultiple=Ge(w):it===1&&(F.firstMultiple=!1);var dt=F.firstInput,Mt=F.firstMultiple,Te=Mt?Mt.center:dt.center,de=w.center=ss(G);w.timeStamp=g(),w.deltaTime=w.timeStamp-dt.timeStamp,w.angle=nc(Te,de),w.distance=go(Te,de),Yd(F,w),w.offsetDirection=uu(w.deltaX,w.deltaY);var Me=We(w.deltaTime,w.deltaX,w.deltaY);w.overallVelocityX=Me.x,w.overallVelocityY=Me.y,w.overallVelocity=d(Me.x)>d(Me.y)?Me.x:Me.y,w.scale=Mt?_o(Mt.pointers,G):1,w.rotation=Mt?po(Mt.pointers,G):0,w.maxPointers=F.prevInput?w.pointers.length>F.prevInput.maxPointers?w.pointers.length:F.prevInput.maxPointers:w.pointers.length,Sr(F,w);var un=v.element;et(w.srcEvent.target,un)&&(un=w.srcEvent.target),w.target=un}function Yd(v,w){var F=w.center,G=v.offsetDelta||{},it=v.prevDelta||{},dt=v.prevInput||{};(w.eventType===jt||dt.eventType===$t)&&(it=v.prevDelta={x:dt.deltaX||0,y:dt.deltaY||0},G=v.offsetDelta={x:F.x,y:F.y}),w.deltaX=it.x+(F.x-G.x),w.deltaY=it.y+(F.y-G.y)}function Sr(v,w){var F=v.lastInterval||w,G=w.timeStamp-F.timeStamp,it,dt,Mt,Te;if(w.eventType!=xe&&(G>vt||F.velocity===i)){var de=w.deltaX-F.deltaX,Me=w.deltaY-F.deltaY,un=We(G,de,Me);dt=un.x,Mt=un.y,it=d(un.x)>d(un.y)?un.x:un.y,Te=uu(de,Me),v.lastInterval=w}else it=F.velocity,dt=F.velocityX,Mt=F.velocityY,Te=F.direction;w.velocity=it,w.velocityX=dt,w.velocityY=Mt,w.direction=Te}function Ge(v){for(var w=[],F=0;F<v.pointers.length;)w[F]={clientX:h(v.pointers[F].clientX),clientY:h(v.pointers[F].clientY)},F++;return{timeStamp:g(),pointers:w,center:ss(w),deltaX:v.deltaX,deltaY:v.deltaY}}function ss(v){var w=v.length;if(w===1)return{x:h(v[0].clientX),y:h(v[0].clientY)};for(var F=0,G=0,it=0;it<w;)F+=v[it].clientX,G+=v[it].clientY,it++;return{x:h(F/w),y:h(G/w)}}function We(v,w,F){return{x:w/v||0,y:F/v||0}}function uu(v,w){return v===w?Xs:d(v)>=d(w)?v<0?Gs:Ws:w<0?qs:Er}function go(v,w,F){F||(F=ec);var G=w[F[0]]-v[F[0]],it=w[F[1]]-v[F[1]];return Math.sqrt(G*G+it*it)}function nc(v,w,F){F||(F=ec);var G=w[F[0]]-v[F[0]],it=w[F[1]]-v[F[1]];return Math.atan2(it,G)*180/Math.PI}function po(v,w){return nc(w[1],w[0],br)+nc(v[1],v[0],br)}function _o(v,w){return go(w[0],w[1],br)/go(v[0],v[1],br)}var Ys={mousedown:jt,mousemove:Ut,mouseup:$t},mo="mousedown",Rr="mousemove mouseup";function Ao(){this.evEl=mo,this.evWin=Rr,this.pressed=!1,ke.apply(this,arguments)}N(Ao,ke,{handler:function(w){var F=Ys[w.type];F&jt&&w.button===0&&(this.pressed=!0),F&Ut&&w.which!==1&&(F=$t),this.pressed&&(F&$t&&(this.pressed=!1),this.callback(this.manager,F,{pointers:[w],changedPointers:[w],pointerType:_t,srcEvent:w}))}});var hu={pointerdown:jt,pointermove:Ut,pointerup:$t,pointercancel:xe,pointerout:xe},fu={2:ut,3:ht,4:_t,5:It},yo="pointerdown",Ri="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(yo="MSPointerDown",Ri="MSPointerMove MSPointerUp MSPointerCancel");function sc(){this.evEl=yo,this.evWin=Ri,ke.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}N(sc,ke,{handler:function(w){var F=this.store,G=!1,it=w.type.toLowerCase().replace("ms",""),dt=hu[it],Mt=fu[w.pointerType]||w.pointerType,Te=Mt==ut,de=rt(F,w.pointerId,"pointerId");dt&jt&&(w.button===0||Te)?de<0&&(F.push(w),de=F.length-1):dt&($t|xe)&&(G=!0),!(de<0)&&(F[de]=w,this.callback(this.manager,dt,{pointers:F,changedPointers:[w],pointerType:Mt,srcEvent:w}),G&&F.splice(de,1))}});var du={touchstart:jt,touchmove:Ut,touchend:$t,touchcancel:xe},gu="touchstart",ic="touchstart touchmove touchend touchcancel";function To(){this.evTarget=gu,this.evWin=ic,this.started=!1,ke.apply(this,arguments)}N(To,ke,{handler:function(w){var F=du[w.type];if(F===jt&&(this.started=!0),!!this.started){var G=pu.call(this,w,F);F&($t|xe)&&G[0].length-G[1].length===0&&(this.started=!1),this.callback(this.manager,F,{pointers:G[0],changedPointers:G[1],pointerType:ut,srcEvent:w})}}});function pu(v,w){var F=ct(v.touches),G=ct(v.changedTouches);return w&($t|xe)&&(F=ft(F.concat(G),"identifier")),[F,G]}var Kd={touchstart:jt,touchmove:Ut,touchend:$t,touchcancel:xe},Ts="touchstart touchmove touchend touchcancel";function me(){this.evTarget=Ts,this.targetIds={},ke.apply(this,arguments)}N(me,ke,{handler:function(w){var F=Kd[w.type],G=qe.call(this,w,F);G&&this.callback(this.manager,F,{pointers:G[0],changedPointers:G[1],pointerType:ut,srcEvent:w})}});function qe(v,w){var F=ct(v.touches),G=this.targetIds;if(w&(jt|Ut)&&F.length===1)return G[F[0].identifier]=!0,[F,F];var it,dt,Mt=ct(v.changedTouches),Te=[],de=this.target;if(dt=F.filter(function(Me){return et(Me.target,de)}),w===jt)for(it=0;it<dt.length;)G[dt[it].identifier]=!0,it++;for(it=0;it<Mt.length;)G[Mt[it].identifier]&&Te.push(Mt[it]),w&($t|xe)&&delete G[Mt[it].identifier],it++;if(Te.length)return[ft(dt.concat(Te),"identifier"),Te]}var vi=2500,Eo=25;function rc(){ke.apply(this,arguments);var v=O(this.handler,this);this.touch=new me(this.manager,v),this.mouse=new Ao(this.manager,v),this.primaryTouch=null,this.lastTouches=[]}N(rc,ke,{handler:function(w,F,G){var it=G.pointerType==ut,dt=G.pointerType==_t;if(!(dt&&G.sourceCapabilities&&G.sourceCapabilities.firesTouchEvents)){if(it)Jd.call(this,F,G);else if(dt&&vr.call(this,G))return;this.callback(w,F,G)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Jd(v,w){v&jt?(this.primaryTouch=w.changedPointers[0].identifier,oc.call(this,w)):v&($t|xe)&&oc.call(this,w)}function oc(v){var w=v.changedPointers[0];if(w.identifier===this.primaryTouch){var F={x:w.clientX,y:w.clientY};this.lastTouches.push(F);var G=this.lastTouches,it=function(){var dt=G.indexOf(F);dt>-1&&G.splice(dt,1)};setTimeout(it,vi)}}function vr(v){for(var w=v.srcEvent.clientX,F=v.srcEvent.clientY,G=0;G<this.lastTouches.length;G++){var it=this.lastTouches[G],dt=Math.abs(w-it.x),Mt=Math.abs(F-it.y);if(dt<=Eo&&Mt<=Eo)return!0}return!1}var bo=Y(a.style,"touchAction"),Ks=bo!==i,Js="compute",Ci="auto",Es="manipulation",oe="none",Mi="pan-x",wi="pan-y",Hn=_u();function bs(v,w){this.manager=v,this.set(w)}bs.prototype={set:function(v){v==Js&&(v=this.compute()),Ks&&this.manager.element.style&&Hn[v]&&(this.manager.element.style[bo]=v),this.actions=v.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var v=[];return y(this.manager.recognizers,function(w){x(w.options.enable,[w])&&(v=v.concat(w.getTouchAction()))}),Zd(v.join(" "))},preventDefaults:function(v){var w=v.srcEvent,F=v.offsetDirection;if(this.manager.session.prevented){w.preventDefault();return}var G=this.actions,it=q(G,oe)&&!Hn[oe],dt=q(G,wi)&&!Hn[wi],Mt=q(G,Mi)&&!Hn[Mi];if(it){var Te=v.pointers.length===1,de=v.distance<2,Me=v.deltaTime<250;if(Te&&de&&Me)return}if(!(Mt&&dt)&&(it||dt&&F&Vn||Mt&&F&Ne))return this.preventSrc(w)},preventSrc:function(v){this.manager.session.prevented=!0,v.preventDefault()}};function Zd(v){if(q(v,oe))return oe;var w=q(v,Mi),F=q(v,wi);return w&&F?oe:w||F?w?Mi:wi:q(v,Es)?Es:Ci}function _u(){if(!Ks)return!1;var v={},w=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(F){v[F]=w?t.CSS.supports("touch-action",F):!0}),v}var Cr=1,an=2,is=4,Rn=8,Ce=Rn,Zs=16,vn=32;function Ye(v){this.options=b({},this.defaults,v||{}),this.id=K(),this.manager=null,this.options.enable=I(this.options.enable,!0),this.state=Cr,this.simultaneous={},this.requireFail=[]}Ye.prototype={defaults:{},set:function(v){return b(this.options,v),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(v){if(m(v,"recognizeWith",this))return this;var w=this.simultaneous;return v=vo(v,this),w[v.id]||(w[v.id]=v,v.recognizeWith(this)),this},dropRecognizeWith:function(v){return m(v,"dropRecognizeWith",this)?this:(v=vo(v,this),delete this.simultaneous[v.id],this)},requireFailure:function(v){if(m(v,"requireFailure",this))return this;var w=this.requireFail;return v=vo(v,this),rt(w,v)===-1&&(w.push(v),v.requireFailure(this)),this},dropRequireFailure:function(v){if(m(v,"dropRequireFailure",this))return this;v=vo(v,this);var w=rt(this.requireFail,v);return w>-1&&this.requireFail.splice(w,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(v){return!!this.simultaneous[v.id]},emit:function(v){var w=this,F=this.state;function G(it){w.manager.emit(it,v)}F<Rn&&G(w.options.event+So(F)),G(w.options.event),v.additionalEvent&&G(v.additionalEvent),F>=Rn&&G(w.options.event+So(F))},tryEmit:function(v){if(this.canEmit())return this.emit(v);this.state=vn},canEmit:function(){for(var v=0;v<this.requireFail.length;){if(!(this.requireFail[v].state&(vn|Cr)))return!1;v++}return!0},recognize:function(v){var w=b({},v);if(!x(this.options.enable,[this,w])){this.reset(),this.state=vn;return}this.state&(Ce|Zs|vn)&&(this.state=Cr),this.state=this.process(w),this.state&(an|is|Rn|Zs)&&this.tryEmit(w)},process:function(v){},getTouchAction:function(){},reset:function(){}};function So(v){return v&Zs?"cancel":v&Rn?"end":v&is?"move":v&an?"start":""}function Ro(v){return v==Er?"down":v==qs?"up":v==Gs?"left":v==Ws?"right":""}function vo(v,w){var F=w.manager;return F?F.get(v):v}function cn(){Ye.apply(this,arguments)}N(cn,Ye,{defaults:{pointers:1},attrTest:function(v){var w=this.options.pointers;return w===0||v.pointers.length===w},process:function(v){var w=this.state,F=v.eventType,G=w&(an|is),it=this.attrTest(v);return G&&(F&xe||!it)?w|Zs:G||it?F&$t?w|Rn:w&an?w|is:an:vn}});function ze(){cn.apply(this,arguments),this.pX=null,this.pY=null}N(ze,cn,{defaults:{event:"pan",threshold:10,pointers:1,direction:cu},getTouchAction:function(){var v=this.options.direction,w=[];return v&Vn&&w.push(wi),v&Ne&&w.push(Mi),w},directionTest:function(v){var w=this.options,F=!0,G=v.distance,it=v.direction,dt=v.deltaX,Mt=v.deltaY;return it&w.direction||(w.direction&Vn?(it=dt===0?Xs:dt<0?Gs:Ws,F=dt!=this.pX,G=Math.abs(v.deltaX)):(it=Mt===0?Xs:Mt<0?qs:Er,F=Mt!=this.pY,G=Math.abs(v.deltaY))),v.direction=it,F&&G>w.threshold&&it&w.direction},attrTest:function(v){return cn.prototype.attrTest.call(this,v)&&(this.state&an||!(this.state&an)&&this.directionTest(v))},emit:function(v){this.pX=v.deltaX,this.pY=v.deltaY;var w=Ro(v.direction);w&&(v.additionalEvent=this.options.event+w),this._super.emit.call(this,v)}});function Co(){cn.apply(this,arguments)}N(Co,cn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[oe]},attrTest:function(v){return this._super.attrTest.call(this,v)&&(Math.abs(v.scale-1)>this.options.threshold||this.state&an)},emit:function(v){if(v.scale!==1){var w=v.scale<1?"in":"out";v.additionalEvent=this.options.event+w}this._super.emit.call(this,v)}});function ac(){Ye.apply(this,arguments),this._timer=null,this._input=null}N(ac,Ye,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ci]},process:function(v){var w=this.options,F=v.pointers.length===w.pointers,G=v.distance<w.threshold,it=v.deltaTime>w.time;if(this._input=v,!G||!F||v.eventType&($t|xe)&&!it)this.reset();else if(v.eventType&jt)this.reset(),this._timer=_(function(){this.state=Ce,this.tryEmit()},w.time,this);else if(v.eventType&$t)return Ce;return vn},reset:function(){clearTimeout(this._timer)},emit:function(v){this.state===Ce&&(v&&v.eventType&$t?this.manager.emit(this.options.event+"up",v):(this._input.timeStamp=g(),this.manager.emit(this.options.event,this._input)))}});function Oi(){cn.apply(this,arguments)}N(Oi,cn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[oe]},attrTest:function(v){return this._super.attrTest.call(this,v)&&(Math.abs(v.rotation)>this.options.threshold||this.state&an)}});function Mo(){cn.apply(this,arguments)}N(Mo,cn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Vn|Ne,pointers:1},getTouchAction:function(){return ze.prototype.getTouchAction.call(this)},attrTest:function(v){var w=this.options.direction,F;return w&(Vn|Ne)?F=v.overallVelocity:w&Vn?F=v.overallVelocityX:w&Ne&&(F=v.overallVelocityY),this._super.attrTest.call(this,v)&&w&v.offsetDirection&&v.distance>this.options.threshold&&v.maxPointers==this.options.pointers&&d(F)>this.options.velocity&&v.eventType&$t},emit:function(v){var w=Ro(v.offsetDirection);w&&this.manager.emit(this.options.event+w,v),this.manager.emit(this.options.event,v)}});function Qs(){Ye.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}N(Qs,Ye,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Es]},process:function(v){var w=this.options,F=v.pointers.length===w.pointers,G=v.distance<w.threshold,it=v.deltaTime<w.time;if(this.reset(),v.eventType&jt&&this.count===0)return this.failTimeout();if(G&&it&&F){if(v.eventType!=$t)return this.failTimeout();var dt=this.pTime?v.timeStamp-this.pTime<w.interval:!0,Mt=!this.pCenter||go(this.pCenter,v.center)<w.posThreshold;this.pTime=v.timeStamp,this.pCenter=v.center,!Mt||!dt?this.count=1:this.count+=1,this._input=v;var Te=this.count%w.taps;if(Te===0)return this.hasRequireFailures()?(this._timer=_(function(){this.state=Ce,this.tryEmit()},w.interval,this),an):Ce}return vn},failTimeout:function(){return this._timer=_(function(){this.state=vn},this.options.interval,this),vn},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Ce&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Ss(v,w){return w=w||{},w.recognizers=I(w.recognizers,Ss.defaults.preset),new Oo(v,w)}Ss.VERSION="2.0.7",Ss.defaults={domEvents:!1,touchAction:Js,enable:!0,inputTarget:null,inputClass:null,preset:[[Oi,{enable:!1}],[Co,{enable:!1},["rotate"]],[Mo,{direction:Vn}],[ze,{direction:Vn},["swipe"]],[Qs],[Qs,{event:"doubletap",taps:2},["tap"]],[ac]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ln=1,wo=2;function Oo(v,w){this.options=b({},Ss.defaults,w||{}),this.options.inputTarget=this.options.inputTarget||v,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=v,this.input=Wd(this),this.touchAction=new bs(this,this.options.touchAction),Bo(this,!0),y(this.options.recognizers,function(F){var G=this.add(new F[0](F[1]));F[2]&&G.recognizeWith(F[2]),F[3]&&G.requireFailure(F[3])},this)}Oo.prototype={set:function(v){return b(this.options,v),v.touchAction&&this.touchAction.update(),v.inputTarget&&(this.input.destroy(),this.input.target=v.inputTarget,this.input.init()),this},stop:function(v){this.session.stopped=v?wo:ln},recognize:function(v){var w=this.session;if(!w.stopped){this.touchAction.preventDefaults(v);var F,G=this.recognizers,it=w.curRecognizer;(!it||it&&it.state&Ce)&&(it=w.curRecognizer=null);for(var dt=0;dt<G.length;)F=G[dt],w.stopped!==wo&&(!it||F==it||F.canRecognizeWith(it))?F.recognize(v):F.reset(),!it&&F.state&(an|is|Rn)&&(it=w.curRecognizer=F),dt++}},get:function(v){if(v instanceof Ye)return v;for(var w=this.recognizers,F=0;F<w.length;F++)if(w[F].options.event==v)return w[F];return null},add:function(v){if(m(v,"add",this))return this;var w=this.get(v.options.event);return w&&this.remove(w),this.recognizers.push(v),v.manager=this,this.touchAction.update(),v},remove:function(v){if(m(v,"remove",this))return this;if(v=this.get(v),v){var w=this.recognizers,F=rt(w,v);F!==-1&&(w.splice(F,1),this.touchAction.update())}return this},on:function(v,w){if(v!==i&&w!==i){var F=this.handlers;return y(Q(v),function(G){F[G]=F[G]||[],F[G].push(w)}),this}},off:function(v,w){if(v!==i){var F=this.handlers;return y(Q(v),function(G){w?F[G]&&F[G].splice(rt(F[G],w),1):delete F[G]}),this}},emit:function(v,w){this.options.domEvents&&Bi(v,w);var F=this.handlers[v]&&this.handlers[v].slice();if(!(!F||!F.length)){w.type=v,w.preventDefault=function(){w.srcEvent.preventDefault()};for(var G=0;G<F.length;)F[G](w),G++}},destroy:function(){this.element&&Bo(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Bo(v,w){var F=v.element;if(F.style){var G;y(v.options.cssProps,function(it,dt){G=Y(F.style,dt),w?(v.oldCssProps[G]=F.style[G],F.style[G]=it):F.style[G]=v.oldCssProps[G]||""}),w||(v.oldCssProps={})}}function Bi(v,w){var F=n.createEvent("Event");F.initEvent(v,!0,!0),F.gesture=w,w.target.dispatchEvent(F)}b(Ss,{INPUT_START:jt,INPUT_MOVE:Ut,INPUT_END:$t,INPUT_CANCEL:xe,STATE_POSSIBLE:Cr,STATE_BEGAN:an,STATE_CHANGED:is,STATE_ENDED:Rn,STATE_RECOGNIZED:Ce,STATE_CANCELLED:Zs,STATE_FAILED:vn,DIRECTION_NONE:Xs,DIRECTION_LEFT:Gs,DIRECTION_RIGHT:Ws,DIRECTION_UP:qs,DIRECTION_DOWN:Er,DIRECTION_HORIZONTAL:Vn,DIRECTION_VERTICAL:Ne,DIRECTION_ALL:cu,Manager:Oo,Input:ke,TouchAction:bs,TouchInput:me,MouseInput:Ao,PointerEventInput:sc,TouchMouseInput:rc,SingleTouchInput:To,Recognizer:Ye,AttrRecognizer:cn,Tap:Qs,Pan:ze,Swipe:Mo,Pinch:Co,Rotate:Oi,Press:ac,on:P,off:J,each:y,merge:M,extend:R,assign:b,inherit:N,bindFn:O,prefixed:Y});var mu=typeof t<"u"?t:typeof self<"u"?self:{};mu.Hammer=Ss,e.exports?e.exports=Ss:t[s]=Ss})(window,document,"Hammer")}(O_)),O_.exports}var tu=U6();const L6=Nm(tu),Ns=PO({__proto__:null,default:L6},[tu]),cv=1,lv=2,em=4,k6={mousedown:cv,mousemove:lv,mouseup:em};function z6(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return!0;return!1}function V6(e){const t=e.prototype.handler;e.prototype.handler=function(s){const i=this.store;s.button>0&&s.type==="pointerdown"&&(z6(i,r=>r.pointerId===s.pointerId)||i.push(s)),t.call(this,s)}}function H6(e){e.prototype.handler=function(n){let s=k6[n.type];s&cv&&n.button>=0&&(this.pressed=!0),s&lv&&n.which===0&&(s=em),this.pressed&&(s&em&&(this.pressed=!1),this.callback(this.manager,s,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}V6(tu.PointerEventInput);H6(tu.MouseInput);const j6=tu.Manager;class Ud{constructor(t,n,s){this.element=t,this.callback=n,this.options={enable:!0,...s}}}const $6=Ns?[[Ns.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Ns.Rotate,{enable:!1}],[Ns.Pinch,{enable:!1}],[Ns.Swipe,{enable:!1}],[Ns.Pan,{threshold:0,enable:!1}],[Ns.Press,{enable:!1}],[Ns.Tap,{event:"doubletap",taps:2,enable:!1}],[Ns.Tap,{event:"anytap",enable:!1}],[Ns.Tap,{enable:!1}]]:null,Qb={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},X6={doubletap:["tap"]},G6={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},r1={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},W6={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},t2={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},q6=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",va=typeof window<"u"?window:global;let nm=!1;try{const e={get passive(){return nm=!0,!0}};va.addEventListener("test",null,e),va.removeEventListener("test",null)}catch{nm=!1}const Y6=q6.indexOf("firefox")!==-1,{WHEEL_EVENTS:K6}=r1,e2="wheel",n2=4.000244140625,J6=40,Z6=.25;class Q6 extends Ud{constructor(t,n,s){super(t,n,s),this.handleEvent=i=>{if(!this.options.enable)return;let r=i.deltaY;va.WheelEvent&&(Y6&&i.deltaMode===va.WheelEvent.DOM_DELTA_PIXEL&&(r/=va.devicePixelRatio),i.deltaMode===va.WheelEvent.DOM_DELTA_LINE&&(r*=J6)),r!==0&&r%n2===0&&(r=Math.floor(r/n2)),i.shiftKey&&r&&(r=r*Z6),this.callback({type:e2,center:{x:i.clientX,y:i.clientY},delta:-r,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(K6),this.events.forEach(i=>t.addEventListener(i,this.handleEvent,nm?{passive:!1}:!1))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,n){t===e2&&(this.options.enable=n)}}const{MOUSE_EVENTS:tk}=r1,s2="pointermove",i2="pointerover",r2="pointerout",o2="pointerenter",a2="pointerleave";class ek extends Ud{constructor(t,n,s){super(t,n,s),this.handleEvent=r=>{this.handleOverEvent(r),this.handleOutEvent(r),this.handleEnterEvent(r),this.handleLeaveEvent(r),this.handleMoveEvent(r)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(tk),this.events.forEach(r=>t.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,n){t===s2&&(this.enableMoveEvent=n),t===i2&&(this.enableOverEvent=n),t===r2&&(this.enableOutEvent=n),t===o2&&(this.enableEnterEvent=n),t===a2&&(this.enableLeaveEvent=n)}handleOverEvent(t){this.enableOverEvent&&t.type==="mouseover"&&this._emit(i2,t)}handleOutEvent(t){this.enableOutEvent&&t.type==="mouseout"&&this._emit(r2,t)}handleEnterEvent(t){this.enableEnterEvent&&t.type==="mouseenter"&&this._emit(o2,t)}handleLeaveEvent(t){this.enableLeaveEvent&&t.type==="mouseleave"&&this._emit(a2,t)}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":t.which===0&&(this.pressed=!1),this.pressed||this._emit(s2,t);break;case"mouseup":this.pressed=!1;break}}_emit(t,n){this.callback({type:t,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:nk}=r1,c2="keydown",l2="keyup";class sk extends Ud{constructor(t,n,s){super(t,n,s),this.handleEvent=i=>{const r=i.target||i.srcElement;r.tagName==="INPUT"&&r.type==="text"||r.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:c2,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:l2,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(nk),t.tabIndex=this.options.tabIndex||0,t.style.outline="none",this.events.forEach(i=>t.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,n){t===c2&&(this.enableDownEvent=n),t===l2&&(this.enableUpEvent=n)}}const u2="contextmenu";class ik extends Ud{constructor(t,n,s){super(t,n,s),this.handleEvent=i=>{this.options.enable&&this.callback({type:u2,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,n){t===u2&&(this.options.enable=n)}}const sm=1,ed=2,im=4,rk={pointerdown:sm,pointermove:ed,pointerup:im,mousedown:sm,mousemove:ed,mouseup:im},ok=1,ak=2,ck=3,lk=0,uk=1,hk=2,fk=1,dk=2,gk=4;function pk(e){const t=rk[e.srcEvent.type];if(!t)return null;const{buttons:n,button:s,which:i}=e.srcEvent;let r=!1,a=!1,l=!1;return t===im||t===ed&&!Number.isFinite(n)?(r=i===ok,a=i===ak,l=i===ck):t===ed?(r=!!(n&fk),a=!!(n&gk),l=!!(n&dk)):t===sm&&(r=s===lk,a=s===uk,l=s===hk),{leftButton:r,middleButton:a,rightButton:l}}function _k(e,t){const n=e.center;if(!n)return null;const s=t.getBoundingClientRect(),i=s.width/t.offsetWidth||1,r=s.height/t.offsetHeight||1,a={x:(n.x-s.left-t.clientLeft)/i,y:(n.y-s.top-t.clientTop)/r};return{center:n,offsetCenter:a}}const B_={srcElement:"root",priority:0};class mk{constructor(t){this.handleEvent=n=>{if(this.isEmpty())return;const s=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==s.rootElement;){if(this._emit(s,i),s.handled)return;i=i.parentNode}this._emit(s,"root")},this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(t,n,s,i=!1,r=!1){const{handlers:a,handlersByElement:l}=this;let h=B_;typeof s=="string"||s&&s.addEventListener?h={...B_,srcElement:s}:s&&(h={...B_,...s});let d=l.get(h.srcElement);d||(d=[],l.set(h.srcElement,d));const g={type:t,handler:n,srcElement:h.srcElement,priority:h.priority};i&&(g.once=!0),r&&(g.passive=!0),a.push(g),this._active=this._active||!g.passive;let _=d.length-1;for(;_>=0&&!(d[_].priority>=g.priority);)_--;d.splice(_+1,0,g)}remove(t,n){const{handlers:s,handlersByElement:i}=this;for(let r=s.length-1;r>=0;r--){const a=s[r];if(a.type===t&&a.handler===n){s.splice(r,1);const l=i.get(a.srcElement);l.splice(l.indexOf(a),1),l.length===0&&i.delete(a.srcElement)}}this._active=s.some(r=>!r.passive)}_emit(t,n){const s=this.handlersByElement.get(n);if(s){let i=!1;const r=()=>{t.handled=!0},a=()=>{t.handled=!0,i=!0},l=[];for(let h=0;h<s.length;h++){const{type:d,handler:g,once:_}=s[h];if(g({...t,type:d,stopPropagation:r,stopImmediatePropagation:a}),_&&l.push(s[h]),i)break}for(let h=0;h<l.length;h++){const{type:d,handler:g}=l[h];this.remove(d,g)}}}_normalizeEvent(t){const n=this.eventManager.getElement();return{...t,...pk(t),..._k(t,n),preventDefault:()=>{t.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const Ak={events:null,recognizers:null,recognizerOptions:{},Manager:j6,touchAction:"none",tabIndex:0};class yk{constructor(t=null,n){this._onBasicInput=i=>{const{srcEvent:r}=i,a=G6[r.type];a&&this.manager.emit(a,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...Ak,...n},this.events=new Map,this.setElement(t);const{events:s}=this.options;s&&this.on(s)}getElement(){return this.element}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:n}=this,s=n.Manager;this.manager=new s(t,{touchAction:n.touchAction,recognizers:n.recognizers||$6}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(Qb).forEach(i=>{const r=this.manager.get(i);r&&Qb[i].forEach(a=>{r.recognizeWith(a)})});for(const i in n.recognizerOptions){const r=this.manager.get(i);if(r){const a=n.recognizerOptions[i];delete a.enable,r.set(a)}}this.wheelInput=new Q6(t,this._onOtherEvent,{enable:!1}),this.moveInput=new ek(t,this._onOtherEvent,{enable:!1}),this.keyInput=new sk(t,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new ik(t,this._onOtherEvent,{enable:!1});for(const[i,r]of this.events)r.isEmpty()||(this._toggleRecognizer(r.recognizerName,!0),this.manager.on(i,r.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,n,s){this._addEventHandler(t,n,s,!1)}once(t,n,s){this._addEventHandler(t,n,s,!0)}watch(t,n,s){this._addEventHandler(t,n,s,!1,!0)}off(t,n){this._removeEventHandler(t,n)}_toggleRecognizer(t,n){const{manager:s}=this;if(!s)return;const i=s.get(t);if(i&&i.options.enable!==n){i.set({enable:n});const r=X6[t];r&&!this.options.recognizers&&r.forEach(a=>{const l=s.get(a);n?(l.requireFailure(t),i.dropRequireFailure(a)):l.dropRequireFailure(t)})}this.wheelInput.enableEventType(t,n),this.moveInput.enableEventType(t,n),this.keyInput.enableEventType(t,n),this.contextmenuInput.enableEventType(t,n)}_addEventHandler(t,n,s,i,r){if(typeof t!="string"){s=n;for(const g in t)this._addEventHandler(g,t[g],s,i,r);return}const{manager:a,events:l}=this,h=t2[t]||t;let d=l.get(h);d||(d=new mk(this),l.set(h,d),d.recognizerName=W6[h]||h,a&&a.on(h,d.handleEvent)),d.add(t,n,s,i,r),d.isEmpty()||this._toggleRecognizer(d.recognizerName,!0)}_removeEventHandler(t,n){if(typeof t!="string"){for(const a in t)this._removeEventHandler(a,t[a]);return}const{events:s}=this,i=t2[t]||t,r=s.get(i);if(r&&(r.remove(t,n),r.isEmpty())){const{recognizerName:a}=r;let l=!1;for(const h of s.values())if(h.recognizerName===a&&!h.isEmpty()){l=!0;break}l||this._toggleRecognizer(a,!1)}}}function nr(){}const Tk=({isDragging:e})=>e?"grabbing":"grab",uv={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{type:"webgl"},gl:null,glOptions:{},canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:nr,onWebGLInitialized:nr,onResize:nr,onViewStateChange:nr,onInteractionStateChange:nr,onBeforeRender:nr,onAfterRender:nr,onLoad:nr,onError:e=>kt.error(e.message,e.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:Tk,getTooltip:null,debug:!1,drawPickingColors:!1};class Vl{constructor(t){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new Za({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=s=>{const{_pickRequest:i}=this;if(s.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(s.leftButton||s.rightButton)return;{const r=s.offsetCenter;if(!r)return;i.x=r.x,i.y=r.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=s},this._onEvent=s=>{const i=$0[s.type],r=s.offsetCenter;if(!i||!r||!this.layerManager)return;const a=this.layerManager.getLayers(),l=this.deckPicker.getLastPickedObject({x:r.x,y:r.y,layers:a,viewports:this.getViewports(r)},this._lastPointerDownInfo),{layer:h}=l,d=h&&(h[i.handler]||h.props[i.handler]),g=this.props[i.handler];let _=!1;d&&(_=d.call(h,l,s)),_||(g==null||g(l,s),this.widgetManager.onEvent(l,s))},this._onPointerDown=s=>{const i=s.offsetCenter,r=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=r.result[0]||r.emptyInfo},this.props={...uv,...t},t=this.props,t.viewState&&t.initialViewState&&kt.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,t.device?this.device=t.device:t.gl&&(t.gl instanceof WebGLRenderingContext&&kt.error("WebGL1 context not supported.")(),this.device=Rl.attach(t.gl));let n=this.device;n||(Oa.registerDevices([Rl]),n=Oa.createDevice({...t.deviceProps,canvas:this._createCanvas(t)})),this.animationLoop=this._createAnimationLoop(n,t),this.setProps(t),t._typedArrayManagerProps&&Ll.setOptions(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){var t,n,s,i,r,a,l,h,d,g;(t=this.animationLoop)==null||t.stop(),(n=this.animationLoop)==null||n.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,(s=this.layerManager)==null||s.finalize(),this.layerManager=null,(i=this.viewManager)==null||i.finalize(),this.viewManager=null,(r=this.effectManager)==null||r.finalize(),this.effectManager=null,(a=this.deckRenderer)==null||a.finalize(),this.deckRenderer=null,(l=this.deckPicker)==null||l.finalize(),this.deckPicker=null,(h=this.eventManager)==null||h.destroy(),this.eventManager=null,(d=this.widgetManager)==null||d.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&((g=this.canvas.parentElement)==null||g.removeChild(this.canvas),this.canvas=null)}setProps(t){var s;this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&kt.removed("onLayerHover","onHover")(),"onLayerClick"in t&&kt.removed("onLayerClick","onClick")(),t.initialViewState&&!fs(this.props.initialViewState,t.initialViewState,3)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),(s=this.animationLoop)==null||s.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n),this.widgetManager.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(t={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const s=this.viewManager.needsRedraw(t),i=this.layerManager.needsRedraw(t),r=this.effectManager.needsRedraw(t),a=this.deckRenderer.needsRedraw(t);return n=n||s||i||r||a,n}redraw(t){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=t||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Be(this.viewManager),this.viewManager.views}getViewports(t){return Be(this.viewManager),this.viewManager.getViewports(t)}getCanvas(){return this.canvas}pickObject(t){const n=this._pick("pickObject","pickObject Time",t).result;return n.length?n[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t,n=!1){for(const s in t)this.layerManager.resourceManager.add({resourceId:s,data:t[s],forceUpdate:n})}_removeResources(t){for(const n of t)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(t){this.effectManager.addDefaultEffect(t)}_addDefaultShaderModule(t){this.layerManager.addDefaultShaderModule(t)}_removeDefaultShaderModule(t){var n;(n=this.layerManager)==null||n.removeDefaultShaderModule(t)}_pick(t,n,s){Be(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const r=this.deckPicker[t]({layers:this.layerManager.getLayers(s),views:this.viewManager.getViews(),viewports:this.getViewports(s),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...s});return i.get(n).timeEnd(),r}_createCanvas(t){let n=t.canvas;return typeof n=="string"&&(n=document.getElementById(n),Be(n)),n||(n=document.createElement("canvas"),n.id=t.id||"deckgl-overlay",(t.parent||document.body).appendChild(n)),Object.assign(n.style,t.style),n}_setCanvasSize(t){var i;if(!this.canvas)return;const{width:n,height:s}=t;if(n||n===0){const r=Number.isFinite(n)?`${n}px`:n;this.canvas.style.width=r}if(s||s===0){const r=Number.isFinite(s)?`${s}px`:s;this.canvas.style.position=((i=t.style)==null?void 0:i.position)||"absolute",this.canvas.style.height=r}}_updateCanvasSize(){var i,r;const{canvas:t}=this;if(!t)return;const n=t.clientWidth??t.width,s=t.clientHeight??t.height;(n!==this.width||s!==this.height)&&(this.width=n,this.height=s,(i=this.viewManager)==null||i.setProps({width:n,height:s}),(r=this.layerManager)==null||r.activateViewport(this.getViewports()[0]),this.props.onResize({width:n,height:s}))}_createAnimationLoop(t,n){const{gl:s,onError:i,useDevicePixels:r}=n;return new kU({device:t,useDevicePixels:r,autoResizeDrawingBuffer:!s,autoResizeViewport:!1,onInitialize:a=>this._setDevice(a.device),onRender:this._onRenderFrame.bind(this),onError:i})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:t}=this.props,n=Array.isArray(t)?t:t?[t]:[new t1({id:"default-view"})];return n.length&&this.props.controller&&(n[0].props.controller=this.props.controller),n}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_pickAndCallback(){var n,s,i;const{_pickRequest:t}=this;if(t.event){const{result:r,emptyInfo:a}=this._pick("pickObject","pickObject Time",t);this.cursorState.isHovering=r.length>0;let l=a,h=!1;for(const d of r)l=d,h=((n=d.layer)==null?void 0:n.onHover(d,t.event))||h;h||((i=(s=this.props).onHover)==null||i.call(s,l,t.event),this.widgetManager.onHover(l,t.event)),t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(t){var i,r;if(this.device=t,!this.animationLoop)return;this.canvas||(this.canvas=(i=this.device.canvasContext)==null?void 0:i.canvas),this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device instanceof Rl&&this.props.onWebGLInitialized(this.device.gl);const n=new jR;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new yk(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const a in $0)this.eventManager.on(a,this._onEvent);this.viewManager=new s4({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const s=this.viewManager.getViewports()[0];this.layerManager=new n4(this.device,{deck:this,stats:this.stats,viewport:s,timeline:n}),this.effectManager=new T4({deck:this,device:this.device}),this.deckRenderer=new S4(this.device),this.deckPicker=new O4(this.device),this.widgetManager=new N4({deck:this,parentElement:(r=this.canvas)==null?void 0:r.parentElement}),this.widgetManager.addDefault(new D4),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,n){var a;const{device:s,gl:i}=this.layerManager.context;this.props.onBeforeRender({device:s,gl:i});const r={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n};(a=this.deckRenderer)==null||a.renderLayers(r),r.pass==="screen"&&this.widgetManager.onRedraw({viewports:r.viewports,layers:r.layers}),this.props.onAfterRender({device:s,gl:i})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),kt.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const n=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.cursorState.isDragging=t.isDragging||!1,this.props.onInteractionStateChange(t)}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const n=this.animationLoop.stats;t.get("GPU Time").addTime(n.get("GPU Time").lastTiming),t.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:n}=this;t.fps=n.get("frameRate").getHz(),t.setPropsTime=n.get("setProps Time").time,t.updateAttributesTime=n.get("Update Attributes").time,t.framesRedrawn=n.get("Redraw Count").count,t.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,t.pickCount=n.get("Pick Count").count,t.gpuTime=n.get("GPU Time").time,t.cpuTime=n.get("CPU Time").time,t.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const s=Oa.stats.get("Memory Usage");t.bufferMemory=s.get("Buffer Memory").count,t.textureMemory=s.get("Texture Memory").count,t.renderbufferMemory=s.get("Renderbuffer Memory").count,t.gpuMemory=s.get("GPU Memory").count}}Vl.defaultProps=uv;Vl.VERSION=_N;function Ek(e){switch(e){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return rR(e)}}const bk=iR;function Fh(e,t){return{attribute:e,format:t.size>1?`${t.type}x${t.size}`:t.type,byteOffset:t.offset||0}}function Zr(e){return e.stride||e.size*e.bytesPerElement}function Sk(e,t){return e.type===t.type&&e.size===t.size&&Zr(e)===Zr(t)&&(e.offset||0)===(t.offset||0)}function rm(e,t){t.offset&&kt.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=Zr(e),s=t.vertexOffset!==void 0?t.vertexOffset:e.vertexOffset||0,i=t.elementOffset||0,r=s*n+i*e.bytesPerElement+(e.offset||0);return{...t,offset:r,stride:n}}function Rk(e,t){const n=rm(e,t);return{high:n,low:{...n,offset:n.offset+e.size*4}}}class vk{constructor(t,n,s){this._buffer=null,this.device=t,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,r=i==="float64";let{defaultValue:a}=n;a=Number.isFinite(a)?[a]:a||new Array(this.size).fill(0);let l;r?l="float32":!i&&n.isIndexed?l="uint32":l=i||"float32";let h=Ek(i||l);this.doublePrecision=r,r&&n.fp64===!1&&(h=Float32Array),this.value=null,this.settings={...n,defaultType:h,defaultValue:a,logicalType:i,type:l,normalized:l.includes("norm"),size:this.size,bytesPerElement:h.BYTES_PER_ELEMENT},this.state={...s,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*Zr(t):0}get numInstances(){return this.state.numInstances}set numInstances(t){this.state.numInstances=t}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Ll.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(t=this.id,n=null){const s={};if(this.state.constant){const i=this.value;if(n){const r=rm(this.getAccessor(),n),a=r.offset/i.BYTES_PER_ELEMENT,l=r.size||this.size;s[t]=i.subarray(a,a+l)}else s[t]=i}else s[t]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?s[`${t}64Low`]=s[t]:s[`${t}64Low`]=new Float32Array(this.size)),s}_getBufferLayout(t=this.id,n=null){const s=this.getAccessor(),i=[],r={name:this.id,byteStride:Zr(s),attributes:i};if(this.doublePrecision){const a=Rk(s,n||{});i.push(Fh(t,{...s,...a.high}),Fh(`${t}64Low`,{...s,...a.low}))}else if(n){const a=rm(s,n);i.push(Fh(t,{...s,...a}))}else i.push(Fh(t,s));return r}setAccessor(t){this.state.bufferAccessor=t}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let t=null;if(this.state.constant&&this.value){const n=Array.from(this.value);t=[n,n]}else{const{value:n,numInstances:s,size:i}=this,r=s*i;if(n&&r&&n.length>=r){const a=new Array(i).fill(1/0),l=new Array(i).fill(-1/0);for(let h=0;h<r;)for(let d=0;d<i;d++){const g=n[h++];g<a[d]&&(a[d]=g),g>l[d]&&(l[d]=g)}t=[a,l]}}return this.state.bounds=t,t}setData(t){const{state:n}=this;let s;ArrayBuffer.isView(t)?s={value:t}:t instanceof fe?s={buffer:t}:s=t;const i={...this.settings,...s};if(ArrayBuffer.isView(s.value)){if(!s.type)if(this.doublePrecision&&s.value instanceof Float64Array)i.type="float32";else{const a=bk(s.value);i.type=i.normalized?a.replace("int","norm"):a}i.bytesPerElement=s.value.BYTES_PER_ELEMENT,i.stride=Zr(i)}if(n.bounds=null,s.constant){let r=s.value;if(r=this._normalizeValue(r,[],0),this.settings.normalized&&(r=this.normalizeConstant(r)),!(!n.constant||!this._areValuesEqual(r,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=ArrayBuffer.isView(r)?r:new Float32Array(r)}else if(s.buffer){const r=s.buffer;n.externalBuffer=r,n.constant=!1,this.value=s.value||null}else if(s.value){this._checkExternalBuffer(s);let r=s.value;n.externalBuffer=null,n.constant=!1,this.value=r;let{buffer:a}=this;const l=Zr(i),h=(i.vertexOffset||0)*l;if(this.doublePrecision&&r instanceof Float64Array&&(r=__(r,i)),this.settings.isIndexed){const g=this.settings.defaultType;r.constructor!==g&&(r=new g(r))}const d=r.byteLength+h+l*2;(!a||a.byteLength<d)&&(a=this._createBuffer(d)),a.write(r,h)}return this.setAccessor(i),!0}updateSubBuffer(t={}){this.state.bounds=null;const n=this.value,{startOffset:s=0,endOffset:i}=t;this.buffer.write(this.doublePrecision&&n instanceof Float64Array?__(n,{size:this.size,startIndex:s,endIndex:i}):n.subarray(s,i),s*n.BYTES_PER_ELEMENT+this.byteOffset)}allocate(t,n=!1){const{state:s}=this,i=s.allocatedValue,r=Ll.allocate(i,t+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=r;const{byteOffset:a}=this;let{buffer:l}=this;return(!l||l.byteLength<r.byteLength+a)&&(l=this._createBuffer(r.byteLength+a),n&&i&&l.write(i instanceof Float64Array?__(i,this):i,a)),s.allocatedValue=r,s.constant=!1,s.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(t){const{value:n}=t;if(!ArrayBuffer.isView(n))throw new Error(`Attribute ${this.id} value is not TypedArray`);const s=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error(`Attribute ${this.id} does not support ${n.constructor.name}`);!(n instanceof s)&&this.settings.normalized&&!("normalized"in t)&&kt.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(t){switch(this.settings.type){case"snorm8":return new Float32Array(t).map(n=>(n+128)/255*2-1);case"snorm16":return new Float32Array(t).map(n=>(n+32768)/65535*2-1);case"unorm8":return new Float32Array(t).map(n=>n/255);case"unorm16":return new Float32Array(t).map(n=>n/65535);default:return t}}_normalizeValue(t,n,s){const{defaultValue:i,size:r}=this.settings;if(Number.isFinite(t))return n[s]=t,n;if(!t){let a=r;for(;--a>=0;)n[s+a]=i[a];return n}switch(r){case 4:n[s+3]=Number.isFinite(t[3])?t[3]:i[3];case 3:n[s+2]=Number.isFinite(t[2])?t[2]:i[2];case 2:n[s+1]=Number.isFinite(t[1])?t[1]:i[1];case 1:n[s+0]=Number.isFinite(t[0])?t[0]:i[0];break;default:let a=r;for(;--a>=0;)n[s+a]=Number.isFinite(t[a])?t[a]:i[a]}return n}_areValuesEqual(t,n){if(!t||!n)return!1;const{size:s}=this;for(let i=0;i<s;i++)if(t[i]!==n[i])return!1;return!0}_createBuffer(t){var i;this._buffer&&this._buffer.destroy();const{isIndexed:n,type:s}=this.settings;return this._buffer=this.device.createBuffer({...(i=this._buffer)==null?void 0:i.props,id:this.id,usage:n?fe.INDEX:fe.VERTEX,indexType:n?s:void 0,byteLength:t}),this._buffer}}const h2=[],f2=[];function hv(e,t=0,n=1/0){let s=h2;const i={index:-1,data:e,target:[]};return e?typeof e[Symbol.iterator]=="function"?s=e:e.length>0&&(f2.length=e.length,s=f2):s=h2,(t>0||Number.isFinite(n))&&(s=(Array.isArray(s)?s:Array.from(s)).slice(t,n),i.index=t-1),{iterable:s,objectInfo:i}}function fv(e){return e&&e[Symbol.asyncIterator]}function Ck(e,t){const{size:n,stride:s,offset:i,startIndices:r,nested:a}=t,l=e.BYTES_PER_ELEMENT,h=s?s/l:n,d=i?i/l:0,g=Math.floor((e.length-d)/h);return(_,{index:m,target:y})=>{if(!r){const M=m*h+d;for(let N=0;N<n;N++)y[N]=e[M+N];return y}const E=r[m],b=r[m+1]||g;let R;if(a){R=new Array(b-E);for(let M=E;M<b;M++){const N=M*h+d;y=new Array(n);for(let O=0;O<n;O++)y[O]=e[N+O];R[M-E]=y}}else if(h===n)R=e.subarray(E*n+d,b*n+d);else{R=new e.constructor((b-E)*n);let M=0;for(let N=E;N<b;N++){const O=N*h+d;for(let x=0;x<n;x++)R[M++]=e[O+x]}}return R}}const Mk=[],vf=[[0,1/0]];function wk(e,t){if(e===vf||(t[0]<0&&(t[0]=0),t[0]>=t[1]))return e;const n=[],s=e.length;let i=0;for(let r=0;r<s;r++){const a=e[r];a[1]<t[0]?(n.push(a),i=r+1):a[0]>t[1]?n.push(a):t=[Math.min(a[0],t[0]),Math.max(a[1],t[1])]}return n.splice(i,0,t),n}const Ok={interpolation:{duration:0,easing:e=>e},spring:{stiffness:.05,damping:.5}};function dv(e,t){if(!e)return null;Number.isFinite(e)&&(e={type:"interpolation",duration:e});const n=e.type||"interpolation";return{...Ok[n],...t,...e,type:n}}class gv extends vk{constructor(t,n){super(t,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:vf}),this.constant=!1,this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:t=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!t,n}layoutChanged(){return this.state.layoutChanged}setAccessor(t){var n;(n=this.state).layoutChanged||(n.layoutChanged=!Sk(t,this.getAccessor())),super.setAccessor(t)}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat(typeof t!="function"&&t||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:n}=this.settings,s=this.settings.transition,i=Array.isArray(n)?t[n.find(r=>t[r])]:t[n];return dv(i,s)}setNeedsUpdate(t=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),n){const{startRow:s=0,endRow:i=1/0}=n;this.state.updateRanges=wk(this.state.updateRanges,[s,i])}else this.state.updateRanges=vf}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Mk}setNeedsRedraw(t=this.id){this.state.needsRedraw=this.state.needsRedraw||t}allocate(t){const{state:n,settings:s}=this;return s.noAlloc?!1:s.update?(super.allocate(t,n.updateRanges!==vf),!0):!1}updateBuffer({numInstances:t,data:n,props:s,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:r},settings:{update:a,noAlloc:l}}=this;let h=!0;if(a){for(const[d,g]of r)a.call(i,this,{data:n,startRow:d,endRow:g,props:s,numInstances:t});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[d,g]of r){const _=Number.isFinite(d)?this.getVertexOffset(d):0,m=Number.isFinite(g)?this.getVertexOffset(g):l||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:_,endOffset:m})}this._checkAttributeArray()}else h=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),h}setConstantValue(t){return t===void 0||typeof t=="function"?!1:(this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(t){const{state:n}=this;return t?(this.clearNeedsUpdate(),n.lastExternalBuffer===t||(n.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(t,n=null){const{state:s,settings:i}=this;if(!t)return s.binaryValue=null,s.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(s.binaryValue===t)return this.clearNeedsUpdate(),!0;if(s.binaryValue=t,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(t)&&(t={value:t});const a=t;Be(ArrayBuffer.isView(a.value),`invalid ${i.accessor}`);const l=!!a.size&&a.size!==this.size;return s.binaryAccessor=Ck(a.value,{size:a.size||this.size,stride:a.stride,offset:a.offset,startIndices:n,nested:l}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:n}=this;return(n?t<n.length?n[t]:this.numInstances:t)*this.size}getValue(){const t=this.settings.shaderAttributes,n=super.getValue();if(!t)return n;for(const s in t)Object.assign(n,super.getValue(s,t[s]));return n}getBufferLayout(t){this.state.layoutChanged=!1;const n=this.settings.shaderAttributes,s=super._getBufferLayout(),{stepMode:i}=this.settings;if(i==="dynamic"?s.stepMode=t?t.isInstanced?"instance":"vertex":"instance":s.stepMode=i??"vertex",!n)return s;for(const r in n){const a=super._getBufferLayout(r,n[r]);s.attributes.push(...a.attributes)}return s}_autoUpdater(t,{data:n,startRow:s,endRow:i,props:r,numInstances:a}){if(t.constant)return;const{settings:l,state:h,value:d,size:g,startIndices:_}=t,{accessor:m,transform:y}=l,E=h.binaryAccessor||(typeof m=="function"?m:r[m]);Be(typeof E=="function",`accessor "${m}" is not a function`);let b=t.getVertexOffset(s);const{iterable:R,objectInfo:M}=hv(n,s,i);for(const N of R){M.index++;let O=E(N,M);if(y&&(O=y.call(this,O)),_){const x=(M.index<_.length-1?_[M.index+1]:a)-_[M.index];if(O&&Array.isArray(O[0])){let I=b;for(const P of O)t._normalizeValue(P,d,I),I+=g}else O&&O.length>g?d.set(O,b):(t._normalizeValue(O,M.target,0),JU({target:d,source:M.target,start:b,count:x}));b+=x*g}else t._normalizeValue(O,d,b),b+=g}}_validateAttributeUpdaters(){const{settings:t}=this;if(!(t.noAlloc||typeof t.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:t}=this,n=Math.min(4,this.size);if(t&&t.length>=n){let s=!0;switch(n){case 4:s=s&&Number.isFinite(t[3]);case 3:s=s&&Number.isFinite(t[2]);case 2:s=s&&Number.isFinite(t[1]);case 1:s=s&&Number.isFinite(t[0]);break;default:s=!1}if(!s)throw new Error(`Illegal attribute generated for ${this.id}`)}}}function x_(e){const{source:t,target:n,start:s=0,size:i,getData:r}=e,a=e.end||n.length,l=t.length,h=a-s;if(l>h){n.set(t.subarray(0,h),s);return}if(n.set(t,s),!r)return;let d=l;for(;d<h;){const g=r(d,t);for(let _=0;_<i;_++)n[s+d]=g[_]||0,d++}}function Bk({source:e,target:t,size:n,getData:s,sourceStartIndices:i,targetStartIndices:r}){if(!i||!r)return x_({source:e,target:t,size:n,getData:s}),t;let a=0,l=0;const h=s&&((g,_)=>s(g+l,_)),d=Math.min(i.length,r.length);for(let g=1;g<d;g++){const _=i[g]*n,m=r[g]*n;x_({source:e.subarray(a,_),target:t,start:l,end:m,size:n,getData:h}),a=_,l=m}return l<t.length&&x_({source:[],target:t,start:l,size:n,getData:h}),t}function xk(e){const{device:t,settings:n,value:s}=e,i=new gv(t,n);return i.setData({value:s instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:n.normalized}),i}function pv(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${e}"`)}}function _v(e){switch(e){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function mv(e){e.push(e.shift())}function Nk(e,t){const{doublePrecision:n,settings:s,value:i,size:r}=e,a=n&&i instanceof Float64Array?2:1;let l=0;const{shaderAttributes:h}=e.settings;if(h)for(const d of Object.values(h))l=Math.max(l,d.vertexOffset??0);return(s.noAlloc?i.length:(t+l)*r)*a}function Av({device:e,source:t,target:n}){return(!n||n.byteLength<t.byteLength)&&(n==null||n.destroy(),n=e.createBuffer({byteLength:t.byteLength,usage:t.usage})),n}function yv({device:e,buffer:t,attribute:n,fromLength:s,toLength:i,fromStartIndices:r,getData:a=l=>l}){const l=n.doublePrecision&&n.value instanceof Float64Array?2:1,h=n.size*l,d=n.byteOffset,g=n.settings.bytesPerElement<4?d/n.settings.bytesPerElement*4:d,_=n.startIndices,m=r&&_,y=n.isConstant;if(!m&&t&&s>=i)return t;const E=n.value instanceof Float64Array?Float32Array:n.value.constructor,b=y?n.value:new E(n.getBuffer().readSyncWebGL(d,i*E.BYTES_PER_ELEMENT).buffer);if(n.settings.normalized&&!y){const O=a;a=(x,I)=>n.normalizeConstant(O(x,I))}const R=y?(O,x)=>a(b,x):(O,x)=>a(b.subarray(O+d,O+d+h),x),M=t?new Float32Array(t.readSyncWebGL(g,s*4).buffer):new Float32Array(0),N=new Float32Array(i);return Bk({source:M,target:N,sourceStartIndices:r,targetStartIndices:_,size:h,getData:R}),(!t||t.byteLength<N.byteLength+g)&&(t==null||t.destroy(),t=e.createBuffer({byteLength:N.byteLength+g,usage:35050})),t.write(N,g),t}class Tv{constructor({device:t,attribute:n,timeline:s}){this.buffers=[],this.currentLength=0,this.device=t,this.transition=new Dd(s),this.attribute=n,this.attributeInTransition=xk(n),this.currentStartIndices=n.startIndices}get inProgress(){return this.transition.inProgress}start(t,n,s=1/0){this.settings=t,this.currentStartIndices=this.attribute.startIndices,this.currentLength=Nk(this.attribute,n),this.transition.start({...t,duration:s})}update(){const t=this.transition.update();return t&&this.onUpdate(),t}setBuffer(t){this.attributeInTransition.setData({buffer:t,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const t of this.buffers)t.destroy();this.buffers.length=0}}class Ik extends Tv{constructor({device:t,attribute:n,timeline:s}){super({device:t,attribute:n,timeline:s}),this.type="interpolation",this.transform=Fk(t,n)}start(t,n){const s=this.currentLength,i=this.currentStartIndices;if(super.start(t,n,t.duration),t.duration<=0){this.transition.cancel();return}const{buffers:r,attribute:a}=this;mv(r),r[0]=yv({device:this.device,buffer:r[0],attribute:a,fromLength:s,toLength:this.currentLength,fromStartIndices:i,getData:t.enter}),r[1]=Av({device:this.device,source:r[0],target:r[1]}),this.setBuffer(r[1]);const{transform:l}=this,h=l.model;let d=Math.floor(this.currentLength/a.size);Ev(a)&&(d/=2),h.setVertexCount(d),a.isConstant?(h.setAttributes({aFrom:r[0]}),h.setConstantAttributes({aTo:a.value})):h.setAttributes({aFrom:r[0],aTo:a.getBuffer()}),l.transformFeedback.setBuffers({vCurrent:r[1]})}onUpdate(){const{duration:t,easing:n}=this.settings,{time:s}=this.transition;let i=s/t;n&&(i=n(i));const{model:r}=this.transform;r.setUniforms({time:i}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}}const Dk=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`,Pk=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function Ev(e){return e.doublePrecision&&e.value instanceof Float64Array}function Fk(e,t){const n=t.size,s=pv(n),i=_v(n),r=t.getBufferLayout();return Ev(t)?new kl(e,{vs:Pk,bufferLayout:[{name:"aFrom",byteStride:8*n,attributes:[{attribute:"aFrom",format:i,byteOffset:0},{attribute:"aFrom64Low",format:i,byteOffset:4*n}]},{name:"aTo",byteStride:8*n,attributes:[{attribute:"aTo",format:i,byteOffset:0},{attribute:"aTo64Low",format:i,byteOffset:4*n}]}],modules:[jD],defines:{ATTRIBUTE_TYPE:s,ATTRIBUTE_SIZE:n},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new kl(e,{vs:Dk,bufferLayout:[{name:"aFrom",format:i},{name:"aTo",format:r.attributes[0].format}],defines:{ATTRIBUTE_TYPE:s},varyings:["vCurrent"],disableWarnings:!0})}class Uk extends Tv{constructor({device:t,attribute:n,timeline:s}){super({device:t,attribute:n,timeline:s}),this.type="spring",this.texture=Vk(t),this.framebuffer=Hk(t,this.texture),this.transform=zk(t,n)}start(t,n){const s=this.currentLength,i=this.currentStartIndices;super.start(t,n);const{buffers:r,attribute:a}=this;for(let h=0;h<2;h++)r[h]=yv({device:this.device,buffer:r[h],attribute:a,fromLength:s,toLength:this.currentLength,fromStartIndices:i,getData:t.enter});r[2]=Av({device:this.device,source:r[0],target:r[2]}),this.setBuffer(r[1]);const{model:l}=this.transform;l.setVertexCount(Math.floor(this.currentLength/a.size)),a.isConstant?l.setConstantAttributes({aTo:a.value}):l.setAttributes({aTo:a.getBuffer()})}onUpdate(){const{buffers:t,transform:n,framebuffer:s,transition:i}=this,r=this.settings;n.model.setAttributes({aPrev:t[0],aCur:t[1]}),n.transformFeedback.setBuffers({vNext:t[2]}),n.model.setUniforms({stiffness:r.stiffness,damping:r.damping}),n.run({framebuffer:s,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),mv(t),this.setBuffer(t[1]),this.device.readPixelsToArrayWebGL(s)[0]>0||i.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}const Lk=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,kk=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function zk(e,t){const n=pv(t.size),s=_v(t.size);return new kl(e,{vs:Lk,fs:kk,bufferLayout:[{name:"aPrev",format:s},{name:"aCur",format:s},{name:"aTo",format:t.getBufferLayout().attributes[0].format}],varyings:["vNext"],defines:{ATTRIBUTE_TYPE:n},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function Vk(e){return e.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}function Hk(e,t){return e.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[t]})}const jk={interpolation:Ik,spring:Uk};class $k{constructor(t,{id:n,timeline:s}){if(!t)throw new Error("AttributeTransitionManager is constructed without device");this.id=n,this.device=t,this.timeline=s,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const t in this.transitions)this._removeTransition(t)}update({attributes:t,transitions:n,numInstances:s}){this.numInstances=s||1;for(const i in t){const r=t[i],a=r.getTransitionSetting(n);a&&this._updateAttribute(i,r,a)}for(const i in this.transitions){const r=t[i];(!r||!r.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(t){const n=this.transitions[t];return n&&n.inProgress}getAttributes(){const t={};for(const n in this.transitions){const s=this.transitions[n];s.inProgress&&(t[n]=s.attributeInTransition)}return t}run(){if(this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].delete(),delete this.transitions[t]}_updateAttribute(t,n,s){const i=this.transitions[t];let r=!i||i.type!==s.type;if(r){i&&this._removeTransition(t);const a=jk[s.type];a?this.transitions[t]=new a({attribute:n,timeline:this.timeline,device:this.device}):(kt.error(`unsupported transition type '${s.type}'`)(),r=!1)}(r||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(s,this.numInstances))}}const d2="attributeManager.invalidate",Xk="attributeManager.updateStart",Gk="attributeManager.updateEnd",Wk="attribute.updateStart",qk="attribute.allocate",Yk="attribute.updateEnd";class Kk{constructor(t,{id:n="attribute-manager",stats:s,timeline:i}={}){this.mergeBoundsMemoized=Zl(wU),this.id=n,this.device=t,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=s,this.attributeTransitionManager=new $k(t,{id:`${n}-transitions`,timeline:i}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(t={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(t){this._add(t)}addInstanced(t){this._add(t,{stepMode:"instance"})}remove(t){for(const n of t)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(t,n){const s=this._invalidateTrigger(t,n);Qe(d2,this,t,s)}invalidateAll(t){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,t);Qe(d2,this,"all")}update({data:t,numInstances:n,startIndices:s=null,transitions:i,props:r={},buffers:a={},context:l={}}){let h=!1;Qe(Xk,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const d in this.attributes){const g=this.attributes[d],_=g.settings.accessor;g.startIndices=s,g.numInstances=n,r[d]&&kt.removed(`props.${d}`,`data.attributes.${d}`)(),g.setExternalBuffer(a[d])||g.setBinaryValue(typeof _=="string"?a[_]:void 0,t.startIndices)||typeof _=="string"&&!a[_]&&g.setConstantValue(r[_])||g.needsUpdate()&&(h=!0,this._updateAttribute({attribute:g,numInstances:n,data:t,props:r,context:l})),this.needsRedraw=this.needsRedraw||g.needsRedraw()}h&&Qe(Gk,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:t}=this,n=t.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(t){const n=t.map(s=>{var i;return(i=this.attributes[s])==null?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(t={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:s}=this,i={...s.getAttributes()};for(const r in n){const a=n[r];a.needsRedraw(t)&&!s.hasAttribute(r)&&(i[r]=a)}return i}getBufferLayouts(t){return Object.values(this.getAttributes()).map(n=>n.getBufferLayout(t))}_add(t,n){for(const s in t){const i=t[s],r={...i,id:s,size:i.isIndexed&&1||i.size||1,...n};this.attributes[s]=new gv(this.device,r)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const t={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{t[i]||(t[i]=[]),t[i].push(n)});this.updateTriggers=t}_invalidateTrigger(t,n){const{attributes:s,updateTriggers:i}=this,r=i[t];return r&&r.forEach(a=>{const l=s[a];l&&l.setNeedsUpdate(l.id,n)}),r}_updateAttribute(t){const{attribute:n,numInstances:s}=t;if(Qe(Wk,n),n.constant){n.setConstantValue(n.value);return}n.allocate(s)&&Qe(qk,n,s),n.updateBuffer(t)&&(this.needsRedraw=!0,Qe(Yk,n,s))}}class Jk extends Dd{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:n,toValue:s,duration:i,easing:r}}=this,a=r(t/i);this._value=Yf(n,s,a)}}const g2=1e-5;function p2(e,t,n,s,i){const r=t-e,l=(n-t)*i,h=-r*s;return l+h+r+t}function Zk(e,t,n,s,i){if(Array.isArray(n)){const r=[];for(let a=0;a<n.length;a++)r[a]=p2(e[a],t[a],n[a],s,i);return r}return p2(e,t,n,s,i)}function _2(e,t){if(Array.isArray(e)){let n=0;for(let s=0;s<e.length;s++){const i=e[s]-t[s];n+=i*i}return Math.sqrt(n)}return Math.abs(e-t)}class Qk extends Dd{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:n,damping:s,stiffness:i}=this.settings,{_prevValue:r=t,_currValue:a=t}=this;let l=Zk(r,a,n,s,i);const h=_2(l,n),d=_2(l,a);h<g2&&d<g2&&(l=n,this.end()),this._prevValue=a,this._currValue=l}}const t8={interpolation:Jk,spring:Qk};class e8{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,n,s,i){const{transitions:r}=this;if(r.has(t)){const h=r.get(t),{value:d=h.settings.fromValue}=h;n=d,this.remove(t)}if(i=dv(i),!i)return;const a=t8[i.type];if(!a){kt.error(`unsupported transition type '${i.type}'`)();return}const l=new a(this.timeline);l.start({...i,fromValue:n,toValue:s}),r.set(t,l)}remove(t){const{transitions:n}=this;n.has(t)&&(n.get(t).cancel(),n.delete(t))}update(){const t={};for(const[n,s]of this.transitions)s.update(),t[n]=s.value,s.inProgress||this.remove(n);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}function n8(e){const t=e[hr];for(const n in t){const s=t[n],{validate:i}=s;if(i&&!i(e[n],s))throw new Error(`Invalid prop ${n}: ${e[n]}`)}}function s8(e,t){const n=bv({newProps:e,oldProps:t,propTypes:e[hr],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),s=r8(e,t);let i=!1;return s||(i=o8(e,t)),{dataChanged:s,propsChanged:n,updateTriggersChanged:i,extensionsChanged:a8(e,t),transitionsChanged:i8(e,t)}}function i8(e,t){if(!e.transitions)return!1;const n={},s=e[hr];let i=!1;for(const r in e.transitions){const a=s[r],l=a&&a.type;(l==="number"||l==="color"||l==="array")&&om(e[r],t[r],a)&&(n[r]=!0,i=!0)}return i?n:!1}function bv({newProps:e,oldProps:t,ignoreProps:n={},propTypes:s={},triggerName:i="props"}){if(t===e)return!1;if(typeof e!="object"||e===null)return`${i} changed shallowly`;if(typeof t!="object"||t===null)return`${i} changed shallowly`;for(const r of Object.keys(e))if(!(r in n)){if(!(r in t))return`${i}.${r} added`;const a=om(e[r],t[r],s[r]);if(a)return`${i}.${r} ${a}`}for(const r of Object.keys(t))if(!(r in n)){if(!(r in e))return`${i}.${r} dropped`;if(!Object.hasOwnProperty.call(e,r)){const a=om(e[r],t[r],s[r]);if(a)return`${i}.${r} ${a}`}}return!1}function om(e,t,n){let s=n&&n.equal;return s&&!s(e,t,n)||!s&&(s=e&&t&&e.equals,s&&!s.call(e,t))?"changed deeply":!s&&t!==e?"changed shallowly":null}function r8(e,t){if(t===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:s,_dataDiff:i}=e;return s?s(e.data,t.data)||(n="Data comparator detected a change"):e.data!==t.data&&(n="A new data container was supplied"),n&&i&&(n=i(e.data,t.data)||n),n}function o8(e,t){if(t===null)return{all:!0};if("all"in e.updateTriggers&&m2(e,t,"all"))return{all:!0};const n={};let s=!1;for(const i in e.updateTriggers)i!=="all"&&m2(e,t,i)&&(n[i]=!0,s=!0);return s?n:!1}function a8(e,t){if(t===null)return!0;const n=t.extensions,{extensions:s}=e;if(s===n)return!1;if(!n||!s||s.length!==n.length)return!0;for(let i=0;i<s.length;i++)if(!s[i].equals(n[i]))return!0;return!1}function m2(e,t,n){let s=e.updateTriggers[n];s=s??{};let i=t.updateTriggers[n];return i=i??{},bv({oldProps:i,newProps:s,triggerName:n})}const c8="count(): argument not an object",l8="count(): argument not a container";function u8(e){if(!f8(e))throw new Error(c8);if(typeof e.count=="function")return e.count();if(Number.isFinite(e.size))return e.size;if(Number.isFinite(e.length))return e.length;if(h8(e))return Object.keys(e).length;throw new Error(l8)}function h8(e){return e!==null&&typeof e=="object"&&e.constructor===Object}function f8(e){return e!==null&&typeof e=="object"}function A2(e,t){if(!t)return e;const n={...e,...t};if("defines"in t&&(n.defines={...e.defines,...t.defines}),"modules"in t&&(n.modules=(e.modules||[]).concat(t.modules),t.modules.some(s=>s.name==="project64"))){const s=n.modules.findIndex(i=>i.name==="project32");s>=0&&n.modules.splice(s,1)}if("inject"in t)if(!e.inject)n.inject=t.inject;else{const s={...e.inject};for(const i in t.inject)s[i]=(s[i]||"")+t.inject[i];n.inject=s}return n}const d8={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},am={};function g8(e,t,n,s){if(n instanceof kn)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={minFilter:"linear",mipmapFilter:n.data.length>1?"nearest":"linear"});const r=t.createTexture({...n,sampler:{...d8,...i,...s}});return am[r.id]=e,r}function p8(e,t){!t||!(t instanceof kn)||am[t.id]===e&&(t.delete(),delete am[t.id])}const _8={boolean:{validate(e,t){return!0},equal(e,t,n){return!!e==!!t}},number:{validate(e,t){return Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)}},color:{validate(e,t){return t.optional&&!e||cm(e)&&(e.length===3||e.length===4)},equal(e,t,n){return fs(e,t,1)}},accessor:{validate(e,t){const n=nd(e);return n==="function"||n===nd(t.value)},equal(e,t,n){return typeof t=="function"?!0:fs(e,t,1)}},array:{validate(e,t){return t.optional&&!e||cm(e)},equal(e,t,n){const{compare:s}=n,i=Number.isInteger(s)?s:s?1:0;return s?fs(e,t,i):e===t}},object:{equal(e,t,n){if(n.ignore)return!0;const{compare:s}=n,i=Number.isInteger(s)?s:s?1:0;return s?fs(e,t,i):e===t}},function:{validate(e,t){return t.optional&&!e||typeof e=="function"},equal(e,t,n){return!n.compare&&n.ignore!==!1||e===t}},data:{transform:(e,t,n)=>{if(!e)return e;const{dataTransform:s}=n.props;return s?s(e):typeof e.shape=="string"&&e.shape.endsWith("-table")&&Array.isArray(e.data)?e.data:e}},image:{transform:(e,t,n)=>{const s=n.context;return!s||!s.device?null:g8(n.id,s.device,e,{...t.parameters,...n.props.textureParameters})},release:(e,t,n)=>{p8(n.id,e)}}};function m8(e){const t={},n={},s={};for(const[i,r]of Object.entries(e)){const a=r==null?void 0:r.deprecatedFor;if(a)s[i]=Array.isArray(a)?a:[a];else{const l=A8(i,r);t[i]=l,n[i]=l.value}}return{propTypes:t,defaultProps:n,deprecatedProps:s}}function A8(e,t){switch(nd(t)){case"object":return cl(e,t);case"array":return cl(e,{type:"array",value:t,compare:!1});case"boolean":return cl(e,{type:"boolean",value:t});case"number":return cl(e,{type:"number",value:t});case"function":return cl(e,{type:"function",value:t,compare:!0});default:return{name:e,type:"unknown",value:t}}}function cl(e,t){return"type"in t?{name:e,..._8[t.type],...t}:"value"in t?{name:e,type:nd(t.value),...t}:{name:e,type:"object",value:t}}function cm(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function nd(e){return cm(e)?"array":e===null?"null":typeof e}function y8(e,t){let n;for(let r=t.length-1;r>=0;r--){const a=t[r];"extensions"in a&&(n=a.extensions)}const s=lm(e.constructor,n),i=Object.create(s);i[Qf]=e,i[oo]={},i[lr]={};for(let r=0;r<t.length;++r){const a=t[r];for(const l in a)i[l]=a[l]}return Object.freeze(i),i}const T8="_mergedDefaultProps";function lm(e,t){if(!(e instanceof Ld.constructor))return{};let n=T8;if(t)for(const i of t){const r=i.constructor;r&&(n+=`:${r.extensionName||r.name}`)}const s=Sv(e,n);return s||(e[n]=E8(e,t||[]))}function E8(e,t){if(!e.prototype)return null;const s=Object.getPrototypeOf(e),i=lm(s),r=Sv(e,"defaultProps")||{},a=m8(r),l=Object.assign(Object.create(null),i,a.defaultProps),h=Object.assign(Object.create(null),i==null?void 0:i[hr],a.propTypes),d=Object.assign(Object.create(null),i==null?void 0:i[y_],a.deprecatedProps);for(const g of t){const _=lm(g.constructor);_&&(Object.assign(l,_),Object.assign(h,_[hr]),Object.assign(d,_[y_]))}return b8(l,e),R8(l,h),S8(l,d),l[hr]=h,l[y_]=d,t.length===0&&!o1(e,"_propTypes")&&(e._propTypes=h),l}function b8(e,t){const n=C8(t);Object.defineProperties(e,{id:{writable:!0,value:n}})}function S8(e,t){for(const n in t)Object.defineProperty(e,n,{enumerable:!1,set(s){const i=`${this.id}: ${n}`;for(const r of t[n])o1(this,r)||(this[r]=s);kt.deprecated(i,t[n].join("/"))()}})}function R8(e,t){const n={},s={};for(const i in t){const r=t[i],{name:a,value:l}=r;r.async&&(n[a]=l,s[a]=v8(a))}e[Da]=n,e[oo]={},Object.defineProperties(e,s)}function v8(e){return{enumerable:!0,set(t){typeof t=="string"||t instanceof Promise||fv(t)?this[oo][e]=t:this[lr][e]=t},get(){if(this[lr]){if(e in this[lr])return this[lr][e]||this[Da][e];if(e in this[oo]){const t=this[Qf]&&this[Qf].internalState;if(t&&t.hasAsyncProp(e))return t.getAsyncProp(e)||this[Da][e]}}return this[Da][e]}}}function o1(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Sv(e,t){return o1(e,t)&&e[t]}function C8(e){const t=e.componentName;return t||kt.warn(`${e.name}.componentName not specified`)(),t||e.name}let M8=0;class Ld{constructor(...t){this.props=y8(this,t),this.id=this.props.id,this.count=M8++}clone(t){const{props:n}=this,s={};for(const i in n[Da])i in n[lr]?s[i]=n[lr][i]:i in n[oo]&&(s[i]=n[oo][i]);return new this.constructor({...n,...s,...t})}}Ld.componentName="Component";Ld.defaultProps={};const w8=Object.freeze({});class O8{constructor(t){this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const n=this.asyncProps[t];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||w8}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const n=this.asyncProps[t];return n&&n.resolvedValue}isAsyncPropLoading(t){if(t){const n=this.asyncProps[t];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(t,n){this._watchPromise(t,Promise.resolve(n))}setAsyncProps(t){this.component=t[Qf]||this.component;const n=t[lr]||{},s=t[oo]||t,i=t[Da]||{};for(const r in n){const a=n[r];this._createAsyncPropData(r,i[r]),this._updateAsyncProp(r,a),n[r]=this.getAsyncProp(r)}for(const r in s){const a=s[r];this._createAsyncPropData(r,i[r]),this._updateAsyncProp(r,a)}}_fetch(t,n){return null}_onResolve(t,n){}_onError(t,n){}_updateAsyncProp(t,n){if(this._didAsyncInputValueChange(t,n)){if(typeof n=="string"&&(n=this._fetch(t,n)),n instanceof Promise){this._watchPromise(t,n);return}if(fv(n)){this._resolveAsyncIterable(t,n);return}this._setPropValue(t,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}_didAsyncInputValueChange(t,n){const s=this.asyncProps[t];return n===s.resolvedValue||n===s.lastValue?!1:(s.lastValue=n,!0)}_setPropValue(t,n){this._freezeAsyncOldProps();const s=this.asyncProps[t];s&&(n=this._postProcessValue(s,n),s.resolvedValue=n,s.pendingLoadCount++,s.resolvedLoadCount=s.pendingLoadCount)}_setAsyncPropValue(t,n,s){const i=this.asyncProps[t];i&&s>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=s,this.onAsyncPropUpdated(t,n))}_watchPromise(t,n){const s=this.asyncProps[t];if(s){s.pendingLoadCount++;const i=s.pendingLoadCount;n.then(r=>{this.component&&(r=this._postProcessValue(s,r),this._setAsyncPropValue(t,r,i),this._onResolve(t,r))}).catch(r=>{this._onError(t,r)})}}async _resolveAsyncIterable(t,n){if(t!=="data"){this._setPropValue(t,n);return}const s=this.asyncProps[t];if(!s)return;s.pendingLoadCount++;const i=s.pendingLoadCount;let r=[],a=0;for await(const l of n){if(!this.component)return;const{dataTransform:h}=this.component.props;h?r=h(l,r):r=r.concat(l),Object.defineProperty(r,"__diff",{enumerable:!1,value:[{startRow:a,endRow:r.length}]}),a=r.length,this._setAsyncPropValue(t,r,i)}this._onResolve(t,r)}_postProcessValue(t,n){const s=t.type;return s&&this.component&&(s.release&&s.release(t.resolvedValue,s,this.component),s.transform)?s.transform(n,s,this.component):n}_createAsyncPropData(t,n){if(!this.asyncProps[t]){const i=this.component&&this.component.props[hr];this.asyncProps[t]={type:i&&i[t],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class B8 extends O8{constructor({attributeManager:t,layer:n}){super(n),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(t,n){const s=this.layer,i=s==null?void 0:s.props.fetch;return i?i(n,{propName:t,layer:s}):super._fetch(t,n)}_onResolve(t,n){const s=this.layer;if(s){const i=s.props.onDataLoad;t==="data"&&i&&i(n,{propName:t,layer:s})}}_onError(t,n){const s=this.layer;s&&s.raiseError(n,`loading ${t} of ${this.layer}`)}}const x8="layer.changeFlag",N8="layer.initialize",I8="layer.update",D8="layer.finalize",P8="layer.matched",y2=2**24-1,F8=Object.freeze([]),U8=Zl(({oldViewport:e,viewport:t})=>e.equals(t));let Is=new Uint8ClampedArray(0);const L8={data:{type:"data",value:F8,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:e=>e&&e.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(e,{propName:t,layer:n,loaders:s,loadOptions:i,signal:r})=>{const{resourceManager:a}=n.context;i=i||n.getLoadOptions(),s=s||n.props.loaders,r&&(i={...i,fetch:{...i==null?void 0:i.fetch,signal:r}});let l=a.contains(e);return!l&&!i&&(a.add({resourceId:e,data:gr(e,s),persistent:!1}),l=!0),l?a.subscribe({resourceId:e,onChange:h=>{var d;return(d=n.internalState)==null?void 0:d.reloadAsyncProp(t,h)},consumerId:n.id,requestId:t}):gr(e,s,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Nt.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:e})=>[0,-e*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class tc extends Ld{constructor(){super(...arguments),this.internalState=null,this.lifecycle=Aa.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let t=this;for(;t.parent;)t=t.parent;return t}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(t){Be(this.internalState);const n=this.internalState.viewport||this.context.viewport,s=HR(t,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,r,a]=kR(s,n.pixelProjectionMatrix);return t.length===2?[i,r]:[i,r,a]}unproject(t){return Be(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(t)}projectPosition(t,n){Be(this.internalState);const s=this.internalState.viewport||this.context.viewport;return DU(t,{viewport:s,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const t=this.state;return t&&(t.models||t.model&&[t.model])||[]}setModuleParameters(t){for(const n of this.getModels())n.updateModuleSettings(t)}setShaderModuleProps(...t){for(const n of this.getModels())n.shaderInputs.setProps(...t)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===Nt.DEFAULT||t===Nt.LNGLAT||t===Nt.CARTESIAN}onHover(t,n){return this.props.onHover&&this.props.onHover(t,n)||!1}onClick(t,n){return this.props.onClick&&this.props.onClick(t,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(t,n=[]){return n[0]=t+1&255,n[1]=t+1>>8&255,n[2]=t+1>>8>>8&255,n}decodePickingColor(t){Be(t instanceof Uint8Array);const[n,s,i]=t;return n+s*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:u8(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var t;return(t=this.getAttributeManager())==null?void 0:t.getBounds(["positions","instancePositions"])}getShaders(t){t=A2(t,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const n of this.props.extensions)t=A2(t,n.getShaders.call(this,n));return t}shouldUpdateState(t){return t.changeFlags.propsOrDataChanged}updateState(t){const n=this.getAttributeManager(),{dataChanged:s}=t.changeFlags;if(s&&n)if(Array.isArray(s))for(const i of s)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=t,r=this.internalState.hasPickingBuffer,a=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(l=>l.getNeedsPickingBuffer.call(this,l));if(r!==a){this.internalState.hasPickingBuffer=a;const{pickingColors:l,instancePickingColors:h}=n.attributes,d=l||h;d&&(a&&d.constant&&(d.constant=!1,n.invalidate(d.id)),!d.value&&!a&&(d.constant=!0,d.value=[0,0,0]))}}}finalizeState(t){for(const s of this.getModels())s.destroy();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(t){for(const n of this.getModels())n.draw(t)}getPickingInfo({info:t,mode:n,sourceLayer:s}){const{index:i}=t;return i>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[i]),t}raiseError(t,n){var s,i,r,a;n&&(t=new Error(`${n}: ${t.message}`,{cause:t})),(i=(s=this.props).onError)!=null&&i.call(s,t)||(a=(r=this.context)==null?void 0:r.onError)==null||a.call(r,t,this)}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var t;return((t=this.internalState)==null?void 0:t.uniformTransitions.active)||!1}activateViewport(t){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=t,(!n||!U8({oldViewport:n,viewport:t}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all"){const n=this.getAttributeManager();n&&(t==="all"?n.invalidateAll():n.invalidate(t))}updateAttributes(t){let n=!1;for(const s in t)t[s].layoutChanged()&&(n=!0);for(const s of this.getModels())this._setModelAttributes(s,t,n)}_updateAttributes(){const t=this.getAttributeManager();if(!t)return;const n=this.props,s=this.getNumInstances(),i=this.getStartIndices();t.update({data:n.data,numInstances:s,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const r=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(r)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const n=t.update(),s=Object.create(this.props);for(const i in n)Object.defineProperty(s,i,{value:n[i]});return s}return this.props}calculateInstancePickingColors(t,{numInstances:n}){if(t.constant)return;const s=Math.floor(Is.length/4);if(this.internalState.usesPickingColorCache=!0,s<n){n>y2&&kt.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Is=Ll.allocate(Is,n,{size:4,copy:!0,maxCount:Math.max(n,y2)});const i=Math.floor(Is.length/4),r=[];for(let a=s;a<i;a++)this.encodePickingColor(a,r),Is[a*4+0]=r[0],Is[a*4+1]=r[1],Is[a*4+2]=r[2]}t.value=Is.subarray(0,n*4)}_setModelAttributes(t,n,s=!1){var l;if(!Object.keys(n).length)return;if(s){const h=this.getAttributeManager();t.setBufferLayout(h.getBufferLayouts(t)),n=h.getAttributes()}const i=((l=t.userData)==null?void 0:l.excludeAttributes)||{},r={},a={};for(const h in n){if(i[h])continue;const d=n[h].getValue();for(const g in d){const _=d[g];_ instanceof fe?n[h].settings.isIndexed?t.setIndexBuffer(_):r[g]=_:_&&(a[g]=_)}}t.setAttributes(r),t.setConstantAttributes(a)}disablePickingIndex(t){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(t);return}const{pickingColors:s,instancePickingColors:i}=this.getAttributeManager().attributes,r=s||i,a=r&&n.attributes&&n.attributes[r.id];if(a&&a.value){const l=a.value,h=this.encodePickingColor(t);for(let d=0;d<n.length;d++){const g=r.getVertexOffset(d);l[g]===h[0]&&l[g+1]===h[1]&&l[g+2]===h[2]&&this._disablePickingIndex(d)}}else this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:n,instancePickingColors:s}=this.getAttributeManager().attributes,i=n||s;if(!i)return;const r=i.getVertexOffset(t),a=i.getVertexOffset(t+1);i.buffer.write(new Uint8Array(a-r),r)}restorePickingColors(){const{pickingColors:t,instancePickingColors:n}=this.getAttributeManager().attributes,s=t||n;s&&(this.internalState.usesPickingColorCache&&s.value.buffer!==Is.buffer&&(s.value=Is.subarray(0,s.value.length)),s.updateSubBuffer({startOffset:0}))}_initialize(){Be(!this.internalState),Be(Number.isFinite(this.props.coordinateSystem)),Qe(N8,this);const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new B8({attributeManager:t,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(kt.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),t)}),this.internalState.uniformTransitions=new e8(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(t){Qe(P8,this,this===t);const{state:n,internalState:s}=t;this!==t&&(this.internalState=s,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const t=this.needsUpdate();if(Qe(I8,this,t),!t)return;const n=this.props,s=this.context,i=this.internalState,r=s.viewport,a=this._updateUniformTransition();i.propsInTransition=a,s.viewport=i.viewport||r,this.props=a;try{const l=this._getUpdateParams(),h=this.getModels();if(s.device)this.updateState(l);else try{this.updateState(l)}catch{}for(const g of this.props.extensions)g.updateState.call(this,l,g);const d=this.getModels()[0]!==h[0];this._postUpdate(l,d)}finally{s.viewport=r,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Qe(D8,this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,this.context,t)}_drawLayer({renderPass:t,moduleParameters:n=null,uniforms:s={},parameters:i={}}){this._updateAttributeTransition();const r=this.props,a=this.context;this.props=this.internalState.propsInTransition||r;const l=this.props.opacity;s.opacity=Math.pow(l,1/2.2);try{if(n){const{isActive:g,isAttribute:_}=n.picking;this.setModuleParameters(n),this.setShaderModuleProps({picking:{isActive:g,isAttribute:_}})}const{getPolygonOffset:h}=this.props,d=h&&h(s)||[0,0];a.device.setParametersWebGL({polygonOffset:d});for(const g of this.getModels())g.setParameters(i);a.device.withParametersWebGL(i,()=>{const g={renderPass:t,moduleParameters:n,uniforms:s,parameters:i,context:a};for(const _ of this.props.extensions)_.draw.call(this,g,_);this.draw(g)})}finally{this.props=r}}getChangeFlags(){var t;return(t=this.internalState)==null?void 0:t.changeFlags}setChangeFlags(t){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in t)if(t[i]){let r=!1;switch(i){case"dataChanged":const a=t[i],l=n[i];a&&Array.isArray(l)&&(n.dataChanged=Array.isArray(a)?l.concat(a):a,r=!0);default:n[i]||(n[i]=t[i],r=!0)}r&&Qe(x8,this,i,t)}const s=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=s,n.somethingChanged=s||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(t,n){var i;const s=s8(t,n);if(s.updateTriggersChanged)for(const r in s.updateTriggersChanged)s.updateTriggersChanged[r]&&this.invalidateAttribute(r);if(s.transitionsChanged)for(const r in s.transitionsChanged)this.internalState.uniformTransitions.add(r,n[r],t[r],(i=t.transitions)==null?void 0:i[r]);return this.setChangeFlags(s)}validateProps(){n8(this.props)}updateAutoHighlight(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const n={highlightedObjectColor:t.picked?t.color:null},{highlightColor:s}=this.props;t.picked&&typeof s=="function"&&(n.highlightColor=s(t)),this.setShaderModuleProps({picking:n}),this.setNeedsRedraw()}_getAttributeManager(){const t=this.context;return new Kk(t.device,{id:this.props.id,stats:t.stats,timeline:t.timeline})}_postUpdate(t,n){const{props:s,oldProps:i}=t;this.setNeedsRedraw(),this._updateAttributes();const r=this.state.model;r!=null&&r.isInstanced&&r.setInstanceCount(this.getNumInstances());const{autoHighlight:a,highlightedObjectIndex:l,highlightColor:h}=s;if(n||i.autoHighlight!==a||i.highlightedObjectIndex!==l||i.highlightColor!==h){const d={};Array.isArray(h)&&(d.highlightColor=h),(n||i.autoHighlight!==a||l!==i.highlightedObjectIndex)&&(d.highlightedObjectColor=Number.isFinite(l)&&l>=0?this.encodePickingColor(l):null),this.setShaderModuleProps({picking:d})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const s=this.getAttributeManager(),i=s?s.getNeedsRedraw(t):!1;if(n=n||i,n)for(const r of this.props.extensions)r.onNeedsRedraw.call(this,r);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}tc.defaultProps=L8;tc.layerName="Layer";const k8="compositeLayer.renderLayers";class Rv extends tc{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(t){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:n}=t;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(t.object=n.__source.object,t.index=n.__source.index),t}filterSubLayer(t){return!0}shouldRenderSubLayer(t,n){return n&&n.length}getSubLayerClass(t,n){const{_subLayerProps:s}=this.props;return s&&s[t]&&s[t].type||n}getSubLayerRow(t,n,s){return t.__source={parent:this,object:n,index:s},t}getSubLayerAccessor(t){if(typeof t=="function"){const n={index:-1,data:this.props.data,target:[]};return(s,i)=>s&&s.__source?(n.index=s.__source.index,t(s.__source.object,n)):t(s,i)}return t}getSubLayerProps(t={}){var J;const{opacity:n,pickable:s,visible:i,parameters:r,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:h,highlightColor:d,coordinateSystem:g,coordinateOrigin:_,wrapLongitude:m,positionFormat:y,modelMatrix:E,extensions:b,fetch:R,operation:M,_subLayerProps:N}=this.props,O={id:"",updateTriggers:{},opacity:n,pickable:s,visible:i,parameters:r,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:h,highlightColor:d,coordinateSystem:g,coordinateOrigin:_,wrapLongitude:m,positionFormat:y,modelMatrix:E,extensions:b,fetch:R,operation:M},x=N&&t.id&&N[t.id],I=x&&x.updateTriggers,P=t.id||"sublayer";if(x){const et=this.props[hr],q=t.type?t.type._propTypes:{};for(const Q in x){const rt=q[Q]||et[Q];rt&&rt.type==="accessor"&&(x[Q]=this.getSubLayerAccessor(x[Q]))}}Object.assign(O,t,x),O.id=`${this.props.id}-${P}`,O.updateTriggers={all:(J=this.props.updateTriggers)==null?void 0:J.all,...t.updateTriggers,...I};for(const et of b){const q=et.getSubLayerProps.call(this,et);q&&Object.assign(O,q,{updateTriggers:Object.assign(O.updateTriggers,q.updateTriggers)})}return O}_updateAutoHighlight(t){for(const n of this.getSubLayers())n.updateAutoHighlight(t)}_getAttributeManager(){return null}_postUpdate(t,n){let s=this.internalState.subLayers;const i=!s||this.needsUpdate();if(i){const r=this.renderLayers();s=Ha(r,Boolean),this.internalState.subLayers=s}Qe(k8,this,i,s);for(const r of s)r.parent=this}}Rv.layerName="CompositeLayer";const z8=`#version 300 es
#define SHADER_NAME point-cloud-layer-vertex-shader
in vec3 positions;
in vec3 instanceNormals;
in vec4 instanceColors;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec3 instancePickingColors;
uniform float opacity;
uniform float radiusPixels;
uniform int sizeUnits;
out vec4 vColor;
out vec2 unitPosition;
void main(void) {
geometry.worldPosition = instancePositions;
geometry.normal = project_normal(instanceNormals);
unitPosition = positions.xy;
geometry.uv = unitPosition;
geometry.pickingColor = instancePickingColors;
vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, instanceColors.a * opacity);
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,V8=`#version 300 es
#define SHADER_NAME point-cloud-layer-fragment-shader
precision highp float;
in vec4 vColor;
in vec2 unitPosition;
out vec4 fragColor;
void main(void) {
geometry.uv = unitPosition;
float distToCenter = length(unitPosition);
if (distToCenter > 1.0) {
discard;
}
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,vv=[0,0,0,255],Cv=[0,0,1],H8={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:e=>e.position},getNormal:{type:"accessor",value:Cv},getColor:{type:"accessor",value:vv},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};function j8(e){const{header:t,attributes:n}=e;if(!(!t||!n)&&(e.length=t.vertexCount,n.POSITION&&(n.instancePositions=n.POSITION),n.NORMAL&&(n.instanceNormals=n.NORMAL),n.COLOR_0)){const{size:s,value:i}=n.COLOR_0;n.instanceColors={size:s,type:"unorm8",value:i}}}const Od=class Od extends tc{getShaders(){return super.getShaders({vs:z8,fs:V8,modules:[Ym,hF,Zm]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:Cv},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:vv}})}updateState(t){var i;const{changeFlags:n,props:s}=t;super.updateState(t),n.extensionsChanged&&((i=this.state.model)==null||i.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll()),n.dataChanged&&j8(s.data)}draw({uniforms:t}){const{pointSize:n,sizeUnits:s}=this.props,i=this.state.model;i.setUniforms(t),i.setUniforms({sizeUnits:j0[s],radiusPixels:n}),i.draw(this.context.renderPass)}_getModel(){const t=[];for(let n=0;n<3;n++){const s=n/3*Math.PI*2;t.push(Math.cos(s)*2,Math.sin(s)*2,0)}return new pr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Na({topology:"triangle-list",attributes:{positions:new Float32Array(t)}}),isInstanced:!0})}};Od.layerName="PointCloudLayer",Od.defaultProps=H8;let um=Od;const Fn={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},$8={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...$8}};const En=globalThis.mathgl.config;function X8(e,{precision:t=En.precision}={}){return e=G8(e),`${parseFloat(e.toPrecision(t))}`}function Hl(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function vl(e,t,n){const s=En.EPSILON;try{if(e===t)return!0;if(Hl(e)&&Hl(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!vl(e[i],t[i]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<=En.EPSILON*Math.max(1,Math.abs(e),Math.abs(t)):!1}finally{En.EPSILON=s}}function G8(e){return Math.round(e/En.EPSILON)*En.EPSILON}let a1=class extends Array{clone(){return new this.constructor().copy(this)}fromArray(t,n=0){for(let s=0;s<this.ELEMENTS;++s)this[s]=t[s+n];return this.check()}toArray(t=[],n=0){for(let s=0;s<this.ELEMENTS;++s)t[n+s]=this[s];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:Hl(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(En)}formatString(t){let n="";for(let s=0;s<this.ELEMENTS;++s)n+=(s>0?", ":"")+X8(this[s],t);return`${t.printTypes?this.constructor.name:""}[${n}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!vl(this[n],t[n]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==t[n])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,n,s){if(s===void 0)return this.lerp(this,t,n);for(let i=0;i<this.ELEMENTS;++i){const r=t[i],a=typeof n=="number"?n:n[i];this[i]=r+s*(a-r)}return this.check()}min(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(t[n],this[n]);return this.check()}max(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(t[n],this[n]);return this.check()}clamp(t,n){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t[s]),n[s]);return this.check()}add(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]+=n[s];return this.check()}subtract(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]-=n[s];return this.check()}scale(t){if(typeof t=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;else for(let n=0;n<this.ELEMENTS&&n<t.length;++n)this[n]*=t[n];return this.check()}multiplyByScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;return this.check()}check(){if(En.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)t=t&&Number.isFinite(this[n]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=t;return this.check()}addScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,n){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t),n);return this.check()}get elements(){return this}};function W8(e,t){if(e.length!==t)return!1;for(let n=0;n<e.length;++n)if(!Number.isFinite(e[n]))return!1;return!0}function ne(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function Mv(e,t,n=""){if(En.debug&&!W8(e,t))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return e}function jl(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}let wv=class extends a1{get x(){return this[0]}set x(t){this[0]=ne(t)}get y(){return this[1]}set y(t){this[1]=ne(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*this[n];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let n=0;for(let s=0;s<this.ELEMENTS;++s){const i=this[s]-t[s];n+=i*i}return ne(n)}dot(t){let n=0;for(let s=0;s<this.ELEMENTS;++s)n+=this[s]*t[s];return ne(n)}normalize(){const t=this.magnitude();if(t!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=t;return this.check()}multiply(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]*=n[s];return this.check()}divide(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]/=n[s];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return jl(t>=0&&t<this.ELEMENTS,"index is out of range"),ne(this[t])}setComponent(t,n){return jl(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=n,this.check()}addVectors(t,n){return this.copy(t).add(n)}subVectors(t,n){return this.copy(t).subtract(n)}multiplyVectors(t,n){return this.copy(t).multiply(n)}addScaledVector(t,n){return this.add(new this.constructor(t).multiplyScalar(n))}};const q8=1e-6;let _s=typeof Float32Array<"u"?Float32Array:Array;function Y8(){const e=new _s(2);return _s!=Float32Array&&(e[0]=0,e[1]=0),e}function K8(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[3]*i+n[6],e[1]=n[1]*s+n[4]*i+n[7],e}(function(){const e=Y8();return function(t,n,s,i,r,a){let l,h;for(n||(n=2),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],r(e,e,a),t[l]=e[0],t[l+1]=e[1];return t}})();function J8(e,t,n){const s=t[0],i=t[1],r=t[2],a=n[3]*s+n[7]*i+n[11]*r||1;return e[0]=(n[0]*s+n[4]*i+n[8]*r)/a,e[1]=(n[1]*s+n[5]*i+n[9]*r)/a,e[2]=(n[2]*s+n[6]*i+n[10]*r)/a,e}function Z8(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[2]*i,e[1]=n[1]*s+n[3]*i,e[2]=t[2],e}function Q8(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[2]*i,e[1]=n[1]*s+n[3]*i,e[2]=t[2],e[3]=t[3],e}function Ov(e,t,n){const s=t[0],i=t[1],r=t[2];return e[0]=n[0]*s+n[3]*i+n[6]*r,e[1]=n[1]*s+n[4]*i+n[7]*r,e[2]=n[2]*s+n[5]*i+n[8]*r,e[3]=t[3],e}function Bv(){const e=new _s(3);return _s!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function t9(e){const t=e[0],n=e[1],s=e[2];return Math.sqrt(t*t+n*n+s*s)}function T2(e,t,n){const s=new _s(3);return s[0]=e,s[1]=t,s[2]=n,s}function e9(e,t){const n=t[0],s=t[1],i=t[2];let r=n*n+s*s+i*i;return r>0&&(r=1/Math.sqrt(r)),e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function xv(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Cf(e,t,n){const s=t[0],i=t[1],r=t[2],a=n[0],l=n[1],h=n[2];return e[0]=i*h-r*l,e[1]=r*a-s*h,e[2]=s*l-i*a,e}function Nv(e,t,n){const s=t[0],i=t[1],r=t[2];let a=n[3]*s+n[7]*i+n[11]*r+n[15];return a=a||1,e[0]=(n[0]*s+n[4]*i+n[8]*r+n[12])/a,e[1]=(n[1]*s+n[5]*i+n[9]*r+n[13])/a,e[2]=(n[2]*s+n[6]*i+n[10]*r+n[14])/a,e}function Iv(e,t,n){const s=t[0],i=t[1],r=t[2];return e[0]=s*n[0]+i*n[3]+r*n[6],e[1]=s*n[1]+i*n[4]+r*n[7],e[2]=s*n[2]+i*n[5]+r*n[8],e}function Dv(e,t,n){const s=n[0],i=n[1],r=n[2],a=n[3],l=t[0],h=t[1],d=t[2];let g=i*d-r*h,_=r*l-s*d,m=s*h-i*l,y=i*m-r*_,E=r*g-s*m,b=s*_-i*g;const R=a*2;return g*=R,_*=R,m*=R,y*=2,E*=2,b*=2,e[0]=l+g+y,e[1]=h+_+E,e[2]=d+m+b,e}function n9(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[0],r[1]=i[1]*Math.cos(s)-i[2]*Math.sin(s),r[2]=i[1]*Math.sin(s)+i[2]*Math.cos(s),e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function s9(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[2]*Math.sin(s)+i[0]*Math.cos(s),r[1]=i[1],r[2]=i[2]*Math.cos(s)-i[0]*Math.sin(s),e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function i9(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[0]*Math.cos(s)-i[1]*Math.sin(s),r[1]=i[0]*Math.sin(s)+i[1]*Math.cos(s),r[2]=i[2],e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function r9(e,t){const n=e[0],s=e[1],i=e[2],r=t[0],a=t[1],l=t[2],h=Math.sqrt((n*n+s*s+i*i)*(r*r+a*a+l*l)),d=h&&xv(e,t)/h;return Math.acos(Math.min(Math.max(d,-1),1))}const o9=t9;(function(){const e=Bv();return function(t,n,s,i,r,a){let l,h;for(n||(n=3),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],r(e,e,a),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2];return t}})();const N_=[0,0,0];let Uh,yt=class Pv extends wv{static get ZERO(){return Uh||(Uh=new Pv(0,0,0),Object.freeze(Uh)),Uh}constructor(t=0,n=0,s=0){super(-0,-0,-0),arguments.length===1&&Hl(t)?this.copy(t):(En.debug&&(ne(t),ne(n),ne(s)),this[0]=t,this[1]=n,this[2]=s)}set(t,n,s){return this[0]=t,this[1]=n,this[2]=s,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return En.debug&&(ne(t.x),ne(t.y),ne(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=ne(t)}angle(t){return r9(this,t)}cross(t){return Cf(this,this,t),this.check()}rotateX({radians:t,origin:n=N_}){return n9(this,this,n,t),this.check()}rotateY({radians:t,origin:n=N_}){return s9(this,this,n,t),this.check()}rotateZ({radians:t,origin:n=N_}){return i9(this,this,n,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return Nv(this,this,t),this.check()}transformAsVector(t){return J8(this,this,t),this.check()}transformByMatrix3(t){return Iv(this,this,t),this.check()}transformByMatrix2(t){return Z8(this,this,t),this.check()}transformByQuaternion(t){return Dv(this,this,t),this.check()}},Lh,a9=class Fv extends wv{static get ZERO(){return Lh||(Lh=new Fv(0,0,0,0),Object.freeze(Lh)),Lh}constructor(t=0,n=0,s=0,i=0){super(-0,-0,-0,-0),Hl(t)&&arguments.length===1?this.copy(t):(En.debug&&(ne(t),ne(n),ne(s),ne(i)),this[0]=t,this[1]=n,this[2]=s,this[3]=i)}set(t,n,s,i){return this[0]=t,this[1]=n,this[2]=s,this[3]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return En.debug&&(ne(t.x),ne(t.y),ne(t.z),ne(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=ne(t)}get w(){return this[3]}set w(t){this[3]=ne(t)}transform(t){return Nv(this,this,t),this.check()}transformByMatrix3(t){return Ov(this,this,t),this.check()}transformByMatrix2(t){return Q8(this,this,t),this.check()}transformByQuaternion(t){return Dv(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}},c9=class extends a1{toString(){let t="[";if(En.printRowMajor){t+="row-major:";for(let n=0;n<this.RANK;++n)for(let s=0;s<this.RANK;++s)t+=` ${this[s*this.RANK+n]}`}else{t+="column-major:";for(let n=0;n<this.ELEMENTS;++n)t+=` ${this[n]}`}return t+="]",t}getElementIndex(t,n){return n*this.RANK+t}getElement(t,n){return this[n*this.RANK+t]}setElement(t,n,s){return this[n*this.RANK+t]=ne(s),this}getColumn(t,n=new Array(this.RANK).fill(-0)){const s=t*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[s+i];return n}setColumn(t,n){const s=t*this.RANK;for(let i=0;i<this.RANK;++i)this[s+i]=n[i];return this}};function l9(){const e=new _s(9);return _s!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function u9(e,t){if(e===t){const n=t[1],s=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=s,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function h9(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=t[4],l=t[5],h=t[6],d=t[7],g=t[8],_=g*a-l*d,m=-g*r+l*h,y=d*r-a*h;let E=n*_+s*m+i*y;return E?(E=1/E,e[0]=_*E,e[1]=(-g*s+i*d)*E,e[2]=(l*s-i*a)*E,e[3]=m*E,e[4]=(g*n-i*h)*E,e[5]=(-l*n+i*r)*E,e[6]=y*E,e[7]=(-d*n+s*h)*E,e[8]=(a*n-s*r)*E,e):null}function f9(e){const t=e[0],n=e[1],s=e[2],i=e[3],r=e[4],a=e[5],l=e[6],h=e[7],d=e[8];return t*(d*r-a*h)+n*(-d*i+a*l)+s*(h*i-r*l)}function E2(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=t[4],h=t[5],d=t[6],g=t[7],_=t[8],m=n[0],y=n[1],E=n[2],b=n[3],R=n[4],M=n[5],N=n[6],O=n[7],x=n[8];return e[0]=m*s+y*a+E*d,e[1]=m*i+y*l+E*g,e[2]=m*r+y*h+E*_,e[3]=b*s+R*a+M*d,e[4]=b*i+R*l+M*g,e[5]=b*r+R*h+M*_,e[6]=N*s+O*a+x*d,e[7]=N*i+O*l+x*g,e[8]=N*r+O*h+x*_,e}function d9(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=t[4],h=t[5],d=t[6],g=t[7],_=t[8],m=n[0],y=n[1];return e[0]=s,e[1]=i,e[2]=r,e[3]=a,e[4]=l,e[5]=h,e[6]=m*s+y*a+d,e[7]=m*i+y*l+g,e[8]=m*r+y*h+_,e}function g9(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=t[4],h=t[5],d=t[6],g=t[7],_=t[8],m=Math.sin(n),y=Math.cos(n);return e[0]=y*s+m*a,e[1]=y*i+m*l,e[2]=y*r+m*h,e[3]=y*a-m*s,e[4]=y*l-m*i,e[5]=y*h-m*r,e[6]=d,e[7]=g,e[8]=_,e}function b2(e,t,n){const s=n[0],i=n[1];return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function p9(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=n+n,l=s+s,h=i+i,d=n*a,g=s*a,_=s*l,m=i*a,y=i*l,E=i*h,b=r*a,R=r*l,M=r*h;return e[0]=1-_-E,e[3]=g-M,e[6]=m+R,e[1]=g+M,e[4]=1-d-E,e[7]=y-b,e[2]=m-R,e[5]=y+b,e[8]=1-d-_,e}var hm;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL1ROW0=3]="COL1ROW0",e[e.COL1ROW1=4]="COL1ROW1",e[e.COL1ROW2=5]="COL1ROW2",e[e.COL2ROW0=6]="COL2ROW0",e[e.COL2ROW1=7]="COL2ROW1",e[e.COL2ROW2=8]="COL2ROW2"})(hm||(hm={}));const _9=Object.freeze([1,0,0,0,1,0,0,0,1]);let Xe=class extends c9{static get IDENTITY(){return A9()}static get ZERO(){return m9()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return hm}constructor(t,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):n.length>0?this.copy([t,...n]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(_9)}fromObject(t){return this.check()}fromQuaternion(t){return p9(this,t),this.check()}set(t,n,s,i,r,a,l,h,d){return this[0]=t,this[1]=n,this[2]=s,this[3]=i,this[4]=r,this[5]=a,this[6]=l,this[7]=h,this[8]=d,this.check()}setRowMajor(t,n,s,i,r,a,l,h,d){return this[0]=t,this[1]=i,this[2]=l,this[3]=n,this[4]=r,this[5]=h,this[6]=s,this[7]=a,this[8]=d,this.check()}determinant(){return f9(this)}transpose(){return u9(this,this),this.check()}invert(){return h9(this,this),this.check()}multiplyLeft(t){return E2(this,t,this),this.check()}multiplyRight(t){return E2(this,this,t),this.check()}rotate(t){return g9(this,this,t),this.check()}scale(t){return Array.isArray(t)?b2(this,this,t):b2(this,this,[t,t]),this.check()}translate(t){return d9(this,this,t),this.check()}transform(t,n){let s;switch(t.length){case 2:s=K8(n||[-0,-0],t,this);break;case 3:s=Iv(n||[-0,-0,-0],t,this);break;case 4:s=Ov(n||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Mv(s,t.length),s}transformVector(t,n){return this.transform(t,n)}transformVector2(t,n){return this.transform(t,n)}transformVector3(t,n){return this.transform(t,n)}},kh,zh=null;function m9(){return kh||(kh=new Xe([0,0,0,0,0,0,0,0,0]),Object.freeze(kh)),kh}function A9(){return zh||(zh=new Xe,Object.freeze(zh)),zh}function y9(e,t){const n=t[0],s=t[1],i=t[2],r=t[4],a=t[5],l=t[6],h=t[8],d=t[9],g=t[10];return e[0]=Math.sqrt(n*n+s*s+i*i),e[1]=Math.sqrt(r*r+a*a+l*l),e[2]=Math.sqrt(h*h+d*d+g*g),e}function T9(){const e=new _s(4);return _s!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function E9(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function b9(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function S9(e){const t=e[0],n=e[1],s=e[2],i=e[3];return Math.sqrt(t*t+n*n+s*s+i*i)}function R9(e){const t=e[0],n=e[1],s=e[2],i=e[3];return t*t+n*n+s*s+i*i}function v9(e,t){const n=t[0],s=t[1],i=t[2],r=t[3];let a=n*n+s*s+i*i+r*r;return a>0&&(a=1/Math.sqrt(a)),e[0]=n*a,e[1]=s*a,e[2]=i*a,e[3]=r*a,e}function C9(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function M9(e,t,n,s){const i=t[0],r=t[1],a=t[2],l=t[3];return e[0]=i+s*(n[0]-i),e[1]=r+s*(n[1]-r),e[2]=a+s*(n[2]-a),e[3]=l+s*(n[3]-l),e}function w9(e,t,n){const s=t[0],i=t[1],r=t[2],a=n[0],l=n[1],h=n[2],d=n[3],g=d*s+l*r-h*i,_=d*i+h*s-a*r,m=d*r+a*i-l*s,y=-a*s-l*i-h*r;return e[0]=g*d+y*-a+_*-h-m*-l,e[1]=_*d+y*-l+m*-a-g*-h,e[2]=m*d+y*-h+g*-l-_*-a,e[3]=t[3],e}(function(){const e=T9();return function(t,n,s,i,r,a){let l,h;for(n||(n=4),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],e[3]=t[l+3],r(e,e,a),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2],t[l+3]=e[3];return t}})();function S2(){const e=new _s(4);return _s!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function O9(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Uv(e,t,n){n=n*.5;const s=Math.sin(n);return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=Math.cos(n),e}function R2(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=n[0],h=n[1],d=n[2],g=n[3];return e[0]=s*g+a*l+i*d-r*h,e[1]=i*g+a*h+r*l-s*d,e[2]=r*g+a*d+s*h-i*l,e[3]=a*g-s*l-i*h-r*d,e}function B9(e,t,n){n*=.5;const s=t[0],i=t[1],r=t[2],a=t[3],l=Math.sin(n),h=Math.cos(n);return e[0]=s*h+a*l,e[1]=i*h+r*l,e[2]=r*h-i*l,e[3]=a*h-s*l,e}function x9(e,t,n){n*=.5;const s=t[0],i=t[1],r=t[2],a=t[3],l=Math.sin(n),h=Math.cos(n);return e[0]=s*h-r*l,e[1]=i*h+a*l,e[2]=r*h+s*l,e[3]=a*h-i*l,e}function N9(e,t,n){n*=.5;const s=t[0],i=t[1],r=t[2],a=t[3],l=Math.sin(n),h=Math.cos(n);return e[0]=s*h+i*l,e[1]=i*h-s*l,e[2]=r*h+a*l,e[3]=a*h-r*l,e}function I9(e,t){const n=t[0],s=t[1],i=t[2];return e[0]=n,e[1]=s,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-s*s-i*i)),e}function Mf(e,t,n,s){const i=t[0],r=t[1],a=t[2],l=t[3];let h=n[0],d=n[1],g=n[2],_=n[3],m,y,E,b,R;return m=i*h+r*d+a*g+l*_,m<0&&(m=-m,h=-h,d=-d,g=-g,_=-_),1-m>q8?(y=Math.acos(m),R=Math.sin(y),E=Math.sin((1-s)*y)/R,b=Math.sin(s*y)/R):(E=1-s,b=s),e[0]=E*i+b*h,e[1]=E*r+b*d,e[2]=E*a+b*g,e[3]=E*l+b*_,e}function D9(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=n*n+s*s+i*i+r*r,l=a?1/a:0;return e[0]=-n*l,e[1]=-s*l,e[2]=-i*l,e[3]=r*l,e}function P9(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function Lv(e,t){const n=t[0]+t[4]+t[8];let s;if(n>0)s=Math.sqrt(n+1),e[3]=.5*s,s=.5/s,e[0]=(t[5]-t[7])*s,e[1]=(t[6]-t[2])*s,e[2]=(t[1]-t[3])*s;else{let i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);const r=(i+1)%3,a=(i+2)%3;s=Math.sqrt(t[i*3+i]-t[r*3+r]-t[a*3+a]+1),e[i]=.5*s,s=.5/s,e[3]=(t[r*3+a]-t[a*3+r])*s,e[r]=(t[r*3+i]+t[i*3+r])*s,e[a]=(t[a*3+i]+t[i*3+a])*s}return e}const F9=E9,U9=b9,L9=C9,k9=M9,z9=S9,V9=R9,kv=v9,H9=function(){const e=Bv(),t=T2(1,0,0),n=T2(0,1,0);return function(s,i,r){const a=xv(i,r);return a<-.999999?(Cf(e,t,i),o9(e)<1e-6&&Cf(e,n,i),e9(e,e),Uv(s,e,Math.PI),s):a>.999999?(s[0]=0,s[1]=0,s[2]=0,s[3]=1,s):(Cf(e,i,r),s[0]=e[0],s[1]=e[1],s[2]=e[2],s[3]=1+a,kv(s,s))}}();(function(){const e=S2(),t=S2();return function(n,s,i,r,a,l){return Mf(e,s,a,l),Mf(t,i,r,l),Mf(n,e,t,2*l*(1-l)),n}})();(function(){const e=l9();return function(t,n,s,i){return e[0]=s[0],e[3]=s[1],e[6]=s[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],kv(t,Lv(t,e))}})();const j9=[0,0,0,1];let v2=class extends a1{constructor(t=0,n=0,s=0,i=1){super(-0,-0,-0,-0),Array.isArray(t)&&arguments.length===1?this.copy(t):this.set(t,n,s,i)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,n,s,i){return this[0]=t,this[1]=n,this[2]=s,this[3]=i,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return Lv(this,t),this.check()}fromAxisRotation(t,n){return Uv(this,t,n),this.check()}identity(){return O9(this),this.check()}setAxisAngle(t,n){return this.fromAxisRotation(t,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=ne(t)}get y(){return this[1]}set y(t){this[1]=ne(t)}get z(){return this[2]}set z(t){this[2]=ne(t)}get w(){return this[3]}set w(t){this[3]=ne(t)}len(){return z9(this)}lengthSquared(){return V9(this)}dot(t){return L9(this,t)}rotationTo(t,n){return H9(this,t,n),this.check()}add(t){return F9(this,this,t),this.check()}calculateW(){return I9(this,this),this.check()}conjugate(){return P9(this,this),this.check()}invert(){return D9(this,this),this.check()}lerp(t,n,s){return s===void 0?this.lerp(this,t,n):(k9(this,t,n,s),this.check())}multiplyRight(t){return R2(this,this,t),this.check()}multiplyLeft(t){return R2(this,t,this),this.check()}normalize(){const t=this.len(),n=t>0?1/t:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,t===0&&(this[3]=1),this.check()}rotateX(t){return B9(this,this,t),this.check()}rotateY(t){return x9(this,this,t),this.check()}rotateZ(t){return N9(this,this,t),this.check()}scale(t){return U9(this,this,t),this.check()}slerp(t,n,s){let i,r,a;switch(arguments.length){case 1:({start:i=j9,target:r,ratio:a}=t);break;case 2:i=this,r=t,a=n;break;default:i=t,r=n,a=s}return Mf(this,i,r,a),this.check()}transformVector4(t,n=new a9){return w9(n,t,this),Mv(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,n){return this.setAxisAngle(t,n)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}};const $9=1e-15,X9=1e-20;new yt;new yt;const ll=new yt,C2=new yt;class eu{constructor(t=[0,0,0],n=0){this.radius=-0,this.center=new yt,this.fromCenterRadius(t,n)}fromCenterRadius(t,n){return this.center.from(t),this.radius=n,this}fromCornerPoints(t,n){return n=ll.from(n),this.center=new yt().from(t).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(t){return this===t||!!t&&this.center.equals(t.center)&&this.radius===t.radius}clone(){return new eu(this.center,this.radius)}union(t){const n=this.center,s=this.radius,i=t.center,r=t.radius,a=ll.copy(i).subtract(n),l=a.magnitude();if(s>=l+r)return this.clone();if(r>=l+s)return t.clone();const h=(s+l+r)*.5;return C2.copy(a).scale((-s+h)/l).add(n),this.center.copy(C2),this.radius=h,this}expand(t){const s=ll.from(t).subtract(this.center).magnitude();return s>this.radius&&(this.radius=s),this}transform(t){this.center.transform(t);const n=y9(ll,t);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(t){const n=this.distanceTo(t);return n*n}distanceTo(t){const s=ll.from(t).subtract(this.center);return Math.max(0,s.len()-this.radius)}intersectPlane(t){const n=this.center,s=this.radius,r=t.normal.dot(n)+t.distance;return r<-s?Fn.OUTSIDE:r<s?Fn.INTERSECTING:Fn.INSIDE}}const G9=new yt,W9=new yt,Vh=new yt,Hh=new yt,jh=new yt,q9=new yt,Y9=new yt,gi={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class nu{constructor(t=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){this.center=new yt().from(t),this.halfAxes=new Xe(n)}get halfSize(){const t=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),s=this.halfAxes.getColumn(2);return[new yt(t).len(),new yt(n).len(),new yt(s).len()]}get quaternion(){const t=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),s=this.halfAxes.getColumn(2),i=new yt(t).normalize(),r=new yt(n).normalize(),a=new yt(s).normalize();return new v2().fromMatrix3(new Xe([...i,...r,...a]))}fromCenterHalfSizeQuaternion(t,n,s){const i=new v2(s),r=new Xe().fromQuaternion(i);return r[0]=r[0]*n[0],r[1]=r[1]*n[0],r[2]=r[2]*n[0],r[3]=r[3]*n[1],r[4]=r[4]*n[1],r[5]=r[5]*n[1],r[6]=r[6]*n[2],r[7]=r[7]*n[2],r[8]=r[8]*n[2],this.center=new yt().from(t),this.halfAxes=r,this}clone(){return new nu(this.center,this.halfAxes)}equals(t){return this===t||!!t&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}getBoundingSphere(t=new eu){const n=this.halfAxes,s=n.getColumn(0,Vh),i=n.getColumn(1,Hh),r=n.getColumn(2,jh),a=G9.copy(s).add(i).add(r);return t.center.copy(this.center),t.radius=a.magnitude(),t}intersectPlane(t){const n=this.center,s=t.normal,i=this.halfAxes,r=s.x,a=s.y,l=s.z,h=Math.abs(r*i[gi.COLUMN0ROW0]+a*i[gi.COLUMN0ROW1]+l*i[gi.COLUMN0ROW2])+Math.abs(r*i[gi.COLUMN1ROW0]+a*i[gi.COLUMN1ROW1]+l*i[gi.COLUMN1ROW2])+Math.abs(r*i[gi.COLUMN2ROW0]+a*i[gi.COLUMN2ROW1]+l*i[gi.COLUMN2ROW2]),d=s.dot(n)+t.distance;return d<=-h?Fn.OUTSIDE:d>=h?Fn.INSIDE:Fn.INTERSECTING}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const n=W9.from(t).subtract(this.center),s=this.halfAxes,i=s.getColumn(0,Vh),r=s.getColumn(1,Hh),a=s.getColumn(2,jh),l=i.magnitude(),h=r.magnitude(),d=a.magnitude();i.normalize(),r.normalize(),a.normalize();let g=0,_;return _=Math.abs(n.dot(i))-l,_>0&&(g+=_*_),_=Math.abs(n.dot(r))-h,_>0&&(g+=_*_),_=Math.abs(n.dot(a))-d,_>0&&(g+=_*_),g}computePlaneDistances(t,n,s=[-0,-0]){let i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;const a=this.center,l=this.halfAxes,h=l.getColumn(0,Vh),d=l.getColumn(1,Hh),g=l.getColumn(2,jh),_=q9.copy(h).add(d).add(g).add(a),m=Y9.copy(_).subtract(t);let y=n.dot(m);return i=Math.min(y,i),r=Math.max(y,r),_.copy(a).add(h).add(d).subtract(g),m.copy(_).subtract(t),y=n.dot(m),i=Math.min(y,i),r=Math.max(y,r),_.copy(a).add(h).subtract(d).add(g),m.copy(_).subtract(t),y=n.dot(m),i=Math.min(y,i),r=Math.max(y,r),_.copy(a).add(h).subtract(d).subtract(g),m.copy(_).subtract(t),y=n.dot(m),i=Math.min(y,i),r=Math.max(y,r),a.copy(_).subtract(h).add(d).add(g),m.copy(_).subtract(t),y=n.dot(m),i=Math.min(y,i),r=Math.max(y,r),a.copy(_).subtract(h).add(d).subtract(g),m.copy(_).subtract(t),y=n.dot(m),i=Math.min(y,i),r=Math.max(y,r),a.copy(_).subtract(h).subtract(d).add(g),m.copy(_).subtract(t),y=n.dot(m),i=Math.min(y,i),r=Math.max(y,r),a.copy(_).subtract(h).subtract(d).subtract(g),m.copy(_).subtract(t),y=n.dot(m),i=Math.min(y,i),r=Math.max(y,r),s[0]=i,s[1]=r,s}transform(t){this.center.transformAsPoint(t);const n=this.halfAxes.getColumn(0,Vh);n.transformAsPoint(t);const s=this.halfAxes.getColumn(1,Hh);s.transformAsPoint(t);const i=this.halfAxes.getColumn(2,jh);return i.transformAsPoint(t),this.halfAxes=new Xe([...n,...s,...i]),this}getTransform(){throw new Error("not implemented")}}const M2=new yt,w2=new yt;class Ps{constructor(t=[0,0,1],n=0){this.normal=new yt,this.distance=-0,this.fromNormalDistance(t,n)}fromNormalDistance(t,n){return jl(Number.isFinite(n)),this.normal.from(t).normalize(),this.distance=n,this}fromPointNormal(t,n){t=M2.from(t),this.normal.from(n).normalize();const s=-this.normal.dot(t);return this.distance=s,this}fromCoefficients(t,n,s,i){return this.normal.set(t,n,s),jl(vl(this.normal.len(),1)),this.distance=i,this}clone(){return new Ps(this.normal,this.distance)}equals(t){return vl(this.distance,t.distance)&&vl(this.normal,t.normal)}getPointDistance(t){return this.normal.dot(t)+this.distance}transform(t){const n=w2.copy(this.normal).transformAsVector(t).normalize(),s=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(s,n)}projectPointOntoPlane(t,n=[0,0,0]){const s=M2.from(t),i=this.getPointDistance(s),r=w2.copy(this.normal).scale(i);return s.subtract(r).to(n)}}const O2=[new yt([1,0,0]),new yt([0,1,0]),new yt([0,0,1])],B2=new yt,K9=new yt;class Jn{constructor(t=[]){this.planes=t}fromBoundingSphere(t){this.planes.length=2*O2.length;const n=t.center,s=t.radius;let i=0;for(const r of O2){let a=this.planes[i],l=this.planes[i+1];a||(a=this.planes[i]=new Ps),l||(l=this.planes[i+1]=new Ps);const h=B2.copy(r).scale(-s).add(n);a.fromPointNormal(h,r);const d=B2.copy(r).scale(s).add(n),g=K9.copy(r).negate();l.fromPointNormal(d,g),i+=2}return this}computeVisibility(t){let n=Fn.INSIDE;for(const s of this.planes)switch(t.intersectPlane(s)){case Fn.OUTSIDE:return Fn.OUTSIDE;case Fn.INTERSECTING:n=Fn.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(t,n){if(jl(Number.isFinite(n),"parentPlaneMask is required."),n===Jn.MASK_OUTSIDE||n===Jn.MASK_INSIDE)return n;let s=Jn.MASK_INSIDE;const i=this.planes;for(let r=0;r<this.planes.length;++r){const a=r<31?1<<r:0;if(r<31&&(n&a)===0)continue;const l=i[r],h=t.intersectPlane(l);if(h===Fn.OUTSIDE)return Jn.MASK_OUTSIDE;h===Fn.INTERSECTING&&(s|=a)}return s}}Jn.MASK_OUTSIDE=4294967295;Jn.MASK_INSIDE=0;Jn.MASK_INDETERMINATE=2147483647;new yt;new yt;new yt;new yt;new yt;new yt;new yt;new yt;new yt;new yt;new yt;new yt;new yt;new yt;new yt;new yt;new yt;const Ds=new Xe,J9=new Xe,Z9=new Xe,$h=new Xe,x2=new Xe;function Q9(e,t={}){const n=X9,s=10;let i=0,r=0;const a=J9,l=Z9;a.identity(),l.copy(e);const h=n*t5(l);for(;r<s&&e5(l)>h;)n5(l,$h),x2.copy($h).transpose(),l.multiplyRight($h),l.multiplyLeft(x2),a.multiplyRight($h),++i>2&&(++r,i=0);return t.unitary=a.toTarget(t.unitary),t.diagonal=l.toTarget(t.diagonal),t}function t5(e){let t=0;for(let n=0;n<9;++n){const s=e[n];t+=s*s}return Math.sqrt(t)}const fm=[1,0,0],dm=[2,2,1];function e5(e){let t=0;for(let n=0;n<3;++n){const s=e[Ds.getElementIndex(dm[n],fm[n])];t+=2*s*s}return Math.sqrt(t)}function n5(e,t){const n=$9;let s=0,i=1;for(let d=0;d<3;++d){const g=Math.abs(e[Ds.getElementIndex(dm[d],fm[d])]);g>s&&(i=d,s=g)}const r=fm[i],a=dm[i];let l=1,h=0;if(Math.abs(e[Ds.getElementIndex(a,r)])>n){const d=e[Ds.getElementIndex(a,a)],g=e[Ds.getElementIndex(r,r)],_=e[Ds.getElementIndex(a,r)],m=(d-g)/2/_;let y;m<0?y=-1/(-m+Math.sqrt(1+m*m)):y=1/(m+Math.sqrt(1+m*m)),l=1/Math.sqrt(1+y*y),h=y*l}return Xe.IDENTITY.to(t),t[Ds.getElementIndex(r,r)]=t[Ds.getElementIndex(a,a)]=l,t[Ds.getElementIndex(a,r)]=h,t[Ds.getElementIndex(r,a)]=-h,t}const sr=new yt,s5=new yt,i5=new yt,r5=new yt,o5=new yt,a5=new Xe,c5={diagonal:new Xe,unitary:new Xe};function l5(e,t=new nu){if(!e||e.length===0)return t.halfAxes=new Xe([0,0,0,0,0,0,0,0,0]),t.center=new yt,t;const n=e.length,s=new yt(0,0,0);for(const q of e)s.add(q);const i=1/n;s.multiplyByScalar(i);let r=0,a=0,l=0,h=0,d=0,g=0;for(const q of e){const Q=sr.copy(q).subtract(s);r+=Q.x*Q.x,a+=Q.x*Q.y,l+=Q.x*Q.z,h+=Q.y*Q.y,d+=Q.y*Q.z,g+=Q.z*Q.z}r*=i,a*=i,l*=i,h*=i,d*=i,g*=i;const _=a5;_[0]=r,_[1]=a,_[2]=l,_[3]=a,_[4]=h,_[5]=d,_[6]=l,_[7]=d,_[8]=g;const{unitary:m}=Q9(_,c5),y=t.halfAxes.copy(m);let E=y.getColumn(0,i5),b=y.getColumn(1,r5),R=y.getColumn(2,o5),M=-Number.MAX_VALUE,N=-Number.MAX_VALUE,O=-Number.MAX_VALUE,x=Number.MAX_VALUE,I=Number.MAX_VALUE,P=Number.MAX_VALUE;for(const q of e)sr.copy(q),M=Math.max(sr.dot(E),M),N=Math.max(sr.dot(b),N),O=Math.max(sr.dot(R),O),x=Math.min(sr.dot(E),x),I=Math.min(sr.dot(b),I),P=Math.min(sr.dot(R),P);E=E.multiplyByScalar(.5*(x+M)),b=b.multiplyByScalar(.5*(I+N)),R=R.multiplyByScalar(.5*(P+O)),t.center.copy(E).add(b).add(R);const J=s5.set(M-x,N-I,O-P).multiplyByScalar(.5),et=new Xe([J[0],0,0,0,J[1],0,0,0,J[2]]);return t.halfAxes.multiplyRight(et),t}const I_=Math.PI/180,Xh=new Float32Array(16),N2=new Float32Array(12);function I2(e,t,n){const s=t[0]*I_,i=t[1]*I_,r=t[2]*I_,a=Math.sin(r),l=Math.sin(s),h=Math.sin(i),d=Math.cos(r),g=Math.cos(s),_=Math.cos(i),m=n[0],y=n[1],E=n[2];e[0]=m*_*g,e[1]=m*h*g,e[2]=m*-l,e[3]=y*(-h*d+_*l*a),e[4]=y*(_*d+h*l*a),e[5]=y*g*a,e[6]=E*(h*a+_*l*d),e[7]=E*(-_*a+h*l*d),e[8]=E*g*d}function D2(e){return e[0]=e[0],e[1]=e[1],e[2]=e[2],e[3]=e[4],e[4]=e[5],e[5]=e[6],e[6]=e[8],e[7]=e[9],e[8]=e[10],e[9]=e[12],e[10]=e[13],e[11]=e[14],e.subarray(0,12)}const zv={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrixCol0:{size:3,elementOffset:0},instanceModelMatrixCol1:{size:3,elementOffset:3},instanceModelMatrixCol2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(e,{startRow:t,endRow:n}){const{data:s,getOrientation:i,getScale:r,getTranslation:a,getTransformMatrix:l}=this.props,h=Array.isArray(l),d=h&&l.length===16,g=Array.isArray(r),_=Array.isArray(i),m=Array.isArray(a),y=d||!h&&!!l(s[0]);y?e.constant=d:e.constant=_&&g&&m;const E=e.value;if(e.constant){let b;y?(Xh.set(l),b=D2(Xh)):(b=N2,I2(b,i,r),b.set(a,9)),e.value=new Float32Array(b)}else{let b=t*e.size;const{iterable:R,objectInfo:M}=hv(s,t,n);for(const N of R){M.index++;let O;if(y)Xh.set(d?l:l(N,M)),O=D2(Xh);else{O=N2;const x=_?i:i(N,M),I=g?r:r(N,M);I2(O,x,I),O.set(m?a:a(N,M),9)}E[b++]=O[0],E[b++]=O[1],E[b++]=O[2],E[b++]=O[3],E[b++]=O[4],E[b++]=O[5],E[b++]=O[6],E[b++]=O[7],E[b++]=O[8],E[b++]=O[9],E[b++]=O[10],E[b++]=O[11]}}}};function Vv(e,t){return t===Nt.CARTESIAN||t===Nt.METER_OFFSETS||t===Nt.DEFAULT&&!e.isGeospatial}const u5=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec3 instanceModelMatrixCol0;
in vec3 instanceModelMatrixCol1;
in vec3 instanceModelMatrixCol2;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = texCoords;
geometry.pickingColor = instancePickingColors;
vTexCoord = texCoords;
cameraPosition = project_uCameraPosition;
vColor = vec4(colors * instanceColors.rgb, instanceColors.a);
mat3 instanceModelMatrix = mat3(instanceModelMatrixCol0, instanceModelMatrixCol1, instanceModelMatrixCol2);
vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;
if (composeModelMatrix) {
DECKGL_FILTER_SIZE(pos, geometry);
normals_commonspace = project_normal(instanceModelMatrix * normals);
geometry.worldPosition += pos;
gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
geometry.position = position_commonspace;
}
else {
pos = project_size(pos);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
geometry.position = position_commonspace;
normals_commonspace = project_normal(instanceModelMatrix * normals);
}
geometry.normal = normals_commonspace;
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,h5=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs
precision highp float;
uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;
in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
geometry.uv = vTexCoord;
vec3 normal;
if (flatShading) {
normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
} else {
normal = normals_commonspace;
}
vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
DECKGL_FILTER_COLOR(color, geometry);
vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
fragColor = vec4(lightColor, color.a * opacity);
}
`;function f5(e){let t=1/0,n=1/0,s=1/0,i=-1/0,r=-1/0,a=-1/0;const l=e.POSITION?e.POSITION.value:[],h=l&&l.length;for(let d=0;d<h;d+=3){const g=l[d],_=l[d+1],m=l[d+2];t=g<t?g:t,n=_<n?_:n,s=m<s?m:s,i=g>i?g:i,r=_>r?_:r,a=m>a?m:a}return[[t,n,s],[i,r,a]]}function D_(e){const t=e.positions||e.POSITION;kt.assert(t,'no "postions" or "POSITION" attribute in mesh');const n=t.value.length/t.size;let s=e.COLOR_0||e.colors;s||(s={size:3,value:new Float32Array(n*3).fill(1)});let i=e.NORMAL||e.normals;i||(i={size:3,value:new Float32Array(n*3).fill(0)});let r=e.TEXCOORD_0||e.texCoords;return r||(r={size:2,value:new Float32Array(n*2).fill(0)}),{positions:t,colors:s,normals:i,texCoords:r}}function P2(e){return e instanceof Na?(e.attributes=D_(e.attributes),e):e.attributes?new Na({...e,topology:"triangle-list",attributes:D_(e.attributes)}):new Na({topology:"triangle-list",attributes:D_(e)})}const d5=[0,0,0,255],g5={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:e=>e.position},getColor:{type:"accessor",value:d5},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0,value:null}};class c1 extends tc{getShaders(){return super.getShaders({vs:u5,fs:h5,modules:[Ym,fF,Zm]})}getBounds(){var s;if(this.props._instanced)return super.getBounds();let t=this.state.positionBounds;if(t)return t;const{mesh:n}=this.props;if(!n)return null;if(t=(s=n.header)==null?void 0:s.boundingBox,!t){const{attributes:i}=P2(n);i.POSITION=i.POSITION||i.positions,t=f5(i)}return this.state.positionBounds=t,t}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:"float64",fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:"unorm8",transition:!0,size:this.props.colorFormat.length,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:zv}),this.setState({emptyTexture:this.context.device.createTexture({data:new Uint8Array(4),width:1,height:1})})}updateState(t){var r;super.updateState(t);const{props:n,oldProps:s,changeFlags:i}=t;if(n.mesh!==s.mesh||i.extensionsChanged){if(this.state.positionBounds=null,(r=this.state.model)==null||r.destroy(),n.mesh){this.state.model=this.getModel(n.mesh);const a=n.mesh.attributes||n.mesh;this.setState({hasNormals:!!(a.NORMAL||a.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==s.texture&&n.texture instanceof kn&&this.setTexture(n.texture),this.state.model&&this.state.model.setTopology(this.props.wireframe?"line-strip":"triangle-list")}finalizeState(t){super.finalizeState(t),this.state.emptyTexture.delete()}draw({uniforms:t}){const{model:n}=this.state;if(!n)return;const{viewport:s,renderPass:i}=this.context,{sizeScale:r,coordinateSystem:a,_instanced:l}=this.props;n.setUniforms(t),n.setUniforms({sizeScale:r,composeModelMatrix:!l||Vv(s,a),flatShading:!this.state.hasNormals}),n.draw(i)}get isLoaded(){var t;return!!((t=this.state)!=null&&t.model&&super.isLoaded)}getModel(t){const n=new pr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:P2(t),isInstanced:!0}),{texture:s}=this.props,{emptyTexture:i}=this.state;return n.setBindings({sampler:s||i}),n.setUniforms({hasTexture:!!s}),n}setTexture(t){const{emptyTexture:n,model:s}=this.state;s&&(s.setBindings({sampler:t||n}),s.setUniforms({hasTexture:!!t}))}}c1.defaultProps=g5;c1.layerName="SimpleMeshLayer";var us;(function(e){e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.ONE=1]="ONE",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.LINEAR=9729]="LINEAR",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL"})(us||(us={}));function Hv(e,t,n,s){const i={defines:{MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},bindings:{},uniforms:{u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},parameters:{},glParameters:{},generatedTextures:[]};i.defines.USE_TEX_LOD=1;const{imageBasedLightingEnvironment:r}=s;return r&&(i.bindings.u_DiffuseEnvSampler=r.diffuseEnvSampler,i.bindings.u_SpecularEnvSampler=r.specularEnvSampler,i.bindings.u_brdfLUT=r.brdfLutTexture,i.uniforms.u_ScaleIBLAmbient=[1,1]),s!=null&&s.pbrDebug&&(i.defines.PBR_DEBUG=1,i.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],i.uniforms.u_ScaleFGDSpec=[0,0,0,0]),n.NORMAL&&(i.defines.HAS_NORMALS=1),n.TANGENT&&(s!=null&&s.useTangents)&&(i.defines.HAS_TANGENTS=1),n.TEXCOORD_0&&(i.defines.HAS_UV=1),s!=null&&s.imageBasedLightingEnvironment&&(i.defines.USE_IBL=1),s!=null&&s.lights&&(i.defines.USE_LIGHTS=1),t&&p5(e,t,i),i}function p5(e,t,n){if(n.uniforms.pbr_uUnlit=!!t.unlit,t.pbrMetallicRoughness&&_5(e,t.pbrMetallicRoughness,n),t.normalTexture){Cl(e,t.normalTexture,"u_NormalSampler","HAS_NORMALMAP",n);const{scale:s=1}=t.normalTexture;n.uniforms.u_NormalScale=s}if(t.occlusionTexture){Cl(e,t.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP",n);const{strength:s=1}=t.occlusionTexture;n.uniforms.u_OcclusionStrength=s}switch(t.emissiveTexture&&(Cl(e,t.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP",n),n.uniforms.u_EmissiveFactor=t.emissiveFactor||[0,0,0]),t.alphaMode){case"MASK":const{alphaCutoff:s=.5}=t;n.defines.ALPHA_CUTOFF=1,n.uniforms.u_AlphaCutoff=s;break;case"BLEND":ot.warn("glTF BLEND alphaMode might not work well because it requires mesh sorting")(),n.parameters.blendColorOperation="add",n.parameters.blendColorSrcFactor="src-alpha",n.parameters.blendColorDstFactor="one-minus-src-alpha",n.parameters.blendAlphaOperation="add",n.parameters.blendAlphaSrcFactor="one",n.parameters.blendAlphaDstFactor="one-minus-src-alpha",n.glParameters.blend=!0,n.glParameters.blendEquation=us.FUNC_ADD,n.glParameters.blendFunc=[us.SRC_ALPHA,us.ONE_MINUS_SRC_ALPHA,us.ONE,us.ONE_MINUS_SRC_ALPHA];break}}function _5(e,t,n){t.baseColorTexture&&Cl(e,t.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP",n),n.uniforms.u_BaseColorFactor=t.baseColorFactor||[1,1,1,1],t.metallicRoughnessTexture&&Cl(e,t.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP",n);const{metallicFactor:s=1,roughnessFactor:i=1}=t;n.uniforms.u_MetallicRoughnessValues=[s,i]}function Cl(e,t,n,s=null,i){var g,_;const r=((_=(g=t==null?void 0:t.texture)==null?void 0:g.sampler)==null?void 0:_.parameters)||{},a=t.texture.source.image;let l,h={};a.compressed?(l=a,h={[us.TEXTURE_MIN_FILTER]:a.data.length>1?us.LINEAR_MIPMAP_NEAREST:us.LINEAR}):l={data:a};const d=e.createTexture({id:t.uniformName||t.id,parameters:{...r,...h},pixelStore:{[us.UNPACK_FLIP_Y_WEBGL]:!1},...l});i.bindings[n]=d,s&&(i.defines[s]=1),i.generatedTextures.push(d)}const m5="4.3.2";function A5(e){var t;globalThis.loaders||(globalThis.loaders={}),(t=globalThis.loaders).modules||(t.modules={}),Object.assign(globalThis.loaders.modules,e)}function y5(e){var n,s;return((s=(n=globalThis.loaders)==null?void 0:n.modules)==null?void 0:s[e])||null}function T5(){var e;return(e=globalThis._loadersgl_)!=null&&e.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.2"),globalThis._loadersgl_.version}const E5=T5();function b5(e,t){if(!e)throw new Error("loaders.gl assertion failed.")}const su=typeof process!="object"||String(process)!=="[object process]"||process.browser,l1=typeof importScripts=="function",F2=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);F2&&parseFloat(F2[1]);const P_={};async function sd(e,t=null,n={},s=null){return t&&(e=S5(e,t,n,s)),P_[e]=P_[e]||R5(e),await P_[e]}function S5(e,t,n={},s=null){if(!n.useLocalLibraries&&e.startsWith("http"))return e;s=s||e;const i=n.modules||{};return i[s]?i[s]:su?n.CDN?(b5(n.CDN.startsWith("http")),`${n.CDN}/${t}@${E5}/dist/libs/${s}`):l1?`../src/libs/${s}`:`modules/${t}/src/libs/${s}`:`modules/${t}/dist/libs/${s}`}async function R5(e){if(e.endsWith("wasm"))return await C5(e);if(!su)try{const{requireFromFile:n}=globalThis.loaders||{};return await(n==null?void 0:n(e))}catch(n){return console.error(n),null}if(l1)return importScripts(e);const t=await M5(e);return v5(t,e)}function v5(e,t){if(!su){const{requireFromString:s}=globalThis.loaders||{};return s==null?void 0:s(e,t)}if(l1)return eval.call(globalThis,e),null;const n=document.createElement("script");n.id=t;try{n.appendChild(document.createTextNode(e))}catch{n.text=e}return document.body.appendChild(n),null}async function C5(e){const{readFileAsArrayBuffer:t}=globalThis.loaders||{};return su||!t||e.startsWith("http")?await(await fetch(e)).arrayBuffer():await t(e)}async function M5(e){const{readFileAsText:t}=globalThis.loaders||{};return su||!t||e.startsWith("http")?await(await fetch(e)).text():await t(e)}const id={TRANSCODER:"basis_transcoder.js",TRANSCODER_WASM:"basis_transcoder.wasm",ENCODER:"basis_encoder.js",ENCODER_WASM:"basis_encoder.wasm"};let U2;async function L2(e){A5(e.modules);const t=y5("basis");return t||(U2||(U2=w5(e)),await U2)}async function w5(e){let t=null,n=null;return[t,n]=await Promise.all([await sd(id.TRANSCODER,"textures",e),await sd(id.TRANSCODER_WASM,"textures",e)]),t=t||globalThis.BASIS,await O5(t,n)}function O5(e,t){const n={};return t&&(n.wasmBinary=t),new Promise(s=>{e(n).then(i=>{const{BasisFile:r,initializeBasis:a}=i;a(),s({BasisFile:r})})})}let F_;async function k2(e){const t=e.modules||{};return t.basisEncoder?t.basisEncoder:(F_=F_||B5(e),await F_)}async function B5(e){let t=null,n=null;return[t,n]=await Promise.all([await sd(id.ENCODER,"textures",e),await sd(id.ENCODER_WASM,"textures",e)]),t=t||globalThis.BASIS,await x5(t,n)}function x5(e,t){const n={};return t&&(n.wasmBinary=t),new Promise(s=>{e(n).then(i=>{const{BasisFile:r,KTX2File:a,initializeBasis:l,BasisEncoder:h}=i;l(),s({BasisFile:r,KTX2File:a,BasisEncoder:h})})})}const pa={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGBA_ASTC_4X4_KHR:37808},N5=["","WEBKIT_","MOZ_"],z2={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let Gh=null;function I5(e){if(!Gh){e=e||D5()||void 0,Gh=new Set;for(const t of N5)for(const n in z2)if(e&&e.getExtension(`${t}${n}`)){const s=z2[n];Gh.add(s)}}return Gh}function D5(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}const Dn=[171,75,84,88,32,50,48,187,13,10,26,10];function P5(e){const t=new Uint8Array(e);return!(t.byteLength<Dn.length||t[0]!==Dn[0]||t[1]!==Dn[1]||t[2]!==Dn[2]||t[3]!==Dn[3]||t[4]!==Dn[4]||t[5]!==Dn[5]||t[6]!==Dn[6]||t[7]!==Dn[7]||t[8]!==Dn[8]||t[9]!==Dn[9]||t[10]!==Dn[10]||t[11]!==Dn[11])}const F5={etc1:{basisFormat:0,compressed:!0,format:pa.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:pa.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:pa.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:pa.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:pa.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:pa.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function U5(e,t){if(t.basis.containerFormat==="auto"){if(P5(e)){const s=await k2(t);return V2(s.KTX2File,e,t)}const{BasisFile:n}=await L2(t);return U_(n,e,t)}switch(t.basis.module){case"encoder":const n=await k2(t);switch(t.basis.containerFormat){case"ktx2":return V2(n.KTX2File,e,t);case"basis":default:return U_(n.BasisFile,e,t)}case"transcoder":default:const{BasisFile:s}=await L2(t);return U_(s,e,t)}}function U_(e,t,n){const s=new e(new Uint8Array(t));try{if(!s.startTranscoding())throw new Error("Failed to start basis transcoding");const i=s.getNumImages(),r=[];for(let a=0;a<i;a++){const l=s.getNumLevels(a),h=[];for(let d=0;d<l;d++)h.push(L5(s,a,d,n));r.push(h)}return r}finally{s.close(),s.delete()}}function L5(e,t,n,s){const i=e.getImageWidth(t,n),r=e.getImageHeight(t,n),a=e.getHasAlpha(),{compressed:l,format:h,basisFormat:d}=jv(s,a),g=e.getImageTranscodedSizeInBytes(t,n,d),_=new Uint8Array(g);if(!e.transcodeImage(_,t,n,d,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:r,data:_,compressed:l,format:h,hasAlpha:a}}function V2(e,t,n){const s=new e(new Uint8Array(t));try{if(!s.startTranscoding())throw new Error("failed to start KTX2 transcoding");const i=s.getLevels(),r=[];for(let a=0;a<i;a++)r.push(k5(s,a,n));return[r]}finally{s.close(),s.delete()}}function k5(e,t,n){const{alphaFlag:s,height:i,width:r}=e.getImageLevelInfo(t,0,0),{compressed:a,format:l,basisFormat:h}=jv(n,s),d=e.getImageTranscodedSizeInBytes(t,0,0,h),g=new Uint8Array(d);if(!e.transcodeImage(g,t,0,0,h,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:r,height:i,data:g,compressed:a,levelSize:d,hasAlpha:s,format:l}}function jv(e,t){let n=e&&e.basis&&e.basis.format;return n==="auto"&&(n=$v()),typeof n=="object"&&(n=t?n.alpha:n.noAlpha),n=n.toLowerCase(),F5[n]}function $v(){const e=I5();return e.has("astc")?"astc-4x4":e.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:e.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:e.has("etc1")?"etc1":e.has("etc2")?"etc2":"rgb565"}const z5={dataType:null,batchType:null,name:"Basis",id:"basis",module:"textures",version:m5,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},V5={...z5,parse:U5},H5={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},j5={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};class $5{constructor(t){T(this,"name");T(this,"startTime",0);T(this,"playing",!0);T(this,"speed",1);T(this,"channels",[]);Object.assign(this,t)}animate(t){if(!this.playing)return;const s=(t/1e3-this.startTime)*this.speed;this.channels.forEach(({sampler:i,target:r,path:a})=>{J5(s,i,r,a),W5(r,r._node)})}}class X5{constructor(t){T(this,"animations");this.animations=t.animations.map((n,s)=>{const i=n.name||`Animation-${s}`,r=n.samplers.map(({input:l,interpolation:h="LINEAR",output:d})=>({input:H2(t.accessors[l]),interpolation:h,output:H2(t.accessors[d])})),a=n.channels.map(({sampler:l,target:h})=>({sampler:r[l],target:t.nodes[h.node],path:h.path}));return new $5({name:i,channels:a})})}animate(t){this.setTime(t)}setTime(t){this.animations.forEach(n=>n.animate(t))}getAnimations(){return this.animations}}function H2(e){if(!e._animation){const t=j5[e.componentType],n=H5[e.type],s=n*e.count,{buffer:i,byteOffset:r}=e.bufferView.data,a=new t(i,r+(e.byteOffset||0),s);if(n===1)e._animation=Array.from(a);else{const l=[];for(let h=0;h<a.length;h+=n)l.push(Array.from(a.slice(h,h+n)));e._animation=l}}return e._animation}const G5=new nn;function W5(e,t){if(t.matrix.identity(),e.translation&&t.matrix.translate(e.translation),e.rotation){const n=G5.fromQuaternion(e.rotation);t.matrix.multiplyRight(n)}e.scale&&t.matrix.scale(e.scale)}const L_=new oF;function q5(e,t,n,s,i){if(t==="rotation"){L_.slerp({start:n,target:s,ratio:i});for(let r=0;r<L_.length;r++)e[t][r]=L_[r]}else for(let r=0;r<n.length;r++)e[t][r]=i*s[r]+(1-i)*n[r]}function Y5(e,t,{p0:n,outTangent0:s,inTangent1:i,p1:r,tDiff:a,ratio:l}){for(let h=0;h<e[t].length;h++){const d=s[h]*a,g=i[h]*a;e[t][h]=(2*Math.pow(l,3)-3*Math.pow(l,2)+1)*n[h]+(Math.pow(l,3)-2*Math.pow(l,2)+l)*d+(-2*Math.pow(l,3)+3*Math.pow(l,2))*r[h]+(Math.pow(l,3)-Math.pow(l,2))*g}}function K5(e,t,n){for(let s=0;s<n.length;s++)e[t][s]=n[s]}function J5(e,{input:t,interpolation:n,output:s},i,r){const a=t[t.length-1],l=e%a,h=t.findIndex(m=>m>=l),d=Math.max(0,h-1);if(!Array.isArray(i[r]))switch(r){case"translation":i[r]=[0,0,0];break;case"rotation":i[r]=[0,0,0,1];break;case"scale":i[r]=[1,1,1];break;default:ot.warn(`Bad animation path ${r}`)()}Ht(i[r].length===s[d].length);const g=t[d],_=t[h];switch(n){case"STEP":K5(i,r,s[d]);break;case"LINEAR":if(_>g){const m=(l-g)/(_-g);q5(i,r,s[d],s[h],m)}break;case"CUBICSPLINE":if(_>g){const m=(l-g)/(_-g),y=_-g,E=s[3*d+1],b=s[3*d+2],R=s[3*h+0],M=s[3*h+1];Y5(i,r,{p0:E,outTangent0:b,inTangent1:R,p1:M,tDiff:y,ratio:m})}break;default:ot.warn(`Interpolation ${n} not supported`)();break}}const Z5=`
#pragma vscode_glsllint_stage: vert
#if (__VERSION__ < 300)
  #define _attr attribute
#else
  #define _attr in
#endif

  // _attr vec4 POSITION;
  _attr vec4 positions;

  #ifdef HAS_NORMALS
    // _attr vec4 NORMAL;
    _attr vec4 normals;
  #endif

  #ifdef HAS_TANGENTS
    _attr vec4 TANGENT;
  #endif

  #ifdef HAS_UV
    // _attr vec2 TEXCOORD_0;
    _attr vec2 texCoords;
  #endif

  void main(void) {
    vec4 _NORMAL = vec4(0.);
    vec4 _TANGENT = vec4(0.);
    vec2 _TEXCOORD_0 = vec2(0.);

    #ifdef HAS_NORMALS
      _NORMAL = normals;
    #endif

    #ifdef HAS_TANGENTS
      _TANGENT = TANGENT;
    #endif

    #ifdef HAS_UV
      _TEXCOORD_0 = texCoords;
    #endif

    pbr_setPositionNormalTangentUV(positions, _NORMAL, _TANGENT, _TEXCOORD_0);
    gl_Position = u_MVPMatrix * positions;
  }
`,Q5=`
#pragma vscode_glsllint_stage: frag
#if (__VERSION__ < 300)
  #define fragmentColor gl_FragColor
#else
  out vec4 fragmentColor;
#endif

  void main(void) {
    vec3 pos = pbr_vPosition;
    fragmentColor = pbr_filterColor(vec4(1.0));
  }
`;function tz(e,t){const{id:n,geometry:s,material:i,vertexCount:r,materialOptions:a,modelOptions:l}=t,h=Hv(e,i,s.attributes,a);ot.info(4,"createGLTFModel defines: ",h.defines)();const d=[],g={depthWriteEnabled:!0,depthCompare:"less",depthFormat:"depth24plus",cullMode:"back"},_={id:n,geometry:s,topology:s.topology,vertexCount:r,modules:[Wm],vs:j2(e,Z5),fs:j2(e,Q5),...l,bindings:{...h.bindings,...l.bindings},defines:{...h.defines,...l.defines},parameters:{...g,...h.parameters,...l.parameters},uniforms:{...h.uniforms,...l.uniforms}},m=new pr(e,_);return new K0({managedResources:d,model:m})}function j2(e,t){return`#version 300 es
${t}`}const ez={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class nz{constructor(t,n={}){T(this,"device");T(this,"options");T(this,"gltf");this.device=t,this.options={...ez,...n}}instantiate(t){return this.gltf=t,(t.scenes||[]).map(s=>this.createScene(s))}createAnimator(){return Array.isArray(this.gltf.animations)?new X5(this.gltf):null}createScene(t){const s=(t.nodes||[]).map(r=>this.createNode(r));return new Ia({id:t.name||t.id,children:s})}createNode(t){if(!t._node){const s=(t.children||[]).map(r=>this.createNode(r));t.mesh&&s.push(this.createMesh(t.mesh));const i=new Ia({id:t.name||t.id,children:s});if(t.matrix)i.setMatrix(t.matrix);else{if(i.matrix.identity(),t.translation&&i.matrix.translate(t.translation),t.rotation){const r=new nn().fromQuaternion(t.rotation);i.matrix.multiplyRight(r)}t.scale&&i.matrix.scale(t.scale)}t._node=i}return t._node}createMesh(t){if(!t._mesh){const s=(t.primitives||[]).map((r,a)=>this.createPrimitive(r,a,t)),i=new Ia({id:t.name||t.id,children:s});t._mesh=i}return t._mesh}createPrimitive(t,n,s){const i=t.name||`${s.name||s.id}-primitive-${n}`,r=sz(t.mode||4),a=t.indices?t.indices.count:this.getVertexCount(t.attributes),l=tz(this.device,{id:i,geometry:this.createGeometry(i,t,r),material:t.material,materialOptions:this.options,modelOptions:this.options.modelOptions,vertexCount:a});return l.bounds=[t.attributes.POSITION.min,t.attributes.POSITION.max],l}getVertexCount(t){throw new Error("getVertexCount not implemented")}createGeometry(t,n,s){const i={};for(const[r,a]of Object.entries(n.attributes)){const{components:l,size:h,value:d}=a;i[r]={size:h??l,value:d}}return new Na({id:t,topology:s,indices:n.indices.value,attributes:i})}createBuffer(t,n){t.bufferView||(t.bufferView={});const{bufferView:s}=t;return s.lumaBuffers||(s.lumaBuffers={}),s.lumaBuffers[n]||(s.lumaBuffers[n]=this.device.createBuffer({id:`from-${s.id}`,data:s.data||t.value})),s.lumaBuffers[n]}createSampler(t){return t}needsPOT(){return!1}}var _i;(function(e){e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(_i||(_i={}));function sz(e){switch(e){case _i.POINTS:return"point-list";case _i.LINES:return"line-list";case _i.LINE_STRIP:return"line-strip";case _i.LINE_LOOP:return"line-loop-webgl";case _i.TRIANGLES:return"triangle-list";case _i.TRIANGLE_STRIP:return"triangle-strip";case _i.TRIANGLE_FAN:return"triangle-fan-webgl";default:throw new Error(e)}}function iz(e,t,n){const s=new nz(e,n),i=s.instantiate(t),r=s.createAnimator();return{scenes:i,animator:r}}const rz="4.3.2";async function Xv(e,t,n,s){return s._parse(e,t,n,s)}function co(e,t){if(!e)throw new Error("loader assertion failed.")}const Gv=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),$2=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);$2&&parseFloat($2[1]);function oz(e,t=5){return typeof e=="string"?e.slice(0,t):ArrayBuffer.isView(e)?X2(e.buffer,e.byteOffset,t):e instanceof ArrayBuffer?X2(e,0,t):""}function X2(e,t,n){if(e.byteLength<=t+n)return"";const s=new DataView(e);let i="";for(let r=0;r<n;r++)i+=String.fromCharCode(s.getUint8(t+r));return i}function az(e){try{return JSON.parse(e)}catch{throw new Error(`Failed to parse JSON from data starting with "${oz(e)}"`)}}function Wv(e,t,n){const s=n!==void 0?new Uint8Array(e).subarray(t,t+n):new Uint8Array(e).subarray(t);return new Uint8Array(s).buffer}function iu(e,t){return co(e>=0),co(t>0),e+(t-1)&-4}function cz(e,t,n){let s;if(e instanceof ArrayBuffer)s=new Uint8Array(e);else{const i=e.byteOffset,r=e.byteLength;s=new Uint8Array(e.buffer||e.arrayBuffer,i,r)}return t.set(s,n),n+iu(s.byteLength,4)}var A3;const lz=(A3=globalThis.loaders)==null?void 0:A3.parseImageNode,gm=typeof Image<"u",pm=typeof ImageBitmap<"u",uz=!!lz,_m=Gv?!0:uz;function hz(e){switch(e){case"auto":return pm||gm||_m;case"imagebitmap":return pm;case"image":return gm;case"data":return _m;default:throw new Error(`@loaders.gl/images: image ${e} not supported in this environment`)}}function fz(){if(pm)return"imagebitmap";if(gm)return"image";if(_m)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function dz(e){const t=gz(e);if(!t)throw new Error("Not an image");return t}function qv(e){switch(dz(e)){case"data":return e;case"image":case"imagebitmap":const t=document.createElement("canvas"),n=t.getContext("2d");if(!n)throw new Error("getImageData");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),n.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function gz(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&e instanceof Image?"image":e&&typeof e=="object"&&e.data&&e.width&&e.height?"data":null}const pz=/^data:image\/svg\+xml/,_z=/\.svg((\?|#).*)?$/;function u1(e){return e&&(pz.test(e)||_z.test(e))}function mz(e,t){if(u1(t)){let s=new TextDecoder().decode(e);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(s=unescape(encodeURIComponent(s)))}catch(r){throw new Error(r.message)}return`data:image/svg+xml;base64,${btoa(s)}`}return Yv(e,t)}function Yv(e,t){if(u1(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function Kv(e,t,n){const s=mz(e,n),i=self.URL||self.webkitURL,r=typeof s!="string"&&i.createObjectURL(s);try{return await Az(r||s,t)}finally{r&&i.revokeObjectURL(r)}}async function Az(e,t){const n=new Image;return n.src=e,t.image&&t.image.decode&&n.decode?(await n.decode(),n):await new Promise((s,i)=>{try{n.onload=()=>s(n),n.onerror=r=>{const a=r instanceof Error?r.message:"error";i(new Error(a))}}catch(r){i(r)}})}const yz={};let G2=!0;async function Tz(e,t,n){let s;u1(n)?s=await Kv(e,t,n):s=Yv(e,n);const i=t&&t.imagebitmap;return await Ez(s,i)}async function Ez(e,t=null){if((bz(t)||!G2)&&(t=null),t)try{return await createImageBitmap(e,t)}catch(n){console.warn(n),G2=!1}return await createImageBitmap(e)}function bz(e){for(const t in e||yz)return!1;return!0}function Sz(e){return!Mz(e,"ftyp",4)||(e[8]&96)===0?null:Rz(e)}function Rz(e){switch(vz(e,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function vz(e,t,n){return String.fromCharCode(...e.slice(t,n))}function Cz(e){return[...e].map(t=>t.charCodeAt(0))}function Mz(e,t,n=0){const s=Cz(t);for(let i=0;i<s.length;++i)if(s[i]!==e[i+n])return!1;return!0}const ks=!1,Ml=!0;function h1(e){const t=ru(e);return Oz(t)||Nz(t)||Bz(t)||xz(t)||wz(t)}function wz(e){const t=new Uint8Array(e instanceof DataView?e.buffer:e),n=Sz(t);return n?{mimeType:n.mimeType,width:0,height:0}:null}function Oz(e){const t=ru(e);return t.byteLength>=24&&t.getUint32(0,ks)===2303741511?{mimeType:"image/png",width:t.getUint32(16,ks),height:t.getUint32(20,ks)}:null}function Bz(e){const t=ru(e);return t.byteLength>=10&&t.getUint32(0,ks)===1195984440?{mimeType:"image/gif",width:t.getUint16(6,Ml),height:t.getUint16(8,Ml)}:null}function xz(e){const t=ru(e);return t.byteLength>=14&&t.getUint16(0,ks)===16973&&t.getUint32(2,Ml)===t.byteLength?{mimeType:"image/bmp",width:t.getUint32(18,Ml),height:t.getUint32(22,Ml)}:null}function Nz(e){const t=ru(e);if(!(t.byteLength>=3&&t.getUint16(0,ks)===65496&&t.getUint8(2)===255))return null;const{tableMarkers:s,sofMarkers:i}=Iz();let r=2;for(;r+9<t.byteLength;){const a=t.getUint16(r,ks);if(i.has(a))return{mimeType:"image/jpeg",height:t.getUint16(r+5,ks),width:t.getUint16(r+7,ks)};if(!s.has(a))return null;r+=2,r+=t.getUint16(r,ks)}return null}function Iz(){const e=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)e.add(n);return{tableMarkers:e,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function ru(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}async function Dz(e,t){var i;const{mimeType:n}=h1(e)||{},s=(i=globalThis.loaders)==null?void 0:i.parseImageNode;return co(s),await s(e,n)}async function Pz(e,t,n){t=t||{};const i=(t.image||{}).type||"auto",{url:r}=n||{},a=Fz(i);let l;switch(a){case"imagebitmap":l=await Tz(e,t,r);break;case"image":l=await Kv(e,t,r);break;case"data":l=await Dz(e);break;default:co(!1)}return i==="data"&&(l=qv(l)),l}function Fz(e){switch(e){case"auto":case"data":return fz();default:return hz(e),e}}const Uz=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],Lz=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],kz={image:{type:"auto",decode:!0}},zz={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:rz,mimeTypes:Lz,extensions:Uz,parse:Pz,tests:[e=>!!h1(new DataView(e))],options:kz},k_={};function Vz(e){if(k_[e]===void 0){const t=Gv?jz(e):Hz(e);k_[e]=t}return k_[e]}function Hz(e){var i,r;const t=["image/png","image/jpeg","image/gif"],n=((i=globalThis.loaders)==null?void 0:i.imageFormatsNode)||t;return!!((r=globalThis.loaders)==null?void 0:r.parseImageNode)&&n.includes(e)}function jz(e){switch(e){case"image/avif":case"image/webp":return $z(e);default:return!0}}function $z(e){try{return document.createElement("canvas").toDataURL(e).indexOf(`data:${e}`)===0}catch{return!1}}function zn(e,t){if(!e)throw new Error(t||"assert failed: gltf")}const Jv={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Zv={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Xz=1.33,W2=["SCALAR","VEC2","VEC3","VEC4"],Gz=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],Wz=new Map(Gz),qz={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Yz={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Kz={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function Qv(e){return W2[e-1]||W2[0]}function kd(e){const t=Wz.get(e.constructor);if(!t)throw new Error("Illegal typed array");return t}function f1(e,t){const n=Kz[e.componentType],s=qz[e.type],i=Yz[e.componentType],r=e.count*s,a=e.count*s*i;zn(a>=0&&a<=t.byteLength);const l=Zv[e.componentType],h=Jv[e.type];return{ArrayType:n,length:r,byteLength:a,componentByteSize:l,numberOfComponentsInElement:h}}function tC(e){let{images:t,bufferViews:n}=e;t=t||[],n=n||[];const s=t.map(a=>a.bufferView);n=n.filter(a=>!s.includes(a));const i=n.reduce((a,l)=>a+l.byteLength,0),r=t.reduce((a,l)=>{const{width:h,height:d}=l.image;return a+h*d},0);return i+Math.ceil(4*r*Xz)}function Jz(e,t,n){const s=e.bufferViews[n];zn(s);const i=s.buffer,r=t[i];zn(r);const a=(s.byteOffset||0)+r.byteOffset;return new Uint8Array(r.arrayBuffer,a,s.byteLength)}function Zz(e,t,n){var b,R;const s=typeof n=="number"?(b=e.accessors)==null?void 0:b[n]:n;if(!s)throw new Error(`No gltf accessor ${JSON.stringify(n)}`);const i=(R=e.bufferViews)==null?void 0:R[s.bufferView||0];if(!i)throw new Error(`No gltf buffer view for accessor ${i}`);const{arrayBuffer:r,byteOffset:a}=t[i.buffer],l=(a||0)+(s.byteOffset||0)+(i.byteOffset||0),{ArrayType:h,length:d,componentByteSize:g,numberOfComponentsInElement:_}=f1(s,i),m=g*_,y=i.byteStride||m;if(typeof i.byteStride>"u"||i.byteStride===m)return new h(r,l,d);const E=new h(d);for(let M=0;M<s.count;M++){const N=new h(r,l+M*y,_);E.set(N,M*_)}return E}function Qz(){return{asset:{version:"2.0",generator:"loaders.gl"},buffers:[],extensions:{},extensionsRequired:[],extensionsUsed:[]}}class Le{constructor(t){T(this,"gltf");T(this,"sourceBuffers");T(this,"byteLength");this.gltf={json:(t==null?void 0:t.json)||Qz(),buffers:(t==null?void 0:t.buffers)||[],images:(t==null?void 0:t.images)||[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(t){return this.json[t]}getExtraData(t){return(this.json.extras||{})[t]}hasExtension(t){const n=this.getUsedExtensions().find(i=>i===t),s=this.getRequiredExtensions().find(i=>i===t);return typeof n=="string"||typeof s=="string"}getExtension(t){const n=this.getUsedExtensions().find(i=>i===t),s=this.json.extensions||{};return n?s[t]:null}getRequiredExtension(t){return this.getRequiredExtensions().find(s=>s===t)?this.getExtension(t):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(t,n){return(t.extensions||{})[n]}getScene(t){return this.getObject("scenes",t)}getNode(t){return this.getObject("nodes",t)}getSkin(t){return this.getObject("skins",t)}getMesh(t){return this.getObject("meshes",t)}getMaterial(t){return this.getObject("materials",t)}getAccessor(t){return this.getObject("accessors",t)}getTexture(t){return this.getObject("textures",t)}getSampler(t){return this.getObject("samplers",t)}getImage(t){return this.getObject("images",t)}getBufferView(t){return this.getObject("bufferViews",t)}getBuffer(t){return this.getObject("buffers",t)}getObject(t,n){if(typeof n=="object")return n;const s=this.json[t]&&this.json[t][n];if(!s)throw new Error(`glTF file error: Could not find ${t}[${n}]`);return s}getTypedArrayForBufferView(t){t=this.getBufferView(t);const n=t.buffer,s=this.gltf.buffers[n];zn(s);const i=(t.byteOffset||0)+s.byteOffset;return new Uint8Array(s.arrayBuffer,i,t.byteLength)}getTypedArrayForAccessor(t){const n=this.getAccessor(t);return Zz(this.gltf.json,this.gltf.buffers,n)}getTypedArrayForImageData(t){t=this.getAccessor(t);const n=this.getBufferView(t.bufferView),i=this.getBuffer(n.buffer).data,r=n.byteOffset||0;return new Uint8Array(i,r,n.byteLength)}addApplicationData(t,n){return this.json[t]=n,this}addExtraData(t,n){return this.json.extras=this.json.extras||{},this.json.extras[t]=n,this}addObjectExtension(t,n,s){return t.extensions=t.extensions||{},t.extensions[n]=s,this.registerUsedExtension(n),this}setObjectExtension(t,n,s){const i=t.extensions||{};i[n]=s}removeObjectExtension(t,n){const s=(t==null?void 0:t.extensions)||{};if(s[n]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];const i=this.json.extensionsRemoved;i.includes(n)||i.push(n)}delete s[n]}addExtension(t,n={}){return zn(n),this.json.extensions=this.json.extensions||{},this.json.extensions[t]=n,this.registerUsedExtension(t),n}addRequiredExtension(t,n={}){return zn(n),this.addExtension(t,n),this.registerRequiredExtension(t),n}registerUsedExtension(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(n=>n===t)||this.json.extensionsUsed.push(t)}registerRequiredExtension(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(n=>n===t)||this.json.extensionsRequired.push(t)}removeExtension(t){var n;if((n=this.json.extensions)!=null&&n[t]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];const s=this.json.extensionsRemoved;s.includes(t)||s.push(t)}this.json.extensions&&delete this.json.extensions[t],this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,t),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,t)}setDefaultScene(t){this.json.scene=t}addScene(t){const{nodeIndices:n}=t;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:n}),this.json.scenes.length-1}addNode(t){const{meshIndex:n,matrix:s}=t;this.json.nodes=this.json.nodes||[];const i={mesh:n};return s&&(i.matrix=s),this.json.nodes.push(i),this.json.nodes.length-1}addMesh(t){const{attributes:n,indices:s,material:i,mode:r=4}=t,l={primitives:[{attributes:this._addAttributes(n),mode:r}]};if(s){const h=this._addIndices(s);l.primitives[0].indices=h}return Number.isFinite(i)&&(l.primitives[0].material=i),this.json.meshes=this.json.meshes||[],this.json.meshes.push(l),this.json.meshes.length-1}addPointCloud(t){const s={primitives:[{attributes:this._addAttributes(t),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(s),this.json.meshes.length-1}addImage(t,n){const s=h1(t),i=n||(s==null?void 0:s.mimeType),a={bufferView:this.addBufferView(t),mimeType:i};return this.json.images=this.json.images||[],this.json.images.push(a),this.json.images.length-1}addBufferView(t,n=0,s=this.byteLength){const i=t.byteLength;zn(Number.isFinite(i)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(t);const r={buffer:n,byteOffset:s,byteLength:i};return this.byteLength+=iu(i,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(r),this.json.bufferViews.length-1}addAccessor(t,n){const s={bufferView:t,type:Qv(n.size),componentType:n.componentType,count:n.count,max:n.max,min:n.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(s),this.json.accessors.length-1}addBinaryBuffer(t,n={size:3}){const s=this.addBufferView(t);let i={min:n.min,max:n.max};(!i.min||!i.max)&&(i=this._getAccessorMinMax(t,n.size));const r={size:n.size,componentType:kd(t),count:Math.round(t.length/n.size),min:i.min,max:i.max};return this.addAccessor(s,Object.assign(r,n))}addTexture(t){const{imageIndex:n}=t,s={source:n};return this.json.textures=this.json.textures||[],this.json.textures.push(s),this.json.textures.length-1}addMaterial(t){return this.json.materials=this.json.materials||[],this.json.materials.push(t),this.json.materials.length-1}createBinaryChunk(){var r,a;const t=this.byteLength,n=new ArrayBuffer(t),s=new Uint8Array(n);let i=0;for(const l of this.sourceBuffers||[])i=cz(l,s,i);(a=(r=this.json)==null?void 0:r.buffers)!=null&&a[0]?this.json.buffers[0].byteLength=t:this.json.buffers=[{byteLength:t}],this.gltf.binary=n,this.sourceBuffers=[n],this.gltf.buffers=[{arrayBuffer:n,byteOffset:0,byteLength:n.byteLength}]}_removeStringFromArray(t,n){let s=!0;for(;s;){const i=t.indexOf(n);i>-1?t.splice(i,1):s=!1}}_addAttributes(t={}){const n={};for(const s in t){const i=t[s],r=this._getGltfAttributeName(s),a=this.addBinaryBuffer(i.value,i);n[r]=a}return n}_addIndices(t){return this.addBinaryBuffer(t,{size:1})}_getGltfAttributeName(t){switch(t.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return t}}_getAccessorMinMax(t,n){const s={min:null,max:null};if(t.length<n)return s;s.min=[],s.max=[];const i=t.subarray(0,n);for(const r of i)s.min.push(r),s.max.push(r);for(let r=n;r<t.length;r+=n)for(let a=0;a<n;a++)s.min[0+a]=Math.min(s.min[0+a],t[r+a]),s.max[0+a]=Math.max(s.max[0+a],t[r+a]);return s}}function q2(e){return(e%1+1)%1}const eC={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16,BOOLEAN:1,STRING:1,ENUM:1},tV={INT8:Int8Array,UINT8:Uint8Array,INT16:Int16Array,UINT16:Uint16Array,INT32:Int32Array,UINT32:Uint32Array,INT64:BigInt64Array,UINT64:BigUint64Array,FLOAT32:Float32Array,FLOAT64:Float64Array},nC={INT8:1,UINT8:1,INT16:2,UINT16:2,INT32:4,UINT32:4,INT64:8,UINT64:8,FLOAT32:4,FLOAT64:8};function d1(e,t){return nC[t]*eC[e]}function zd(e,t,n,s){if(n!=="UINT8"&&n!=="UINT16"&&n!=="UINT32"&&n!=="UINT64")return null;const i=e.getTypedArrayForBufferView(t),r=Vd(i,"SCALAR",n,s+1);return r instanceof BigInt64Array||r instanceof BigUint64Array?null:r}function Vd(e,t,n,s=1){const i=eC[t],r=tV[n],a=nC[n],l=s*i,h=l*a;let d=e.buffer,g=e.byteOffset;return g%a!==0&&(d=new Uint8Array(d).slice(g,g+h).buffer,g=0),new r(d,g,l)}function g1(e,t,n){var d,g,_,m,y;const s=`TEXCOORD_${t.texCoord||0}`,i=n.attributes[s],r=e.getTypedArrayForAccessor(i),a=e.gltf.json,l=t.index,h=(g=(d=a.textures)==null?void 0:d[l])==null?void 0:g.source;if(typeof h<"u"){const E=(m=(_=a.images)==null?void 0:_[h])==null?void 0:m.mimeType,b=(y=e.gltf.images)==null?void 0:y[h];if(b&&typeof b.width<"u"){const R=[];for(let M=0;M<r.length;M+=2){const N=eV(b,E,r,M,t.channels);R.push(N)}return R}}return[]}function sC(e,t,n,s,i){if(!(n!=null&&n.length))return;const r=[];for(const g of n){let _=s.findIndex(m=>m===g);_===-1&&(_=s.push(g)-1),r.push(_)}const a=new Uint32Array(r),l=e.gltf.buffers.push({arrayBuffer:a.buffer,byteOffset:a.byteOffset,byteLength:a.byteLength})-1,h=e.addBufferView(a,l,0),d=e.addAccessor(h,{size:1,componentType:kd(a),count:a.length});i.attributes[t]=d}function eV(e,t,n,s,i=[0]){const r={r:{offset:0,shift:0},g:{offset:1,shift:8},b:{offset:2,shift:16},a:{offset:3,shift:24}},a=n[s],l=n[s+1];let h=1;t&&(t.indexOf("image/jpeg")!==-1||t.indexOf("image/png")!==-1)&&(h=4);const d=nV(a,l,e,h);let g=0;for(const _ of i){const m=typeof _=="number"?Object.values(r)[_]:r[_],y=d+m.offset,E=qv(e);if(E.data.length<=y)throw new Error(`${E.data.length} <= ${y}`);const b=E.data[y];g|=b<<m.shift}return g}function nV(e,t,n,s=1){const i=n.width,r=q2(e)*(i-1),a=Math.round(r),l=n.height,h=q2(t)*(l-1),d=Math.round(h),g=n.components?n.components:s;return(d*i+a)*g}function iC(e,t,n,s,i){const r=[];for(let a=0;a<t;a++){const l=n[a],h=n[a+1]-n[a];if(h+l>s)break;const d=l/i,g=h/i;r.push(e.slice(d,d+g))}return r}function rC(e,t,n){const s=[];for(let i=0;i<t;i++){const r=i*n;s.push(e.slice(r,r+n))}return s}function oC(e,t,n,s){if(n)throw new Error("Not implemented - arrayOffsets for strings is specified");if(s){const i=[],r=new TextDecoder("utf8");let a=0;for(let l=0;l<e;l++){const h=s[l+1]-s[l];if(h+a<=t.length){const d=t.subarray(a,h+a),g=r.decode(d);i.push(g),a+=h}}return i}return[]}const Pa="EXT_mesh_features",sV=Pa;async function iV(e,t){const n=new Le(e);oV(n,t)}function rV(e,t){const n=new Le(e);return cV(n),n.createBinaryChunk(),n.gltf}function oV(e,t){const n=e.gltf.json;if(n.meshes)for(const s of n.meshes)for(const i of s.primitives)aV(e,i,t)}function aV(e,t,n){var r,a,l;if(!((r=n==null?void 0:n.gltf)!=null&&r.loadBuffers))return;const s=(a=t.extensions)==null?void 0:a[Pa],i=s==null?void 0:s.featureIds;if(i)for(const h of i){let d;if(typeof h.attribute<"u"){const g=`_FEATURE_ID_${h.attribute}`,_=t.attributes[g];d=e.getTypedArrayForAccessor(_)}else typeof h.texture<"u"&&((l=n==null?void 0:n.gltf)!=null&&l.loadImages)?d=g1(e,h.texture,t):d=[];h.data=d}}function cV(e,t){const n=e.gltf.json.meshes;if(n)for(const s of n)for(const i of s.primitives)uV(e,i)}function lV(e,t,n,s){t.extensions||(t.extensions={});let i=t.extensions[Pa];i||(i={featureIds:[]},t.extensions[Pa]=i);const{featureIds:r}=i,a={featureCount:n.length,propertyTable:s,data:n};r.push(a),e.addObjectExtension(t,Pa,i)}function uV(e,t){var i;const n=(i=t.extensions)==null?void 0:i[Pa];if(!n)return;const s=n.featureIds;s.forEach((r,a)=>{if(r.data){const{accessorKey:l,index:h}=hV(t.attributes),d=new Uint32Array(r.data);s[a]={featureCount:d.length,propertyTable:r.propertyTable,attribute:h},e.gltf.buffers.push({arrayBuffer:d.buffer,byteOffset:d.byteOffset,byteLength:d.byteLength});const g=e.addBufferView(d),_=e.addAccessor(g,{size:1,componentType:kd(d),count:d.length});t.attributes[l]=_}})}function hV(e){const t="_FEATURE_ID_",n=Object.keys(e).filter(r=>r.indexOf(t)===0);let s=-1;for(const r of n){const a=Number(r.substring(t.length));a>s&&(s=a)}return s++,{accessorKey:`${t}${s}`,index:s}}const fV=Object.freeze(Object.defineProperty({__proto__:null,createExtMeshFeatures:lV,decode:iV,encode:rV,name:sV},Symbol.toStringTag,{value:"Module"})),ja="EXT_structural_metadata",dV=ja;async function gV(e,t){const n=new Le(e);_V(n,t)}function pV(e,t){const n=new Le(e);return NV(n),n.createBinaryChunk(),n.gltf}function _V(e,t){var s,i;if(!((s=t.gltf)!=null&&s.loadBuffers))return;const n=e.getExtension(ja);n&&((i=t.gltf)!=null&&i.loadImages&&mV(e,n),AV(e,n))}function mV(e,t){const n=t.propertyTextures,s=e.gltf.json;if(n&&s.meshes)for(const i of s.meshes)for(const r of i.primitives)TV(e,n,r,t)}function AV(e,t){const n=t.schema;if(!n)return;const s=n.classes,i=t.propertyTables;if(s&&i)for(const r in s){const a=yV(i,r);a&&bV(e,n,a)}}function yV(e,t){for(const n of e)if(n.class===t)return n;return null}function TV(e,t,n,s){var a;if(!t)return;const i=(a=n.extensions)==null?void 0:a[ja],r=i==null?void 0:i.propertyTextures;if(r)for(const l of r){const h=t[l];EV(e,h,n,s)}}function EV(e,t,n,s){var r;if(!t.properties)return;s.dataAttributeNames||(s.dataAttributeNames=[]);const i=t.class;for(const a in t.properties){const l=`${i}_${a}`,h=(r=t.properties)==null?void 0:r[a];if(!h)continue;h.data||(h.data=[]);const d=h.data,g=g1(e,h,n);g!==null&&(sC(e,l,g,d,n),h.data=d,s.dataAttributeNames.push(l))}}function bV(e,t,n){var r,a;const s=(r=t.classes)==null?void 0:r[n.class];if(!s)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${n.class}`);const i=n.count;for(const l in s.properties){const h=s.properties[l],d=(a=n.properties)==null?void 0:a[l];if(d){const g=SV(e,t,h,i,d);d.data=g}}}function SV(e,t,n,s,i){let r=[];const a=i.values,l=e.getTypedArrayForBufferView(a),h=RV(e,n,i,s),d=vV(e,i,s);switch(n.type){case"SCALAR":case"VEC2":case"VEC3":case"VEC4":case"MAT2":case"MAT3":case"MAT4":{r=CV(n,s,l,h);break}case"BOOLEAN":throw new Error(`Not implemented - classProperty.type=${n.type}`);case"STRING":{r=oC(s,l,h,d);break}case"ENUM":{r=MV(t,n,s,l,h);break}default:throw new Error(`Unknown classProperty type ${n.type}`)}return r}function RV(e,t,n,s){return t.array&&typeof t.count>"u"&&typeof n.arrayOffsets<"u"?zd(e,n.arrayOffsets,n.arrayOffsetType||"UINT32",s):null}function vV(e,t,n){return typeof t.stringOffsets<"u"?zd(e,t.stringOffsets,t.stringOffsetType||"UINT32",n):null}function CV(e,t,n,s){const i=e.array,r=e.count,a=d1(e.type,e.componentType),l=n.byteLength/a;let h;return e.componentType?h=Vd(n,e.type,e.componentType,l):h=n,i?s?iC(h,t,s,n.length,a):r?rC(h,t,r):[]:h}function MV(e,t,n,s,i){var _;const r=t.enumType;if(!r)throw new Error("Incorrect data in the EXT_structural_metadata extension: classProperty.enumType is not set for type ENUM");const a=(_=e.enums)==null?void 0:_[r];if(!a)throw new Error(`Incorrect data in the EXT_structural_metadata extension: schema.enums does't contain ${r}`);const l=a.valueType||"UINT16",h=d1(t.type,l),d=s.byteLength/h;let g=Vd(s,t.type,l,d);if(g||(g=s),t.array){if(i)return wV({valuesData:g,numberOfElements:n,arrayOffsets:i,valuesDataBytesLength:s.length,elementSize:h,enumEntry:a});const m=t.count;return m?OV(g,n,m,a):[]}return p1(g,0,n,a)}function wV(e){const{valuesData:t,numberOfElements:n,arrayOffsets:s,valuesDataBytesLength:i,elementSize:r,enumEntry:a}=e,l=[];for(let h=0;h<n;h++){const d=s[h],g=s[h+1]-s[h];if(g+d>i)break;const _=d/r,m=g/r,y=p1(t,_,m,a);l.push(y)}return l}function OV(e,t,n,s){const i=[];for(let r=0;r<t;r++){const a=n*r,l=p1(e,a,n,s);i.push(l)}return i}function p1(e,t,n,s){const i=[];for(let r=0;r<n;r++)if(e instanceof BigInt64Array||e instanceof BigUint64Array)i.push("");else{const a=e[t+r],l=BV(s,a);l?i.push(l.name):i.push("")}return i}function BV(e,t){for(const n of e.values)if(n.value===t)return n;return null}const xV="schemaClassId";function NV(e,t){var s,i;const n=e.getExtension(ja);if(n&&n.propertyTables)for(const r of n.propertyTables){const a=r.class,l=(i=(s=n.schema)==null?void 0:s.classes)==null?void 0:i[a];r.properties&&l&&IV(r,l,e)}}function IV(e,t,n){for(const s in e.properties){const i=e.properties[s].data;if(i){const r=t.properties[s];if(r){const a=UV(i,r,n);e.properties[s]=a}}}}function DV(e,t,n=xV){let s=e.getExtension(ja);s||(s=e.addExtension(ja)),s.schema=PV(t,n,s.schema);const i=FV(t,n,s.schema);return s.propertyTables||(s.propertyTables=[]),s.propertyTables.push(i)-1}function PV(e,t,n){const s=n??{id:"schema_id"},i={properties:{}};for(const r of e){const a={type:r.elementType,componentType:r.componentType};i.properties[r.name]=a}return s.classes={},s.classes[t]=i,s}function FV(e,t,n){var a;const s={class:t,count:0};let i=0;const r=(a=n.classes)==null?void 0:a[t];for(const l of e){if(i===0&&(i=l.values.length),i!==l.values.length&&l.values.length)throw new Error("Illegal values in attributes");(r==null?void 0:r.properties[l.name])&&(s.properties||(s.properties={}),s.properties[l.name]={values:0,data:l.values})}return s.count=i,s}function UV(e,t,n){const s={values:0};if(t.type==="STRING"){const{stringData:i,stringOffsets:r}=zV(e);s.stringOffsets=z_(r,n),s.values=z_(i,n)}else if(t.type==="SCALAR"&&t.componentType){const i=kV(e,t.componentType);s.values=z_(i,n)}return s}const LV={INT8:Int8Array,UINT8:Uint8Array,INT16:Int16Array,UINT16:Uint16Array,INT32:Int32Array,UINT32:Uint32Array,INT64:Int32Array,UINT64:Uint32Array,FLOAT32:Float32Array,FLOAT64:Float64Array};function kV(e,t){const n=[];for(const i of e)n.push(Number(i));const s=LV[t];if(!s)throw new Error("Illegal component type");return new s(n)}function zV(e){const t=new TextEncoder,n=[];let s=0;for(const h of e){const d=t.encode(h);s+=d.length,n.push(d)}const i=new Uint8Array(s),r=[];let a=0;for(const h of n)i.set(h,a),r.push(a),a+=h.length;r.push(a);const l=new Uint32Array(r);return{stringData:i,stringOffsets:l}}function z_(e,t){return t.gltf.buffers.push({arrayBuffer:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength}),t.addBufferView(e)}const VV=Object.freeze(Object.defineProperty({__proto__:null,createExtStructuralMetadata:DV,decode:gV,encode:pV,name:dV},Symbol.toStringTag,{value:"Module"})),aC="EXT_feature_metadata",HV=aC;async function jV(e,t){const n=new Le(e);$V(n,t)}function $V(e,t){var s,i;if(!((s=t.gltf)!=null&&s.loadBuffers))return;const n=e.getExtension(aC);n&&((i=t.gltf)!=null&&i.loadImages&&XV(e,n),GV(e,n))}function XV(e,t){const n=t.schema;if(!n)return;const s=n.classes,{featureTextures:i}=t;if(s&&i)for(const r in s){const a=s[r],l=qV(i,r);l&&KV(e,l,a)}}function GV(e,t){const n=t.schema;if(!n)return;const s=n.classes,i=t.featureTables;if(s&&i)for(const r in s){const a=WV(i,r);a&&YV(e,n,a)}}function WV(e,t){for(const n in e){const s=e[n];if(s.class===t)return s}return null}function qV(e,t){for(const n in e){const s=e[n];if(s.class===t)return s}return null}function YV(e,t,n){var r,a;if(!n.class)return;const s=(r=t.classes)==null?void 0:r[n.class];if(!s)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${n.class}`);const i=n.count;for(const l in s.properties){const h=s.properties[l],d=(a=n.properties)==null?void 0:a[l];if(d){const g=JV(e,t,h,i,d);d.data=g}}}function KV(e,t,n){var i;const s=t.class;for(const r in n.properties){const a=(i=t==null?void 0:t.properties)==null?void 0:i[r];if(a){const l=nH(e,a,s);a.data=l}}}function JV(e,t,n,s,i){let r=[];const a=i.bufferView,l=e.getTypedArrayForBufferView(a),h=ZV(e,n,i,s),d=QV(e,n,i,s);return n.type==="STRING"||n.componentType==="STRING"?r=oC(s,l,h,d):tH(n)&&(r=eH(n,s,l,h)),r}function ZV(e,t,n,s){return t.type==="ARRAY"&&typeof t.componentCount>"u"&&typeof n.arrayOffsetBufferView<"u"?zd(e,n.arrayOffsetBufferView,n.offsetType||"UINT32",s):null}function QV(e,t,n,s){return typeof n.stringOffsetBufferView<"u"?zd(e,n.stringOffsetBufferView,n.offsetType||"UINT32",s):null}function tH(e){const t=["UINT8","INT16","UINT16","INT32","UINT32","INT64","UINT64","FLOAT32","FLOAT64"];return t.includes(e.type)||typeof e.componentType<"u"&&t.includes(e.componentType)}function eH(e,t,n,s){const i=e.type==="ARRAY",r=e.componentCount,a="SCALAR",l=e.componentType||e.type,h=d1(a,l),d=n.byteLength/h,g=Vd(n,a,l,d);return i?s?iC(g,t,s,n.length,h):r?rC(g,t,r):[]:g}function nH(e,t,n){const s=e.gltf.json;if(!s.meshes)return[];const i=[];for(const r of s.meshes)for(const a of r.primitives)sH(e,n,t,i,a);return i}function sH(e,t,n,s,i){const r={channels:n.channels,...n.texture},a=g1(e,r,i);a&&sC(e,t,a,s,i)}const iH=Object.freeze(Object.defineProperty({__proto__:null,decode:jV,name:HV},Symbol.toStringTag,{value:"Module"})),rH="4.3.2",$a=!0,Y2=1735152710,_1=12,rd=8,oH=1313821514,aH=5130562,cH=0,lH=0,uH=1;function hH(e,t=0){return`${String.fromCharCode(e.getUint8(t+0))}${String.fromCharCode(e.getUint8(t+1))}${String.fromCharCode(e.getUint8(t+2))}${String.fromCharCode(e.getUint8(t+3))}`}function fH(e,t=0,n={}){const s=new DataView(e),{magic:i=Y2}=n,r=s.getUint32(t,!1);return r===i||r===Y2}function dH(e,t,n=0,s={}){const i=new DataView(t),r=hH(i,n+0),a=i.getUint32(n+4,$a),l=i.getUint32(n+8,$a);switch(Object.assign(e,{header:{byteOffset:n,byteLength:l,hasBinChunk:!1},type:r,version:a,json:{},binChunks:[]}),n+=_1,e.version){case 1:return gH(e,i,n);case 2:return pH(e,i,n,s={});default:throw new Error(`Invalid GLB version ${e.version}. Only supports version 1 and 2.`)}}function gH(e,t,n){co(e.header.byteLength>_1+rd);const s=t.getUint32(n+0,$a),i=t.getUint32(n+4,$a);return n+=rd,co(i===cH),mm(e,t,n,s),n+=s,n+=Am(e,t,n,e.header.byteLength),n}function pH(e,t,n,s){return co(e.header.byteLength>_1+rd),_H(e,t,n,s),n+e.header.byteLength}function _H(e,t,n,s){for(;n+8<=e.header.byteLength;){const i=t.getUint32(n+0,$a),r=t.getUint32(n+4,$a);switch(n+=rd,r){case oH:mm(e,t,n,i);break;case aH:Am(e,t,n,i);break;case lH:s.strict||mm(e,t,n,i);break;case uH:s.strict||Am(e,t,n,i);break}n+=iu(i,4)}return n}function mm(e,t,n,s){const i=new Uint8Array(t.buffer,n,s),a=new TextDecoder("utf8").decode(i);return e.json=JSON.parse(a),iu(s,4)}function Am(e,t,n,s){return e.header.hasBinChunk=!0,e.binChunks.push({byteOffset:n,byteLength:s,arrayBuffer:t.buffer}),iu(s,4)}function cC(e,t){if(e.startsWith("data:")||e.startsWith("http:")||e.startsWith("https:"))return e;const s=t.baseUri||t.uri;if(!s)throw new Error(`'baseUri' must be provided to resolve relative url ${e}`);return s.substr(0,s.lastIndexOf("/")+1)+e}const mH="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",AH="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",yH=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),TH=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),EH={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},bH={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};async function SH(e,t,n,s,i,r="NONE"){const a=await RH();MH(a,a.exports[bH[i]],e,t,n,s,a.exports[EH[r||"NONE"]])}let V_;async function RH(){return V_||(V_=vH()),V_}async function vH(){let e=mH;WebAssembly.validate(yH)&&(e=AH,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const t=await WebAssembly.instantiate(CH(e),{});return await t.instance.exports.__wasm_call_ctors(),t.instance}function CH(e){const t=new Uint8Array(e.length);for(let s=0;s<e.length;++s){const i=e.charCodeAt(s);t[s]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}let n=0;for(let s=0;s<e.length;++s)t[n++]=t[s]<60?TH[t[s]]:(t[s]-60)*64+t[++s];return t.buffer.slice(0,n)}function MH(e,t,n,s,i,r,a){const l=e.exports.sbrk,h=s+3&-4,d=l(h*i),g=l(r.length),_=new Uint8Array(e.exports.memory.buffer);_.set(r,g);const m=t(d,s,i,g,r.length);if(m===0&&a&&a(d,h,i),n.set(_.subarray(d,d+s*i)),l(d-l(0)),m!==0)throw new Error(`Malformed buffer data: ${m}`)}const od="EXT_meshopt_compression",wH=od;async function OH(e,t){var i,r;const n=new Le(e);if(!((i=t==null?void 0:t.gltf)!=null&&i.decompressMeshes)||!((r=t.gltf)!=null&&r.loadBuffers))return;const s=[];for(const a of e.json.bufferViews||[])s.push(BH(n,a));await Promise.all(s),n.removeExtension(od)}async function BH(e,t){const n=e.getObjectExtension(t,od);if(n){const{byteOffset:s=0,byteLength:i=0,byteStride:r,count:a,mode:l,filter:h="NONE",buffer:d}=n,g=e.gltf.buffers[d],_=new Uint8Array(g.arrayBuffer,g.byteOffset+s,i),m=new Uint8Array(e.gltf.buffers[t.buffer].arrayBuffer,t.byteOffset,t.byteLength);await SH(m,a,r,_,l,h),e.removeObjectExtension(t,od)}}const xH=Object.freeze(Object.defineProperty({__proto__:null,decode:OH,name:wH},Symbol.toStringTag,{value:"Module"})),ya="EXT_texture_webp",NH=ya;function IH(e,t){const n=new Le(e);if(!Vz("image/webp")){if(n.getRequiredExtensions().includes(ya))throw new Error(`gltf: Required extension ${ya} not supported by browser`);return}const{json:s}=n;for(const i of s.textures||[]){const r=n.getObjectExtension(i,ya);r&&(i.source=r.source),n.removeObjectExtension(i,ya)}n.removeExtension(ya)}const DH=Object.freeze(Object.defineProperty({__proto__:null,name:NH,preprocess:IH},Symbol.toStringTag,{value:"Module"})),wf="KHR_texture_basisu",PH=wf;function FH(e,t){const n=new Le(e),{json:s}=n;for(const i of s.textures||[]){const r=n.getObjectExtension(i,wf);r&&(i.source=r.source,n.removeObjectExtension(i,wf))}n.removeExtension(wf)}const UH=Object.freeze(Object.defineProperty({__proto__:null,name:PH,preprocess:FH},Symbol.toStringTag,{value:"Module"})),LH="4.3.2",kH={dataType:null,batchType:null,name:"Draco",id:"draco",module:"draco",version:LH,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:typeof WebAssembly=="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};function zH(e){switch(e.constructor){case Int8Array:return"int8";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int16Array:return"int16";case Uint16Array:return"uint16";case Int32Array:return"int32";case Uint32Array:return"uint32";case Float32Array:return"float32";case Float64Array:return"float64";default:return"null"}}function VH(e){let t=1/0,n=1/0,s=1/0,i=-1/0,r=-1/0,a=-1/0;const l=e.POSITION?e.POSITION.value:[],h=l&&l.length;for(let d=0;d<h;d+=3){const g=l[d],_=l[d+1],m=l[d+2];t=g<t?g:t,n=_<n?_:n,s=m<s?m:s,i=g>i?g:i,r=_>r?_:r,a=m>a?m:a}return[[t,n,s],[i,r,a]]}function HH(e,t,n){const s=zH(t.value),i=n||jH(t);return{name:e,type:{type:"fixed-size-list",listSize:t.size,children:[{name:"value",type:s}]},nullable:!1,metadata:i}}function jH(e){const t={};return"byteOffset"in e&&(t.byteOffset=e.byteOffset.toString(10)),"byteStride"in e&&(t.byteStride=e.byteStride.toString(10)),"normalized"in e&&(t.normalized=e.normalized.toString()),t}function $H(e,t,n){const s=lC(t.metadata),i=[],r=XH(t.attributes);for(const a in e){const l=e[a],h=K2(a,l,r[a]);i.push(h)}if(n){const a=K2("indices",n);i.push(a)}return{fields:i,metadata:s}}function XH(e){const t={};for(const n in e){const s=e[n];t[s.name||"undefined"]=s}return t}function K2(e,t,n){const s=n?lC(n.metadata):void 0;return HH(e,t,s)}function lC(e){Object.entries(e);const t={};for(const n in e)t[`${n}.string`]=JSON.stringify(e[n]);return t}const J2={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},GH={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},WH=4;class qH{constructor(t){T(this,"draco");T(this,"decoder");T(this,"metadataQuerier");this.draco=t,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(t,n={}){const s=new this.draco.DecoderBuffer;s.Init(new Int8Array(t),t.byteLength),this._disableAttributeTransforms(n);const i=this.decoder.GetEncodedGeometryType(s),r=i===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let a;switch(i){case this.draco.TRIANGULAR_MESH:a=this.decoder.DecodeBufferToMesh(s,r);break;case this.draco.POINT_CLOUD:a=this.decoder.DecodeBufferToPointCloud(s,r);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!a.ok()||!r.ptr){const m=`DRACO decompression failed: ${a.error_msg()}`;throw new Error(m)}const l=this._getDracoLoaderData(r,i,n),h=this._getMeshData(r,l,n),d=VH(h.attributes),g=$H(h.attributes,l,h.indices);return{loader:"draco",loaderData:l,header:{vertexCount:r.num_points(),boundingBox:d},...h,schema:g}}finally{this.draco.destroy(s),r&&this.draco.destroy(r)}}_getDracoLoaderData(t,n,s){const i=this._getTopLevelMetadata(t),r=this._getDracoAttributes(t,s);return{geometry_type:n,num_attributes:t.num_attributes(),num_points:t.num_points(),num_faces:t instanceof this.draco.Mesh?t.num_faces():0,metadata:i,attributes:r}}_getDracoAttributes(t,n){const s={};for(let i=0;i<t.num_attributes();i++){const r=this.decoder.GetAttribute(t,i),a=this._getAttributeMetadata(t,i);s[r.unique_id()]={unique_id:r.unique_id(),attribute_type:r.attribute_type(),data_type:r.data_type(),num_components:r.num_components(),byte_offset:r.byte_offset(),byte_stride:r.byte_stride(),normalized:r.normalized(),attribute_index:i,metadata:a};const l=this._getQuantizationTransform(r,n);l&&(s[r.unique_id()].quantization_transform=l);const h=this._getOctahedronTransform(r,n);h&&(s[r.unique_id()].octahedron_transform=h)}return s}_getMeshData(t,n,s){const i=this._getMeshAttributes(n,t,s);if(!i.POSITION)throw new Error("DRACO: No position attribute found.");if(t instanceof this.draco.Mesh)switch(s.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:i,indices:{value:this._getTriangleStripIndices(t),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:i,indices:{value:this._getTriangleListIndices(t),size:1}}}return{topology:"point-list",mode:0,attributes:i}}_getMeshAttributes(t,n,s){const i={};for(const r of Object.values(t.attributes)){const a=this._deduceAttributeName(r,s);r.name=a;const l=this._getAttributeValues(n,r);if(l){const{value:h,size:d}=l;i[a]={value:h,size:d,byteOffset:r.byte_offset,byteStride:r.byte_stride,normalized:r.normalized}}}return i}_getTriangleListIndices(t){const s=t.num_faces()*3,i=s*WH,r=this.draco._malloc(i);try{return this.decoder.GetTrianglesUInt32Array(t,i,r),new Uint32Array(this.draco.HEAPF32.buffer,r,s).slice()}finally{this.draco._free(r)}}_getTriangleStripIndices(t){const n=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(t,n),JH(n)}finally{this.draco.destroy(n)}}_getAttributeValues(t,n){const s=GH[n.data_type];if(!s)return console.warn(`DRACO: Unsupported attribute type ${n.data_type}`),null;const i=n.num_components,a=t.num_points()*i,l=a*s.BYTES_PER_ELEMENT,h=YH(this.draco,s);let d;const g=this.draco._malloc(l);try{const _=this.decoder.GetAttribute(t,n.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(t,_,h,l,g),d=new s(this.draco.HEAPF32.buffer,g,a).slice()}finally{this.draco._free(g)}return{value:d,size:i}}_deduceAttributeName(t,n){const s=t.unique_id;for(const[a,l]of Object.entries(n.extraAttributes||{}))if(l===s)return a;const i=t.attribute_type;for(const a in J2)if(this.draco[a]===i)return J2[a];const r=n.attributeNameEntry||"name";return t.metadata[r]?t.metadata[r].string:`CUSTOM_ATTRIBUTE_${s}`}_getTopLevelMetadata(t){const n=this.decoder.GetMetadata(t);return this._getDracoMetadata(n)}_getAttributeMetadata(t,n){const s=this.decoder.GetAttributeMetadata(t,n);return this._getDracoMetadata(s)}_getDracoMetadata(t){if(!t||!t.ptr)return{};const n={},s=this.metadataQuerier.NumEntries(t);for(let i=0;i<s;i++){const r=this.metadataQuerier.GetEntryName(t,i);n[r]=this._getDracoMetadataField(t,r)}return n}_getDracoMetadataField(t,n){const s=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(t,n,s);const i=KH(s);return{int:this.metadataQuerier.GetIntEntry(t,n),string:this.metadataQuerier.GetStringEntry(t,n),double:this.metadataQuerier.GetDoubleEntry(t,n),intArray:i}}finally{this.draco.destroy(s)}}_disableAttributeTransforms(t){const{quantizedAttributes:n=[],octahedronAttributes:s=[]}=t,i=[...n,...s];for(const r of i)this.decoder.SkipAttributeTransform(this.draco[r])}_getQuantizationTransform(t,n){const{quantizedAttributes:s=[]}=n,i=t.attribute_type();if(s.map(a=>this.decoder[a]).includes(i)){const a=new this.draco.AttributeQuantizationTransform;try{if(a.InitFromAttribute(t))return{quantization_bits:a.quantization_bits(),range:a.range(),min_values:new Float32Array([1,2,3]).map(l=>a.min_value(l))}}finally{this.draco.destroy(a)}}return null}_getOctahedronTransform(t,n){const{octahedronAttributes:s=[]}=n,i=t.attribute_type();if(s.map(a=>this.decoder[a]).includes(i)){const a=new this.draco.AttributeQuantizationTransform;try{if(a.InitFromAttribute(t))return{quantization_bits:a.quantization_bits()}}finally{this.draco.destroy(a)}}return null}}function YH(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32;default:return e.DT_INVALID}}function KH(e){const t=e.size(),n=new Int32Array(t);for(let s=0;s<t;s++)n[s]=e.GetValue(s);return n}function JH(e){const t=e.size(),n=new Int32Array(t);for(let s=0;s<t;s++)n[s]=e.GetValue(s);return n}function ZH(){var e;return(e=globalThis._loadersgl_)!=null&&e.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.2"),globalThis._loadersgl_.version}const QH=ZH();function t7(e,t){if(!e)throw new Error("loaders.gl assertion failed.")}const ou=typeof process!="object"||String(process)!=="[object process]"||process.browser,m1=typeof importScripts=="function",Z2=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);Z2&&parseFloat(Z2[1]);const H_={};async function j_(e,t=null,n={},s=null){return t&&(e=e7(e,t,n,s)),H_[e]=H_[e]||n7(e),await H_[e]}function e7(e,t,n={},s=null){if(!n.useLocalLibraries&&e.startsWith("http"))return e;s=s||e;const i=n.modules||{};return i[s]?i[s]:ou?n.CDN?(t7(n.CDN.startsWith("http")),`${n.CDN}/${t}@${QH}/dist/libs/${s}`):m1?`../src/libs/${s}`:`modules/${t}/src/libs/${s}`:`modules/${t}/dist/libs/${s}`}async function n7(e){if(e.endsWith("wasm"))return await i7(e);if(!ou)try{const{requireFromFile:n}=globalThis.loaders||{};return await(n==null?void 0:n(e))}catch(n){return console.error(n),null}if(m1)return importScripts(e);const t=await r7(e);return s7(t,e)}function s7(e,t){if(!ou){const{requireFromString:s}=globalThis.loaders||{};return s==null?void 0:s(e,t)}if(m1)return eval.call(globalThis,e),null;const n=document.createElement("script");n.id=t;try{n.appendChild(document.createTextNode(e))}catch{n.text=e}return document.body.appendChild(n),null}async function i7(e){const{readFileAsArrayBuffer:t}=globalThis.loaders||{};return ou||!t||e.startsWith("http")?await(await fetch(e)).arrayBuffer():await t(e)}async function r7(e){const{readFileAsText:t}=globalThis.loaders||{};return ou||!t||e.startsWith("http")?await(await fetch(e)).text():await t(e)}const o7="1.5.6",a7="1.4.1",$_=`https://www.gstatic.com/draco/versioned/decoders/${o7}`,mn={DECODER:"draco_wasm_wrapper.js",DECODER_WASM:"draco_decoder.wasm",FALLBACK_DECODER:"draco_decoder.js",ENCODER:"draco_encoder.js"},X_={[mn.DECODER]:`${$_}/${mn.DECODER}`,[mn.DECODER_WASM]:`${$_}/${mn.DECODER_WASM}`,[mn.FALLBACK_DECODER]:`${$_}/${mn.FALLBACK_DECODER}`,[mn.ENCODER]:`https://raw.githubusercontent.com/google/draco/${a7}/javascript/${mn.ENCODER}`};let G_;async function c7(e){const t=e.modules||{};return t.draco3d?G_||(G_=t.draco3d.createDecoderModule({}).then(n=>({draco:n}))):G_||(G_=l7(e)),await G_}async function l7(e){let t,n;switch(e.draco&&e.draco.decoderType){case"js":t=await j_(X_[mn.FALLBACK_DECODER],"draco",e,mn.FALLBACK_DECODER);break;case"wasm":default:[t,n]=await Promise.all([await j_(X_[mn.DECODER],"draco",e,mn.DECODER),await j_(X_[mn.DECODER_WASM],"draco",e,mn.DECODER_WASM)])}return t=t||globalThis.DracoDecoderModule,await u7(t,n)}function u7(e,t){const n={};return t&&(n.wasmBinary=t),new Promise(s=>{e({...n,onModuleLoaded:i=>s({draco:i})})})}const uC={...kH,parse:h7};async function h7(e,t){const{draco:n}=await c7(t),s=new qH(n);try{return s.parseSync(e,t==null?void 0:t.draco)}finally{s.destroy()}}function f7(e){const t={};for(const n in e){const s=e[n];if(n!=="indices"){const i=hC(s);t[n]=i}}return t}function hC(e){const{buffer:t,size:n,count:s}=d7(e);return{value:t,size:n,byteOffset:0,count:s,type:Qv(n),componentType:kd(t)}}function d7(e){let t=e,n=1,s=0;return e&&e.value&&(t=e.value,n=e.size||1),t&&(ArrayBuffer.isView(t)||(t=g7(t,Float32Array)),s=t.length/n),{buffer:t,size:n,count:s}}function g7(e,t,n=!1){return e?Array.isArray(e)?new t(e):n&&!(e instanceof t)?new t(e):e:null}const mr="KHR_draco_mesh_compression",p7=mr;function _7(e,t,n){const s=new Le(e);for(const i of fC(s))s.getObjectExtension(i,mr)}async function m7(e,t,n){var r;if(!((r=t==null?void 0:t.gltf)!=null&&r.decompressMeshes))return;const s=new Le(e),i=[];for(const a of fC(s))s.getObjectExtension(a,mr)&&i.push(y7(s,a,t,n));await Promise.all(i),s.removeExtension(mr)}function A7(e,t={}){const n=new Le(e);for(const s of n.json.meshes||[])T7(s),n.addRequiredExtension(mr)}async function y7(e,t,n,s){const i=e.getObjectExtension(t,mr);if(!i)return;const r=e.getTypedArrayForBufferView(i.bufferView),a=Wv(r.buffer,r.byteOffset),l={...n};delete l["3d-tiles"];const h=await Xv(a,uC,l,s),d=f7(h.attributes);for(const[g,_]of Object.entries(d))if(g in t.attributes){const m=t.attributes[g],y=e.getAccessor(m);y!=null&&y.min&&(y!=null&&y.max)&&(_.min=y.min,_.max=y.max)}t.attributes=d,h.indices&&(t.indices=hC(h.indices)),e.removeObjectExtension(t,mr),E7(t)}function T7(e,t,n=4,s,i){var g;if(!s.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const r=s.DracoWriter.encodeSync({attributes:e}),a=(g=i==null?void 0:i.parseSync)==null?void 0:g.call(i,{attributes:e}),l=s._addFauxAttributes(a.attributes),h=s.addBufferView(r);return{primitives:[{attributes:l,mode:n,extensions:{[mr]:{bufferView:h,attributes:l}}}]}}function E7(e){if(!e.attributes&&Object.keys(e.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*fC(e){for(const t of e.json.meshes||[])for(const n of t.primitives)yield n}const b7=Object.freeze(Object.defineProperty({__proto__:null,decode:m7,encode:A7,name:p7,preprocess:_7},Symbol.toStringTag,{value:"Module"})),S7={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...S7}};const es=globalThis.mathgl.config;function R7(e,{precision:t=es.precision}={}){return e=v7(e),`${parseFloat(e.toPrecision(t))}`}function ad(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function dC(e,t,n){const s=es.EPSILON;try{if(e===t)return!0;if(ad(e)&&ad(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!dC(e[i],t[i]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<=es.EPSILON*Math.max(1,Math.abs(e),Math.abs(t)):!1}finally{es.EPSILON=s}}function v7(e){return Math.round(e/es.EPSILON)*es.EPSILON}let gC=class extends Array{clone(){return new this.constructor().copy(this)}fromArray(t,n=0){for(let s=0;s<this.ELEMENTS;++s)this[s]=t[s+n];return this.check()}toArray(t=[],n=0){for(let s=0;s<this.ELEMENTS;++s)t[n+s]=this[s];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:ad(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(es)}formatString(t){let n="";for(let s=0;s<this.ELEMENTS;++s)n+=(s>0?", ":"")+R7(this[s],t);return`${t.printTypes?this.constructor.name:""}[${n}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!dC(this[n],t[n]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==t[n])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,n,s){if(s===void 0)return this.lerp(this,t,n);for(let i=0;i<this.ELEMENTS;++i){const r=t[i],a=typeof n=="number"?n:n[i];this[i]=r+s*(a-r)}return this.check()}min(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(t[n],this[n]);return this.check()}max(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(t[n],this[n]);return this.check()}clamp(t,n){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t[s]),n[s]);return this.check()}add(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]+=n[s];return this.check()}subtract(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]-=n[s];return this.check()}scale(t){if(typeof t=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;else for(let n=0;n<this.ELEMENTS&&n<t.length;++n)this[n]*=t[n];return this.check()}multiplyByScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;return this.check()}check(){if(es.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)t=t&&Number.isFinite(this[n]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=t;return this.check()}addScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,n){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t),n);return this.check()}get elements(){return this}};function C7(e,t){if(e.length!==t)return!1;for(let n=0;n<e.length;++n)if(!Number.isFinite(e[n]))return!1;return!0}function Un(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function M7(e,t,n=""){if(es.debug&&!C7(e,t))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return e}function Q2(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}let w7=class extends gC{get x(){return this[0]}set x(t){this[0]=Un(t)}get y(){return this[1]}set y(t){this[1]=Un(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*this[n];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let n=0;for(let s=0;s<this.ELEMENTS;++s){const i=this[s]-t[s];n+=i*i}return Un(n)}dot(t){let n=0;for(let s=0;s<this.ELEMENTS;++s)n+=this[s]*t[s];return Un(n)}normalize(){const t=this.magnitude();if(t!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=t;return this.check()}multiply(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]*=n[s];return this.check()}divide(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]/=n[s];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return Q2(t>=0&&t<this.ELEMENTS,"index is out of range"),Un(this[t])}setComponent(t,n){return Q2(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=n,this.check()}addVectors(t,n){return this.copy(t).add(n)}subVectors(t,n){return this.copy(t).subtract(n)}multiplyVectors(t,n){return this.copy(t).multiply(n)}addScaledVector(t,n){return this.add(new this.constructor(t).multiplyScalar(n))}},cd=typeof Float32Array<"u"?Float32Array:Array;function O7(){const e=new cd(2);return cd!=Float32Array&&(e[0]=0,e[1]=0),e}function B7(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[3]*i+n[6],e[1]=n[1]*s+n[4]*i+n[7],e}(function(){const e=O7();return function(t,n,s,i,r,a){let l,h;for(n||(n=2),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],r(e,e,a),t[l]=e[0],t[l+1]=e[1];return t}})();function x7(e,t,n){const s=t[0],i=t[1],r=t[2],a=n[3]*s+n[7]*i+n[11]*r||1;return e[0]=(n[0]*s+n[4]*i+n[8]*r)/a,e[1]=(n[1]*s+n[5]*i+n[9]*r)/a,e[2]=(n[2]*s+n[6]*i+n[10]*r)/a,e}function N7(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[2]*i,e[1]=n[1]*s+n[3]*i,e[2]=t[2],e}function I7(e,t,n){const s=t[0],i=t[1],r=t[2];return e[0]=n[0]*s+n[3]*i+n[6]*r,e[1]=n[1]*s+n[4]*i+n[7]*r,e[2]=n[2]*s+n[5]*i+n[8]*r,e[3]=t[3],e}function D7(){const e=new cd(3);return cd!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function P7(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function F7(e,t,n){const s=t[0],i=t[1],r=t[2],a=n[0],l=n[1],h=n[2];return e[0]=i*h-r*l,e[1]=r*a-s*h,e[2]=s*l-i*a,e}function U7(e,t,n){const s=t[0],i=t[1],r=t[2];let a=n[3]*s+n[7]*i+n[11]*r+n[15];return a=a||1,e[0]=(n[0]*s+n[4]*i+n[8]*r+n[12])/a,e[1]=(n[1]*s+n[5]*i+n[9]*r+n[13])/a,e[2]=(n[2]*s+n[6]*i+n[10]*r+n[14])/a,e}function pC(e,t,n){const s=t[0],i=t[1],r=t[2];return e[0]=s*n[0]+i*n[3]+r*n[6],e[1]=s*n[1]+i*n[4]+r*n[7],e[2]=s*n[2]+i*n[5]+r*n[8],e}function L7(e,t,n){const s=n[0],i=n[1],r=n[2],a=n[3],l=t[0],h=t[1],d=t[2];let g=i*d-r*h,_=r*l-s*d,m=s*h-i*l,y=i*m-r*_,E=r*g-s*m,b=s*_-i*g;const R=a*2;return g*=R,_*=R,m*=R,y*=2,E*=2,b*=2,e[0]=l+g+y,e[1]=h+_+E,e[2]=d+m+b,e}function k7(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[0],r[1]=i[1]*Math.cos(s)-i[2]*Math.sin(s),r[2]=i[1]*Math.sin(s)+i[2]*Math.cos(s),e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function z7(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[2]*Math.sin(s)+i[0]*Math.cos(s),r[1]=i[1],r[2]=i[2]*Math.cos(s)-i[0]*Math.sin(s),e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function V7(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[0]*Math.cos(s)-i[1]*Math.sin(s),r[1]=i[0]*Math.sin(s)+i[1]*Math.cos(s),r[2]=i[2],e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function H7(e,t){const n=e[0],s=e[1],i=e[2],r=t[0],a=t[1],l=t[2],h=Math.sqrt((n*n+s*s+i*i)*(r*r+a*a+l*l)),d=h&&P7(e,t)/h;return Math.acos(Math.min(Math.max(d,-1),1))}(function(){const e=D7();return function(t,n,s,i,r,a){let l,h;for(n||(n=3),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],r(e,e,a),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2];return t}})();const W_=[0,0,0];let Wh,j7=class _C extends w7{static get ZERO(){return Wh||(Wh=new _C(0,0,0),Object.freeze(Wh)),Wh}constructor(t=0,n=0,s=0){super(-0,-0,-0),arguments.length===1&&ad(t)?this.copy(t):(es.debug&&(Un(t),Un(n),Un(s)),this[0]=t,this[1]=n,this[2]=s)}set(t,n,s){return this[0]=t,this[1]=n,this[2]=s,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return es.debug&&(Un(t.x),Un(t.y),Un(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=Un(t)}angle(t){return H7(this,t)}cross(t){return F7(this,this,t),this.check()}rotateX({radians:t,origin:n=W_}){return k7(this,this,n,t),this.check()}rotateY({radians:t,origin:n=W_}){return z7(this,this,n,t),this.check()}rotateZ({radians:t,origin:n=W_}){return V7(this,this,n,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return U7(this,this,t),this.check()}transformAsVector(t){return x7(this,this,t),this.check()}transformByMatrix3(t){return pC(this,this,t),this.check()}transformByMatrix2(t){return N7(this,this,t),this.check()}transformByQuaternion(t){return L7(this,this,t),this.check()}},$7=class extends gC{toString(){let t="[";if(es.printRowMajor){t+="row-major:";for(let n=0;n<this.RANK;++n)for(let s=0;s<this.RANK;++s)t+=` ${this[s*this.RANK+n]}`}else{t+="column-major:";for(let n=0;n<this.ELEMENTS;++n)t+=` ${this[n]}`}return t+="]",t}getElementIndex(t,n){return n*this.RANK+t}getElement(t,n){return this[n*this.RANK+t]}setElement(t,n,s){return this[n*this.RANK+t]=Un(s),this}getColumn(t,n=new Array(this.RANK).fill(-0)){const s=t*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[s+i];return n}setColumn(t,n){const s=t*this.RANK;for(let i=0;i<this.RANK;++i)this[s+i]=n[i];return this}};function X7(e,t){if(e===t){const n=t[1],s=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=s,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function G7(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=t[4],l=t[5],h=t[6],d=t[7],g=t[8],_=g*a-l*d,m=-g*r+l*h,y=d*r-a*h;let E=n*_+s*m+i*y;return E?(E=1/E,e[0]=_*E,e[1]=(-g*s+i*d)*E,e[2]=(l*s-i*a)*E,e[3]=m*E,e[4]=(g*n-i*h)*E,e[5]=(-l*n+i*r)*E,e[6]=y*E,e[7]=(-d*n+s*h)*E,e[8]=(a*n-s*r)*E,e):null}function W7(e){const t=e[0],n=e[1],s=e[2],i=e[3],r=e[4],a=e[5],l=e[6],h=e[7],d=e[8];return t*(d*r-a*h)+n*(-d*i+a*l)+s*(h*i-r*l)}function tS(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=t[4],h=t[5],d=t[6],g=t[7],_=t[8],m=n[0],y=n[1],E=n[2],b=n[3],R=n[4],M=n[5],N=n[6],O=n[7],x=n[8];return e[0]=m*s+y*a+E*d,e[1]=m*i+y*l+E*g,e[2]=m*r+y*h+E*_,e[3]=b*s+R*a+M*d,e[4]=b*i+R*l+M*g,e[5]=b*r+R*h+M*_,e[6]=N*s+O*a+x*d,e[7]=N*i+O*l+x*g,e[8]=N*r+O*h+x*_,e}function q7(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=t[4],h=t[5],d=t[6],g=t[7],_=t[8],m=n[0],y=n[1];return e[0]=s,e[1]=i,e[2]=r,e[3]=a,e[4]=l,e[5]=h,e[6]=m*s+y*a+d,e[7]=m*i+y*l+g,e[8]=m*r+y*h+_,e}function Y7(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=t[4],h=t[5],d=t[6],g=t[7],_=t[8],m=Math.sin(n),y=Math.cos(n);return e[0]=y*s+m*a,e[1]=y*i+m*l,e[2]=y*r+m*h,e[3]=y*a-m*s,e[4]=y*l-m*i,e[5]=y*h-m*r,e[6]=d,e[7]=g,e[8]=_,e}function eS(e,t,n){const s=n[0],i=n[1];return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function K7(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=n+n,l=s+s,h=i+i,d=n*a,g=s*a,_=s*l,m=i*a,y=i*l,E=i*h,b=r*a,R=r*l,M=r*h;return e[0]=1-_-E,e[3]=g-M,e[6]=m+R,e[1]=g+M,e[4]=1-d-E,e[7]=y-b,e[2]=m-R,e[5]=y+b,e[8]=1-d-_,e}var ym;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL1ROW0=3]="COL1ROW0",e[e.COL1ROW1=4]="COL1ROW1",e[e.COL1ROW2=5]="COL1ROW2",e[e.COL2ROW0=6]="COL2ROW0",e[e.COL2ROW1=7]="COL2ROW1",e[e.COL2ROW2=8]="COL2ROW2"})(ym||(ym={}));const J7=Object.freeze([1,0,0,0,1,0,0,0,1]);let au=class extends $7{static get IDENTITY(){return Q7()}static get ZERO(){return Z7()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return ym}constructor(t,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):n.length>0?this.copy([t,...n]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(J7)}fromObject(t){return this.check()}fromQuaternion(t){return K7(this,t),this.check()}set(t,n,s,i,r,a,l,h,d){return this[0]=t,this[1]=n,this[2]=s,this[3]=i,this[4]=r,this[5]=a,this[6]=l,this[7]=h,this[8]=d,this.check()}setRowMajor(t,n,s,i,r,a,l,h,d){return this[0]=t,this[1]=i,this[2]=l,this[3]=n,this[4]=r,this[5]=h,this[6]=s,this[7]=a,this[8]=d,this.check()}determinant(){return W7(this)}transpose(){return X7(this,this),this.check()}invert(){return G7(this,this),this.check()}multiplyLeft(t){return tS(this,t,this),this.check()}multiplyRight(t){return tS(this,this,t),this.check()}rotate(t){return Y7(this,this,t),this.check()}scale(t){return Array.isArray(t)?eS(this,this,t):eS(this,this,[t,t]),this.check()}translate(t){return q7(this,this,t),this.check()}transform(t,n){let s;switch(t.length){case 2:s=B7(n||[-0,-0],t,this);break;case 3:s=pC(n||[-0,-0,-0],t,this);break;case 4:s=I7(n||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return M7(s,t.length),s}transformVector(t,n){return this.transform(t,n)}transformVector2(t,n){return this.transform(t,n)}transformVector3(t,n){return this.transform(t,n)}},qh,Yh=null;function Z7(){return qh||(qh=new au([0,0,0,0,0,0,0,0,0]),Object.freeze(qh)),qh}function Q7(){return Yh||(Yh=new au,Object.freeze(Yh)),Yh}const Hd="KHR_texture_transform",tj=Hd,Kh=new j7,ej=new au,nj=new au;async function sj(e,t){var r;if(!new Le(e).hasExtension(Hd)||!((r=t.gltf)!=null&&r.loadBuffers))return;const i=e.json.materials||[];for(let a=0;a<i.length;a++)ij(a,e)}function ij(e,t){var r,a,l,h;const n=(r=t.json.materials)==null?void 0:r[e],s=[(a=n==null?void 0:n.pbrMetallicRoughness)==null?void 0:a.baseColorTexture,n==null?void 0:n.emissiveTexture,n==null?void 0:n.normalTexture,n==null?void 0:n.occlusionTexture,(l=n==null?void 0:n.pbrMetallicRoughness)==null?void 0:l.metallicRoughnessTexture],i=[];for(const d of s)d&&((h=d==null?void 0:d.extensions)!=null&&h[Hd])&&rj(t,e,d,i)}function rj(e,t,n,s){const i=oj(n,s);if(!i)return;const r=e.json.meshes||[];for(const a of r)for(const l of a.primitives){const h=l.material;Number.isFinite(h)&&t===h&&aj(e,l,i)}}function oj(e,t){var a;const n=(a=e.extensions)==null?void 0:a[Hd],{texCoord:s=0}=e,{texCoord:i=s}=n;if(!(t.findIndex(([l,h])=>l===s&&h===i)!==-1)){const l=uj(n);return s!==i&&(e.texCoord=i),t.push([s,i]),{originalTexCoord:s,texCoord:i,matrix:l}}return null}function aj(e,t,n){var l,h;const{originalTexCoord:s,texCoord:i,matrix:r}=n,a=t.attributes[`TEXCOORD_${s}`];if(Number.isFinite(a)){const d=(l=e.json.accessors)==null?void 0:l[a];if(d&&d.bufferView){const g=(h=e.json.bufferViews)==null?void 0:h[d.bufferView];if(g){const{arrayBuffer:_,byteOffset:m}=e.buffers[g.buffer],y=(m||0)+(d.byteOffset||0)+(g.byteOffset||0),{ArrayType:E,length:b}=f1(d,g),R=Zv[d.componentType],M=Jv[d.type],N=g.byteStride||R*M,O=new Float32Array(b);for(let x=0;x<d.count;x++){const I=new E(_,y+x*N,2);Kh.set(I[0],I[1],1),Kh.transformByMatrix3(r),O.set([Kh[0],Kh[1]],x*M)}s===i?cj(d,g,e.buffers,O):lj(i,d,t,e,O)}}}}function cj(e,t,n,s){e.componentType=5126,n.push({arrayBuffer:s.buffer,byteOffset:0,byteLength:s.buffer.byteLength}),t.buffer=n.length-1,t.byteLength=s.buffer.byteLength,t.byteOffset=0,delete t.byteStride}function lj(e,t,n,s,i){s.buffers.push({arrayBuffer:i.buffer,byteOffset:0,byteLength:i.buffer.byteLength});const r=s.json.bufferViews;if(!r)return;r.push({buffer:s.buffers.length-1,byteLength:i.buffer.byteLength,byteOffset:0});const a=s.json.accessors;a&&(a.push({bufferView:(r==null?void 0:r.length)-1,byteOffset:0,componentType:5126,count:t.count,type:"VEC2"}),n.attributes[`TEXCOORD_${e}`]=a.length-1)}function uj(e){const{offset:t=[0,0],rotation:n=0,scale:s=[1,1]}=e,i=new au().set(1,0,0,0,1,0,t[0],t[1],1),r=ej.set(Math.cos(n),Math.sin(n),0,-Math.sin(n),Math.cos(n),0,0,0,1),a=nj.set(s[0],0,0,0,s[1],0,0,0,1);return i.multiplyRight(r).multiplyRight(a)}const hj=Object.freeze(Object.defineProperty({__proto__:null,decode:sj,name:tj},Symbol.toStringTag,{value:"Module"})),Qr="KHR_lights_punctual",fj=Qr;async function dj(e){const t=new Le(e),{json:n}=t,s=t.getExtension(Qr);s&&(t.json.lights=s.lights,t.removeExtension(Qr));for(const i of n.nodes||[]){const r=t.getObjectExtension(i,Qr);r&&(i.light=r.light),t.removeObjectExtension(i,Qr)}}async function gj(e){const t=new Le(e),{json:n}=t;if(n.lights){const s=t.addExtension(Qr);zn(!s.lights),s.lights=n.lights,delete n.lights}if(t.json.lights){for(const s of t.json.lights){const i=s.node;t.addObjectExtension(i,Qr,s)}delete t.json.lights}}const pj=Object.freeze(Object.defineProperty({__proto__:null,decode:dj,encode:gj,name:fj},Symbol.toStringTag,{value:"Module"})),$l="KHR_materials_unlit",_j=$l;async function mj(e){const t=new Le(e),{json:n}=t;for(const s of n.materials||[])s.extensions&&s.extensions.KHR_materials_unlit&&(s.unlit=!0),t.removeObjectExtension(s,$l);t.removeExtension($l)}function Aj(e){const t=new Le(e),{json:n}=t;if(t.materials)for(const s of n.materials||[])s.unlit&&(delete s.unlit,t.addObjectExtension(s,$l,{}),t.addExtension($l))}const yj=Object.freeze(Object.defineProperty({__proto__:null,decode:mj,encode:Aj,name:_j},Symbol.toStringTag,{value:"Module"})),ml="KHR_techniques_webgl",Tj=ml;async function Ej(e){const t=new Le(e),{json:n}=t,s=t.getExtension(ml);if(s){const i=Sj(s,t);for(const r of n.materials||[]){const a=t.getObjectExtension(r,ml);a&&(r.technique=Object.assign({},a,i[a.technique]),r.technique.values=Rj(r.technique,t)),t.removeObjectExtension(r,ml)}t.removeExtension(ml)}}async function bj(e,t){}function Sj(e,t){const{programs:n=[],shaders:s=[],techniques:i=[]}=e,r=new TextDecoder;return s.forEach(a=>{if(Number.isFinite(a.bufferView))a.code=r.decode(t.getTypedArrayForBufferView(a.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),n.forEach(a=>{a.fragmentShader=s[a.fragmentShader],a.vertexShader=s[a.vertexShader]}),i.forEach(a=>{a.program=n[a.program]}),i}function Rj(e,t){const n=Object.assign({},e.values);return Object.keys(e.uniforms||{}).forEach(s=>{e.uniforms[s].value&&!(s in n)&&(n[s]=e.uniforms[s].value)}),Object.keys(n).forEach(s=>{typeof n[s]=="object"&&n[s].index!==void 0&&(n[s].texture=t.getTexture(n[s].index))}),n}const vj=Object.freeze(Object.defineProperty({__proto__:null,decode:Ej,encode:bj,name:Tj},Symbol.toStringTag,{value:"Module"})),mC=[VV,fV,xH,DH,UH,b7,pj,yj,vj,hj,iH];function Cj(e,t={},n){var i;const s=mC.filter(r=>AC(r.name,t));for(const r of s)(i=r.preprocess)==null||i.call(r,e,t,n)}async function Mj(e,t={},n){var i;const s=mC.filter(r=>AC(r.name,t));for(const r of s)await((i=r.decode)==null?void 0:i.call(r,e,t,n))}function AC(e,t){var i;const n=((i=t==null?void 0:t.gltf)==null?void 0:i.excludeExtensions)||{};return!(e in n&&!n[e])}const q_="KHR_binary_glTF";function wj(e){const t=new Le(e),{json:n}=t;for(const s of n.images||[]){const i=t.getObjectExtension(s,q_);i&&Object.assign(s,i),t.removeObjectExtension(s,q_)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,t.removeExtension(q_)}const nS={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},Oj={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class Bj{constructor(){T(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}});T(this,"json")}normalize(t,n){this.json=t.json;const s=t.json;switch(s.asset&&s.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn(`glTF: Unknown version ${s.asset.version}`);return}if(!n.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(s),this._convertTopLevelObjectsToArrays(s),wj(t),this._convertObjectIdsToArrayIndices(s),this._updateObjects(s),this._updateMaterial(s)}_addAsset(t){t.asset=t.asset||{},t.asset.version="2.0",t.asset.generator=t.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(t){for(const n in nS)this._convertTopLevelObjectToArray(t,n)}_convertTopLevelObjectToArray(t,n){const s=t[n];if(!(!s||Array.isArray(s))){t[n]=[];for(const i in s){const r=s[i];r.id=r.id||i;const a=t[n].length;t[n].push(r),this.idToIndexMap[n][i]=a}}}_convertObjectIdsToArrayIndices(t){for(const n in nS)this._convertIdsToIndices(t,n);"scene"in t&&(t.scene=this._convertIdToIndex(t.scene,"scene"));for(const n of t.textures)this._convertTextureIds(n);for(const n of t.meshes)this._convertMeshIds(n);for(const n of t.nodes)this._convertNodeIds(n);for(const n of t.scenes)this._convertSceneIds(n)}_convertTextureIds(t){t.source&&(t.source=this._convertIdToIndex(t.source,"image"))}_convertMeshIds(t){for(const n of t.primitives){const{attributes:s,indices:i,material:r}=n;for(const a in s)s[a]=this._convertIdToIndex(s[a],"accessor");i&&(n.indices=this._convertIdToIndex(i,"accessor")),r&&(n.material=this._convertIdToIndex(r,"material"))}}_convertNodeIds(t){t.children&&(t.children=t.children.map(n=>this._convertIdToIndex(n,"node"))),t.meshes&&(t.meshes=t.meshes.map(n=>this._convertIdToIndex(n,"mesh")))}_convertSceneIds(t){t.nodes&&(t.nodes=t.nodes.map(n=>this._convertIdToIndex(n,"node")))}_convertIdsToIndices(t,n){t[n]||(console.warn(`gltf v1: json doesn't contain attribute ${n}`),t[n]=[]);for(const s of t[n])for(const i in s){const r=s[i],a=this._convertIdToIndex(r,i);s[i]=a}}_convertIdToIndex(t,n){const s=Oj[n];if(s in this.idToIndexMap){const i=this.idToIndexMap[s][t];if(!Number.isFinite(i))throw new Error(`gltf v1: failed to resolve ${n} with id ${t}`);return i}return t}_updateObjects(t){for(const n of this.json.buffers)delete n.type}_updateMaterial(t){var n,s,i;for(const r of t.materials){r.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const a=((n=r.values)==null?void 0:n.tex)||((s=r.values)==null?void 0:s.texture2d_0)||((i=r.values)==null?void 0:i.diffuseTex),l=t.textures.findIndex(h=>h.id===a);l!==-1&&(r.pbrMetallicRoughness.baseColorTexture={index:l})}}}function xj(e,t={}){return new Bj().normalize(e,t)}async function Nj(e,t,n=0,s,i){var r,a,l;return Ij(e,t,n,s),xj(e,{normalize:(r=s==null?void 0:s.gltf)==null?void 0:r.normalize}),Cj(e,s,i),(a=s==null?void 0:s.gltf)!=null&&a.loadBuffers&&e.json.buffers&&await Dj(e,s,i),(l=s==null?void 0:s.gltf)!=null&&l.loadImages&&await Pj(e,s,i),await Mj(e,s,i),e}function Ij(e,t,n,s){if(s.uri&&(e.baseUri=s.uri),t instanceof ArrayBuffer&&!fH(t,n,s)&&(t=new TextDecoder().decode(t)),typeof t=="string")e.json=az(t);else if(t instanceof ArrayBuffer){const a={};n=dH(a,t,n,s.glb),zn(a.type==="glTF",`Invalid GLB magic string ${a.type}`),e._glb=a,e.json=a.json}else zn(!1,"GLTF: must be ArrayBuffer or string");const i=e.json.buffers||[];if(e.buffers=new Array(i.length).fill(null),e._glb&&e._glb.header.hasBinChunk){const{binChunks:a}=e._glb;e.buffers[0]={arrayBuffer:a[0].arrayBuffer,byteOffset:a[0].byteOffset,byteLength:a[0].byteLength}}const r=e.json.images||[];e.images=new Array(r.length).fill({})}async function Dj(e,t,n){var i,r;const s=e.json.buffers||[];for(let a=0;a<s.length;++a){const l=s[a];if(l.uri){const{fetch:h}=n;zn(h);const d=cC(l.uri,t),g=await((i=n==null?void 0:n.fetch)==null?void 0:i.call(n,d)),_=await((r=g==null?void 0:g.arrayBuffer)==null?void 0:r.call(g));e.buffers[a]={arrayBuffer:_,byteOffset:0,byteLength:_.byteLength},delete l.uri}else e.buffers[a]===null&&(e.buffers[a]={arrayBuffer:new ArrayBuffer(l.byteLength),byteOffset:0,byteLength:l.byteLength})}}async function Pj(e,t,n){const s=Fj(e),i=e.json.images||[],r=[];for(const a of s)r.push(Uj(e,i[a],a,t,n));return await Promise.all(r)}function Fj(e){const t=new Set,n=e.json.textures||[];for(const s of n)s.source!==void 0&&t.add(s.source);return Array.from(t).sort()}async function Uj(e,t,n,s,i){let r;if(t.uri&&!t.hasOwnProperty("bufferView")){const l=cC(t.uri,s),{fetch:h}=i;r=await(await h(l)).arrayBuffer(),t.bufferView={data:r}}if(Number.isFinite(t.bufferView)){const l=Jz(e.json,e.buffers,t.bufferView);r=Wv(l.buffer,l.byteOffset,l.byteLength)}zn(r,"glTF image has no data");let a=await Xv(r,[zz,V5],{...s,mimeType:t.mimeType,basis:s.basis||{format:$v()}},i);a&&a[0]&&(a={compressed:!0,mipmaps:!1,width:a[0].width,height:a[0].height,data:a[0]}),e.images=e.images||[],e.images[n]=a}const Xl={dataType:null,batchType:null,name:"glTF",id:"gltf",module:"gltf",version:rH,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:Lj,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0},log:console}};async function Lj(e,t={},n){t={...Xl.options,...t},t.gltf={...Xl.options.gltf,...t.gltf};const{byteOffset:s=0}=t;return await Nj({},e,s,t,n)}const kj={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},zj={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Kn={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},Vj={magFilter:Kn.TEXTURE_MAG_FILTER,minFilter:Kn.TEXTURE_MIN_FILTER,wrapS:Kn.TEXTURE_WRAP_S,wrapT:Kn.TEXTURE_WRAP_T},Hj={[Kn.TEXTURE_MAG_FILTER]:Kn.LINEAR,[Kn.TEXTURE_MIN_FILTER]:Kn.NEAREST_MIPMAP_LINEAR,[Kn.TEXTURE_WRAP_S]:Kn.REPEAT,[Kn.TEXTURE_WRAP_T]:Kn.REPEAT};function jj(){return{id:"default-sampler",parameters:Hj}}function $j(e){return zj[e]}function Xj(e){return kj[e]}class Gj{constructor(){T(this,"baseUri","");T(this,"jsonUnprocessed");T(this,"json");T(this,"buffers",[]);T(this,"images",[])}postProcess(t,n={}){const{json:s,buffers:i=[],images:r=[]}=t,{baseUri:a=""}=t;return zn(s),this.baseUri=a,this.buffers=i,this.images=r,this.jsonUnprocessed=s,this.json=this._resolveTree(t.json,n),this.json}_resolveTree(t,n={}){const s={...t};return this.json=s,t.bufferViews&&(s.bufferViews=t.bufferViews.map((i,r)=>this._resolveBufferView(i,r))),t.images&&(s.images=t.images.map((i,r)=>this._resolveImage(i,r))),t.samplers&&(s.samplers=t.samplers.map((i,r)=>this._resolveSampler(i,r))),t.textures&&(s.textures=t.textures.map((i,r)=>this._resolveTexture(i,r))),t.accessors&&(s.accessors=t.accessors.map((i,r)=>this._resolveAccessor(i,r))),t.materials&&(s.materials=t.materials.map((i,r)=>this._resolveMaterial(i,r))),t.meshes&&(s.meshes=t.meshes.map((i,r)=>this._resolveMesh(i,r))),t.nodes&&(s.nodes=t.nodes.map((i,r)=>this._resolveNode(i,r)),s.nodes=s.nodes.map((i,r)=>this._resolveNodeChildren(i))),t.skins&&(s.skins=t.skins.map((i,r)=>this._resolveSkin(i,r))),t.scenes&&(s.scenes=t.scenes.map((i,r)=>this._resolveScene(i,r))),typeof this.json.scene=="number"&&s.scenes&&(s.scene=s.scenes[this.json.scene]),s}getScene(t){return this._get(this.json.scenes,t)}getNode(t){return this._get(this.json.nodes,t)}getSkin(t){return this._get(this.json.skins,t)}getMesh(t){return this._get(this.json.meshes,t)}getMaterial(t){return this._get(this.json.materials,t)}getAccessor(t){return this._get(this.json.accessors,t)}getCamera(t){return this._get(this.json.cameras,t)}getTexture(t){return this._get(this.json.textures,t)}getSampler(t){return this._get(this.json.samplers,t)}getImage(t){return this._get(this.json.images,t)}getBufferView(t){return this._get(this.json.bufferViews,t)}getBuffer(t){return this._get(this.json.buffers,t)}_get(t,n){if(typeof n=="object")return n;const s=t&&t[n];return s||console.warn(`glTF file error: Could not find ${t}[${n}]`),s}_resolveScene(t,n){return{...t,id:t.id||`scene-${n}`,nodes:(t.nodes||[]).map(s=>this.getNode(s))}}_resolveNode(t,n){const s={...t,id:(t==null?void 0:t.id)||`node-${n}`};return t.mesh!==void 0&&(s.mesh=this.getMesh(t.mesh)),t.camera!==void 0&&(s.camera=this.getCamera(t.camera)),t.skin!==void 0&&(s.skin=this.getSkin(t.skin)),t.meshes!==void 0&&t.meshes.length&&(s.mesh=t.meshes.reduce((i,r)=>{const a=this.getMesh(r);return i.id=a.id,i.primitives=i.primitives.concat(a.primitives),i},{primitives:[]})),s}_resolveNodeChildren(t){return t.children&&(t.children=t.children.map(n=>this.getNode(n))),t}_resolveSkin(t,n){const s=typeof t.inverseBindMatrices=="number"?this.getAccessor(t.inverseBindMatrices):void 0;return{...t,id:t.id||`skin-${n}`,inverseBindMatrices:s}}_resolveMesh(t,n){const s={...t,id:t.id||`mesh-${n}`,primitives:[]};return t.primitives&&(s.primitives=t.primitives.map(i=>{const r={...i,attributes:{},indices:void 0,material:void 0},a=i.attributes;for(const l in a)r.attributes[l]=this.getAccessor(a[l]);return i.indices!==void 0&&(r.indices=this.getAccessor(i.indices)),i.material!==void 0&&(r.material=this.getMaterial(i.material)),r})),s}_resolveMaterial(t,n){const s={...t,id:t.id||`material-${n}`};if(s.normalTexture&&(s.normalTexture={...s.normalTexture},s.normalTexture.texture=this.getTexture(s.normalTexture.index)),s.occlusionTexture&&(s.occlusionTexture={...s.occlusionTexture},s.occlusionTexture.texture=this.getTexture(s.occlusionTexture.index)),s.emissiveTexture&&(s.emissiveTexture={...s.emissiveTexture},s.emissiveTexture.texture=this.getTexture(s.emissiveTexture.index)),s.emissiveFactor||(s.emissiveFactor=s.emissiveTexture?[1,1,1]:[0,0,0]),s.pbrMetallicRoughness){s.pbrMetallicRoughness={...s.pbrMetallicRoughness};const i=s.pbrMetallicRoughness;i.baseColorTexture&&(i.baseColorTexture={...i.baseColorTexture},i.baseColorTexture.texture=this.getTexture(i.baseColorTexture.index)),i.metallicRoughnessTexture&&(i.metallicRoughnessTexture={...i.metallicRoughnessTexture},i.metallicRoughnessTexture.texture=this.getTexture(i.metallicRoughnessTexture.index))}return s}_resolveAccessor(t,n){const s=$j(t.componentType),i=Xj(t.type),r=s*i,a={...t,id:t.id||`accessor-${n}`,bytesPerComponent:s,components:i,bytesPerElement:r,value:void 0,bufferView:void 0,sparse:void 0};if(t.bufferView!==void 0&&(a.bufferView=this.getBufferView(t.bufferView)),a.bufferView){const l=a.bufferView.buffer,{ArrayType:h,byteLength:d}=f1(a,a.bufferView),g=(a.bufferView.byteOffset||0)+(a.byteOffset||0)+l.byteOffset;let _=l.arrayBuffer.slice(g,g+d);a.bufferView.byteStride&&(_=this._getValueFromInterleavedBuffer(l,g,a.bufferView.byteStride,a.bytesPerElement,a.count)),a.value=new h(_)}return a}_getValueFromInterleavedBuffer(t,n,s,i,r){const a=new Uint8Array(r*i);for(let l=0;l<r;l++){const h=n+l*s;a.set(new Uint8Array(t.arrayBuffer.slice(h,h+i)),l*i)}return a.buffer}_resolveTexture(t,n){return{...t,id:t.id||`texture-${n}`,sampler:typeof t.sampler=="number"?this.getSampler(t.sampler):jj(),source:typeof t.source=="number"?this.getImage(t.source):void 0}}_resolveSampler(t,n){const s={id:t.id||`sampler-${n}`,...t,parameters:{}};for(const i in s){const r=this._enumSamplerParameter(i);r!==void 0&&(s.parameters[r]=s[i])}return s}_enumSamplerParameter(t){return Vj[t]}_resolveImage(t,n){const s={...t,id:t.id||`image-${n}`,image:null,bufferView:t.bufferView!==void 0?this.getBufferView(t.bufferView):void 0},i=this.images[n];return i&&(s.image=i),s}_resolveBufferView(t,n){const s=t.buffer,i=this.buffers[s].arrayBuffer;let r=this.buffers[s].byteOffset||0;return t.byteOffset&&(r+=t.byteOffset),{id:`bufferView-${n}`,...t,buffer:this.buffers[s],data:new Uint8Array(i,r,t.byteLength)}}_resolveCamera(t,n){const s={...t,id:t.id||`camera-${n}`};return s.perspective,s.orthographic,s}}function A1(e,t){return new Gj().postProcess(e,t)}async function Wj(e){const t=[];return e.scenes.forEach(n=>{n.traverse(s=>{Object.values(s.model.uniforms).forEach(i=>{i.loaded===!1&&t.push(i)})})}),await qj(()=>t.some(n=>!n.loaded))}async function qj(e){for(;e();)await new Promise(t=>requestAnimationFrame(t))}const Yj=`#version 300 es
#define SHADER_NAME scenegraph-layer-vertex-shader
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec3 instanceModelMatrixCol0;
in vec3 instanceModelMatrixCol1;
in vec3 instanceModelMatrixCol2;
in vec3 instanceTranslation;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform mat4 sceneModelMatrix;
uniform bool composeModelMatrix;
in vec3 positions;
#ifdef HAS_UV
in vec2 texCoords;
#endif
#ifdef MODULE_PBR
#ifdef HAS_NORMALS
in vec3 normals;
#endif
#endif
out vec4 vColor;
#ifndef MODULE_PBR
#ifdef HAS_UV
out vec2 vTEXCOORD_0;
#endif
#endif
void main(void) {
#if defined(HAS_UV) && !defined(MODULE_PBR)
vTEXCOORD_0 = texCoords;
geometry.uv = texCoords;
#endif
geometry.worldPosition = instancePositions;
geometry.pickingColor = instancePickingColors;
mat3 instanceModelMatrix = mat3(instanceModelMatrixCol0, instanceModelMatrixCol1, instanceModelMatrixCol2);
vec3 normal = vec3(0.0, 0.0, 1.0);
#ifdef MODULE_PBR
#ifdef HAS_NORMALS
normal = instanceModelMatrix * (sceneModelMatrix * vec4(normals, 0.0)).xyz;
#endif
#endif
float originalSize = project_size_to_pixel(sizeScale);
float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);
vec3 pos = (instanceModelMatrix * (sceneModelMatrix * vec4(positions, 1.0)).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;
if(composeModelMatrix) {
DECKGL_FILTER_SIZE(pos, geometry);
geometry.normal = project_normal(normal);
geometry.worldPosition += pos;
gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
}
else {
pos = project_size(pos);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);
geometry.normal = project_normal(normal);
}
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
#ifdef MODULE_PBR
pbr_vPosition = geometry.position.xyz;
#ifdef HAS_NORMALS
pbr_vNormal = geometry.normal;
#endif
#ifdef HAS_UV
pbr_vUV = texCoords;
#else
pbr_vUV = vec2(0., 0.);
#endif
geometry.uv = pbr_vUV;
#endif
vColor = instanceColors;
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Kj=`#version 300 es
#define SHADER_NAME scenegraph-layer-fragment-shader
uniform float opacity;
in vec4 vColor;
out vec4 fragColor;
#ifndef MODULE_PBR
#if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
in vec2 vTEXCOORD_0;
uniform sampler2D u_BaseColorSampler;
#endif
#endif
void main(void) {
#ifdef MODULE_PBR
fragColor = vColor * pbr_filterColor(vec4(0));
geometry.uv = pbr_vUV;
#else
#if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
fragColor = vColor * texture(u_BaseColorSampler, vTEXCOORD_0);
geometry.uv = vTEXCOORD_0;
#else
fragColor = vColor;
#endif
#endif
fragColor.a *= opacity;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,yC=[255,255,255,255],Jj={scenegraph:{type:"object",value:null,async:!0},getScene:e=>e&&e.scenes?typeof e.scene=="object"?e.scene:e.scenes[e.scene||0]:e,getAnimator:e=>e&&e.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:e=>e.position},getColor:{type:"accessor",value:yC},_lighting:"flat",_imageBasedLightingEnvironment:void 0,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[Xl]};class y1 extends tc{getShaders(){const t=[Ym,Zm];return this.props._lighting==="pbr"&&t.push(Wm),super.getShaders({vs:Yj,fs:Kj,modules:t})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:"unorm8",size:this.props.colorFormat.length,accessor:"getColor",defaultValue:yC,transition:!0},instanceModelMatrix:zv})}updateState(t){super.updateState(t);const{props:n,oldProps:s}=t;n.scenegraph!==s.scenegraph?this._updateScenegraph():n._animations!==s._animations&&this._applyAnimationsProp(this.state.animator,n._animations)}finalizeState(t){var n;super.finalizeState(t),(n=this.state.scenegraph)==null||n.destroy()}get isLoaded(){var t;return!!((t=this.state)!=null&&t.scenegraph&&super.isLoaded)}_updateScenegraph(){var l;const t=this.props,{device:n}=this.context;let s=null;if(t.scenegraph instanceof Zf)s={scenes:[t.scenegraph]};else if(t.scenegraph&&typeof t.scenegraph=="object"){const h=t.scenegraph,d=h.json?A1(h):h,g=iz(n,d,this._getModelOptions());s={gltf:d,...g},Wj(g).then(()=>{this.setNeedsRedraw()}).catch(_=>{this.raiseError(_,"loading glTF")})}const i={layer:this,device:this.context.device},r=t.getScene(s,i),a=t.getAnimator(s,i);if(r instanceof Ia){(l=this.state.scenegraph)==null||l.destroy(),this._applyAnimationsProp(a,t._animations);const h=[];r.traverse(d=>{d instanceof K0&&h.push(d.model)}),this.setState({scenegraph:r,animator:a,models:h}),this.getAttributeManager().invalidateAll()}else r!==null&&kt.warn("invalid scenegraph:",r)()}_applyAnimationsProp(t,n){if(!t||!n)return;const s=t.getAnimations();Object.keys(n).sort().forEach(i=>{const r=n[i];if(i==="*")s.forEach(a=>{Object.assign(a,r)});else if(Number.isFinite(Number(i))){const a=Number(i);a>=0&&a<s.length?Object.assign(s[a],r):kt.warn(`animation ${i} not found`)()}else{const a=s.find(({name:l})=>l===i);a?Object.assign(a,r):kt.warn(`animation ${i} not found`)()}})}_getModelOptions(){const{_imageBasedLightingEnvironment:t}=this.props;let n;return t&&(typeof t=="function"?n=t({gl:this.context.gl,layer:this}):n=t),{imageBasedLightingEnvironment:n,modelOptions:{id:this.props.id,isInstanced:!0,bufferLayout:this.getAttributeManager().getBufferLayouts(),...this.getShaders()},useTangents:!1}}draw({context:t}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(t.timeline.getTime()),this.setNeedsRedraw());const{viewport:n,renderPass:s}=this.context,{sizeScale:i,sizeMinPixels:r,sizeMaxPixels:a,opacity:l,coordinateSystem:h}=this.props,d=this.getNumInstances();this.state.scenegraph.traverse((g,{worldMatrix:_})=>{if(g instanceof K0){const{model:m}=g;m.setInstanceCount(d),m.setUniforms({sizeScale:i,opacity:l,sizeMinPixels:r,sizeMaxPixels:a,composeModelMatrix:Vv(n,h),sceneModelMatrix:_,u_Camera:m.uniforms.project_uCameraPosition}),m.draw(s)}})}}y1.defaultProps=Jj;y1.layerName="ScenegraphLayer";const Zj=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
uniform bool pickFeatureIds;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec4 uvRegions;
in vec3 featureIdsPickingColors;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec3 instanceModelMatrixCol0;
in vec3 instanceModelMatrixCol1;
in vec3 instanceModelMatrixCol2;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;
vec2 applyUVRegion(vec2 uv) {
#ifdef HAS_UV_REGIONS
return fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;
#else
return uv;
#endif
}
void main(void) {
vec2 uv = applyUVRegion(texCoords);
geometry.uv = uv;
if (pickFeatureIds) {
geometry.pickingColor = featureIdsPickingColors;
} else {
geometry.pickingColor = instancePickingColors;
}
mat3 instanceModelMatrix = mat3(instanceModelMatrixCol0, instanceModelMatrixCol1, instanceModelMatrixCol2);
vTexCoord = uv;
cameraPosition = project_uCameraPosition;
vColor = vec4(colors * instanceColors.rgb, instanceColors.a);
vec3 pos = (instanceModelMatrix * positions) * sizeScale;
vec3 projectedPosition = project_position(positions);
position_commonspace = vec4(projectedPosition, 1.0);
gl_Position = project_common_position_to_clipspace(position_commonspace);
geometry.position = position_commonspace;
normals_commonspace = project_normal(instanceModelMatrix * normals);
geometry.normal = normals_commonspace;
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
#ifdef MODULE_PBR
pbr_vPosition = geometry.position.xyz;
#ifdef HAS_NORMALS
pbr_vNormal = geometry.normal;
#endif
#ifdef HAS_UV
pbr_vUV = uv;
#else
pbr_vUV = vec2(0., 0.);
#endif
geometry.uv = pbr_vUV;
#endif
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Qj=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs
precision highp float;
uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;
in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
#ifdef MODULE_PBR
fragColor = vColor * pbr_filterColor(vec4(0));
geometry.uv = pbr_vUV;
fragColor.a *= opacity;
#else
geometry.uv = vTexCoord;
vec3 normal;
if (flatShading) {
normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
} else {
normal = normals_commonspace;
}
vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
fragColor = vec4(lightColor, color.a * opacity);
#endif
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function t$(e){const t=e.positions||e.POSITION,n=t.value.length/t.size;e.COLOR_0||e.colors||(e.colors={size:4,value:new Uint8Array(n*4).fill(255),normalized:!0})}const e$={pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}};class T1 extends c1{getShaders(){const t=super.getShaders();return t.modules.push(Wm),{...t,vs:Zj,fs:Qj}}initializeState(){const{featureIds:t}=this.props;super.initializeState();const n=this.getAttributeManager();t&&n.add({featureIdsPickingColors:{type:"uint8",size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}updateState(t){super.updateState(t);const{props:n,oldProps:s}=t;n.pbrMaterial!==s.pbrMaterial&&this.updatePbrMaterialUniforms(n.pbrMaterial)}draw(t){const{featureIds:n}=this.props;this.state.model&&(this.state.model.setUniforms({u_Camera:this.state.model.uniforms.project_uCameraPosition,pickFeatureIds:!!n}),super.draw(t))}getModel(t){const{id:n,pbrMaterial:s}=this.props,i=this.parseMaterial(s,t);this.setState({parsedPBRMaterial:i});const r=this.getShaders();return t$(t.attributes),new pr(this.context.device,{...this.getShaders(),id:n,geometry:t,bufferLayout:this.getAttributeManager().getBufferLayouts(),defines:{...r.defines,...i==null?void 0:i.defines,HAS_UV_REGIONS:t.attributes.uvRegions?1:0},parameters:i==null?void 0:i.parameters,isInstanced:!0})}updatePbrMaterialUniforms(t){const{model:n}=this.state;if(n){const{mesh:s}=this.props,i=this.parseMaterial(t,s);this.setState({parsedPBRMaterial:i}),n.setBindings(i.bindings),n.setUniforms(i.uniforms)}}parseMaterial(t,n){const s=!!(t.pbrMetallicRoughness&&t.pbrMetallicRoughness.baseColorTexture);return Hv(this.context.device,{unlit:s,...t},{NORMAL:n.attributes.normals,TEXCOORD_0:n.attributes.texCoords},{pbrDebug:!1,lights:!0,useTangents:!1})}calculateFeatureIdsPickingColors(t){const n=this.props.featureIds,s=new Uint8ClampedArray(n.length*t.size),i=[];for(let r=0;r<n.length;r++)this.encodePickingColor(n[r],i),s[r*3]=i[0],s[r*3+1]=i[1],s[r*3+2]=i[2];t.value=s}finalizeState(t){var n;super.finalizeState(t),(n=this.state.parsedPBRMaterial)==null||n.generatedTextures.forEach(s=>s.destroy()),this.setState({parsedPBRMaterial:null})}}T1.layerName="MeshLayer";T1.defaultProps=e$;const n$=1/Math.PI*180,s$={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...s$}};const bn=globalThis.mathgl.config;function i$(e,{precision:t=bn.precision}={}){return e=r$(e),`${parseFloat(e.toPrecision(t))}`}function Xa(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Fs(e,t){return a$(e,n=>n*n$,t)}function TC(e,t,n){const s=bn.EPSILON;try{if(e===t)return!0;if(Xa(e)&&Xa(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!TC(e[i],t[i]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<=bn.EPSILON*Math.max(1,Math.abs(e),Math.abs(t)):!1}finally{bn.EPSILON=s}}function r$(e){return Math.round(e/bn.EPSILON)*bn.EPSILON}function o$(e){return e.clone?e.clone():new Array(e.length)}function a$(e,t,n){if(Xa(e)){const s=e;n=n||o$(s);for(let i=0;i<n.length&&i<s.length;++i){const r=typeof e=="number"?e:e[i];n[i]=t(r,i,n)}return n}return t(e)}let E1=class extends Array{clone(){return new this.constructor().copy(this)}fromArray(t,n=0){for(let s=0;s<this.ELEMENTS;++s)this[s]=t[s+n];return this.check()}toArray(t=[],n=0){for(let s=0;s<this.ELEMENTS;++s)t[n+s]=this[s];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:Xa(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(bn)}formatString(t){let n="";for(let s=0;s<this.ELEMENTS;++s)n+=(s>0?", ":"")+i$(this[s],t);return`${t.printTypes?this.constructor.name:""}[${n}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!TC(this[n],t[n]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==t[n])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,n,s){if(s===void 0)return this.lerp(this,t,n);for(let i=0;i<this.ELEMENTS;++i){const r=t[i],a=typeof n=="number"?n:n[i];this[i]=r+s*(a-r)}return this.check()}min(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(t[n],this[n]);return this.check()}max(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(t[n],this[n]);return this.check()}clamp(t,n){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t[s]),n[s]);return this.check()}add(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]+=n[s];return this.check()}subtract(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]-=n[s];return this.check()}scale(t){if(typeof t=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;else for(let n=0;n<this.ELEMENTS&&n<t.length;++n)this[n]*=t[n];return this.check()}multiplyByScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;return this.check()}check(){if(bn.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)t=t&&Number.isFinite(this[n]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=t;return this.check()}addScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,n){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t),n);return this.check()}get elements(){return this}};function c$(e,t){if(e.length!==t)return!1;for(let n=0;n<e.length;++n)if(!Number.isFinite(e[n]))return!1;return!0}function se(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function wl(e,t,n=""){if(bn.debug&&!c$(e,t))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return e}function sS(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}let EC=class extends E1{get x(){return this[0]}set x(t){this[0]=se(t)}get y(){return this[1]}set y(t){this[1]=se(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*this[n];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let n=0;for(let s=0;s<this.ELEMENTS;++s){const i=this[s]-t[s];n+=i*i}return se(n)}dot(t){let n=0;for(let s=0;s<this.ELEMENTS;++s)n+=this[s]*t[s];return se(n)}normalize(){const t=this.magnitude();if(t!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=t;return this.check()}multiply(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]*=n[s];return this.check()}divide(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]/=n[s];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return sS(t>=0&&t<this.ELEMENTS,"index is out of range"),se(this[t])}setComponent(t,n){return sS(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=n,this.check()}addVectors(t,n){return this.copy(t).add(n)}subVectors(t,n){return this.copy(t).subtract(n)}multiplyVectors(t,n){return this.copy(t).multiply(n)}addScaledVector(t,n){return this.add(new this.constructor(t).multiplyScalar(n))}};const Ol=1e-6;let ms=typeof Float32Array<"u"?Float32Array:Array;function l$(){const e=new ms(2);return ms!=Float32Array&&(e[0]=0,e[1]=0),e}function u$(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[3]*i+n[6],e[1]=n[1]*s+n[4]*i+n[7],e}function h$(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[4]*i+n[12],e[1]=n[1]*s+n[5]*i+n[13],e}(function(){const e=l$();return function(t,n,s,i,r,a){let l,h;for(n||(n=2),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],r(e,e,a),t[l]=e[0],t[l+1]=e[1];return t}})();function f$(e,t,n){const s=t[0],i=t[1],r=n[3]*s+n[7]*i||1;return e[0]=(n[0]*s+n[4]*i)/r,e[1]=(n[1]*s+n[5]*i)/r,e}function bC(e,t,n){const s=t[0],i=t[1],r=t[2],a=n[3]*s+n[7]*i+n[11]*r||1;return e[0]=(n[0]*s+n[4]*i+n[8]*r)/a,e[1]=(n[1]*s+n[5]*i+n[9]*r)/a,e[2]=(n[2]*s+n[6]*i+n[10]*r)/a,e}function d$(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[2]*i,e[1]=n[1]*s+n[3]*i,e[2]=t[2],e}function g$(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[2]*i,e[1]=n[1]*s+n[3]*i,e[2]=t[2],e[3]=t[3],e}function SC(e,t,n){const s=t[0],i=t[1],r=t[2];return e[0]=n[0]*s+n[3]*i+n[6]*r,e[1]=n[1]*s+n[4]*i+n[7]*r,e[2]=n[2]*s+n[5]*i+n[8]*r,e[3]=t[3],e}function RC(){const e=new ms(3);return ms!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function p$(e){const t=e[0],n=e[1],s=e[2];return Math.sqrt(t*t+n*n+s*s)}function iS(e,t,n){const s=new ms(3);return s[0]=e,s[1]=t,s[2]=n,s}function _$(e,t){const n=t[0],s=t[1],i=t[2];let r=n*n+s*s+i*i;return r>0&&(r=1/Math.sqrt(r)),e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function vC(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Of(e,t,n){const s=t[0],i=t[1],r=t[2],a=n[0],l=n[1],h=n[2];return e[0]=i*h-r*l,e[1]=r*a-s*h,e[2]=s*l-i*a,e}function b1(e,t,n){const s=t[0],i=t[1],r=t[2];let a=n[3]*s+n[7]*i+n[11]*r+n[15];return a=a||1,e[0]=(n[0]*s+n[4]*i+n[8]*r+n[12])/a,e[1]=(n[1]*s+n[5]*i+n[9]*r+n[13])/a,e[2]=(n[2]*s+n[6]*i+n[10]*r+n[14])/a,e}function CC(e,t,n){const s=t[0],i=t[1],r=t[2];return e[0]=s*n[0]+i*n[3]+r*n[6],e[1]=s*n[1]+i*n[4]+r*n[7],e[2]=s*n[2]+i*n[5]+r*n[8],e}function MC(e,t,n){const s=n[0],i=n[1],r=n[2],a=n[3],l=t[0],h=t[1],d=t[2];let g=i*d-r*h,_=r*l-s*d,m=s*h-i*l,y=i*m-r*_,E=r*g-s*m,b=s*_-i*g;const R=a*2;return g*=R,_*=R,m*=R,y*=2,E*=2,b*=2,e[0]=l+g+y,e[1]=h+_+E,e[2]=d+m+b,e}function m$(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[0],r[1]=i[1]*Math.cos(s)-i[2]*Math.sin(s),r[2]=i[1]*Math.sin(s)+i[2]*Math.cos(s),e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function A$(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[2]*Math.sin(s)+i[0]*Math.cos(s),r[1]=i[1],r[2]=i[2]*Math.cos(s)-i[0]*Math.sin(s),e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function y$(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[0]*Math.cos(s)-i[1]*Math.sin(s),r[1]=i[0]*Math.sin(s)+i[1]*Math.cos(s),r[2]=i[2],e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function T$(e,t){const n=e[0],s=e[1],i=e[2],r=t[0],a=t[1],l=t[2],h=Math.sqrt((n*n+s*s+i*i)*(r*r+a*a+l*l)),d=h&&vC(e,t)/h;return Math.acos(Math.min(Math.max(d,-1),1))}const E$=p$;(function(){const e=RC();return function(t,n,s,i,r,a){let l,h;for(n||(n=3),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],r(e,e,a),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2];return t}})();const Y_=[0,0,0];let Jh,bt=class wC extends EC{static get ZERO(){return Jh||(Jh=new wC(0,0,0),Object.freeze(Jh)),Jh}constructor(t=0,n=0,s=0){super(-0,-0,-0),arguments.length===1&&Xa(t)?this.copy(t):(bn.debug&&(se(t),se(n),se(s)),this[0]=t,this[1]=n,this[2]=s)}set(t,n,s){return this[0]=t,this[1]=n,this[2]=s,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return bn.debug&&(se(t.x),se(t.y),se(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=se(t)}angle(t){return T$(this,t)}cross(t){return Of(this,this,t),this.check()}rotateX({radians:t,origin:n=Y_}){return m$(this,this,n,t),this.check()}rotateY({radians:t,origin:n=Y_}){return A$(this,this,n,t),this.check()}rotateZ({radians:t,origin:n=Y_}){return y$(this,this,n,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return b1(this,this,t),this.check()}transformAsVector(t){return bC(this,this,t),this.check()}transformByMatrix3(t){return CC(this,this,t),this.check()}transformByMatrix2(t){return d$(this,this,t),this.check()}transformByQuaternion(t){return MC(this,this,t),this.check()}},Zh,b$=class OC extends EC{static get ZERO(){return Zh||(Zh=new OC(0,0,0,0),Object.freeze(Zh)),Zh}constructor(t=0,n=0,s=0,i=0){super(-0,-0,-0,-0),Xa(t)&&arguments.length===1?this.copy(t):(bn.debug&&(se(t),se(n),se(s),se(i)),this[0]=t,this[1]=n,this[2]=s,this[3]=i)}set(t,n,s,i){return this[0]=t,this[1]=n,this[2]=s,this[3]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return bn.debug&&(se(t.x),se(t.y),se(t.z),se(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=se(t)}get w(){return this[3]}set w(t){this[3]=se(t)}transform(t){return b1(this,this,t),this.check()}transformByMatrix3(t){return SC(this,this,t),this.check()}transformByMatrix2(t){return g$(this,this,t),this.check()}transformByQuaternion(t){return MC(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}},BC=class extends E1{toString(){let t="[";if(bn.printRowMajor){t+="row-major:";for(let n=0;n<this.RANK;++n)for(let s=0;s<this.RANK;++s)t+=` ${this[s*this.RANK+n]}`}else{t+="column-major:";for(let n=0;n<this.ELEMENTS;++n)t+=` ${this[n]}`}return t+="]",t}getElementIndex(t,n){return n*this.RANK+t}getElement(t,n){return this[n*this.RANK+t]}setElement(t,n,s){return this[n*this.RANK+t]=se(s),this}getColumn(t,n=new Array(this.RANK).fill(-0)){const s=t*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[s+i];return n}setColumn(t,n){const s=t*this.RANK;for(let i=0;i<this.RANK;++i)this[s+i]=n[i];return this}};function S$(){const e=new ms(9);return ms!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function R$(e,t){if(e===t){const n=t[1],s=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=s,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function v$(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=t[4],l=t[5],h=t[6],d=t[7],g=t[8],_=g*a-l*d,m=-g*r+l*h,y=d*r-a*h;let E=n*_+s*m+i*y;return E?(E=1/E,e[0]=_*E,e[1]=(-g*s+i*d)*E,e[2]=(l*s-i*a)*E,e[3]=m*E,e[4]=(g*n-i*h)*E,e[5]=(-l*n+i*r)*E,e[6]=y*E,e[7]=(-d*n+s*h)*E,e[8]=(a*n-s*r)*E,e):null}function C$(e){const t=e[0],n=e[1],s=e[2],i=e[3],r=e[4],a=e[5],l=e[6],h=e[7],d=e[8];return t*(d*r-a*h)+n*(-d*i+a*l)+s*(h*i-r*l)}function rS(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=t[4],h=t[5],d=t[6],g=t[7],_=t[8],m=n[0],y=n[1],E=n[2],b=n[3],R=n[4],M=n[5],N=n[6],O=n[7],x=n[8];return e[0]=m*s+y*a+E*d,e[1]=m*i+y*l+E*g,e[2]=m*r+y*h+E*_,e[3]=b*s+R*a+M*d,e[4]=b*i+R*l+M*g,e[5]=b*r+R*h+M*_,e[6]=N*s+O*a+x*d,e[7]=N*i+O*l+x*g,e[8]=N*r+O*h+x*_,e}function M$(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=t[4],h=t[5],d=t[6],g=t[7],_=t[8],m=n[0],y=n[1];return e[0]=s,e[1]=i,e[2]=r,e[3]=a,e[4]=l,e[5]=h,e[6]=m*s+y*a+d,e[7]=m*i+y*l+g,e[8]=m*r+y*h+_,e}function w$(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=t[4],h=t[5],d=t[6],g=t[7],_=t[8],m=Math.sin(n),y=Math.cos(n);return e[0]=y*s+m*a,e[1]=y*i+m*l,e[2]=y*r+m*h,e[3]=y*a-m*s,e[4]=y*l-m*i,e[5]=y*h-m*r,e[6]=d,e[7]=g,e[8]=_,e}function oS(e,t,n){const s=n[0],i=n[1];return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function O$(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=n+n,l=s+s,h=i+i,d=n*a,g=s*a,_=s*l,m=i*a,y=i*l,E=i*h,b=r*a,R=r*l,M=r*h;return e[0]=1-_-E,e[3]=g-M,e[6]=m+R,e[1]=g+M,e[4]=1-d-E,e[7]=y-b,e[2]=m-R,e[5]=y+b,e[8]=1-d-_,e}var Tm;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL1ROW0=3]="COL1ROW0",e[e.COL1ROW1=4]="COL1ROW1",e[e.COL1ROW2=5]="COL1ROW2",e[e.COL2ROW0=6]="COL2ROW0",e[e.COL2ROW1=7]="COL2ROW1",e[e.COL2ROW2=8]="COL2ROW2"})(Tm||(Tm={}));const B$=Object.freeze([1,0,0,0,1,0,0,0,1]);let S1=class extends BC{static get IDENTITY(){return N$()}static get ZERO(){return x$()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return Tm}constructor(t,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):n.length>0?this.copy([t,...n]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(B$)}fromObject(t){return this.check()}fromQuaternion(t){return O$(this,t),this.check()}set(t,n,s,i,r,a,l,h,d){return this[0]=t,this[1]=n,this[2]=s,this[3]=i,this[4]=r,this[5]=a,this[6]=l,this[7]=h,this[8]=d,this.check()}setRowMajor(t,n,s,i,r,a,l,h,d){return this[0]=t,this[1]=i,this[2]=l,this[3]=n,this[4]=r,this[5]=h,this[6]=s,this[7]=a,this[8]=d,this.check()}determinant(){return C$(this)}transpose(){return R$(this,this),this.check()}invert(){return v$(this,this),this.check()}multiplyLeft(t){return rS(this,t,this),this.check()}multiplyRight(t){return rS(this,this,t),this.check()}rotate(t){return w$(this,this,t),this.check()}scale(t){return Array.isArray(t)?oS(this,this,t):oS(this,this,[t,t]),this.check()}translate(t){return M$(this,this,t),this.check()}transform(t,n){let s;switch(t.length){case 2:s=u$(n||[-0,-0],t,this);break;case 3:s=CC(n||[-0,-0,-0],t,this);break;case 4:s=SC(n||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return wl(s,t.length),s}transformVector(t,n){return this.transform(t,n)}transformVector2(t,n){return this.transform(t,n)}transformVector3(t,n){return this.transform(t,n)}},Qh,tf=null;function x$(){return Qh||(Qh=new S1([0,0,0,0,0,0,0,0,0]),Object.freeze(Qh)),Qh}function N$(){return tf||(tf=new S1,Object.freeze(tf)),tf}function I$(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function D$(e,t){if(e===t){const n=t[1],s=t[2],i=t[3],r=t[6],a=t[7],l=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=s,e[9]=r,e[11]=t[14],e[12]=i,e[13]=a,e[14]=l}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function P$(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=t[4],l=t[5],h=t[6],d=t[7],g=t[8],_=t[9],m=t[10],y=t[11],E=t[12],b=t[13],R=t[14],M=t[15],N=n*l-s*a,O=n*h-i*a,x=n*d-r*a,I=s*h-i*l,P=s*d-r*l,J=i*d-r*h,et=g*b-_*E,q=g*R-m*E,Q=g*M-y*E,rt=_*R-m*b,ct=_*M-y*b,ft=m*M-y*R;let Y=N*ft-O*ct+x*rt+I*Q-P*q+J*et;return Y?(Y=1/Y,e[0]=(l*ft-h*ct+d*rt)*Y,e[1]=(i*ct-s*ft-r*rt)*Y,e[2]=(b*J-R*P+M*I)*Y,e[3]=(m*P-_*J-y*I)*Y,e[4]=(h*Q-a*ft-d*q)*Y,e[5]=(n*ft-i*Q+r*q)*Y,e[6]=(R*x-E*J-M*O)*Y,e[7]=(g*J-m*x+y*O)*Y,e[8]=(a*ct-l*Q+d*et)*Y,e[9]=(s*Q-n*ct-r*et)*Y,e[10]=(E*P-b*x+M*N)*Y,e[11]=(_*x-g*P-y*N)*Y,e[12]=(l*q-a*rt-h*et)*Y,e[13]=(n*rt-s*q+i*et)*Y,e[14]=(b*O-E*I-R*N)*Y,e[15]=(g*I-_*O+m*N)*Y,e):null}function F$(e){const t=e[0],n=e[1],s=e[2],i=e[3],r=e[4],a=e[5],l=e[6],h=e[7],d=e[8],g=e[9],_=e[10],m=e[11],y=e[12],E=e[13],b=e[14],R=e[15],M=t*a-n*r,N=t*l-s*r,O=n*l-s*a,x=d*E-g*y,I=d*b-_*y,P=g*b-_*E,J=t*P-n*I+s*x,et=r*P-a*I+l*x,q=d*O-g*N+_*M,Q=y*O-E*N+b*M;return h*J-i*et+R*q-m*Q}function aS(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=t[4],h=t[5],d=t[6],g=t[7],_=t[8],m=t[9],y=t[10],E=t[11],b=t[12],R=t[13],M=t[14],N=t[15];let O=n[0],x=n[1],I=n[2],P=n[3];return e[0]=O*s+x*l+I*_+P*b,e[1]=O*i+x*h+I*m+P*R,e[2]=O*r+x*d+I*y+P*M,e[3]=O*a+x*g+I*E+P*N,O=n[4],x=n[5],I=n[6],P=n[7],e[4]=O*s+x*l+I*_+P*b,e[5]=O*i+x*h+I*m+P*R,e[6]=O*r+x*d+I*y+P*M,e[7]=O*a+x*g+I*E+P*N,O=n[8],x=n[9],I=n[10],P=n[11],e[8]=O*s+x*l+I*_+P*b,e[9]=O*i+x*h+I*m+P*R,e[10]=O*r+x*d+I*y+P*M,e[11]=O*a+x*g+I*E+P*N,O=n[12],x=n[13],I=n[14],P=n[15],e[12]=O*s+x*l+I*_+P*b,e[13]=O*i+x*h+I*m+P*R,e[14]=O*r+x*d+I*y+P*M,e[15]=O*a+x*g+I*E+P*N,e}function U$(e,t,n){const s=n[0],i=n[1],r=n[2];let a,l,h,d,g,_,m,y,E,b,R,M;return t===e?(e[12]=t[0]*s+t[4]*i+t[8]*r+t[12],e[13]=t[1]*s+t[5]*i+t[9]*r+t[13],e[14]=t[2]*s+t[6]*i+t[10]*r+t[14],e[15]=t[3]*s+t[7]*i+t[11]*r+t[15]):(a=t[0],l=t[1],h=t[2],d=t[3],g=t[4],_=t[5],m=t[6],y=t[7],E=t[8],b=t[9],R=t[10],M=t[11],e[0]=a,e[1]=l,e[2]=h,e[3]=d,e[4]=g,e[5]=_,e[6]=m,e[7]=y,e[8]=E,e[9]=b,e[10]=R,e[11]=M,e[12]=a*s+g*i+E*r+t[12],e[13]=l*s+_*i+b*r+t[13],e[14]=h*s+m*i+R*r+t[14],e[15]=d*s+y*i+M*r+t[15]),e}function L$(e,t,n){const s=n[0],i=n[1],r=n[2];return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function k$(e,t,n,s){let i=s[0],r=s[1],a=s[2],l=Math.sqrt(i*i+r*r+a*a),h,d,g,_,m,y,E,b,R,M,N,O,x,I,P,J,et,q,Q,rt,ct,ft,Y,Tt;return l<Ol?null:(l=1/l,i*=l,r*=l,a*=l,d=Math.sin(n),h=Math.cos(n),g=1-h,_=t[0],m=t[1],y=t[2],E=t[3],b=t[4],R=t[5],M=t[6],N=t[7],O=t[8],x=t[9],I=t[10],P=t[11],J=i*i*g+h,et=r*i*g+a*d,q=a*i*g-r*d,Q=i*r*g-a*d,rt=r*r*g+h,ct=a*r*g+i*d,ft=i*a*g+r*d,Y=r*a*g-i*d,Tt=a*a*g+h,e[0]=_*J+b*et+O*q,e[1]=m*J+R*et+x*q,e[2]=y*J+M*et+I*q,e[3]=E*J+N*et+P*q,e[4]=_*Q+b*rt+O*ct,e[5]=m*Q+R*rt+x*ct,e[6]=y*Q+M*rt+I*ct,e[7]=E*Q+N*rt+P*ct,e[8]=_*ft+b*Y+O*Tt,e[9]=m*ft+R*Y+x*Tt,e[10]=y*ft+M*Y+I*Tt,e[11]=E*ft+N*Y+P*Tt,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function z$(e,t,n){const s=Math.sin(n),i=Math.cos(n),r=t[4],a=t[5],l=t[6],h=t[7],d=t[8],g=t[9],_=t[10],m=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=r*i+d*s,e[5]=a*i+g*s,e[6]=l*i+_*s,e[7]=h*i+m*s,e[8]=d*i-r*s,e[9]=g*i-a*s,e[10]=_*i-l*s,e[11]=m*i-h*s,e}function V$(e,t,n){const s=Math.sin(n),i=Math.cos(n),r=t[0],a=t[1],l=t[2],h=t[3],d=t[8],g=t[9],_=t[10],m=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=r*i-d*s,e[1]=a*i-g*s,e[2]=l*i-_*s,e[3]=h*i-m*s,e[8]=r*s+d*i,e[9]=a*s+g*i,e[10]=l*s+_*i,e[11]=h*s+m*i,e}function H$(e,t,n){const s=Math.sin(n),i=Math.cos(n),r=t[0],a=t[1],l=t[2],h=t[3],d=t[4],g=t[5],_=t[6],m=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=r*i+d*s,e[1]=a*i+g*s,e[2]=l*i+_*s,e[3]=h*i+m*s,e[4]=d*i-r*s,e[5]=g*i-a*s,e[6]=_*i-l*s,e[7]=m*i-h*s,e}function j$(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=n+n,l=s+s,h=i+i,d=n*a,g=s*a,_=s*l,m=i*a,y=i*l,E=i*h,b=r*a,R=r*l,M=r*h;return e[0]=1-_-E,e[1]=g+M,e[2]=m-R,e[3]=0,e[4]=g-M,e[5]=1-d-E,e[6]=y+b,e[7]=0,e[8]=m+R,e[9]=y-b,e[10]=1-d-_,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function $$(e,t,n,s,i,r,a){const l=1/(n-t),h=1/(i-s),d=1/(r-a);return e[0]=r*2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r*2*h,e[6]=0,e[7]=0,e[8]=(n+t)*l,e[9]=(i+s)*h,e[10]=(a+r)*d,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*r*2*d,e[15]=0,e}function X$(e,t,n,s,i){const r=1/Math.tan(t/2);if(e[0]=r/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0){const a=1/(s-i);e[10]=(i+s)*a,e[14]=2*i*s*a}else e[10]=-1,e[14]=-2*s;return e}const G$=X$;function W$(e,t,n,s,i,r,a){const l=1/(t-n),h=1/(s-i),d=1/(r-a);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*h,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*d,e[11]=0,e[12]=(t+n)*l,e[13]=(i+s)*h,e[14]=(a+r)*d,e[15]=1,e}const q$=W$;function Y$(e,t,n,s){let i,r,a,l,h,d,g,_,m,y;const E=t[0],b=t[1],R=t[2],M=s[0],N=s[1],O=s[2],x=n[0],I=n[1],P=n[2];return Math.abs(E-x)<Ol&&Math.abs(b-I)<Ol&&Math.abs(R-P)<Ol?I$(e):(_=E-x,m=b-I,y=R-P,i=1/Math.sqrt(_*_+m*m+y*y),_*=i,m*=i,y*=i,r=N*y-O*m,a=O*_-M*y,l=M*m-N*_,i=Math.sqrt(r*r+a*a+l*l),i?(i=1/i,r*=i,a*=i,l*=i):(r=0,a=0,l=0),h=m*l-y*a,d=y*r-_*l,g=_*a-m*r,i=Math.sqrt(h*h+d*d+g*g),i?(i=1/i,h*=i,d*=i,g*=i):(h=0,d=0,g=0),e[0]=r,e[1]=h,e[2]=_,e[3]=0,e[4]=a,e[5]=d,e[6]=m,e[7]=0,e[8]=l,e[9]=g,e[10]=y,e[11]=0,e[12]=-(r*E+a*b+l*R),e[13]=-(h*E+d*b+g*R),e[14]=-(_*E+m*b+y*R),e[15]=1,e)}function K$(){const e=new ms(4);return ms!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function J$(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function Z$(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function Q$(e){const t=e[0],n=e[1],s=e[2],i=e[3];return Math.sqrt(t*t+n*n+s*s+i*i)}function tX(e){const t=e[0],n=e[1],s=e[2],i=e[3];return t*t+n*n+s*s+i*i}function eX(e,t){const n=t[0],s=t[1],i=t[2],r=t[3];let a=n*n+s*s+i*i+r*r;return a>0&&(a=1/Math.sqrt(a)),e[0]=n*a,e[1]=s*a,e[2]=i*a,e[3]=r*a,e}function nX(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function sX(e,t,n,s){const i=t[0],r=t[1],a=t[2],l=t[3];return e[0]=i+s*(n[0]-i),e[1]=r+s*(n[1]-r),e[2]=a+s*(n[2]-a),e[3]=l+s*(n[3]-l),e}function iX(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3];return e[0]=n[0]*s+n[4]*i+n[8]*r+n[12]*a,e[1]=n[1]*s+n[5]*i+n[9]*r+n[13]*a,e[2]=n[2]*s+n[6]*i+n[10]*r+n[14]*a,e[3]=n[3]*s+n[7]*i+n[11]*r+n[15]*a,e}function rX(e,t,n){const s=t[0],i=t[1],r=t[2],a=n[0],l=n[1],h=n[2],d=n[3],g=d*s+l*r-h*i,_=d*i+h*s-a*r,m=d*r+a*i-l*s,y=-a*s-l*i-h*r;return e[0]=g*d+y*-a+_*-h-m*-l,e[1]=_*d+y*-l+m*-a-g*-h,e[2]=m*d+y*-h+g*-l-_*-a,e[3]=t[3],e}(function(){const e=K$();return function(t,n,s,i,r,a){let l,h;for(n||(n=4),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],e[3]=t[l+3],r(e,e,a),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2],t[l+3]=e[3];return t}})();var Em;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"})(Em||(Em={}));const oX=45*Math.PI/180,aX=1,K_=.1,J_=500,cX=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);let Ue=class extends BC{static get IDENTITY(){return uX()}static get ZERO(){return lX()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Em}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,n,s,i,r,a,l,h,d,g,_,m,y,E,b,R){return this[0]=t,this[1]=n,this[2]=s,this[3]=i,this[4]=r,this[5]=a,this[6]=l,this[7]=h,this[8]=d,this[9]=g,this[10]=_,this[11]=m,this[12]=y,this[13]=E,this[14]=b,this[15]=R,this.check()}setRowMajor(t,n,s,i,r,a,l,h,d,g,_,m,y,E,b,R){return this[0]=t,this[1]=r,this[2]=d,this[3]=y,this[4]=n,this[5]=a,this[6]=g,this[7]=E,this[8]=s,this[9]=l,this[10]=_,this[11]=b,this[12]=i,this[13]=h,this[14]=m,this[15]=R,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(cX)}fromObject(t){return this.check()}fromQuaternion(t){return j$(this,t),this.check()}frustum(t){const{left:n,right:s,bottom:i,top:r,near:a=K_,far:l=J_}=t;return l===1/0?hX(this,n,s,i,r,a):$$(this,n,s,i,r,a,l),this.check()}lookAt(t){const{eye:n,center:s=[0,0,0],up:i=[0,1,0]}=t;return Y$(this,n,s,i),this.check()}ortho(t){const{left:n,right:s,bottom:i,top:r,near:a=K_,far:l=J_}=t;return q$(this,n,s,i,r,a,l),this.check()}orthographic(t){const{fovy:n=oX,aspect:s=aX,focalDistance:i=1,near:r=K_,far:a=J_}=t;cS(n);const l=n/2,h=i*Math.tan(l),d=h*s;return this.ortho({left:-d,right:d,bottom:-h,top:h,near:r,far:a})}perspective(t){const{fovy:n=45*Math.PI/180,aspect:s=1,near:i=.1,far:r=500}=t;return cS(n),G$(this,n,s,i,r),this.check()}determinant(){return F$(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,n){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const s=this.getScale(n),i=1/s[0],r=1/s[1],a=1/s[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*a,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*r,t[6]=this[6]*a,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*r,t[10]=this[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,n){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const s=this.getScale(n),i=1/s[0],r=1/s[1],a=1/s[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*a,t[3]=this[4]*i,t[4]=this[5]*r,t[5]=this[6]*a,t[6]=this[8]*i,t[7]=this[9]*r,t[8]=this[10]*a,t}transpose(){return D$(this,this),this.check()}invert(){return P$(this,this),this.check()}multiplyLeft(t){return aS(this,t,this),this.check()}multiplyRight(t){return aS(this,this,t),this.check()}rotateX(t){return z$(this,this,t),this.check()}rotateY(t){return V$(this,this,t),this.check()}rotateZ(t){return H$(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,n){return k$(this,this,t,n),this.check()}scale(t){return L$(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return U$(this,this,t),this.check()}transform(t,n){return t.length===4?(n=iX(n||[-0,-0,-0,-0],t,this),wl(n,4),n):this.transformAsPoint(t,n)}transformAsPoint(t,n){const{length:s}=t;let i;switch(s){case 2:i=h$(n||[-0,-0],t,this);break;case 3:i=b1(n||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return wl(i,t.length),i}transformAsVector(t,n){let s;switch(t.length){case 2:s=f$(n||[-0,-0],t,this);break;case 3:s=bC(n||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return wl(s,t.length),s}transformPoint(t,n){return this.transformAsPoint(t,n)}transformVector(t,n){return this.transformAsPoint(t,n)}transformDirection(t,n){return this.transformAsVector(t,n)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,n,s){return this.identity().translate([t,n,s])}},ef,nf;function lX(){return ef||(ef=new Ue([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(ef)),ef}function uX(){return nf||(nf=new Ue,Object.freeze(nf)),nf}function cS(e){if(e>Math.PI*2)throw Error("expected radians")}function hX(e,t,n,s,i,r){const a=2*r/(n-t),l=2*r/(i-s),h=(n+t)/(n-t),d=(i+s)/(i-s),g=-1,_=-1,m=-2*r;return e[0]=a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=h,e[9]=d,e[10]=g,e[11]=_,e[12]=0,e[13]=0,e[14]=m,e[15]=0,e}function lS(){const e=new ms(4);return ms!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function fX(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function xC(e,t,n){n=n*.5;const s=Math.sin(n);return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=Math.cos(n),e}function uS(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=n[0],h=n[1],d=n[2],g=n[3];return e[0]=s*g+a*l+i*d-r*h,e[1]=i*g+a*h+r*l-s*d,e[2]=r*g+a*d+s*h-i*l,e[3]=a*g-s*l-i*h-r*d,e}function dX(e,t,n){n*=.5;const s=t[0],i=t[1],r=t[2],a=t[3],l=Math.sin(n),h=Math.cos(n);return e[0]=s*h+a*l,e[1]=i*h+r*l,e[2]=r*h-i*l,e[3]=a*h-s*l,e}function gX(e,t,n){n*=.5;const s=t[0],i=t[1],r=t[2],a=t[3],l=Math.sin(n),h=Math.cos(n);return e[0]=s*h-r*l,e[1]=i*h+a*l,e[2]=r*h+s*l,e[3]=a*h-i*l,e}function pX(e,t,n){n*=.5;const s=t[0],i=t[1],r=t[2],a=t[3],l=Math.sin(n),h=Math.cos(n);return e[0]=s*h+i*l,e[1]=i*h-s*l,e[2]=r*h+a*l,e[3]=a*h-r*l,e}function _X(e,t){const n=t[0],s=t[1],i=t[2];return e[0]=n,e[1]=s,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-s*s-i*i)),e}function Bf(e,t,n,s){const i=t[0],r=t[1],a=t[2],l=t[3];let h=n[0],d=n[1],g=n[2],_=n[3],m,y,E,b,R;return m=i*h+r*d+a*g+l*_,m<0&&(m=-m,h=-h,d=-d,g=-g,_=-_),1-m>Ol?(y=Math.acos(m),R=Math.sin(y),E=Math.sin((1-s)*y)/R,b=Math.sin(s*y)/R):(E=1-s,b=s),e[0]=E*i+b*h,e[1]=E*r+b*d,e[2]=E*a+b*g,e[3]=E*l+b*_,e}function mX(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=n*n+s*s+i*i+r*r,l=a?1/a:0;return e[0]=-n*l,e[1]=-s*l,e[2]=-i*l,e[3]=r*l,e}function AX(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function NC(e,t){const n=t[0]+t[4]+t[8];let s;if(n>0)s=Math.sqrt(n+1),e[3]=.5*s,s=.5/s,e[0]=(t[5]-t[7])*s,e[1]=(t[6]-t[2])*s,e[2]=(t[1]-t[3])*s;else{let i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);const r=(i+1)%3,a=(i+2)%3;s=Math.sqrt(t[i*3+i]-t[r*3+r]-t[a*3+a]+1),e[i]=.5*s,s=.5/s,e[3]=(t[r*3+a]-t[a*3+r])*s,e[r]=(t[r*3+i]+t[i*3+r])*s,e[a]=(t[a*3+i]+t[i*3+a])*s}return e}const yX=J$,TX=Z$,EX=nX,bX=sX,SX=Q$,RX=tX,IC=eX,vX=function(){const e=RC(),t=iS(1,0,0),n=iS(0,1,0);return function(s,i,r){const a=vC(i,r);return a<-.999999?(Of(e,t,i),E$(e)<1e-6&&Of(e,n,i),_$(e,e),xC(s,e,Math.PI),s):a>.999999?(s[0]=0,s[1]=0,s[2]=0,s[3]=1,s):(Of(e,i,r),s[0]=e[0],s[1]=e[1],s[2]=e[2],s[3]=1+a,IC(s,s))}}();(function(){const e=lS(),t=lS();return function(n,s,i,r,a,l){return Bf(e,s,a,l),Bf(t,i,r,l),Bf(n,e,t,2*l*(1-l)),n}})();(function(){const e=S$();return function(t,n,s,i){return e[0]=s[0],e[3]=s[1],e[6]=s[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],IC(t,NC(t,e))}})();const CX=[0,0,0,1];let MX=class extends E1{constructor(t=0,n=0,s=0,i=1){super(-0,-0,-0,-0),Array.isArray(t)&&arguments.length===1?this.copy(t):this.set(t,n,s,i)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,n,s,i){return this[0]=t,this[1]=n,this[2]=s,this[3]=i,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return NC(this,t),this.check()}fromAxisRotation(t,n){return xC(this,t,n),this.check()}identity(){return fX(this),this.check()}setAxisAngle(t,n){return this.fromAxisRotation(t,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=se(t)}get y(){return this[1]}set y(t){this[1]=se(t)}get z(){return this[2]}set z(t){this[2]=se(t)}get w(){return this[3]}set w(t){this[3]=se(t)}len(){return SX(this)}lengthSquared(){return RX(this)}dot(t){return EX(this,t)}rotationTo(t,n){return vX(this,t,n),this.check()}add(t){return yX(this,this,t),this.check()}calculateW(){return _X(this,this),this.check()}conjugate(){return AX(this,this),this.check()}invert(){return mX(this,this),this.check()}lerp(t,n,s){return s===void 0?this.lerp(this,t,n):(bX(this,t,n,s),this.check())}multiplyRight(t){return uS(this,this,t),this.check()}multiplyLeft(t){return uS(this,t,this),this.check()}normalize(){const t=this.len(),n=t>0?1/t:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,t===0&&(this[3]=1),this.check()}rotateX(t){return dX(this,this,t),this.check()}rotateY(t){return gX(this,this,t),this.check()}rotateZ(t){return pX(this,this,t),this.check()}scale(t){return TX(this,this,t),this.check()}slerp(t,n,s){let i,r,a;switch(arguments.length){case 1:({start:i=CX,target:r,ratio:a}=t);break;case 2:i=this,r=t,a=n;break;default:i=t,r=n,a=s}return Bf(this,i,r,a),this.check()}transformVector4(t,n=new b$){return rX(n,t,this),wl(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,n){return this.setAxisAngle(t,n)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}};const wX=1/Math.PI*180,OX=1/180*Math.PI,BX={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...BX}};const on=globalThis.mathgl.config;function xX(e,{precision:t=on.precision}={}){return e=FX(e),`${parseFloat(e.toPrecision(t))}`}function Gl(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function NX(e){return DX(e)}function IX(e){return PX(e)}function DX(e,t){return DC(e,n=>n*OX,t)}function PX(e,t){return DC(e,n=>n*wX,t)}function Wl(e,t,n){const s=on.EPSILON;n&&(on.EPSILON=n);try{if(e===t)return!0;if(Gl(e)&&Gl(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!Wl(e[i],t[i]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<=on.EPSILON*Math.max(1,Math.abs(e),Math.abs(t)):!1}finally{on.EPSILON=s}}function FX(e){return Math.round(e/on.EPSILON)*on.EPSILON}function UX(e){return e.clone?e.clone():new Array(e.length)}function DC(e,t,n){if(Gl(e)){const s=e;n=n||UX(s);for(let i=0;i<n.length&&i<s.length;++i){const r=typeof e=="number"?e:e[i];n[i]=t(r,i,n)}return n}return t(e)}let PC=class extends Array{clone(){return new this.constructor().copy(this)}fromArray(t,n=0){for(let s=0;s<this.ELEMENTS;++s)this[s]=t[s+n];return this.check()}toArray(t=[],n=0){for(let s=0;s<this.ELEMENTS;++s)t[n+s]=this[s];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:Gl(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(on)}formatString(t){let n="";for(let s=0;s<this.ELEMENTS;++s)n+=(s>0?", ":"")+xX(this[s],t);return`${t.printTypes?this.constructor.name:""}[${n}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Wl(this[n],t[n]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==t[n])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,n,s){if(s===void 0)return this.lerp(this,t,n);for(let i=0;i<this.ELEMENTS;++i){const r=t[i],a=typeof n=="number"?n:n[i];this[i]=r+s*(a-r)}return this.check()}min(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(t[n],this[n]);return this.check()}max(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(t[n],this[n]);return this.check()}clamp(t,n){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t[s]),n[s]);return this.check()}add(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]+=n[s];return this.check()}subtract(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]-=n[s];return this.check()}scale(t){if(typeof t=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;else for(let n=0;n<this.ELEMENTS&&n<t.length;++n)this[n]*=t[n];return this.check()}multiplyByScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;return this.check()}check(){if(on.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)t=t&&Number.isFinite(this[n]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=t;return this.check()}addScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,n){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t),n);return this.check()}get elements(){return this}};function LX(e,t){if(e.length!==t)return!1;for(let n=0;n<e.length;++n)if(!Number.isFinite(e[n]))return!1;return!0}function Ln(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function Z_(e,t,n=""){if(on.debug&&!LX(e,t))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return e}function ar(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}let kX=class extends PC{get x(){return this[0]}set x(t){this[0]=Ln(t)}get y(){return this[1]}set y(t){this[1]=Ln(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*this[n];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let n=0;for(let s=0;s<this.ELEMENTS;++s){const i=this[s]-t[s];n+=i*i}return Ln(n)}dot(t){let n=0;for(let s=0;s<this.ELEMENTS;++s)n+=this[s]*t[s];return Ln(n)}normalize(){const t=this.magnitude();if(t!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=t;return this.check()}multiply(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]*=n[s];return this.check()}divide(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]/=n[s];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return ar(t>=0&&t<this.ELEMENTS,"index is out of range"),Ln(this[t])}setComponent(t,n){return ar(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=n,this.check()}addVectors(t,n){return this.copy(t).add(n)}subVectors(t,n){return this.copy(t).subtract(n)}multiplyVectors(t,n){return this.copy(t).multiply(n)}addScaledVector(t,n){return this.add(new this.constructor(t).multiplyScalar(n))}};const xf=1e-6;let Ga=typeof Float32Array<"u"?Float32Array:Array;function zX(){const e=new Ga(2);return Ga!=Float32Array&&(e[0]=0,e[1]=0),e}function VX(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[4]*i+n[12],e[1]=n[1]*s+n[5]*i+n[13],e}(function(){const e=zX();return function(t,n,s,i,r,a){let l,h;for(n||(n=2),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],r(e,e,a),t[l]=e[0],t[l+1]=e[1];return t}})();function HX(e,t,n){const s=t[0],i=t[1],r=n[3]*s+n[7]*i||1;return e[0]=(n[0]*s+n[4]*i)/r,e[1]=(n[1]*s+n[5]*i)/r,e}function FC(e,t,n){const s=t[0],i=t[1],r=t[2],a=n[3]*s+n[7]*i+n[11]*r||1;return e[0]=(n[0]*s+n[4]*i+n[8]*r)/a,e[1]=(n[1]*s+n[5]*i+n[9]*r)/a,e[2]=(n[2]*s+n[6]*i+n[10]*r)/a,e}function jX(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[2]*i,e[1]=n[1]*s+n[3]*i,e[2]=t[2],e}function $X(){const e=new Ga(3);return Ga!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function XX(e){const t=e[0],n=e[1],s=e[2];return Math.sqrt(t*t+n*n+s*s)}function UC(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function GX(e,t,n){const s=t[0],i=t[1],r=t[2],a=n[0],l=n[1],h=n[2];return e[0]=i*h-r*l,e[1]=r*a-s*h,e[2]=s*l-i*a,e}function LC(e,t,n){const s=t[0],i=t[1],r=t[2];let a=n[3]*s+n[7]*i+n[11]*r+n[15];return a=a||1,e[0]=(n[0]*s+n[4]*i+n[8]*r+n[12])/a,e[1]=(n[1]*s+n[5]*i+n[9]*r+n[13])/a,e[2]=(n[2]*s+n[6]*i+n[10]*r+n[14])/a,e}function WX(e,t,n){const s=t[0],i=t[1],r=t[2];return e[0]=s*n[0]+i*n[3]+r*n[6],e[1]=s*n[1]+i*n[4]+r*n[7],e[2]=s*n[2]+i*n[5]+r*n[8],e}function qX(e,t,n){const s=n[0],i=n[1],r=n[2],a=n[3],l=t[0],h=t[1],d=t[2];let g=i*d-r*h,_=r*l-s*d,m=s*h-i*l,y=i*m-r*_,E=r*g-s*m,b=s*_-i*g;const R=a*2;return g*=R,_*=R,m*=R,y*=2,E*=2,b*=2,e[0]=l+g+y,e[1]=h+_+E,e[2]=d+m+b,e}function YX(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[0],r[1]=i[1]*Math.cos(s)-i[2]*Math.sin(s),r[2]=i[1]*Math.sin(s)+i[2]*Math.cos(s),e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function KX(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[2]*Math.sin(s)+i[0]*Math.cos(s),r[1]=i[1],r[2]=i[2]*Math.cos(s)-i[0]*Math.sin(s),e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function JX(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[0]*Math.cos(s)-i[1]*Math.sin(s),r[1]=i[0]*Math.sin(s)+i[1]*Math.cos(s),r[2]=i[2],e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function ZX(e,t){const n=e[0],s=e[1],i=e[2],r=t[0],a=t[1],l=t[2],h=Math.sqrt((n*n+s*s+i*i)*(r*r+a*a+l*l)),d=h&&UC(e,t)/h;return Math.acos(Math.min(Math.max(d,-1),1))}(function(){const e=$X();return function(t,n,s,i,r,a){let l,h;for(n||(n=3),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],r(e,e,a),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2];return t}})();const Q_=[0,0,0];let sf,ce=class kC extends kX{static get ZERO(){return sf||(sf=new kC(0,0,0),Object.freeze(sf)),sf}constructor(t=0,n=0,s=0){super(-0,-0,-0),arguments.length===1&&Gl(t)?this.copy(t):(on.debug&&(Ln(t),Ln(n),Ln(s)),this[0]=t,this[1]=n,this[2]=s)}set(t,n,s){return this[0]=t,this[1]=n,this[2]=s,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return on.debug&&(Ln(t.x),Ln(t.y),Ln(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=Ln(t)}angle(t){return ZX(this,t)}cross(t){return GX(this,this,t),this.check()}rotateX({radians:t,origin:n=Q_}){return YX(this,this,n,t),this.check()}rotateY({radians:t,origin:n=Q_}){return KX(this,this,n,t),this.check()}rotateZ({radians:t,origin:n=Q_}){return JX(this,this,n,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return LC(this,this,t),this.check()}transformAsVector(t){return FC(this,this,t),this.check()}transformByMatrix3(t){return WX(this,this,t),this.check()}transformByMatrix2(t){return jX(this,this,t),this.check()}transformByQuaternion(t){return qX(this,this,t),this.check()}},QX=class extends PC{toString(){let t="[";if(on.printRowMajor){t+="row-major:";for(let n=0;n<this.RANK;++n)for(let s=0;s<this.RANK;++s)t+=` ${this[s*this.RANK+n]}`}else{t+="column-major:";for(let n=0;n<this.ELEMENTS;++n)t+=` ${this[n]}`}return t+="]",t}getElementIndex(t,n){return n*this.RANK+t}getElement(t,n){return this[n*this.RANK+t]}setElement(t,n,s){return this[n*this.RANK+t]=Ln(s),this}getColumn(t,n=new Array(this.RANK).fill(-0)){const s=t*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[s+i];return n}setColumn(t,n){const s=t*this.RANK;for(let i=0;i<this.RANK;++i)this[s+i]=n[i];return this}};function tG(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function eG(e,t){if(e===t){const n=t[1],s=t[2],i=t[3],r=t[6],a=t[7],l=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=s,e[9]=r,e[11]=t[14],e[12]=i,e[13]=a,e[14]=l}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function nG(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=t[4],l=t[5],h=t[6],d=t[7],g=t[8],_=t[9],m=t[10],y=t[11],E=t[12],b=t[13],R=t[14],M=t[15],N=n*l-s*a,O=n*h-i*a,x=n*d-r*a,I=s*h-i*l,P=s*d-r*l,J=i*d-r*h,et=g*b-_*E,q=g*R-m*E,Q=g*M-y*E,rt=_*R-m*b,ct=_*M-y*b,ft=m*M-y*R;let Y=N*ft-O*ct+x*rt+I*Q-P*q+J*et;return Y?(Y=1/Y,e[0]=(l*ft-h*ct+d*rt)*Y,e[1]=(i*ct-s*ft-r*rt)*Y,e[2]=(b*J-R*P+M*I)*Y,e[3]=(m*P-_*J-y*I)*Y,e[4]=(h*Q-a*ft-d*q)*Y,e[5]=(n*ft-i*Q+r*q)*Y,e[6]=(R*x-E*J-M*O)*Y,e[7]=(g*J-m*x+y*O)*Y,e[8]=(a*ct-l*Q+d*et)*Y,e[9]=(s*Q-n*ct-r*et)*Y,e[10]=(E*P-b*x+M*N)*Y,e[11]=(_*x-g*P-y*N)*Y,e[12]=(l*q-a*rt-h*et)*Y,e[13]=(n*rt-s*q+i*et)*Y,e[14]=(b*O-E*I-R*N)*Y,e[15]=(g*I-_*O+m*N)*Y,e):null}function sG(e){const t=e[0],n=e[1],s=e[2],i=e[3],r=e[4],a=e[5],l=e[6],h=e[7],d=e[8],g=e[9],_=e[10],m=e[11],y=e[12],E=e[13],b=e[14],R=e[15],M=t*a-n*r,N=t*l-s*r,O=n*l-s*a,x=d*E-g*y,I=d*b-_*y,P=g*b-_*E,J=t*P-n*I+s*x,et=r*P-a*I+l*x,q=d*O-g*N+_*M,Q=y*O-E*N+b*M;return h*J-i*et+R*q-m*Q}function hS(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=t[4],h=t[5],d=t[6],g=t[7],_=t[8],m=t[9],y=t[10],E=t[11],b=t[12],R=t[13],M=t[14],N=t[15];let O=n[0],x=n[1],I=n[2],P=n[3];return e[0]=O*s+x*l+I*_+P*b,e[1]=O*i+x*h+I*m+P*R,e[2]=O*r+x*d+I*y+P*M,e[3]=O*a+x*g+I*E+P*N,O=n[4],x=n[5],I=n[6],P=n[7],e[4]=O*s+x*l+I*_+P*b,e[5]=O*i+x*h+I*m+P*R,e[6]=O*r+x*d+I*y+P*M,e[7]=O*a+x*g+I*E+P*N,O=n[8],x=n[9],I=n[10],P=n[11],e[8]=O*s+x*l+I*_+P*b,e[9]=O*i+x*h+I*m+P*R,e[10]=O*r+x*d+I*y+P*M,e[11]=O*a+x*g+I*E+P*N,O=n[12],x=n[13],I=n[14],P=n[15],e[12]=O*s+x*l+I*_+P*b,e[13]=O*i+x*h+I*m+P*R,e[14]=O*r+x*d+I*y+P*M,e[15]=O*a+x*g+I*E+P*N,e}function iG(e,t,n){const s=n[0],i=n[1],r=n[2];let a,l,h,d,g,_,m,y,E,b,R,M;return t===e?(e[12]=t[0]*s+t[4]*i+t[8]*r+t[12],e[13]=t[1]*s+t[5]*i+t[9]*r+t[13],e[14]=t[2]*s+t[6]*i+t[10]*r+t[14],e[15]=t[3]*s+t[7]*i+t[11]*r+t[15]):(a=t[0],l=t[1],h=t[2],d=t[3],g=t[4],_=t[5],m=t[6],y=t[7],E=t[8],b=t[9],R=t[10],M=t[11],e[0]=a,e[1]=l,e[2]=h,e[3]=d,e[4]=g,e[5]=_,e[6]=m,e[7]=y,e[8]=E,e[9]=b,e[10]=R,e[11]=M,e[12]=a*s+g*i+E*r+t[12],e[13]=l*s+_*i+b*r+t[13],e[14]=h*s+m*i+R*r+t[14],e[15]=d*s+y*i+M*r+t[15]),e}function rG(e,t,n){const s=n[0],i=n[1],r=n[2];return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function oG(e,t,n,s){let i=s[0],r=s[1],a=s[2],l=Math.sqrt(i*i+r*r+a*a),h,d,g,_,m,y,E,b,R,M,N,O,x,I,P,J,et,q,Q,rt,ct,ft,Y,Tt;return l<xf?null:(l=1/l,i*=l,r*=l,a*=l,d=Math.sin(n),h=Math.cos(n),g=1-h,_=t[0],m=t[1],y=t[2],E=t[3],b=t[4],R=t[5],M=t[6],N=t[7],O=t[8],x=t[9],I=t[10],P=t[11],J=i*i*g+h,et=r*i*g+a*d,q=a*i*g-r*d,Q=i*r*g-a*d,rt=r*r*g+h,ct=a*r*g+i*d,ft=i*a*g+r*d,Y=r*a*g-i*d,Tt=a*a*g+h,e[0]=_*J+b*et+O*q,e[1]=m*J+R*et+x*q,e[2]=y*J+M*et+I*q,e[3]=E*J+N*et+P*q,e[4]=_*Q+b*rt+O*ct,e[5]=m*Q+R*rt+x*ct,e[6]=y*Q+M*rt+I*ct,e[7]=E*Q+N*rt+P*ct,e[8]=_*ft+b*Y+O*Tt,e[9]=m*ft+R*Y+x*Tt,e[10]=y*ft+M*Y+I*Tt,e[11]=E*ft+N*Y+P*Tt,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function aG(e,t,n){const s=Math.sin(n),i=Math.cos(n),r=t[4],a=t[5],l=t[6],h=t[7],d=t[8],g=t[9],_=t[10],m=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=r*i+d*s,e[5]=a*i+g*s,e[6]=l*i+_*s,e[7]=h*i+m*s,e[8]=d*i-r*s,e[9]=g*i-a*s,e[10]=_*i-l*s,e[11]=m*i-h*s,e}function cG(e,t,n){const s=Math.sin(n),i=Math.cos(n),r=t[0],a=t[1],l=t[2],h=t[3],d=t[8],g=t[9],_=t[10],m=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=r*i-d*s,e[1]=a*i-g*s,e[2]=l*i-_*s,e[3]=h*i-m*s,e[8]=r*s+d*i,e[9]=a*s+g*i,e[10]=l*s+_*i,e[11]=h*s+m*i,e}function lG(e,t,n){const s=Math.sin(n),i=Math.cos(n),r=t[0],a=t[1],l=t[2],h=t[3],d=t[4],g=t[5],_=t[6],m=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=r*i+d*s,e[1]=a*i+g*s,e[2]=l*i+_*s,e[3]=h*i+m*s,e[4]=d*i-r*s,e[5]=g*i-a*s,e[6]=_*i-l*s,e[7]=m*i-h*s,e}function uG(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=n+n,l=s+s,h=i+i,d=n*a,g=s*a,_=s*l,m=i*a,y=i*l,E=i*h,b=r*a,R=r*l,M=r*h;return e[0]=1-_-E,e[1]=g+M,e[2]=m-R,e[3]=0,e[4]=g-M,e[5]=1-d-E,e[6]=y+b,e[7]=0,e[8]=m+R,e[9]=y-b,e[10]=1-d-_,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function hG(e,t,n,s,i,r,a){const l=1/(n-t),h=1/(i-s),d=1/(r-a);return e[0]=r*2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r*2*h,e[6]=0,e[7]=0,e[8]=(n+t)*l,e[9]=(i+s)*h,e[10]=(a+r)*d,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*r*2*d,e[15]=0,e}function fG(e,t,n,s,i){const r=1/Math.tan(t/2);if(e[0]=r/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0){const a=1/(s-i);e[10]=(i+s)*a,e[14]=2*i*s*a}else e[10]=-1,e[14]=-2*s;return e}const dG=fG;function gG(e,t,n,s,i,r,a){const l=1/(t-n),h=1/(s-i),d=1/(r-a);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*h,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*d,e[11]=0,e[12]=(t+n)*l,e[13]=(i+s)*h,e[14]=(a+r)*d,e[15]=1,e}const pG=gG;function _G(e,t,n,s){let i,r,a,l,h,d,g,_,m,y;const E=t[0],b=t[1],R=t[2],M=s[0],N=s[1],O=s[2],x=n[0],I=n[1],P=n[2];return Math.abs(E-x)<xf&&Math.abs(b-I)<xf&&Math.abs(R-P)<xf?tG(e):(_=E-x,m=b-I,y=R-P,i=1/Math.sqrt(_*_+m*m+y*y),_*=i,m*=i,y*=i,r=N*y-O*m,a=O*_-M*y,l=M*m-N*_,i=Math.sqrt(r*r+a*a+l*l),i?(i=1/i,r*=i,a*=i,l*=i):(r=0,a=0,l=0),h=m*l-y*a,d=y*r-_*l,g=_*a-m*r,i=Math.sqrt(h*h+d*d+g*g),i?(i=1/i,h*=i,d*=i,g*=i):(h=0,d=0,g=0),e[0]=r,e[1]=h,e[2]=_,e[3]=0,e[4]=a,e[5]=d,e[6]=m,e[7]=0,e[8]=l,e[9]=g,e[10]=y,e[11]=0,e[12]=-(r*E+a*b+l*R),e[13]=-(h*E+d*b+g*R),e[14]=-(_*E+m*b+y*R),e[15]=1,e)}function mG(){const e=new Ga(4);return Ga!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function AG(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3];return e[0]=n[0]*s+n[4]*i+n[8]*r+n[12]*a,e[1]=n[1]*s+n[5]*i+n[9]*r+n[13]*a,e[2]=n[2]*s+n[6]*i+n[10]*r+n[14]*a,e[3]=n[3]*s+n[7]*i+n[11]*r+n[15]*a,e}(function(){const e=mG();return function(t,n,s,i,r,a){let l,h;for(n||(n=4),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],e[3]=t[l+3],r(e,e,a),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2],t[l+3]=e[3];return t}})();var bm;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"})(bm||(bm={}));const yG=45*Math.PI/180,TG=1,t0=.1,e0=500,EG=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);let ld=class extends QX{static get IDENTITY(){return SG()}static get ZERO(){return bG()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return bm}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,n,s,i,r,a,l,h,d,g,_,m,y,E,b,R){return this[0]=t,this[1]=n,this[2]=s,this[3]=i,this[4]=r,this[5]=a,this[6]=l,this[7]=h,this[8]=d,this[9]=g,this[10]=_,this[11]=m,this[12]=y,this[13]=E,this[14]=b,this[15]=R,this.check()}setRowMajor(t,n,s,i,r,a,l,h,d,g,_,m,y,E,b,R){return this[0]=t,this[1]=r,this[2]=d,this[3]=y,this[4]=n,this[5]=a,this[6]=g,this[7]=E,this[8]=s,this[9]=l,this[10]=_,this[11]=b,this[12]=i,this[13]=h,this[14]=m,this[15]=R,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(EG)}fromObject(t){return this.check()}fromQuaternion(t){return uG(this,t),this.check()}frustum(t){const{left:n,right:s,bottom:i,top:r,near:a=t0,far:l=e0}=t;return l===1/0?RG(this,n,s,i,r,a):hG(this,n,s,i,r,a,l),this.check()}lookAt(t){const{eye:n,center:s=[0,0,0],up:i=[0,1,0]}=t;return _G(this,n,s,i),this.check()}ortho(t){const{left:n,right:s,bottom:i,top:r,near:a=t0,far:l=e0}=t;return pG(this,n,s,i,r,a,l),this.check()}orthographic(t){const{fovy:n=yG,aspect:s=TG,focalDistance:i=1,near:r=t0,far:a=e0}=t;fS(n);const l=n/2,h=i*Math.tan(l),d=h*s;return this.ortho({left:-d,right:d,bottom:-h,top:h,near:r,far:a})}perspective(t){const{fovy:n=45*Math.PI/180,aspect:s=1,near:i=.1,far:r=500}=t;return fS(n),dG(this,n,s,i,r),this.check()}determinant(){return sG(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,n){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const s=this.getScale(n),i=1/s[0],r=1/s[1],a=1/s[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*a,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*r,t[6]=this[6]*a,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*r,t[10]=this[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,n){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const s=this.getScale(n),i=1/s[0],r=1/s[1],a=1/s[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*a,t[3]=this[4]*i,t[4]=this[5]*r,t[5]=this[6]*a,t[6]=this[8]*i,t[7]=this[9]*r,t[8]=this[10]*a,t}transpose(){return eG(this,this),this.check()}invert(){return nG(this,this),this.check()}multiplyLeft(t){return hS(this,t,this),this.check()}multiplyRight(t){return hS(this,this,t),this.check()}rotateX(t){return aG(this,this,t),this.check()}rotateY(t){return cG(this,this,t),this.check()}rotateZ(t){return lG(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,n){return oG(this,this,t,n),this.check()}scale(t){return rG(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return iG(this,this,t),this.check()}transform(t,n){return t.length===4?(n=AG(n||[-0,-0,-0,-0],t,this),Z_(n,4),n):this.transformAsPoint(t,n)}transformAsPoint(t,n){const{length:s}=t;let i;switch(s){case 2:i=VX(n||[-0,-0],t,this);break;case 3:i=LC(n||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Z_(i,t.length),i}transformAsVector(t,n){let s;switch(t.length){case 2:s=HX(n||[-0,-0],t,this);break;case 3:s=FC(n||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Z_(s,t.length),s}transformPoint(t,n){return this.transformAsPoint(t,n)}transformVector(t,n){return this.transformAsPoint(t,n)}transformDirection(t,n){return this.transformAsVector(t,n)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,n,s){return this.identity().translate([t,n,s])}},rf,of;function bG(){return rf||(rf=new ld([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(rf)),rf}function SG(){return of||(of=new ld,Object.freeze(of)),of}function fS(e){if(e>Math.PI*2)throw Error("expected radians")}function RG(e,t,n,s,i,r){const a=2*r/(n-t),l=2*r/(i-s),h=(n+t)/(n-t),d=(i+s)/(i-s),g=-1,_=-1,m=-2*r;return e[0]=a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=h,e[9]=d,e[10]=g,e[11]=_,e[12]=0,e[13]=0,e[14]=m,e[15]=0,e}const vG=.1,CG=1e-12,MG=1e-15,wG=6378137,OG=6378137,BG=6356752314245179e-9;function jd(e){return e}new ce;function xG(e,t=[],n=jd){return"longitude"in e?(t[0]=n(e.longitude),t[1]=n(e.latitude),t[2]=e.height):"x"in e?(t[0]=n(e.x),t[1]=n(e.y),t[2]=e.z):(t[0]=n(e[0]),t[1]=n(e[1]),t[2]=e[2]),t}function NG(e,t=[]){return xG(e,t,on._cartographicRadians?jd:NX)}function IG(e,t,n=jd){return"longitude"in t?(t.longitude=n(e[0]),t.latitude=n(e[1]),t.height=e[2]):"x"in t?(t.x=n(e[0]),t.y=n(e[1]),t.z=e[2]):(t[0]=n(e[0]),t[1]=n(e[1]),t[2]=e[2]),t}function DG(e,t){return IG(e,t,on._cartographicRadians?jd:IX)}const dS=1e-14,PG=new ce,gS={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},n0={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},ul={east:new ce,north:new ce,up:new ce,west:new ce,south:new ce,down:new ce},FG=new ce,UG=new ce,LG=new ce;function pS(e,t,n,s,i,r){const a=gS[t]&&gS[t][n];ar(a&&(!s||s===a));let l,h,d;const g=PG.copy(i);if(Wl(g.x,0,dS)&&Wl(g.y,0,dS)){const m=Math.sign(g.z);l=FG.fromArray(n0[t]),t!=="east"&&t!=="west"&&l.scale(m),h=UG.fromArray(n0[n]),n!=="east"&&n!=="west"&&h.scale(m),d=LG.fromArray(n0[s]),s!=="east"&&s!=="west"&&d.scale(m)}else{const{up:m,east:y,north:E}=ul;y.set(-g.y,g.x,0).normalize(),e.geodeticSurfaceNormal(g,m),E.copy(m).cross(y);const{down:b,west:R,south:M}=ul;b.copy(m).scale(-1),R.copy(y).scale(-1),M.copy(E).scale(-1),l=ul[t],h=ul[n],d=ul[s]}return r[0]=l.x,r[1]=l.y,r[2]=l.z,r[3]=0,r[4]=h.x,r[5]=h.y,r[6]=h.z,r[7]=0,r[8]=d.x,r[9]=d.y,r[10]=d.z,r[11]=0,r[12]=g.x,r[13]=g.y,r[14]=g.z,r[15]=1,r}const _a=new ce,kG=new ce,zG=new ce;function VG(e,t,n=[]){const{oneOverRadii:s,oneOverRadiiSquared:i,centerToleranceSquared:r}=t;_a.from(e);const a=_a.x,l=_a.y,h=_a.z,d=s.x,g=s.y,_=s.z,m=a*a*d*d,y=l*l*g*g,E=h*h*_*_,b=m+y+E,R=Math.sqrt(1/b);if(!Number.isFinite(R))return;const M=kG;if(M.copy(e).scale(R),b<r)return M.to(n);const N=i.x,O=i.y,x=i.z,I=zG;I.set(M.x*N*2,M.y*O*2,M.z*x*2);let P=(1-R)*_a.len()/(.5*I.len()),J=0,et,q,Q,rt;do{P-=J,et=1/(1+P*N),q=1/(1+P*O),Q=1/(1+P*x);const ct=et*et,ft=q*q,Y=Q*Q,Tt=ct*et,K=ft*q,lt=Y*Q;rt=m*ct+y*ft+E*Y-1;const Pt=-2*(m*Tt*N+y*K*O+E*lt*x);J=rt/Pt}while(Math.abs(rt)>CG);return _a.scale([et,q,Q]).to(n)}const af=new ce,_S=new ce,HG=new ce,cs=new ce,jG=new ce,cf=new ce;class re{constructor(t=0,n=0,s=0){this.centerToleranceSquared=vG,ar(t>=0),ar(n>=0),ar(s>=0),this.radii=new ce(t,n,s),this.radiiSquared=new ce(t*t,n*n,s*s),this.radiiToTheFourth=new ce(t*t*t*t,n*n*n*n,s*s*s*s),this.oneOverRadii=new ce(t===0?0:1/t,n===0?0:1/n,s===0?0:1/s),this.oneOverRadiiSquared=new ce(t===0?0:1/(t*t),n===0?0:1/(n*n),s===0?0:1/(s*s)),this.minimumRadius=Math.min(t,n,s),this.maximumRadius=Math.max(t,n,s),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(t){return this===t||!!(t&&this.radii.equals(t.radii))}toString(){return this.radii.toString()}cartographicToCartesian(t,n=[0,0,0]){const s=_S,i=HG,[,,r]=t;this.geodeticSurfaceNormalCartographic(t,s),i.copy(this.radiiSquared).scale(s);const a=Math.sqrt(s.dot(i));return i.scale(1/a),s.scale(r),i.add(s),i.to(n)}cartesianToCartographic(t,n=[0,0,0]){cf.from(t);const s=this.scaleToGeodeticSurface(cf,cs);if(!s)return;const i=this.geodeticSurfaceNormal(s,_S),r=jG;r.copy(cf).subtract(s);const a=Math.atan2(i.y,i.x),l=Math.asin(i.z),h=Math.sign(UC(r,cf))*XX(r);return DG([a,l,h],n)}eastNorthUpToFixedFrame(t,n=new ld){return pS(this,"east","north","up",t,n)}localFrameToFixedFrame(t,n,s,i,r=new ld){return pS(this,t,n,s,i,r)}geocentricSurfaceNormal(t,n=[0,0,0]){return af.from(t).normalize().to(n)}geodeticSurfaceNormalCartographic(t,n=[0,0,0]){const s=NG(t),i=s[0],r=s[1],a=Math.cos(r);return af.set(a*Math.cos(i),a*Math.sin(i),Math.sin(r)).normalize(),af.to(n)}geodeticSurfaceNormal(t,n=[0,0,0]){return af.from(t).scale(this.oneOverRadiiSquared).normalize().to(n)}scaleToGeodeticSurface(t,n){return VG(t,this,n)}scaleToGeocentricSurface(t,n=[0,0,0]){cs.from(t);const s=cs.x,i=cs.y,r=cs.z,a=this.oneOverRadiiSquared,l=1/Math.sqrt(s*s*a.x+i*i*a.y+r*r*a.z);return cs.multiplyScalar(l).to(n)}transformPositionToScaledSpace(t,n=[0,0,0]){return cs.from(t).scale(this.oneOverRadii).to(n)}transformPositionFromScaledSpace(t,n=[0,0,0]){return cs.from(t).scale(this.radii).to(n)}getSurfaceNormalIntersectionWithZAxis(t,n=0,s=[0,0,0]){ar(Wl(this.radii.x,this.radii.y,MG)),ar(this.radii.z>0),cs.from(t);const i=cs.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(i)>=this.radii.z-n))return cs.set(0,0,i).to(s)}}re.WGS84=new re(wG,OG,BG);function to(e,t){if(!e)throw new Error(t||"loader assertion failed.")}const $G="Queued Requests",XG="Active Requests",GG="Cancelled Requests",WG="Queued Requests Ever",qG="Active Requests Ever",YG={id:"request-scheduler",throttleRequests:!0,maxRequests:6,debounceTime:0};class KG{constructor(t={}){T(this,"props");T(this,"stats");T(this,"activeRequestCount",0);T(this,"requestQueue",[]);T(this,"requestMap",new Map);T(this,"updateTimer",null);this.props={...YG,...t},this.stats=new Za({id:this.props.id}),this.stats.get($G),this.stats.get(XG),this.stats.get(GG),this.stats.get(WG),this.stats.get(qG)}scheduleRequest(t,n=()=>0){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(t))return this.requestMap.get(t);const s={handle:t,priority:0,getPriority:n},i=new Promise(r=>(s.resolve=r,s));return this.requestQueue.push(s),this.requestMap.set(t,i),this._issueNewRequests(),i}_issueRequest(t){const{handle:n,resolve:s}=t;let i=!1;const r=()=>{i||(i=!0,this.requestMap.delete(n),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,s?s({done:r}):Promise.resolve({done:r})}_issueNewRequests(){this.updateTimer!==null&&clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>this._issueNewRequestsAsync(),this.props.debounceTime)}_issueNewRequestsAsync(){this.updateTimer!==null&&clearTimeout(this.updateTimer),this.updateTimer=null;const t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(t!==0){this._updateAllRequests();for(let n=0;n<t;++n){const s=this.requestQueue.shift();s&&this._issueRequest(s)}}}_updateAllRequests(){const t=this.requestQueue;for(let n=0;n<t.length;++n){const s=t[n];this._updateRequest(s)||(t.splice(n,1),this.requestMap.delete(s.handle),n--)}t.sort((n,s)=>n.priority-s.priority)}_updateRequest(t){return t.priority=t.getPriority(t.handle),t.priority<0?(t.resolve(null),!1):!0}}function JG(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}class ZG{constructor(t,n,s){T(this,"item");T(this,"previous");T(this,"next");this.item=t,this.previous=n,this.next=s}}class QG{constructor(){T(this,"head",null);T(this,"tail",null);T(this,"_length",0)}get length(){return this._length}add(t){const n=new ZG(t,this.tail,null);return this.tail?(this.tail.next=n,this.tail=n):(this.head=n,this.tail=n),++this._length,n}remove(t){t&&(t.previous&&t.next?(t.previous.next=t.next,t.next.previous=t.previous):t.previous?(t.previous.next=null,this.tail=t.previous):t.next?(t.next.previous=null,this.head=t.next):(this.head=null,this.tail=null),t.next=null,t.previous=null,--this._length)}splice(t,n){t!==n&&(this.remove(n),this._insert(t,n))}_insert(t,n){const s=t.next;t.next=n,this.tail===t?this.tail=n:s.previous=n,n.next=s,n.previous=t,++this._length}}class tW{constructor(){T(this,"_list");T(this,"_sentinel");T(this,"_trimTiles");this._list=new QG,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(t){const n=t._cacheNode;n&&this._list.splice(this._sentinel,n)}add(t,n,s){n._cacheNode||(n._cacheNode=this._list.add(n),s&&s(t,n))}unloadTile(t,n,s){const i=n._cacheNode;i&&(this._list.remove(i),n._cacheNode=null,s&&s(t,n))}unloadTiles(t,n){const s=this._trimTiles;this._trimTiles=!1;const i=this._list,r=t.maximumMemoryUsage*1024*1024,a=this._sentinel;let l=i.head;for(;l!==a&&(t.gpuMemoryUsageInBytes>r||s);){const h=l.item;l=l.next,this.unloadTile(t,h,n)}}trim(){this._trimTiles=!0}}function eW(e,t){to(e),to(t);const{rtcCenter:n,gltfUpAxis:s}=t,{computedTransform:i,boundingVolume:{center:r}}=e;let a=new Ue(i);switch(n&&a.translate(n),s){case"Z":break;case"Y":const _=new Ue().rotateX(Math.PI/2);a=a.multiplyRight(_);break;case"X":const m=new Ue().rotateY(-Math.PI/2);a=a.multiplyRight(m);break}t.isQuantized&&a.translate(t.quantizedVolumeOffset).scale(t.quantizedVolumeScale);const l=new bt(r);t.cartesianModelMatrix=a,t.cartesianOrigin=l;const h=re.WGS84.cartesianToCartographic(l,new bt),g=re.WGS84.eastNorthUpToFixedFrame(l).invert();t.cartographicModelMatrix=g.multiplyRight(a),t.cartographicOrigin=h,t.coordinateSystem||(t.modelMatrix=t.cartographicModelMatrix)}const mS=new bt,s0=new bt,Sm=new Jn([new Ps,new Ps,new Ps,new Ps,new Ps,new Ps]);function nW(e,t){const{cameraDirection:n,cameraUp:s,height:i}=e,{metersPerUnit:r}=e.distanceScales,a=Nf(e,e.center),l=re.WGS84.eastNorthUpToFixedFrame(a),h=e.unprojectPosition(e.cameraPosition),d=re.WGS84.cartographicToCartesian(h,new bt),g=new bt(l.transformAsVector(new bt(n).scale(r))).normalize(),_=new bt(l.transformAsVector(new bt(s).scale(r))).normalize();iW(e);const m=e.constructor,{longitude:y,latitude:E,width:b,bearing:R,zoom:M}=e,N=new m({longitude:y,latitude:E,height:i,width:b,bearing:R,zoom:M,pitch:0});return{camera:{position:d,direction:g,up:_},viewport:e,topDownViewport:N,height:i,cullingVolume:Sm,frameNumber:t,sseDenominator:1.15}}function sW(e,t,n){if(n===0||e.length<=n)return[e,[]];const s=[],{longitude:i,latitude:r}=t.viewport;for(const[d,g]of e.entries()){const[_,m]=g.header.mbs,y=Math.abs(i-_),E=Math.abs(r-m),b=Math.sqrt(E*E+y*y);s.push([d,b])}const a=s.sort((d,g)=>d[1]-g[1]),l=[];for(let d=0;d<n;d++)l.push(e[a[d][0]]);const h=[];for(let d=n;d<a.length;d++)h.push(e[a[d][0]]);return[l,h]}function iW(e){const t=e.getFrustumPlanes(),n=AS(t.near,e.cameraPosition),s=Nf(e,n),i=Nf(e,e.cameraPosition,s0);let r=0;Sm.planes[r++].fromPointNormal(s,mS.copy(s).subtract(i));for(const a in t){if(a==="near")continue;const l=t[a],h=AS(l,n,s0),d=Nf(e,h,s0);Sm.planes[r++].fromPointNormal(d,mS.copy(s).subtract(d))}}function AS(e,t,n=new bt){const s=e.normal.dot(t);return n.copy(e.normal).scale(e.distance-s).add(t),n}function Nf(e,t,n=new bt){const s=e.unprojectPosition(t);return re.WGS84.cartographicToCartesian(s,n)}const rW=6378137,oW=6378137,Rm=6356752314245179e-9,Ca=new bt;function aW(e,t){if(e instanceof nu){const{halfAxes:n}=e,s=lW(n);return Math.log2(Rm/(s+t[2]))}else if(e instanceof eu){const{radius:n}=e;return Math.log2(Rm/(n+t[2]))}else if(e.width&&e.height){const{width:n,height:s}=e,i=Math.log2(rW/n),r=Math.log2(oW/s);return(i+r)/2}return 1}function zC(e,t,n){re.WGS84.cartographicToCartesian([e.xmax,e.ymax,e.zmax],Ca);const s=Math.sqrt(Math.pow(Ca[0]-n[0],2)+Math.pow(Ca[1]-n[1],2)+Math.pow(Ca[2]-n[2],2));return Math.log2(Rm/(s+t[2]))}function cW(e,t,n){const[s,i,r,a]=e;return zC({xmax:r,ymax:a,zmax:0},t,n)}function lW(e){e.getColumn(0,Ca);const t=e.getColumn(1),n=e.getColumn(2);return Ca.add(t).add(n).len()}const Pn={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5};var gs;(function(e){e[e.ADD=1]="ADD",e[e.REPLACE=2]="REPLACE"})(gs||(gs={}));var yi;(function(e){e.EMPTY="empty",e.SCENEGRAPH="scenegraph",e.POINTCLOUD="pointcloud",e.MESH="mesh"})(yi||(yi={}));var _n;(function(e){e.I3S="I3S",e.TILES3D="TILES3D"})(_n||(_n={}));var Wa;(function(e){e.GEOMETRIC_ERROR="geometricError",e.MAX_SCREEN_THRESHOLD="maxScreenThreshold"})(Wa||(Wa={}));const uW={USE_OPTIMIZATION:1};function VC(e){return e!=null}const tn=new bt,If=new bt,hW=new bt,fW=new bt,$r=new bt,yS=new bt,TS=new bt,ES=new bt;function i0(e,t,n){if(to(e,"3D Tile: boundingVolume must be defined"),e.box)return HC(e.box,t,n);if(e.region)return pW(e.region);if(e.sphere)return gW(e.sphere,t,n);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function dW(e,t){if(e.box)return _W(t);if(e.region){const[n,s,i,r,a,l]=e.region;return[[Fs(n),Fs(s),a],[Fs(i),Fs(r),l]]}if(e.sphere)return mW(t);throw new Error("Unkown boundingVolume type")}function HC(e,t,n){const s=new bt(e[0],e[1],e[2]);t.transform(s,s);let i=[];if(e.length===10){const d=e.slice(3,6),g=new MX;g.fromArray(e,6);const _=new bt([1,0,0]),m=new bt([0,1,0]),y=new bt([0,0,1]);_.transformByQuaternion(g),_.scale(d[0]),m.transformByQuaternion(g),m.scale(d[1]),y.transformByQuaternion(g),y.scale(d[2]),i=[..._.toArray(),...m.toArray(),...y.toArray()]}else i=[...e.slice(3,6),...e.slice(6,9),...e.slice(9,12)];const r=t.transformAsVector(i.slice(0,3)),a=t.transformAsVector(i.slice(3,6)),l=t.transformAsVector(i.slice(6,9)),h=new S1([r[0],r[1],r[2],a[0],a[1],a[2],l[0],l[1],l[2]]);return VC(n)?(n.center=s,n.halfAxes=h,n):new nu(s,h)}function gW(e,t,n){const s=new bt(e[0],e[1],e[2]);t.transform(s,s);const i=t.getScale(If),r=Math.max(Math.max(i[0],i[1]),i[2]),a=e[3]*r;return VC(n)?(n.center=s,n.radius=a,n):new eu(s,a)}function pW(e){const[t,n,s,i,r,a]=e,l=re.WGS84.cartographicToCartesian([Fs(t),Fs(i),r],hW),h=re.WGS84.cartographicToCartesian([Fs(s),Fs(n),a],fW),d=new bt().addVectors(l,h).multiplyByScalar(.5);return re.WGS84.cartesianToCartographic(d,$r),re.WGS84.cartographicToCartesian([Fs(s),$r[1],$r[2]],yS),re.WGS84.cartographicToCartesian([$r[0],Fs(i),$r[2]],TS),re.WGS84.cartographicToCartesian([$r[0],$r[1],a],ES),HC([...d,...yS.subtract(d),...TS.subtract(d),...ES.subtract(d)],new Ue)}function _W(e){const t=jC(),{halfAxes:n}=e,s=new bt(n.getColumn(0)),i=new bt(n.getColumn(1)),r=new bt(n.getColumn(2));for(let a=0;a<2;a++){for(let l=0;l<2;l++){for(let h=0;h<2;h++)tn.copy(e.center),tn.add(s),tn.add(i),tn.add(r),$C(t,tn),r.negate();i.negate()}s.negate()}return t}function mW(e){const t=jC(),{center:n,radius:s}=e,i=re.WGS84.scaleToGeodeticSurface(n,tn);let r;i?r=re.WGS84.geodeticSurfaceNormal(i):r=new bt(0,0,1);let a=new bt(r[2],-r[1],0);a.len()>0?a.normalize():a=new bt(0,1,0);const l=a.clone().cross(r);for(const h of[a,l,r]){If.copy(h).scale(s);for(let d=0;d<2;d++)tn.copy(n),tn.add(If),$C(t,tn),If.negate()}return t}function jC(){return[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]]}function $C(e,t){re.WGS84.cartesianToCartographic(t,tn),e[0][0]=Math.min(e[0][0],tn[0]),e[0][1]=Math.min(e[0][1],tn[1]),e[0][2]=Math.min(e[0][2],tn[2]),e[1][0]=Math.max(e[1][0],tn[0]),e[1][1]=Math.max(e[1][1],tn[1]),e[1][2]=Math.max(e[1][2],tn[2])}new bt;new bt;new Ue;new bt;new bt;new bt;function AW(e,t){const n=e*t;return 1-Math.exp(-(n*n))}function yW(e,t){if(e.dynamicScreenSpaceError&&e.dynamicScreenSpaceErrorComputedDensity){const n=e.dynamicScreenSpaceErrorComputedDensity,s=e.dynamicScreenSpaceErrorFactor;return AW(t,n)*s}return 0}function TW(e,t,n){const s=e.tileset,i=e.parent&&e.parent.lodMetricValue||e.lodMetricValue,r=n?i:e.lodMetricValue;if(r===0)return 0;const a=Math.max(e._distanceToCamera,1e-7),{height:l,sseDenominator:h}=t,{viewDistanceScale:d}=s.options;let g=r*l*(d||1)/(a*h);return g-=yW(s,a),g}const r0=new bt,bS=new bt,ir=new bt,SS=new bt,EW=new bt,o0=new Ue,RS=new Ue;function bW(e,t){if(e.lodMetricValue===0||isNaN(e.lodMetricValue))return"DIG";const n=2*XC(e,t);return n<2?"OUT":!e.header.children||n<=e.lodMetricValue?"DRAW":e.header.children?"DIG":"OUT"}function XC(e,t){const{topDownViewport:n}=t,s=e.header.mbs[1],i=e.header.mbs[0],r=e.header.mbs[2],a=e.header.mbs[3],l=[...e.boundingVolume.center],h=n.unprojectPosition(n.cameraPosition);re.WGS84.cartographicToCartesian(h,r0),bS.copy(r0).subtract(l).normalize(),re.WGS84.eastNorthUpToFixedFrame(l,o0),RS.copy(o0).invert(),ir.copy(r0).transform(RS);const d=Math.sqrt(ir[0]*ir[0]+ir[1]*ir[1]),g=d*d/ir[2];SS.copy([ir[0],ir[1],g]);const m=SS.transform(o0).subtract(l).normalize(),E=bS.cross(m).normalize().scale(a).add(l),b=re.WGS84.cartesianToCartographic(E),R=n.project([i,s,r]),M=n.project(b);return EW.copy(R).subtract(M).magnitude()}function SW(e){return{assetGltfUpAxis:e.asset&&e.asset.gltfUpAxis||"Y"}}class vS{constructor(t=0){T(this,"_map",new Map);T(this,"_array");T(this,"_length");this._array=new Array(t),this._length=t}get length(){return this._length}set length(t){this._length=t,t>this._array.length&&(this._array.length=t)}get values(){return this._array}get(t){return to(t<this._array.length),this._array[t]}set(t,n){to(t>=0),t>=this.length&&(this.length=t+1),this._map.has(this._array[t])&&this._map.delete(this._array[t]),this._array[t]=n,this._map.set(n,t)}delete(t){const n=this._map.get(t);n>=0&&(this._array.splice(n,1),this._map.delete(t),this.length--)}peek(){return this._array[this._length-1]}push(t){if(!this._map.has(t)){const n=this.length++;this._array[n]=t,this._map.set(t,n)}}pop(){const t=this._array[--this.length];return this._map.delete(t),t}reserve(t){to(t>=0),t>this._array.length&&(this._array.length=t)}resize(t){to(t>=0),this.length=t}trim(t){t==null&&(t=this.length),this._array.length=t}reset(){this._array=[],this._map=new Map,this._length=0}find(t){return this._map.has(t)}}const RW={loadSiblings:!1,skipLevelOfDetail:!1,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:""};class $d{constructor(t){T(this,"options");T(this,"root",null);T(this,"selectedTiles",{});T(this,"requestedTiles",{});T(this,"emptyTiles",{});T(this,"lastUpdate",new Date().getTime());T(this,"updateDebounceTime",1e3);T(this,"_traversalStack",new vS);T(this,"_emptyTraversalStack",new vS);T(this,"_frameNumber",null);this.options={...RW,...t}}traversalFinished(t){return!0}traverse(t,n,s){this.root=t,this.options={...this.options,...s},this.reset(),this.updateTile(t,n),this._frameNumber=n.frameNumber,this.executeTraversal(t,n)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(t,n){const s=this._traversalStack;for(t._selectionDepth=1,s.push(t);s.length>0;){const r=s.pop();let a=!1;this.canTraverse(r,n)&&(this.updateChildTiles(r,n),a=this.updateAndPushChildren(r,n,s,r.hasRenderContent?r._selectionDepth+1:r._selectionDepth));const l=r.parent,h=!!(!l||l._shouldRefine),d=!a;r.hasRenderContent?r.refine===gs.ADD?(this.loadTile(r,n),this.selectTile(r,n)):r.refine===gs.REPLACE&&(this.loadTile(r,n),d&&this.selectTile(r,n)):(this.emptyTiles[r.id]=r,this.loadTile(r,n),d&&this.selectTile(r,n)),this.touchTile(r,n),r._shouldRefine=a&&h}const i=new Date().getTime();(this.traversalFinished(n)||i-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=i,this.options.onTraversalEnd(n))}updateChildTiles(t,n){const s=t.children;for(const i of s)this.updateTile(i,n)}updateAndPushChildren(t,n,s,i){const{loadSiblings:r,skipLevelOfDetail:a}=this.options,l=t.children;l.sort(this.compareDistanceToCamera.bind(this));const h=t.refine===gs.REPLACE&&t.hasRenderContent&&!a;let d=!1,g=!0;for(const _ of l)if(_._selectionDepth=i,_.isVisibleAndInRequestVolume?(s.find(_)&&s.delete(_),s.push(_),d=!0):(h||r)&&(this.loadTile(_,n),this.touchTile(_,n)),h){let m;if(_._inRequestVolume?_.hasRenderContent?m=_.contentAvailable:m=this.executeEmptyTraversal(_,n):m=!1,g=g&&m,!g)return!1}return d||(g=!1),g}updateTile(t,n){this.updateTileVisibility(t,n)}selectTile(t,n){this.shouldSelectTile(t)&&(t._selectedFrame=n.frameNumber,this.selectedTiles[t.id]=t)}loadTile(t,n){this.shouldLoadTile(t)&&(t._requestedFrame=n.frameNumber,t._priority=t._getPriority(),this.requestedTiles[t.id]=t)}touchTile(t,n){t.tileset._cache.touch(t),t._touchedFrame=n.frameNumber}canTraverse(t,n){return t.hasChildren?t.hasTilesetContent?!t.contentExpired:this.shouldRefine(t,n):!1}shouldLoadTile(t){return t.hasUnloadedContent||t.contentExpired}shouldSelectTile(t){return t.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(t,n,s=!1){let i=t._screenSpaceError;return s&&(i=t.getScreenSpaceError(n,!0)),i>t.tileset.memoryAdjustedScreenSpaceError}updateTileVisibility(t,n){const s=[];if(this.options.viewportTraversersMap)for(const i in this.options.viewportTraversersMap)this.options.viewportTraversersMap[i]===n.viewport.id&&s.push(i);else s.push(n.viewport.id);t.updateVisibility(n,s)}compareDistanceToCamera(t,n){return t._distanceToCamera-n._distanceToCamera}anyChildrenVisible(t,n){let s=!1;for(const i of t.children)i.updateVisibility(n),s=s||i.isVisibleAndInRequestVolume;return s}executeEmptyTraversal(t,n){let s=!0;const i=this._emptyTraversalStack;for(i.push(t);i.length>0;){const r=i.pop(),a=!r.hasRenderContent&&this.canTraverse(r,n),l=!r.hasRenderContent&&r.children.length===0;if(!a&&!r.contentAvailable&&!l&&(s=!1),this.updateTile(r,n),r.isVisibleAndInRequestVolume||(this.loadTile(r,n),this.touchTile(r,n)),a){const h=r.children;for(const d of h)i.push(d)}}return s}}const CS=new bt;function vW(e){return e!=null}class vm{constructor(t,n,s,i=""){T(this,"tileset");T(this,"header");T(this,"id");T(this,"url");T(this,"parent");T(this,"refine");T(this,"type");T(this,"contentUrl");T(this,"lodMetricType","geometricError");T(this,"lodMetricValue",0);T(this,"boundingVolume",null);T(this,"content",null);T(this,"contentState",Pn.UNLOADED);T(this,"gpuMemoryUsageInBytes",0);T(this,"children",[]);T(this,"depth",0);T(this,"viewportIds",[]);T(this,"transform",new Ue);T(this,"extensions",null);T(this,"implicitTiling",null);T(this,"userData",{});T(this,"computedTransform");T(this,"hasEmptyContent",!1);T(this,"hasTilesetContent",!1);T(this,"traverser",new $d({}));T(this,"_cacheNode",null);T(this,"_frameNumber",null);T(this,"_expireDate",null);T(this,"_expiredContent",null);T(this,"_boundingBox");T(this,"_distanceToCamera",0);T(this,"_screenSpaceError",0);T(this,"_visibilityPlaneMask");T(this,"_visible");T(this,"_contentBoundingVolume");T(this,"_viewerRequestVolume");T(this,"_initialTransform",new Ue);T(this,"_priority",0);T(this,"_selectedFrame",0);T(this,"_requestedFrame",0);T(this,"_selectionDepth",0);T(this,"_touchedFrame",0);T(this,"_centerZDepth",0);T(this,"_shouldRefine",!1);T(this,"_stackLength",0);T(this,"_visitedFrame",0);T(this,"_inRequestVolume",!1);T(this,"_lodJudge",null);this.header=n,this.tileset=t,this.id=i||n.id,this.url=n.url,this.parent=s,this.refine=this._getRefine(n.refine),this.type=n.type,this.contentUrl=n.contentUrl,this._initializeLodMetric(n),this._initializeTransforms(n),this._initializeBoundingVolumes(n),this._initializeContent(n),this._initializeRenderingState(n),Object.seal(this)}destroy(){this.header=null}isDestroyed(){return this.header===null}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return this.contentState===Pn.READY||this.hasEmptyContent}get contentAvailable(){return!!(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return this.contentState===Pn.UNLOADED}get contentExpired(){return this.contentState===Pn.EXPIRED}get contentFailed(){return this.contentState===Pn.FAILED}get distanceToCamera(){return this._distanceToCamera}get screenSpaceError(){return this._screenSpaceError}get boundingBox(){return this._boundingBox||(this._boundingBox=dW(this.header.boundingVolume,this.boundingVolume)),this._boundingBox}getScreenSpaceError(t,n){switch(this.tileset.type){case _n.I3S:return XC(this,t);case _n.TILES3D:return TW(this,t,n);default:throw new Error("Unsupported tileset type")}}unselect(){this._selectedFrame=0}_getGpuMemoryUsageInBytes(){return this.content.gpuMemoryUsageInBytes||this.content.byteLength||0}_getPriority(){const t=this.tileset._traverser,{skipLevelOfDetail:n}=t.options,s=this.refine===gs.ADD||n;if(s&&!this.isVisible&&this._visible!==void 0||this.tileset._frameNumber-this._touchedFrame>=1||this.contentState===Pn.UNLOADED)return-1;const i=this.parent,a=i&&(!s||this._screenSpaceError===0||i.hasTilesetContent)?i._screenSpaceError:this._screenSpaceError,l=t.root?t.root._screenSpaceError:0;return Math.max(l-a,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=Pn.LOADING;const n=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!n)return this.contentState=Pn.UNLOADED,!1;try{const s=this.tileset.getTileUrl(this.contentUrl),i=this.tileset.loader,r={...this.tileset.loadOptions,[i.id]:{...this.tileset.loadOptions[i.id],isTileset:this.type==="json",...this._getLoaderSpecificOptions(i.id)}};return this.content=await gr(s,i,r),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=Pn.READY,this._onContentLoaded(),!0}catch(s){throw this.contentState=Pn.FAILED,s}finally{n.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=Pn.UNLOADED,!0}updateVisibility(t,n){if(this._frameNumber===t.frameNumber)return;const s=this.parent,i=s?s._visibilityPlaneMask:Jn.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){const r=s?s.computedTransform:this.tileset.modelMatrix;this._updateTransform(r)}this._distanceToCamera=this.distanceToTile(t),this._screenSpaceError=this.getScreenSpaceError(t,!1),this._visibilityPlaneMask=this.visibility(t,i),this._visible=this._visibilityPlaneMask!==Jn.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(t),this._frameNumber=t.frameNumber,this.viewportIds=n}visibility(t,n){const{cullingVolume:s}=t,{boundingVolume:i}=this;return s.computeVisibilityWithPlaneMask(i,n)}contentVisibility(){return!0}distanceToTile(t){const n=this.boundingVolume;return Math.sqrt(Math.max(n.distanceSquaredTo(t.camera.position),0))}cameraSpaceZDepth({camera:t}){const n=this.boundingVolume;return CS.subVectors(n.center,t.position),t.direction.dot(CS)}insideViewerRequestVolume(t){const n=this._viewerRequestVolume;return!n||n.distanceSquaredTo(t.camera.position)<=0}updateExpiration(){if(vW(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){const t=Date.now();Date.lessThan(this._expireDate,t)&&(this.contentState=Pn.EXPIRED,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(t){"lodMetricType"in t?this.lodMetricType=t.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in t?this.lodMetricValue=t.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}_initializeTransforms(t){this.transform=t.transform?new Ue(t.transform):new Ue;const n=this.parent,s=this.tileset,i=n&&n.computedTransform?n.computedTransform.clone():s.modelMatrix.clone();this.computedTransform=new Ue(i).multiplyRight(this.transform);const r=n&&n._initialTransform?n._initialTransform.clone():new Ue;this._initialTransform=new Ue(r).multiplyRight(this.transform)}_initializeBoundingVolumes(t){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(t)}_initializeContent(t){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=Pn.UNLOADED,this.hasTilesetContent=!1,t.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(t){this.depth=t.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=Jn.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(t){return t||this.parent&&this.parent.refine||gs.REPLACE}_isTileset(){return this.contentUrl.indexOf(".json")!==-1}_onContentLoaded(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0;break}this._isTileset()?this.hasTilesetContent=!0:this.gpuMemoryUsageInBytes=this._getGpuMemoryUsageInBytes()}_updateBoundingVolume(t){this.boundingVolume=i0(t.boundingVolume,this.computedTransform,this.boundingVolume);const n=t.content;n&&(n.boundingVolume&&(this._contentBoundingVolume=i0(n.boundingVolume,this.computedTransform,this._contentBoundingVolume)),t.viewerRequestVolume&&(this._viewerRequestVolume=i0(t.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(t=new Ue){const n=t.clone().multiplyRight(this.transform);n.equals(this.computedTransform)||(this.computedTransform=n,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(t){switch(t){case"i3s":return{...this.tileset.options.i3s,_tileOptions:{attributeUrls:this.header.attributeUrls,textureUrl:this.header.textureUrl,textureFormat:this.header.textureFormat,textureLoaderOptions:this.header.textureLoaderOptions,materialDefinition:this.header.materialDefinition,isDracoGeometry:this.header.isDracoGeometry,mbs:this.header.mbs},_tilesetOptions:{store:this.tileset.tileset.store,attributeStorageInfo:this.tileset.tileset.attributeStorageInfo,fields:this.tileset.tileset.fields},isTileHeader:!1};case"3d-tiles":case"cesium-ion":default:return SW(this.tileset.tileset)}}}class CW extends $d{compareDistanceToCamera(t,n){return n._distanceToCamera===0&&t._distanceToCamera===0?n._centerZDepth-t._centerZDepth:n._distanceToCamera-t._distanceToCamera}updateTileVisibility(t,n){if(super.updateTileVisibility(t,n),!t.isVisibleAndInRequestVolume)return;const s=t.children.length>0;if(t.hasTilesetContent&&s){const a=t.children[0];this.updateTileVisibility(a,n),t._visible=a._visible;return}if(this.meetsScreenSpaceErrorEarly(t,n)){t._visible=!1;return}const i=t.refine===gs.REPLACE,r=t._optimChildrenWithinParent===uW.USE_OPTIMIZATION;if(i&&r&&s&&!this.anyChildrenVisible(t,n)){t._visible=!1;return}}meetsScreenSpaceErrorEarly(t,n){const{parent:s}=t;return!s||s.hasTilesetContent||s.refine!==gs.ADD?!1:!this.shouldRefine(t,n,!0)}}class MW{constructor(){T(this,"frameNumberMap",new Map)}register(t,n){const s=this.frameNumberMap.get(t)||new Map,i=s.get(n)||0;s.set(n,i+1),this.frameNumberMap.set(t,s)}deregister(t,n){const s=this.frameNumberMap.get(t);if(!s)return;const i=s.get(n)||1;s.set(n,i-1)}isZero(t,n){var i;return(((i=this.frameNumberMap.get(t))==null?void 0:i.get(n))||0)===0}}const a0={REQUESTED:"REQUESTED",COMPLETED:"COMPLETED",ERROR:"ERROR"};class wW{constructor(){T(this,"_statusMap");T(this,"pendingTilesRegister",new MW);this._statusMap={}}add(t,n,s,i){if(!this._statusMap[n]){const{frameNumber:r,viewport:{id:a}}=i;this._statusMap[n]={request:t,callback:s,key:n,frameState:i,status:a0.REQUESTED},this.pendingTilesRegister.register(a,r),t().then(l=>{this._statusMap[n].status=a0.COMPLETED;const{frameNumber:h,viewport:{id:d}}=this._statusMap[n].frameState;this.pendingTilesRegister.deregister(d,h),this._statusMap[n].callback(l,i)}).catch(l=>{this._statusMap[n].status=a0.ERROR;const{frameNumber:h,viewport:{id:d}}=this._statusMap[n].frameState;this.pendingTilesRegister.deregister(d,h),s(l)})}}update(t,n){if(this._statusMap[t]){const{frameNumber:s,viewport:{id:i}}=this._statusMap[t].frameState;this.pendingTilesRegister.deregister(i,s);const{frameNumber:r,viewport:{id:a}}=n;this.pendingTilesRegister.register(a,r),this._statusMap[t].frameState=n}}find(t){return this._statusMap[t]}hasPendingTiles(t,n){return!this.pendingTilesRegister.isZero(t,n)}}class OW extends $d{constructor(n){super(n);T(this,"_tileManager");this._tileManager=new wW}traversalFinished(n){return!this._tileManager.hasPendingTiles(n.viewport.id,this._frameNumber||0)}shouldRefine(n,s){return n._lodJudge=bW(n,s),n._lodJudge==="DIG"}updateChildTiles(n,s){const i=n.header.children||[],r=n.children,a=n.tileset;for(const l of i){const h=`${l.id}-${s.viewport.id}`,d=r&&r.find(g=>g.id===h);if(d)d&&this.updateTile(d,s);else{let g=()=>this._loadTile(l.id,a);this._tileManager.find(h)?this._tileManager.update(h,s):(a.tileset.nodePages&&(g=()=>a.tileset.nodePagesTile.formTileFromNodePages(l.id)),this._tileManager.add(g,h,m=>this._onTileLoad(m,n,h),s))}}return!1}async _loadTile(n,s){const{loader:i}=s,r=s.getTileUrl(`${s.url}/nodes/${n}`),a={...s.loadOptions,i3s:{...s.loadOptions.i3s,isTileHeader:!0}};return await gr(r,i,a)}_onTileLoad(n,s,i){const r=new vm(s.tileset,n,s,i);s.children.push(r);const a=this._tileManager.find(r.id).frameState;this.updateTile(r,a),this._frameNumber===a.frameNumber&&(this.traversalFinished(a)||new Date().getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(r,a)}}const BW={description:"",ellipsoid:re.WGS84,modelMatrix:new Ue,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,memoryCacheOverflow:1,maximumTilesSelected:0,debounceTime:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:e=>e,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,memoryAdjustedScreenSpaceError:!1,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},lf="Tiles In Tileset(s)",c0="Tiles In Memory",MS="Tiles In View",wS="Tiles To Render",OS="Tiles Loaded",l0="Tiles Loading",BS="Tiles Unloaded",xS="Failed Tile Loads",NS="Points/Vertices",u0="Tile Memory Use",IS="Maximum Screen Space Error";class xW{constructor(t,n){T(this,"options");T(this,"loadOptions");T(this,"type");T(this,"tileset");T(this,"loader");T(this,"url");T(this,"basePath");T(this,"modelMatrix");T(this,"ellipsoid");T(this,"lodMetricType");T(this,"lodMetricValue");T(this,"refine");T(this,"root",null);T(this,"roots",{});T(this,"asset",{});T(this,"description","");T(this,"properties");T(this,"extras",null);T(this,"attributions",{});T(this,"credits",{});T(this,"stats");T(this,"contentFormats",{draco:!1,meshopt:!1,dds:!1,ktx2:!1});T(this,"cartographicCenter",null);T(this,"cartesianCenter",null);T(this,"zoom",1);T(this,"boundingVolume",null);T(this,"dynamicScreenSpaceErrorComputedDensity",0);T(this,"maximumMemoryUsage",32);T(this,"gpuMemoryUsageInBytes",0);T(this,"memoryAdjustedScreenSpaceError",0);T(this,"_cacheBytes",0);T(this,"_cacheOverflowBytes",0);T(this,"_frameNumber",0);T(this,"_queryParams",{});T(this,"_extensionsUsed",[]);T(this,"_tiles",{});T(this,"_pendingCount",0);T(this,"selectedTiles",[]);T(this,"traverseCounter",0);T(this,"geometricError",0);T(this,"lastUpdatedVieports",null);T(this,"_requestedTiles",[]);T(this,"_emptyTiles",[]);T(this,"frameStateData",{});T(this,"_traverser");T(this,"_cache",new tW);T(this,"_requestScheduler");T(this,"updatePromise",null);T(this,"tilesetInitializationPromise");this.options={...BW,...n},this.tileset=t,this.loader=t.loader,this.type=t.type,this.url=t.url,this.basePath=t.basePath||JG(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=t.lodMetricType,this.lodMetricValue=t.lodMetricValue,this.refine=t.root.refine,this.loadOptions=this.options.loadOptions||{},this._traverser=this._initializeTraverser(),this._requestScheduler=new KG({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this.memoryAdjustedScreenSpaceError=this.options.maximumScreenSpaceError,this._cacheBytes=this.options.maximumMemoryUsage*1024*1024,this._cacheOverflowBytes=this.options.memoryCacheOverflow*1024*1024,this.stats=new Za({id:this.url}),this._initializeStats(),this.tilesetInitializationPromise=this._initializeTileSet(t)}destroy(){this._destroy()}isLoaded(){return this._pendingCount===0&&this._frameNumber!==0&&this._requestedTiles.length===0}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return new URLSearchParams(this._queryParams).toString()}setProps(t){this.options={...this.options,...t}}getTileUrl(t){if(t.startsWith("data:"))return t;let s=t;return this.queryParams.length&&(s=`${t}${t.includes("?")?"&":"?"}${this.queryParams}`),s}hasExtension(t){return this._extensionsUsed.indexOf(t)>-1}update(t=null){this.tilesetInitializationPromise.then(()=>{!t&&this.lastUpdatedVieports?t=this.lastUpdatedVieports:this.lastUpdatedVieports=t,t&&this.doUpdate(t)})}async selectTiles(t=null){return await this.tilesetInitializationPromise,t&&(this.lastUpdatedVieports=t),this.updatePromise||(this.updatePromise=new Promise(n=>{setTimeout(()=>{this.lastUpdatedVieports&&this.doUpdate(this.lastUpdatedVieports),n(this._frameNumber),this.updatePromise=null},this.options.debounceTime)})),this.updatePromise}adjustScreenSpaceError(){this.gpuMemoryUsageInBytes<this._cacheBytes?this.memoryAdjustedScreenSpaceError=Math.max(this.memoryAdjustedScreenSpaceError/1.02,this.options.maximumScreenSpaceError):this.gpuMemoryUsageInBytes>this._cacheBytes+this._cacheOverflowBytes&&(this.memoryAdjustedScreenSpaceError*=1.02)}doUpdate(t){if("loadTiles"in this.options&&!this.options.loadTiles||this.traverseCounter>0)return;const n=t instanceof Array?t:[t];this._cache.reset(),this._frameNumber++,this.traverseCounter=n.length;const s=[];for(const i of n){const r=i.id;this._needTraverse(r)?s.push(r):this.traverseCounter--}for(const i of n){const r=i.id;if(this.roots[r]||(this.roots[r]=this._initializeTileHeaders(this.tileset,null)),!s.includes(r))continue;const a=nW(i,this._frameNumber);this._traverser.traverse(this.roots[r],a,this.options)}}_needTraverse(t){let n=t;return this.options.viewportTraversersMap&&(n=this.options.viewportTraversersMap[t]),n===t}_onTraversalEnd(t){const n=t.viewport.id;this.frameStateData[n]||(this.frameStateData[n]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});const s=this.frameStateData[n],i=Object.values(this._traverser.selectedTiles),[r,a]=sW(i,t,this.options.maximumTilesSelected);s.selectedTiles=r;for(const l of a)l.unselect();s._requestedTiles=Object.values(this._traverser.requestedTiles),s._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,!(this.traverseCounter>0)&&this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(const t in this.frameStateData){const n=this.frameStateData[t];this.selectedTiles=this.selectedTiles.concat(n.selectedTiles),this._requestedTiles=this._requestedTiles.concat(n._requestedTiles),this._emptyTiles=this._emptyTiles.concat(n._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(const t of this.selectedTiles)this._tiles[t.id]=t;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(t,n){if(t.length!==n.length)return!0;const s=new Set(t.map(a=>a.id)),i=new Set(n.map(a=>a.id));let r=t.filter(a=>!i.has(a.id)).length>0;return r=r||n.filter(a=>!s.has(a.id)).length>0,r}_loadTiles(){for(const t of this._requestedTiles)t.contentUnloaded&&this._loadTile(t)}_unloadTiles(){this._cache.unloadTiles(this,(t,n)=>t._unloadTile(n))}_updateStats(){let t=0,n=0;for(const s of this.selectedTiles)s.contentAvailable&&s.content&&(t++,s.content.pointCount?n+=s.content.pointCount:n+=s.content.vertexCount);this.stats.get(MS).count=this.selectedTiles.length,this.stats.get(wS).count=t,this.stats.get(NS).count=n,this.stats.get(IS).count=this.memoryAdjustedScreenSpaceError}async _initializeTileSet(t){this.type===_n.I3S&&(this.calculateViewPropsI3S(),t.root=await t.root),this.root=this._initializeTileHeaders(t,null),this.type===_n.TILES3D&&(this._initializeTiles3DTileset(t),this.calculateViewPropsTiles3D()),this.type===_n.I3S&&this._initializeI3STileset()}calculateViewPropsI3S(){var s;const t=this.tileset.fullExtent;if(t){const{xmin:i,xmax:r,ymin:a,ymax:l,zmin:h,zmax:d}=t;this.cartographicCenter=new bt(i+(r-i)/2,a+(l-a)/2,h+(d-h)/2),this.cartesianCenter=new bt,re.WGS84.cartographicToCartesian(this.cartographicCenter,this.cartesianCenter),this.zoom=zC(t,this.cartographicCenter,this.cartesianCenter);return}const n=(s=this.tileset.store)==null?void 0:s.extent;if(n){const[i,r,a,l]=n;this.cartographicCenter=new bt(i+(a-i)/2,r+(l-r)/2,0),this.cartesianCenter=new bt,re.WGS84.cartographicToCartesian(this.cartographicCenter,this.cartesianCenter),this.zoom=cW(n,this.cartographicCenter,this.cartesianCenter);return}console.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new bt,this.zoom=1}calculateViewPropsTiles3D(){const t=this.root,{center:n}=t.boundingVolume;if(!n){console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new bt,this.zoom=1;return}n[0]!==0||n[1]!==0||n[2]!==0?(this.cartographicCenter=new bt,re.WGS84.cartesianToCartographic(n,this.cartographicCenter)):this.cartographicCenter=new bt(0,0,-re.WGS84.radii[0]),this.cartesianCenter=n,this.zoom=aW(t.boundingVolume,this.cartographicCenter)}_initializeStats(){this.stats.get(lf),this.stats.get(l0),this.stats.get(c0),this.stats.get(MS),this.stats.get(wS),this.stats.get(OS),this.stats.get(BS),this.stats.get(xS),this.stats.get(NS),this.stats.get(u0,"memory"),this.stats.get(IS)}_initializeTileHeaders(t,n){var i;const s=new vm(this,t.root,n);if(n&&(n.children.push(s),s.depth=n.depth+1),this.type===_n.TILES3D){const r=[];for(r.push(s);r.length>0;){const a=r.pop();this.stats.get(lf).incrementCount();const l=a.header.children||[];for(const h of l){const d=new vm(this,h,a);if((i=d.contentUrl)!=null&&i.includes("?session=")){const _=new URL(d.contentUrl).searchParams.get("session");_&&(this._queryParams.session=_)}a.children.push(d),d.depth=a.depth+1,r.push(d)}}}return s}_initializeTraverser(){let t;switch(this.type){case _n.TILES3D:t=CW;break;case _n.I3S:t=OW;break;default:t=$d}return new t({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(t){this._destroySubtree(t)}async _loadTile(t){let n;try{this._onStartTileLoading(),n=await t.loadContent()}catch(s){this._onTileLoadError(t,s instanceof Error?s:new Error("load failed"))}finally{this._onEndTileLoading(),this._onTileLoad(t,n)}}_onTileLoadError(t,n){this.stats.get(xS).incrementCount();const s=n.message||n.toString(),i=t.url;console.error(`A 3D tile failed to load: ${t.url} ${s}`),this.options.onTileError(t,s,i)}_onTileLoad(t,n){var s,i;if(n){if(this.type===_n.I3S){const r=((i=(s=this.tileset)==null?void 0:s.nodePagesTile)==null?void 0:i.nodesInNodePages)||0;this.stats.get(lf).reset(),this.stats.get(lf).addCount(r)}t&&t.content&&eW(t,t.content),this.updateContentTypes(t),this._addTileToCache(t),this.options.onTileLoad(t)}}updateContentTypes(t){var n;if(this.type===_n.I3S)switch(t.header.isDracoGeometry&&(this.contentFormats.draco=!0),t.header.textureFormat){case"dds":this.contentFormats.dds=!0;break;case"ktx2":this.contentFormats.ktx2=!0;break}else if(this.type===_n.TILES3D){const{extensionsRemoved:s=[]}=((n=t.content)==null?void 0:n.gltf)||{};s.includes("KHR_draco_mesh_compression")&&(this.contentFormats.draco=!0),s.includes("EXT_meshopt_compression")&&(this.contentFormats.meshopt=!0),s.includes("KHR_texture_basisu")&&(this.contentFormats.ktx2=!0)}}_onStartTileLoading(){this._pendingCount++,this.stats.get(l0).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(l0).decrementCount()}_addTileToCache(t){this._cache.add(this,t,n=>n._updateCacheStats(t))}_updateCacheStats(t){this.stats.get(OS).incrementCount(),this.stats.get(c0).incrementCount(),this.gpuMemoryUsageInBytes+=t.gpuMemoryUsageInBytes||0,this.stats.get(u0).count=this.gpuMemoryUsageInBytes,this.options.memoryAdjustedScreenSpaceError&&this.adjustScreenSpaceError()}_unloadTile(t){this.gpuMemoryUsageInBytes-=t.gpuMemoryUsageInBytes||0,this.stats.get(c0).decrementCount(),this.stats.get(BS).incrementCount(),this.stats.get(u0).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(t),t.unloadContent()}_destroy(){const t=[];for(this.root&&t.push(this.root);t.length>0;){const n=t.pop();for(const s of n.children)t.push(s);this._destroyTile(n)}this.root=null}_destroySubtree(t){const n=t,s=[];for(s.push(n);s.length>0;){t=s.pop();for(const i of t.children)s.push(i);t!==n&&this._destroyTile(t)}n.children=[]}_destroyTile(t){this._cache.unloadTile(this,t),this._unloadTile(t),t.destroy()}_initializeTiles3DTileset(t){if(t.queryString){const n=new URLSearchParams(t.queryString),s=Object.fromEntries(n.entries());this._queryParams={...this._queryParams,...s}}if(this.asset=t.asset,!this.asset)throw new Error("Tileset must have an asset property.");if(this.asset.version!=="0.0"&&this.asset.version!=="1.0"&&this.asset.version!=="1.1")throw new Error("The tileset must be 3D Tiles version either 0.0 or 1.0 or 1.1.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=t.properties,this.geometricError=t.geometricError,this._extensionsUsed=t.extensionsUsed||[],this.extras=t.extras}_initializeI3STileset(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}async function R1(e,t,n,s){return s._parse(e,t,n,s)}function ls(e,t){if(!e)throw new Error(t||"loader assertion failed.")}function NW(e,t,n){const s=n!==void 0?new Uint8Array(e).subarray(t,t+n):new Uint8Array(e).subarray(t);return new Uint8Array(s).buffer}function IW(){var t;if(typeof process<"u"&&typeof process.cwd<"u")return process.cwd();const e=(t=window.location)==null?void 0:t.pathname;return(e==null?void 0:e.slice(0,e.lastIndexOf("/")+1))||""}function DW(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}function PW(...e){const t=[];for(let r=0;r<e.length;r++)t[r]=e[r];let n="",s=!1,i;for(let r=t.length-1;r>=-1&&!s;r--){let a;r>=0?a=t[r]:(i===void 0&&(i=IW()),a=i),a.length!==0&&(n=`${a}/${n}`,s=a.charCodeAt(0)===Al)}return n=FW(n,!s),s?`/${n}`:n.length>0?n:"."}const Al=47,h0=46;function FW(e,t){let n="",s=-1,i=0,r,a=!1;for(let l=0;l<=e.length;++l){if(l<e.length)r=e.charCodeAt(l);else{if(r===Al)break;r=Al}if(r===Al){if(!(s===l-1||i===1))if(s!==l-1&&i===2){if(n.length<2||!a||n.charCodeAt(n.length-1)!==h0||n.charCodeAt(n.length-2)!==h0){if(n.length>2){const h=n.length-1;let d=h;for(;d>=0&&n.charCodeAt(d)!==Al;--d);if(d!==h){n=d===-1?"":n.slice(0,d),s=l,i=0,a=!1;continue}}else if(n.length===2||n.length===1){n="",s=l,i=0,a=!1;continue}}t&&(n.length>0?n+="/..":n="..",a=!0)}else{const h=e.slice(s+1,l);n.length>0?n+=`/${h}`:n=h,a=!1}s=l,i=0}else r===h0&&i!==-1?++i:i=-1}return n}const GC="4.3.2",hl={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GLTF:"glTF"};function WC(e,t,n){ls(e instanceof ArrayBuffer);const s=new TextDecoder("utf8"),i=new Uint8Array(e,t,n);return s.decode(i)}function UW(e,t=0){const n=new DataView(e);return`${String.fromCharCode(n.getUint8(t+0))}${String.fromCharCode(n.getUint8(t+1))}${String.fromCharCode(n.getUint8(t+2))}${String.fromCharCode(n.getUint8(t+3))}`}const LW={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Re={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},Ft={...LW,...Re},f0={[Re.DOUBLE]:Float64Array,[Re.FLOAT]:Float32Array,[Re.UNSIGNED_SHORT]:Uint16Array,[Re.UNSIGNED_INT]:Uint32Array,[Re.UNSIGNED_BYTE]:Uint8Array,[Re.BYTE]:Int8Array,[Re.SHORT]:Int16Array,[Re.INT]:Int32Array},kW={DOUBLE:Re.DOUBLE,FLOAT:Re.FLOAT,UNSIGNED_SHORT:Re.UNSIGNED_SHORT,UNSIGNED_INT:Re.UNSIGNED_INT,UNSIGNED_BYTE:Re.UNSIGNED_BYTE,BYTE:Re.BYTE,SHORT:Re.SHORT,INT:Re.INT},d0="Failed to convert GL type";class js{static fromTypedArray(t){t=ArrayBuffer.isView(t)?t.constructor:t;for(const n in f0)if(f0[n]===t)return n;throw new Error(d0)}static fromName(t){const n=kW[t];if(!n)throw new Error(d0);return n}static getArrayType(t){switch(t){case Re.UNSIGNED_SHORT_5_6_5:case Re.UNSIGNED_SHORT_4_4_4_4:case Re.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const n=f0[t];if(!n)throw new Error(d0);return n}}static getByteSize(t){return js.getArrayType(t).BYTES_PER_ELEMENT}static validate(t){return!!js.getArrayType(t)}static createTypedArray(t,n,s=0,i){i===void 0&&(i=(n.byteLength-s)/js.getByteSize(t));const r=js.getArrayType(t);return new r(n,s,i)}}const zW={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...zW}};const ns=globalThis.mathgl.config;function VW(e,{precision:t=ns.precision}={}){return e=jW(e),`${parseFloat(e.toPrecision(t))}`}function qa(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function HW(e,t,n){return XW(e,s=>Math.max(t,Math.min(n,s)))}function qC(e,t,n){const s=ns.EPSILON;try{if(e===t)return!0;if(qa(e)&&qa(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!qC(e[i],t[i]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<=ns.EPSILON*Math.max(1,Math.abs(e),Math.abs(t)):!1}finally{ns.EPSILON=s}}function jW(e){return Math.round(e/ns.EPSILON)*ns.EPSILON}function $W(e){return e.clone?e.clone():new Array(e.length)}function XW(e,t,n){if(qa(e)){const s=e;n=n||$W(s);for(let i=0;i<n.length&&i<s.length;++i){const r=typeof e=="number"?e:e[i];n[i]=t(r,i,n)}return n}return t(e)}let GW=class extends Array{clone(){return new this.constructor().copy(this)}fromArray(t,n=0){for(let s=0;s<this.ELEMENTS;++s)this[s]=t[s+n];return this.check()}toArray(t=[],n=0){for(let s=0;s<this.ELEMENTS;++s)t[n+s]=this[s];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:qa(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(ns)}formatString(t){let n="";for(let s=0;s<this.ELEMENTS;++s)n+=(s>0?", ":"")+VW(this[s],t);return`${t.printTypes?this.constructor.name:""}[${n}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!qC(this[n],t[n]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==t[n])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,n,s){if(s===void 0)return this.lerp(this,t,n);for(let i=0;i<this.ELEMENTS;++i){const r=t[i],a=typeof n=="number"?n:n[i];this[i]=r+s*(a-r)}return this.check()}min(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(t[n],this[n]);return this.check()}max(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(t[n],this[n]);return this.check()}clamp(t,n){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t[s]),n[s]);return this.check()}add(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]+=n[s];return this.check()}subtract(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]-=n[s];return this.check()}scale(t){if(typeof t=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;else for(let n=0;n<this.ELEMENTS&&n<t.length;++n)this[n]*=t[n];return this.check()}multiplyByScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;return this.check()}check(){if(ns.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)t=t&&Number.isFinite(this[n]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=t;return this.check()}addScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,n){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t),n);return this.check()}get elements(){return this}};function en(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function DS(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}let YC=class extends GW{get x(){return this[0]}set x(t){this[0]=en(t)}get y(){return this[1]}set y(t){this[1]=en(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*this[n];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let n=0;for(let s=0;s<this.ELEMENTS;++s){const i=this[s]-t[s];n+=i*i}return en(n)}dot(t){let n=0;for(let s=0;s<this.ELEMENTS;++s)n+=this[s]*t[s];return en(n)}normalize(){const t=this.magnitude();if(t!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=t;return this.check()}multiply(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]*=n[s];return this.check()}divide(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]/=n[s];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return DS(t>=0&&t<this.ELEMENTS,"index is out of range"),en(this[t])}setComponent(t,n){return DS(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=n,this.check()}addVectors(t,n){return this.copy(t).add(n)}subVectors(t,n){return this.copy(t).subtract(n)}multiplyVectors(t,n){return this.copy(t).multiply(n)}addScaledVector(t,n){return this.add(new this.constructor(t).multiplyScalar(n))}},ud=typeof Float32Array<"u"?Float32Array:Array;function WW(){const e=new ud(2);return ud!=Float32Array&&(e[0]=0,e[1]=0),e}function qW(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[2]*i,e[1]=n[1]*s+n[3]*i,e}function YW(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[2]*i+n[4],e[1]=n[1]*s+n[3]*i+n[5],e}function KW(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[3]*i+n[6],e[1]=n[1]*s+n[4]*i+n[7],e}function JW(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[4]*i+n[12],e[1]=n[1]*s+n[5]*i+n[13],e}(function(){const e=WW();return function(t,n,s,i,r,a){let l,h;for(n||(n=2),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],r(e,e,a),t[l]=e[0],t[l+1]=e[1];return t}})();function ZW(e,t,n){const s=t[0],i=t[1],r=n[3]*s+n[7]*i||1;return e[0]=(n[0]*s+n[4]*i)/r,e[1]=(n[1]*s+n[5]*i)/r,e}function QW(e,t,n){const s=t[0],i=t[1],r=t[2],a=n[3]*s+n[7]*i+n[11]*r||1;return e[0]=(n[0]*s+n[4]*i+n[8]*r)/a,e[1]=(n[1]*s+n[5]*i+n[9]*r)/a,e[2]=(n[2]*s+n[6]*i+n[10]*r)/a,e}function tq(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[2]*i,e[1]=n[1]*s+n[3]*i,e[2]=t[2],e}class v1 extends YC{constructor(t=0,n=0){super(2),qa(t)&&arguments.length===1?this.copy(t):(ns.debug&&(en(t),en(n)),this[0]=t,this[1]=n)}set(t,n){return this[0]=t,this[1]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return ns.debug&&(en(t.x),en(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return JW(this,this,t),this.check()}transformAsVector(t){return ZW(this,this,t),this.check()}transformByMatrix3(t){return KW(this,this,t),this.check()}transformByMatrix2x3(t){return YW(this,this,t),this.check()}transformByMatrix2(t){return qW(this,this,t),this.check()}}function eq(){const e=new ud(3);return ud!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function nq(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function sq(e,t,n){const s=t[0],i=t[1],r=t[2],a=n[0],l=n[1],h=n[2];return e[0]=i*h-r*l,e[1]=r*a-s*h,e[2]=s*l-i*a,e}function iq(e,t,n){const s=t[0],i=t[1],r=t[2];let a=n[3]*s+n[7]*i+n[11]*r+n[15];return a=a||1,e[0]=(n[0]*s+n[4]*i+n[8]*r+n[12])/a,e[1]=(n[1]*s+n[5]*i+n[9]*r+n[13])/a,e[2]=(n[2]*s+n[6]*i+n[10]*r+n[14])/a,e}function rq(e,t,n){const s=t[0],i=t[1],r=t[2];return e[0]=s*n[0]+i*n[3]+r*n[6],e[1]=s*n[1]+i*n[4]+r*n[7],e[2]=s*n[2]+i*n[5]+r*n[8],e}function oq(e,t,n){const s=n[0],i=n[1],r=n[2],a=n[3],l=t[0],h=t[1],d=t[2];let g=i*d-r*h,_=r*l-s*d,m=s*h-i*l,y=i*m-r*_,E=r*g-s*m,b=s*_-i*g;const R=a*2;return g*=R,_*=R,m*=R,y*=2,E*=2,b*=2,e[0]=l+g+y,e[1]=h+_+E,e[2]=d+m+b,e}function aq(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[0],r[1]=i[1]*Math.cos(s)-i[2]*Math.sin(s),r[2]=i[1]*Math.sin(s)+i[2]*Math.cos(s),e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function cq(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[2]*Math.sin(s)+i[0]*Math.cos(s),r[1]=i[1],r[2]=i[2]*Math.cos(s)-i[0]*Math.sin(s),e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function lq(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[0]*Math.cos(s)-i[1]*Math.sin(s),r[1]=i[0]*Math.sin(s)+i[1]*Math.cos(s),r[2]=i[2],e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function uq(e,t){const n=e[0],s=e[1],i=e[2],r=t[0],a=t[1],l=t[2],h=Math.sqrt((n*n+s*s+i*i)*(r*r+a*a+l*l)),d=h&&nq(e,t)/h;return Math.acos(Math.min(Math.max(d,-1),1))}(function(){const e=eq();return function(t,n,s,i,r,a){let l,h;for(n||(n=3),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],r(e,e,a),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2];return t}})();const g0=[0,0,0];let uf,hq=class KC extends YC{static get ZERO(){return uf||(uf=new KC(0,0,0),Object.freeze(uf)),uf}constructor(t=0,n=0,s=0){super(-0,-0,-0),arguments.length===1&&qa(t)?this.copy(t):(ns.debug&&(en(t),en(n),en(s)),this[0]=t,this[1]=n,this[2]=s)}set(t,n,s){return this[0]=t,this[1]=n,this[2]=s,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return ns.debug&&(en(t.x),en(t.y),en(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=en(t)}angle(t){return uq(this,t)}cross(t){return sq(this,this,t),this.check()}rotateX({radians:t,origin:n=g0}){return aq(this,this,n,t),this.check()}rotateY({radians:t,origin:n=g0}){return cq(this,this,n,t),this.check()}rotateZ({radians:t,origin:n=g0}){return lq(this,this,n,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return iq(this,this,t),this.check()}transformAsVector(t){return QW(this,this,t),this.check()}transformByMatrix3(t){return rq(this,this,t),this.check()}transformByMatrix2(t){return tq(this,this,t),this.check()}transformByQuaternion(t){return oq(this,this,t),this.check()}};function fq(e,t){if(!e)throw new Error(`math.gl assertion failed. ${t}`)}function dq(e,t=[0,0,0]){const n=e>>11&31,s=e>>5&63,i=e&31;return t[0]=n<<3,t[1]=s<<2,t[2]=i<<3,t}new v1;new hq;new v1;new v1;function PS(e,t=255){return HW(e,0,t)/t*2-1}function FS(e){return e<0?-1:1}function gq(e,t,n,s){if(fq(s),e<0||e>n||t<0||t>n)throw new Error(`x and y must be unsigned normalized integers between 0 and ${n}`);if(s.x=PS(e,n),s.y=PS(t,n),s.z=1-(Math.abs(s.x)+Math.abs(s.y)),s.z<0){const i=s.x;s.x=(1-Math.abs(s.y))*FS(i),s.y=(1-Math.abs(i))*FS(s.y)}return s.normalize()}function pq(e,t,n){return gq(e,t,255,n)}const _q={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{..._q}};const Sn=globalThis.mathgl.config;function mq(e,{precision:t=Sn.precision}={}){return e=Aq(e),`${parseFloat(e.toPrecision(t))}`}function ql(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function JC(e,t,n){const s=Sn.EPSILON;try{if(e===t)return!0;if(ql(e)&&ql(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!JC(e[i],t[i]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<=Sn.EPSILON*Math.max(1,Math.abs(e),Math.abs(t)):!1}finally{Sn.EPSILON=s}}function Aq(e){return Math.round(e/Sn.EPSILON)*Sn.EPSILON}class C1 extends Array{clone(){return new this.constructor().copy(this)}fromArray(t,n=0){for(let s=0;s<this.ELEMENTS;++s)this[s]=t[s+n];return this.check()}toArray(t=[],n=0){for(let s=0;s<this.ELEMENTS;++s)t[n+s]=this[s];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:ql(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Sn)}formatString(t){let n="";for(let s=0;s<this.ELEMENTS;++s)n+=(s>0?", ":"")+mq(this[s],t);return`${t.printTypes?this.constructor.name:""}[${n}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!JC(this[n],t[n]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==t[n])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,n,s){if(s===void 0)return this.lerp(this,t,n);for(let i=0;i<this.ELEMENTS;++i){const r=t[i],a=typeof n=="number"?n:n[i];this[i]=r+s*(a-r)}return this.check()}min(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(t[n],this[n]);return this.check()}max(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(t[n],this[n]);return this.check()}clamp(t,n){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t[s]),n[s]);return this.check()}add(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]+=n[s];return this.check()}subtract(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]-=n[s];return this.check()}scale(t){if(typeof t=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;else for(let n=0;n<this.ELEMENTS&&n<t.length;++n)this[n]*=t[n];return this.check()}multiplyByScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;return this.check()}check(){if(Sn.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)t=t&&Number.isFinite(this[n]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]=t;return this.check()}addScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let n=0;n<this.ELEMENTS;++n)this[n]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,n){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t),n);return this.check()}get elements(){return this}}function yq(e,t){if(e.length!==t)return!1;for(let n=0;n<e.length;++n)if(!Number.isFinite(e[n]))return!1;return!0}function ie(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function Bl(e,t,n=""){if(Sn.debug&&!yq(e,t))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return e}function US(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}class ZC extends C1{get x(){return this[0]}set x(t){this[0]=ie(t)}get y(){return this[1]}set y(t){this[1]=ie(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*this[n];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let n=0;for(let s=0;s<this.ELEMENTS;++s){const i=this[s]-t[s];n+=i*i}return ie(n)}dot(t){let n=0;for(let s=0;s<this.ELEMENTS;++s)n+=this[s]*t[s];return ie(n)}normalize(){const t=this.magnitude();if(t!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=t;return this.check()}multiply(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]*=n[s];return this.check()}divide(...t){for(const n of t)for(let s=0;s<this.ELEMENTS;++s)this[s]/=n[s];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return US(t>=0&&t<this.ELEMENTS,"index is out of range"),ie(this[t])}setComponent(t,n){return US(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=n,this.check()}addVectors(t,n){return this.copy(t).add(n)}subVectors(t,n){return this.copy(t).subtract(n)}multiplyVectors(t,n){return this.copy(t).multiply(n)}addScaledVector(t,n){return this.add(new this.constructor(t).multiplyScalar(n))}}const xl=1e-6;let As=typeof Float32Array<"u"?Float32Array:Array;function Tq(){const e=new As(2);return As!=Float32Array&&(e[0]=0,e[1]=0),e}function Eq(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[3]*i+n[6],e[1]=n[1]*s+n[4]*i+n[7],e}function bq(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[4]*i+n[12],e[1]=n[1]*s+n[5]*i+n[13],e}(function(){const e=Tq();return function(t,n,s,i,r,a){let l,h;for(n||(n=2),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],r(e,e,a),t[l]=e[0],t[l+1]=e[1];return t}})();function Sq(e,t,n){const s=t[0],i=t[1],r=n[3]*s+n[7]*i||1;return e[0]=(n[0]*s+n[4]*i)/r,e[1]=(n[1]*s+n[5]*i)/r,e}function QC(e,t,n){const s=t[0],i=t[1],r=t[2],a=n[3]*s+n[7]*i+n[11]*r||1;return e[0]=(n[0]*s+n[4]*i+n[8]*r)/a,e[1]=(n[1]*s+n[5]*i+n[9]*r)/a,e[2]=(n[2]*s+n[6]*i+n[10]*r)/a,e}function Rq(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[2]*i,e[1]=n[1]*s+n[3]*i,e[2]=t[2],e}function vq(e,t,n){const s=t[0],i=t[1];return e[0]=n[0]*s+n[2]*i,e[1]=n[1]*s+n[3]*i,e[2]=t[2],e[3]=t[3],e}function tM(e,t,n){const s=t[0],i=t[1],r=t[2];return e[0]=n[0]*s+n[3]*i+n[6]*r,e[1]=n[1]*s+n[4]*i+n[7]*r,e[2]=n[2]*s+n[5]*i+n[8]*r,e[3]=t[3],e}function eM(){const e=new As(3);return As!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Cq(e){const t=e[0],n=e[1],s=e[2];return Math.sqrt(t*t+n*n+s*s)}function LS(e,t,n){const s=new As(3);return s[0]=e,s[1]=t,s[2]=n,s}function Mq(e,t){const n=t[0],s=t[1],i=t[2];let r=n*n+s*s+i*i;return r>0&&(r=1/Math.sqrt(r)),e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function nM(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Df(e,t,n){const s=t[0],i=t[1],r=t[2],a=n[0],l=n[1],h=n[2];return e[0]=i*h-r*l,e[1]=r*a-s*h,e[2]=s*l-i*a,e}function M1(e,t,n){const s=t[0],i=t[1],r=t[2];let a=n[3]*s+n[7]*i+n[11]*r+n[15];return a=a||1,e[0]=(n[0]*s+n[4]*i+n[8]*r+n[12])/a,e[1]=(n[1]*s+n[5]*i+n[9]*r+n[13])/a,e[2]=(n[2]*s+n[6]*i+n[10]*r+n[14])/a,e}function sM(e,t,n){const s=t[0],i=t[1],r=t[2];return e[0]=s*n[0]+i*n[3]+r*n[6],e[1]=s*n[1]+i*n[4]+r*n[7],e[2]=s*n[2]+i*n[5]+r*n[8],e}function iM(e,t,n){const s=n[0],i=n[1],r=n[2],a=n[3],l=t[0],h=t[1],d=t[2];let g=i*d-r*h,_=r*l-s*d,m=s*h-i*l,y=i*m-r*_,E=r*g-s*m,b=s*_-i*g;const R=a*2;return g*=R,_*=R,m*=R,y*=2,E*=2,b*=2,e[0]=l+g+y,e[1]=h+_+E,e[2]=d+m+b,e}function wq(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[0],r[1]=i[1]*Math.cos(s)-i[2]*Math.sin(s),r[2]=i[1]*Math.sin(s)+i[2]*Math.cos(s),e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function Oq(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[2]*Math.sin(s)+i[0]*Math.cos(s),r[1]=i[1],r[2]=i[2]*Math.cos(s)-i[0]*Math.sin(s),e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function Bq(e,t,n,s){const i=[],r=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],r[0]=i[0]*Math.cos(s)-i[1]*Math.sin(s),r[1]=i[0]*Math.sin(s)+i[1]*Math.cos(s),r[2]=i[2],e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function xq(e,t){const n=e[0],s=e[1],i=e[2],r=t[0],a=t[1],l=t[2],h=Math.sqrt((n*n+s*s+i*i)*(r*r+a*a+l*l)),d=h&&nM(e,t)/h;return Math.acos(Math.min(Math.max(d,-1),1))}const Nq=Cq;(function(){const e=eM();return function(t,n,s,i,r,a){let l,h;for(n||(n=3),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],r(e,e,a),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2];return t}})();const p0=[0,0,0];let hf;class ve extends ZC{static get ZERO(){return hf||(hf=new ve(0,0,0),Object.freeze(hf)),hf}constructor(t=0,n=0,s=0){super(-0,-0,-0),arguments.length===1&&ql(t)?this.copy(t):(Sn.debug&&(ie(t),ie(n),ie(s)),this[0]=t,this[1]=n,this[2]=s)}set(t,n,s){return this[0]=t,this[1]=n,this[2]=s,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return Sn.debug&&(ie(t.x),ie(t.y),ie(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=ie(t)}angle(t){return xq(this,t)}cross(t){return Df(this,this,t),this.check()}rotateX({radians:t,origin:n=p0}){return wq(this,this,n,t),this.check()}rotateY({radians:t,origin:n=p0}){return Oq(this,this,n,t),this.check()}rotateZ({radians:t,origin:n=p0}){return Bq(this,this,n,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return M1(this,this,t),this.check()}transformAsVector(t){return QC(this,this,t),this.check()}transformByMatrix3(t){return sM(this,this,t),this.check()}transformByMatrix2(t){return Rq(this,this,t),this.check()}transformByQuaternion(t){return iM(this,this,t),this.check()}}let ff;class w1 extends ZC{static get ZERO(){return ff||(ff=new w1(0,0,0,0),Object.freeze(ff)),ff}constructor(t=0,n=0,s=0,i=0){super(-0,-0,-0,-0),ql(t)&&arguments.length===1?this.copy(t):(Sn.debug&&(ie(t),ie(n),ie(s),ie(i)),this[0]=t,this[1]=n,this[2]=s,this[3]=i)}set(t,n,s,i){return this[0]=t,this[1]=n,this[2]=s,this[3]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return Sn.debug&&(ie(t.x),ie(t.y),ie(t.z),ie(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=ie(t)}get w(){return this[3]}set w(t){this[3]=ie(t)}transform(t){return M1(this,this,t),this.check()}transformByMatrix3(t){return tM(this,this,t),this.check()}transformByMatrix2(t){return vq(this,this,t),this.check()}transformByQuaternion(t){return iM(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}}class rM extends C1{toString(){let t="[";if(Sn.printRowMajor){t+="row-major:";for(let n=0;n<this.RANK;++n)for(let s=0;s<this.RANK;++s)t+=` ${this[s*this.RANK+n]}`}else{t+="column-major:";for(let n=0;n<this.ELEMENTS;++n)t+=` ${this[n]}`}return t+="]",t}getElementIndex(t,n){return n*this.RANK+t}getElement(t,n){return this[n*this.RANK+t]}setElement(t,n,s){return this[n*this.RANK+t]=ie(s),this}getColumn(t,n=new Array(this.RANK).fill(-0)){const s=t*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[s+i];return n}setColumn(t,n){const s=t*this.RANK;for(let i=0;i<this.RANK;++i)this[s+i]=n[i];return this}}function Iq(){const e=new As(9);return As!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Dq(e,t){if(e===t){const n=t[1],s=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=s,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function Pq(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=t[4],l=t[5],h=t[6],d=t[7],g=t[8],_=g*a-l*d,m=-g*r+l*h,y=d*r-a*h;let E=n*_+s*m+i*y;return E?(E=1/E,e[0]=_*E,e[1]=(-g*s+i*d)*E,e[2]=(l*s-i*a)*E,e[3]=m*E,e[4]=(g*n-i*h)*E,e[5]=(-l*n+i*r)*E,e[6]=y*E,e[7]=(-d*n+s*h)*E,e[8]=(a*n-s*r)*E,e):null}function Fq(e){const t=e[0],n=e[1],s=e[2],i=e[3],r=e[4],a=e[5],l=e[6],h=e[7],d=e[8];return t*(d*r-a*h)+n*(-d*i+a*l)+s*(h*i-r*l)}function kS(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=t[4],h=t[5],d=t[6],g=t[7],_=t[8],m=n[0],y=n[1],E=n[2],b=n[3],R=n[4],M=n[5],N=n[6],O=n[7],x=n[8];return e[0]=m*s+y*a+E*d,e[1]=m*i+y*l+E*g,e[2]=m*r+y*h+E*_,e[3]=b*s+R*a+M*d,e[4]=b*i+R*l+M*g,e[5]=b*r+R*h+M*_,e[6]=N*s+O*a+x*d,e[7]=N*i+O*l+x*g,e[8]=N*r+O*h+x*_,e}function Uq(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=t[4],h=t[5],d=t[6],g=t[7],_=t[8],m=n[0],y=n[1];return e[0]=s,e[1]=i,e[2]=r,e[3]=a,e[4]=l,e[5]=h,e[6]=m*s+y*a+d,e[7]=m*i+y*l+g,e[8]=m*r+y*h+_,e}function Lq(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=t[4],h=t[5],d=t[6],g=t[7],_=t[8],m=Math.sin(n),y=Math.cos(n);return e[0]=y*s+m*a,e[1]=y*i+m*l,e[2]=y*r+m*h,e[3]=y*a-m*s,e[4]=y*l-m*i,e[5]=y*h-m*r,e[6]=d,e[7]=g,e[8]=_,e}function zS(e,t,n){const s=n[0],i=n[1];return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function kq(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=n+n,l=s+s,h=i+i,d=n*a,g=s*a,_=s*l,m=i*a,y=i*l,E=i*h,b=r*a,R=r*l,M=r*h;return e[0]=1-_-E,e[3]=g-M,e[6]=m+R,e[1]=g+M,e[4]=1-d-E,e[7]=y-b,e[2]=m-R,e[5]=y+b,e[8]=1-d-_,e}var Cm;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL1ROW0=3]="COL1ROW0",e[e.COL1ROW1=4]="COL1ROW1",e[e.COL1ROW2=5]="COL1ROW2",e[e.COL2ROW0=6]="COL2ROW0",e[e.COL2ROW1=7]="COL2ROW1",e[e.COL2ROW2=8]="COL2ROW2"})(Cm||(Cm={}));const zq=Object.freeze([1,0,0,0,1,0,0,0,1]);class O1 extends rM{static get IDENTITY(){return Hq()}static get ZERO(){return Vq()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return Cm}constructor(t,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):n.length>0?this.copy([t,...n]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(zq)}fromObject(t){return this.check()}fromQuaternion(t){return kq(this,t),this.check()}set(t,n,s,i,r,a,l,h,d){return this[0]=t,this[1]=n,this[2]=s,this[3]=i,this[4]=r,this[5]=a,this[6]=l,this[7]=h,this[8]=d,this.check()}setRowMajor(t,n,s,i,r,a,l,h,d){return this[0]=t,this[1]=i,this[2]=l,this[3]=n,this[4]=r,this[5]=h,this[6]=s,this[7]=a,this[8]=d,this.check()}determinant(){return Fq(this)}transpose(){return Dq(this,this),this.check()}invert(){return Pq(this,this),this.check()}multiplyLeft(t){return kS(this,t,this),this.check()}multiplyRight(t){return kS(this,this,t),this.check()}rotate(t){return Lq(this,this,t),this.check()}scale(t){return Array.isArray(t)?zS(this,this,t):zS(this,this,[t,t]),this.check()}translate(t){return Uq(this,this,t),this.check()}transform(t,n){let s;switch(t.length){case 2:s=Eq(n||[-0,-0],t,this);break;case 3:s=sM(n||[-0,-0,-0],t,this);break;case 4:s=tM(n||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Bl(s,t.length),s}transformVector(t,n){return this.transform(t,n)}transformVector2(t,n){return this.transform(t,n)}transformVector3(t,n){return this.transform(t,n)}}let df,gf=null;function Vq(){return df||(df=new O1([0,0,0,0,0,0,0,0,0]),Object.freeze(df)),df}function Hq(){return gf||(gf=new O1,Object.freeze(gf)),gf}function jq(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function $q(e,t){if(e===t){const n=t[1],s=t[2],i=t[3],r=t[6],a=t[7],l=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=s,e[9]=r,e[11]=t[14],e[12]=i,e[13]=a,e[14]=l}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function Xq(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=t[4],l=t[5],h=t[6],d=t[7],g=t[8],_=t[9],m=t[10],y=t[11],E=t[12],b=t[13],R=t[14],M=t[15],N=n*l-s*a,O=n*h-i*a,x=n*d-r*a,I=s*h-i*l,P=s*d-r*l,J=i*d-r*h,et=g*b-_*E,q=g*R-m*E,Q=g*M-y*E,rt=_*R-m*b,ct=_*M-y*b,ft=m*M-y*R;let Y=N*ft-O*ct+x*rt+I*Q-P*q+J*et;return Y?(Y=1/Y,e[0]=(l*ft-h*ct+d*rt)*Y,e[1]=(i*ct-s*ft-r*rt)*Y,e[2]=(b*J-R*P+M*I)*Y,e[3]=(m*P-_*J-y*I)*Y,e[4]=(h*Q-a*ft-d*q)*Y,e[5]=(n*ft-i*Q+r*q)*Y,e[6]=(R*x-E*J-M*O)*Y,e[7]=(g*J-m*x+y*O)*Y,e[8]=(a*ct-l*Q+d*et)*Y,e[9]=(s*Q-n*ct-r*et)*Y,e[10]=(E*P-b*x+M*N)*Y,e[11]=(_*x-g*P-y*N)*Y,e[12]=(l*q-a*rt-h*et)*Y,e[13]=(n*rt-s*q+i*et)*Y,e[14]=(b*O-E*I-R*N)*Y,e[15]=(g*I-_*O+m*N)*Y,e):null}function Gq(e){const t=e[0],n=e[1],s=e[2],i=e[3],r=e[4],a=e[5],l=e[6],h=e[7],d=e[8],g=e[9],_=e[10],m=e[11],y=e[12],E=e[13],b=e[14],R=e[15],M=t*a-n*r,N=t*l-s*r,O=n*l-s*a,x=d*E-g*y,I=d*b-_*y,P=g*b-_*E,J=t*P-n*I+s*x,et=r*P-a*I+l*x,q=d*O-g*N+_*M,Q=y*O-E*N+b*M;return h*J-i*et+R*q-m*Q}function VS(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=t[4],h=t[5],d=t[6],g=t[7],_=t[8],m=t[9],y=t[10],E=t[11],b=t[12],R=t[13],M=t[14],N=t[15];let O=n[0],x=n[1],I=n[2],P=n[3];return e[0]=O*s+x*l+I*_+P*b,e[1]=O*i+x*h+I*m+P*R,e[2]=O*r+x*d+I*y+P*M,e[3]=O*a+x*g+I*E+P*N,O=n[4],x=n[5],I=n[6],P=n[7],e[4]=O*s+x*l+I*_+P*b,e[5]=O*i+x*h+I*m+P*R,e[6]=O*r+x*d+I*y+P*M,e[7]=O*a+x*g+I*E+P*N,O=n[8],x=n[9],I=n[10],P=n[11],e[8]=O*s+x*l+I*_+P*b,e[9]=O*i+x*h+I*m+P*R,e[10]=O*r+x*d+I*y+P*M,e[11]=O*a+x*g+I*E+P*N,O=n[12],x=n[13],I=n[14],P=n[15],e[12]=O*s+x*l+I*_+P*b,e[13]=O*i+x*h+I*m+P*R,e[14]=O*r+x*d+I*y+P*M,e[15]=O*a+x*g+I*E+P*N,e}function Wq(e,t,n){const s=n[0],i=n[1],r=n[2];let a,l,h,d,g,_,m,y,E,b,R,M;return t===e?(e[12]=t[0]*s+t[4]*i+t[8]*r+t[12],e[13]=t[1]*s+t[5]*i+t[9]*r+t[13],e[14]=t[2]*s+t[6]*i+t[10]*r+t[14],e[15]=t[3]*s+t[7]*i+t[11]*r+t[15]):(a=t[0],l=t[1],h=t[2],d=t[3],g=t[4],_=t[5],m=t[6],y=t[7],E=t[8],b=t[9],R=t[10],M=t[11],e[0]=a,e[1]=l,e[2]=h,e[3]=d,e[4]=g,e[5]=_,e[6]=m,e[7]=y,e[8]=E,e[9]=b,e[10]=R,e[11]=M,e[12]=a*s+g*i+E*r+t[12],e[13]=l*s+_*i+b*r+t[13],e[14]=h*s+m*i+R*r+t[14],e[15]=d*s+y*i+M*r+t[15]),e}function qq(e,t,n){const s=n[0],i=n[1],r=n[2];return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Yq(e,t,n,s){let i=s[0],r=s[1],a=s[2],l=Math.sqrt(i*i+r*r+a*a),h,d,g,_,m,y,E,b,R,M,N,O,x,I,P,J,et,q,Q,rt,ct,ft,Y,Tt;return l<xl?null:(l=1/l,i*=l,r*=l,a*=l,d=Math.sin(n),h=Math.cos(n),g=1-h,_=t[0],m=t[1],y=t[2],E=t[3],b=t[4],R=t[5],M=t[6],N=t[7],O=t[8],x=t[9],I=t[10],P=t[11],J=i*i*g+h,et=r*i*g+a*d,q=a*i*g-r*d,Q=i*r*g-a*d,rt=r*r*g+h,ct=a*r*g+i*d,ft=i*a*g+r*d,Y=r*a*g-i*d,Tt=a*a*g+h,e[0]=_*J+b*et+O*q,e[1]=m*J+R*et+x*q,e[2]=y*J+M*et+I*q,e[3]=E*J+N*et+P*q,e[4]=_*Q+b*rt+O*ct,e[5]=m*Q+R*rt+x*ct,e[6]=y*Q+M*rt+I*ct,e[7]=E*Q+N*rt+P*ct,e[8]=_*ft+b*Y+O*Tt,e[9]=m*ft+R*Y+x*Tt,e[10]=y*ft+M*Y+I*Tt,e[11]=E*ft+N*Y+P*Tt,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function Kq(e,t,n){const s=Math.sin(n),i=Math.cos(n),r=t[4],a=t[5],l=t[6],h=t[7],d=t[8],g=t[9],_=t[10],m=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=r*i+d*s,e[5]=a*i+g*s,e[6]=l*i+_*s,e[7]=h*i+m*s,e[8]=d*i-r*s,e[9]=g*i-a*s,e[10]=_*i-l*s,e[11]=m*i-h*s,e}function Jq(e,t,n){const s=Math.sin(n),i=Math.cos(n),r=t[0],a=t[1],l=t[2],h=t[3],d=t[8],g=t[9],_=t[10],m=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=r*i-d*s,e[1]=a*i-g*s,e[2]=l*i-_*s,e[3]=h*i-m*s,e[8]=r*s+d*i,e[9]=a*s+g*i,e[10]=l*s+_*i,e[11]=h*s+m*i,e}function Zq(e,t,n){const s=Math.sin(n),i=Math.cos(n),r=t[0],a=t[1],l=t[2],h=t[3],d=t[4],g=t[5],_=t[6],m=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=r*i+d*s,e[1]=a*i+g*s,e[2]=l*i+_*s,e[3]=h*i+m*s,e[4]=d*i-r*s,e[5]=g*i-a*s,e[6]=_*i-l*s,e[7]=m*i-h*s,e}function Qq(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=n+n,l=s+s,h=i+i,d=n*a,g=s*a,_=s*l,m=i*a,y=i*l,E=i*h,b=r*a,R=r*l,M=r*h;return e[0]=1-_-E,e[1]=g+M,e[2]=m-R,e[3]=0,e[4]=g-M,e[5]=1-d-E,e[6]=y+b,e[7]=0,e[8]=m+R,e[9]=y-b,e[10]=1-d-_,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function tY(e,t,n,s,i,r,a){const l=1/(n-t),h=1/(i-s),d=1/(r-a);return e[0]=r*2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r*2*h,e[6]=0,e[7]=0,e[8]=(n+t)*l,e[9]=(i+s)*h,e[10]=(a+r)*d,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*r*2*d,e[15]=0,e}function eY(e,t,n,s,i){const r=1/Math.tan(t/2);if(e[0]=r/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0){const a=1/(s-i);e[10]=(i+s)*a,e[14]=2*i*s*a}else e[10]=-1,e[14]=-2*s;return e}const nY=eY;function sY(e,t,n,s,i,r,a){const l=1/(t-n),h=1/(s-i),d=1/(r-a);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*h,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*d,e[11]=0,e[12]=(t+n)*l,e[13]=(i+s)*h,e[14]=(a+r)*d,e[15]=1,e}const iY=sY;function rY(e,t,n,s){let i,r,a,l,h,d,g,_,m,y;const E=t[0],b=t[1],R=t[2],M=s[0],N=s[1],O=s[2],x=n[0],I=n[1],P=n[2];return Math.abs(E-x)<xl&&Math.abs(b-I)<xl&&Math.abs(R-P)<xl?jq(e):(_=E-x,m=b-I,y=R-P,i=1/Math.sqrt(_*_+m*m+y*y),_*=i,m*=i,y*=i,r=N*y-O*m,a=O*_-M*y,l=M*m-N*_,i=Math.sqrt(r*r+a*a+l*l),i?(i=1/i,r*=i,a*=i,l*=i):(r=0,a=0,l=0),h=m*l-y*a,d=y*r-_*l,g=_*a-m*r,i=Math.sqrt(h*h+d*d+g*g),i?(i=1/i,h*=i,d*=i,g*=i):(h=0,d=0,g=0),e[0]=r,e[1]=h,e[2]=_,e[3]=0,e[4]=a,e[5]=d,e[6]=m,e[7]=0,e[8]=l,e[9]=g,e[10]=y,e[11]=0,e[12]=-(r*E+a*b+l*R),e[13]=-(h*E+d*b+g*R),e[14]=-(_*E+m*b+y*R),e[15]=1,e)}function oY(){const e=new As(4);return As!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function aY(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function cY(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function lY(e){const t=e[0],n=e[1],s=e[2],i=e[3];return Math.sqrt(t*t+n*n+s*s+i*i)}function uY(e){const t=e[0],n=e[1],s=e[2],i=e[3];return t*t+n*n+s*s+i*i}function hY(e,t){const n=t[0],s=t[1],i=t[2],r=t[3];let a=n*n+s*s+i*i+r*r;return a>0&&(a=1/Math.sqrt(a)),e[0]=n*a,e[1]=s*a,e[2]=i*a,e[3]=r*a,e}function fY(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function dY(e,t,n,s){const i=t[0],r=t[1],a=t[2],l=t[3];return e[0]=i+s*(n[0]-i),e[1]=r+s*(n[1]-r),e[2]=a+s*(n[2]-a),e[3]=l+s*(n[3]-l),e}function gY(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3];return e[0]=n[0]*s+n[4]*i+n[8]*r+n[12]*a,e[1]=n[1]*s+n[5]*i+n[9]*r+n[13]*a,e[2]=n[2]*s+n[6]*i+n[10]*r+n[14]*a,e[3]=n[3]*s+n[7]*i+n[11]*r+n[15]*a,e}function pY(e,t,n){const s=t[0],i=t[1],r=t[2],a=n[0],l=n[1],h=n[2],d=n[3],g=d*s+l*r-h*i,_=d*i+h*s-a*r,m=d*r+a*i-l*s,y=-a*s-l*i-h*r;return e[0]=g*d+y*-a+_*-h-m*-l,e[1]=_*d+y*-l+m*-a-g*-h,e[2]=m*d+y*-h+g*-l-_*-a,e[3]=t[3],e}(function(){const e=oY();return function(t,n,s,i,r,a){let l,h;for(n||(n=4),s||(s=0),i?h=Math.min(i*n+s,t.length):h=t.length,l=s;l<h;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],e[3]=t[l+3],r(e,e,a),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2],t[l+3]=e[3];return t}})();var Mm;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"})(Mm||(Mm={}));const _Y=45*Math.PI/180,mY=1,_0=.1,m0=500,AY=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class hd extends rM{static get IDENTITY(){return TY()}static get ZERO(){return yY()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Mm}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,n,s,i,r,a,l,h,d,g,_,m,y,E,b,R){return this[0]=t,this[1]=n,this[2]=s,this[3]=i,this[4]=r,this[5]=a,this[6]=l,this[7]=h,this[8]=d,this[9]=g,this[10]=_,this[11]=m,this[12]=y,this[13]=E,this[14]=b,this[15]=R,this.check()}setRowMajor(t,n,s,i,r,a,l,h,d,g,_,m,y,E,b,R){return this[0]=t,this[1]=r,this[2]=d,this[3]=y,this[4]=n,this[5]=a,this[6]=g,this[7]=E,this[8]=s,this[9]=l,this[10]=_,this[11]=b,this[12]=i,this[13]=h,this[14]=m,this[15]=R,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(AY)}fromObject(t){return this.check()}fromQuaternion(t){return Qq(this,t),this.check()}frustum(t){const{left:n,right:s,bottom:i,top:r,near:a=_0,far:l=m0}=t;return l===1/0?EY(this,n,s,i,r,a):tY(this,n,s,i,r,a,l),this.check()}lookAt(t){const{eye:n,center:s=[0,0,0],up:i=[0,1,0]}=t;return rY(this,n,s,i),this.check()}ortho(t){const{left:n,right:s,bottom:i,top:r,near:a=_0,far:l=m0}=t;return iY(this,n,s,i,r,a,l),this.check()}orthographic(t){const{fovy:n=_Y,aspect:s=mY,focalDistance:i=1,near:r=_0,far:a=m0}=t;HS(n);const l=n/2,h=i*Math.tan(l),d=h*s;return this.ortho({left:-d,right:d,bottom:-h,top:h,near:r,far:a})}perspective(t){const{fovy:n=45*Math.PI/180,aspect:s=1,near:i=.1,far:r=500}=t;return HS(n),nY(this,n,s,i,r),this.check()}determinant(){return Gq(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,n){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const s=this.getScale(n),i=1/s[0],r=1/s[1],a=1/s[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*a,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*r,t[6]=this[6]*a,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*r,t[10]=this[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,n){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const s=this.getScale(n),i=1/s[0],r=1/s[1],a=1/s[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*a,t[3]=this[4]*i,t[4]=this[5]*r,t[5]=this[6]*a,t[6]=this[8]*i,t[7]=this[9]*r,t[8]=this[10]*a,t}transpose(){return $q(this,this),this.check()}invert(){return Xq(this,this),this.check()}multiplyLeft(t){return VS(this,t,this),this.check()}multiplyRight(t){return VS(this,this,t),this.check()}rotateX(t){return Kq(this,this,t),this.check()}rotateY(t){return Jq(this,this,t),this.check()}rotateZ(t){return Zq(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,n){return Yq(this,this,t,n),this.check()}scale(t){return qq(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return Wq(this,this,t),this.check()}transform(t,n){return t.length===4?(n=gY(n||[-0,-0,-0,-0],t,this),Bl(n,4),n):this.transformAsPoint(t,n)}transformAsPoint(t,n){const{length:s}=t;let i;switch(s){case 2:i=bq(n||[-0,-0],t,this);break;case 3:i=M1(n||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Bl(i,t.length),i}transformAsVector(t,n){let s;switch(t.length){case 2:s=Sq(n||[-0,-0],t,this);break;case 3:s=QC(n||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Bl(s,t.length),s}transformPoint(t,n){return this.transformAsPoint(t,n)}transformVector(t,n){return this.transformAsPoint(t,n)}transformDirection(t,n){return this.transformAsVector(t,n)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,n,s){return this.identity().translate([t,n,s])}}let pf,_f;function yY(){return pf||(pf=new hd([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(pf)),pf}function TY(){return _f||(_f=new hd,Object.freeze(_f)),_f}function HS(e){if(e>Math.PI*2)throw Error("expected radians")}function EY(e,t,n,s,i,r){const a=2*r/(n-t),l=2*r/(i-s),h=(n+t)/(n-t),d=(i+s)/(i-s),g=-1,_=-1,m=-2*r;return e[0]=a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=h,e[9]=d,e[10]=g,e[11]=_,e[12]=0,e[13]=0,e[14]=m,e[15]=0,e}function jS(){const e=new As(4);return As!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function bY(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function oM(e,t,n){n=n*.5;const s=Math.sin(n);return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=Math.cos(n),e}function $S(e,t,n){const s=t[0],i=t[1],r=t[2],a=t[3],l=n[0],h=n[1],d=n[2],g=n[3];return e[0]=s*g+a*l+i*d-r*h,e[1]=i*g+a*h+r*l-s*d,e[2]=r*g+a*d+s*h-i*l,e[3]=a*g-s*l-i*h-r*d,e}function SY(e,t,n){n*=.5;const s=t[0],i=t[1],r=t[2],a=t[3],l=Math.sin(n),h=Math.cos(n);return e[0]=s*h+a*l,e[1]=i*h+r*l,e[2]=r*h-i*l,e[3]=a*h-s*l,e}function RY(e,t,n){n*=.5;const s=t[0],i=t[1],r=t[2],a=t[3],l=Math.sin(n),h=Math.cos(n);return e[0]=s*h-r*l,e[1]=i*h+a*l,e[2]=r*h+s*l,e[3]=a*h-i*l,e}function vY(e,t,n){n*=.5;const s=t[0],i=t[1],r=t[2],a=t[3],l=Math.sin(n),h=Math.cos(n);return e[0]=s*h+i*l,e[1]=i*h-s*l,e[2]=r*h+a*l,e[3]=a*h-r*l,e}function CY(e,t){const n=t[0],s=t[1],i=t[2];return e[0]=n,e[1]=s,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-s*s-i*i)),e}function Pf(e,t,n,s){const i=t[0],r=t[1],a=t[2],l=t[3];let h=n[0],d=n[1],g=n[2],_=n[3],m,y,E,b,R;return m=i*h+r*d+a*g+l*_,m<0&&(m=-m,h=-h,d=-d,g=-g,_=-_),1-m>xl?(y=Math.acos(m),R=Math.sin(y),E=Math.sin((1-s)*y)/R,b=Math.sin(s*y)/R):(E=1-s,b=s),e[0]=E*i+b*h,e[1]=E*r+b*d,e[2]=E*a+b*g,e[3]=E*l+b*_,e}function MY(e,t){const n=t[0],s=t[1],i=t[2],r=t[3],a=n*n+s*s+i*i+r*r,l=a?1/a:0;return e[0]=-n*l,e[1]=-s*l,e[2]=-i*l,e[3]=r*l,e}function wY(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function aM(e,t){const n=t[0]+t[4]+t[8];let s;if(n>0)s=Math.sqrt(n+1),e[3]=.5*s,s=.5/s,e[0]=(t[5]-t[7])*s,e[1]=(t[6]-t[2])*s,e[2]=(t[1]-t[3])*s;else{let i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);const r=(i+1)%3,a=(i+2)%3;s=Math.sqrt(t[i*3+i]-t[r*3+r]-t[a*3+a]+1),e[i]=.5*s,s=.5/s,e[3]=(t[r*3+a]-t[a*3+r])*s,e[r]=(t[r*3+i]+t[i*3+r])*s,e[a]=(t[a*3+i]+t[i*3+a])*s}return e}const OY=aY,BY=cY,xY=fY,NY=dY,IY=lY,DY=uY,cM=hY,PY=function(){const e=eM(),t=LS(1,0,0),n=LS(0,1,0);return function(s,i,r){const a=nM(i,r);return a<-.999999?(Df(e,t,i),Nq(e)<1e-6&&Df(e,n,i),Mq(e,e),oM(s,e,Math.PI),s):a>.999999?(s[0]=0,s[1]=0,s[2]=0,s[3]=1,s):(Df(e,i,r),s[0]=e[0],s[1]=e[1],s[2]=e[2],s[3]=1+a,cM(s,s))}}();(function(){const e=jS(),t=jS();return function(n,s,i,r,a,l){return Pf(e,s,a,l),Pf(t,i,r,l),Pf(n,e,t,2*l*(1-l)),n}})();(function(){const e=Iq();return function(t,n,s,i){return e[0]=s[0],e[3]=s[1],e[6]=s[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],cM(t,aM(t,e))}})();const FY=[0,0,0,1];class UY extends C1{constructor(t=0,n=0,s=0,i=1){super(-0,-0,-0,-0),Array.isArray(t)&&arguments.length===1?this.copy(t):this.set(t,n,s,i)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,n,s,i){return this[0]=t,this[1]=n,this[2]=s,this[3]=i,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return aM(this,t),this.check()}fromAxisRotation(t,n){return oM(this,t,n),this.check()}identity(){return bY(this),this.check()}setAxisAngle(t,n){return this.fromAxisRotation(t,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=ie(t)}get y(){return this[1]}set y(t){this[1]=ie(t)}get z(){return this[2]}set z(t){this[2]=ie(t)}get w(){return this[3]}set w(t){this[3]=ie(t)}len(){return IY(this)}lengthSquared(){return DY(this)}dot(t){return xY(this,t)}rotationTo(t,n){return PY(this,t,n),this.check()}add(t){return OY(this,this,t),this.check()}calculateW(){return CY(this,this),this.check()}conjugate(){return wY(this,this),this.check()}invert(){return MY(this,this),this.check()}lerp(t,n,s){return s===void 0?this.lerp(this,t,n):(NY(this,t,n,s),this.check())}multiplyRight(t){return $S(this,this,t),this.check()}multiplyLeft(t){return $S(this,t,this),this.check()}normalize(){const t=this.len(),n=t>0?1/t:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,t===0&&(this[3]=1),this.check()}rotateX(t){return SY(this,this,t),this.check()}rotateY(t){return RY(this,this,t),this.check()}rotateZ(t){return vY(this,this,t),this.check()}scale(t){return BY(this,this,t),this.check()}slerp(t,n,s){let i,r,a;switch(arguments.length){case 1:({start:i=FY,target:r,ratio:a}=t);break;case 2:i=this,r=t,a=n;break;default:i=t,r=n,a=s}return Pf(this,i,r,a),this.check()}transformVector4(t,n=new w1){return pY(n,t,this),Bl(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,n){return this.setAxisAngle(t,n)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}}class B1{constructor(t,n){T(this,"json");T(this,"buffer");T(this,"featuresLength",0);T(this,"_cachedTypedArrays",{});this.json=t,this.buffer=n}getExtension(t){return this.json.extensions&&this.json.extensions[t]}hasProperty(t){return!!this.json[t]}getGlobalProperty(t,n=Ft.UNSIGNED_INT,s=1){const i=this.json[t];return i&&Number.isFinite(i.byteOffset)?this._getTypedArrayFromBinary(t,n,s,1,i.byteOffset):i}getPropertyArray(t,n,s){const i=this.json[t];return i&&Number.isFinite(i.byteOffset)?("componentType"in i&&(n=js.fromName(i.componentType)),this._getTypedArrayFromBinary(t,n,s,this.featuresLength,i.byteOffset)):this._getTypedArrayFromArray(t,n,i)}getProperty(t,n,s,i,r){const a=this.json[t];if(!a)return a;const l=this.getPropertyArray(t,n,s);if(s===1)return l[i];for(let h=0;h<s;++h)r[h]=l[s*i+h];return r}_getTypedArrayFromBinary(t,n,s,i,r){const a=this._cachedTypedArrays;let l=a[t];return l||(l=js.createTypedArray(n,this.buffer.buffer,this.buffer.byteOffset+r,i*s),a[t]=l),l}_getTypedArrayFromArray(t,n,s){const i=this._cachedTypedArrays;let r=i[t];return r||(r=js.createTypedArray(n,s),i[t]=r),r}}const LY={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},kY={SCALAR:(e,t)=>e[t],VEC2:(e,t)=>[e[2*t+0],e[2*t+1]],VEC3:(e,t)=>[e[3*t+0],e[3*t+1],e[3*t+2]],VEC4:(e,t)=>[e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]],MAT2:(e,t)=>[e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]],MAT3:(e,t)=>[e[9*t+0],e[9*t+1],e[9*t+2],e[9*t+3],e[9*t+4],e[9*t+5],e[9*t+6],e[9*t+7],e[9*t+8]],MAT4:(e,t)=>[e[16*t+0],e[16*t+1],e[16*t+2],e[16*t+3],e[16*t+4],e[16*t+5],e[16*t+6],e[16*t+7],e[16*t+8],e[16*t+9],e[16*t+10],e[16*t+11],e[16*t+12],e[16*t+13],e[16*t+14],e[16*t+15]]},zY={SCALAR:(e,t,n)=>{t[n]=e},VEC2:(e,t,n)=>{t[2*n+0]=e[0],t[2*n+1]=e[1]},VEC3:(e,t,n)=>{t[3*n+0]=e[0],t[3*n+1]=e[1],t[3*n+2]=e[2]},VEC4:(e,t,n)=>{t[4*n+0]=e[0],t[4*n+1]=e[1],t[4*n+2]=e[2],t[4*n+3]=e[3]},MAT2:(e,t,n)=>{t[4*n+0]=e[0],t[4*n+1]=e[1],t[4*n+2]=e[2],t[4*n+3]=e[3]},MAT3:(e,t,n)=>{t[9*n+0]=e[0],t[9*n+1]=e[1],t[9*n+2]=e[2],t[9*n+3]=e[3],t[9*n+4]=e[4],t[9*n+5]=e[5],t[9*n+6]=e[6],t[9*n+7]=e[7],t[9*n+8]=e[8],t[9*n+9]=e[9]},MAT4:(e,t,n)=>{t[16*n+0]=e[0],t[16*n+1]=e[1],t[16*n+2]=e[2],t[16*n+3]=e[3],t[16*n+4]=e[4],t[16*n+5]=e[5],t[16*n+6]=e[6],t[16*n+7]=e[7],t[16*n+8]=e[8],t[16*n+9]=e[9],t[16*n+10]=e[10],t[16*n+11]=e[11],t[16*n+12]=e[12],t[16*n+13]=e[13],t[16*n+14]=e[14],t[16*n+15]=e[15]}};function VY(e,t,n,s){const{componentType:i}=e;ls(e.componentType);const r=typeof i=="string"?js.fromName(i):i,a=LY[e.type],l=kY[e.type],h=zY[e.type];return n+=e.byteOffset,{values:js.createTypedArray(r,t,n,a*s),type:r,size:a,unpacker:l,packer:h}}const zs=e=>e!==void 0;function HY(e,t,n){if(!t)return null;let s=e.getExtension("3DTILES_batch_table_hierarchy");const i=t.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),t.extensions=t.extensions||{},t.extensions["3DTILES_batch_table_hierarchy"]=i,s=i),s?jY(s,n):null}function jY(e,t){let n,s,i;const r=e.instancesLength,a=e.classes;let l=e.classIds,h=e.parentCounts,d=e.parentIds,g=r;zs(l.byteOffset)&&(l.componentType=defaultValue(l.componentType,GL.UNSIGNED_SHORT),l.type=AttributeType.SCALAR,i=getBinaryAccessor(l),l=i.createArrayBufferView(t.buffer,t.byteOffset+l.byteOffset,r));let _;if(zs(h))for(zs(h.byteOffset)&&(h.componentType=defaultValue(h.componentType,GL.UNSIGNED_SHORT),h.type=AttributeType.SCALAR,i=getBinaryAccessor(h),h=i.createArrayBufferView(t.buffer,t.byteOffset+h.byteOffset,r)),_=new Uint16Array(r),g=0,n=0;n<r;++n)_[n]=g,g+=h[n];zs(d)&&zs(d.byteOffset)&&(d.componentType=defaultValue(d.componentType,GL.UNSIGNED_SHORT),d.type=AttributeType.SCALAR,i=getBinaryAccessor(d),d=i.createArrayBufferView(t.buffer,t.byteOffset+d.byteOffset,g));const m=a.length;for(n=0;n<m;++n){const R=a[n].length,M=a[n].instances,N=getBinaryProperties(R,M,t);a[n].instances=combine(N,M)}const y=new Array(m).fill(0),E=new Uint16Array(r);for(n=0;n<r;++n)s=l[n],E[n]=y[s],++y[s];const b={classes:a,classIds:l,classIndexes:E,parentCounts:h,parentIndexes:_,parentIds:d};return GY(b),b}function fl(e,t,n){if(!e)return;const s=e.parentCounts;return e.parentIds?n(e,t):s>0?$Y(e,t,n):XY(e,t,n)}function $Y(e,t,n){const s=e.classIds,i=e.parentCounts,r=e.parentIds,a=e.parentIndexes,l=s.length,h=scratchVisited;h.length=Math.max(h.length,l);const d=++marker,g=scratchStack;for(g.length=0,g.push(t);g.length>0;){if(t=g.pop(),h[t]===d)continue;h[t]=d;const _=n(e,t);if(zs(_))return _;const m=i[t],y=a[t];for(let E=0;E<m;++E){const b=r[y+E];b!==t&&g.push(b)}}return null}function XY(e,t,n){let s=!0;for(;s;){const i=n(e,t);if(zs(i))return i;const r=e.parentIds[t];s=r!==t,t=r}throw new Error("traverseHierarchySingleParent")}function GY(e){const n=e.classIds.length;for(let s=0;s<n;++s)lM(e,s,stack)}function lM(e,t,n){const s=e.parentCounts,i=e.parentIds,r=e.parentIndexes,l=e.classIds.length;if(!zs(i))return;assert(t<l,`Parent index ${t} exceeds the total number of instances: ${l}`),assert(n.indexOf(t)===-1,"Circular dependency detected in the batch table hierarchy."),n.push(t);const h=zs(s)?s[t]:1,d=zs(s)?r[t]:t;for(let g=0;g<h;++g){const _=i[d+g];_!==t&&lM(e,_,n)}n.pop(t)}function pn(e){return e!=null}const mf=(e,t)=>e,WY={HIERARCHY:!0,extensions:!0,extras:!0};class uM{constructor(t,n,s,i={}){T(this,"json");T(this,"binary");T(this,"featureCount");T(this,"_extensions");T(this,"_properties");T(this,"_binaryProperties");T(this,"_hierarchy");var r;ls(s>=0),this.json=t||{},this.binary=n,this.featureCount=s,this._extensions=((r=this.json)==null?void 0:r.extensions)||{},this._properties={};for(const a in this.json)WY[a]||(this._properties[a]=this.json[a]);this._binaryProperties=this._initializeBinaryProperties(),i["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=HY(this,this.json,this.binary))}getExtension(t){return this.json&&this.json.extensions&&this.json.extensions[t]}memorySizeInBytes(){return 0}isClass(t,n){if(this._checkBatchId(t),ls(typeof n=="string",n),this._hierarchy){const s=fl(this._hierarchy,t,(i,r)=>{const a=i.classIds[r];return i.classes[a].name===n});return pn(s)}return!1}isExactClass(t,n){return ls(typeof n=="string",n),this.getExactClassName(t)===n}getExactClassName(t){if(this._checkBatchId(t),this._hierarchy){const n=this._hierarchy.classIds[t];return this._hierarchy.classes[n].name}}hasProperty(t,n){return this._checkBatchId(t),ls(typeof n=="string",n),pn(this._properties[n])||this._hasPropertyInHierarchy(t,n)}getPropertyNames(t,n){this._checkBatchId(t),n=pn(n)?n:[],n.length=0;const s=Object.keys(this._properties);return n.push(...s),this._hierarchy&&this._getPropertyNamesInHierarchy(t,n),n}getProperty(t,n){if(this._checkBatchId(t),ls(typeof n=="string",n),this._binaryProperties){const i=this._binaryProperties[n];if(pn(i))return this._getBinaryProperty(i,t)}const s=this._properties[n];if(pn(s))return mf(s[t]);if(this._hierarchy){const i=this._getHierarchyProperty(t,n);if(pn(i))return i}}setProperty(t,n,s){const i=this.featureCount;if(this._checkBatchId(t),ls(typeof n=="string",n),this._binaryProperties){const a=this._binaryProperties[n];if(a){this._setBinaryProperty(a,t,s);return}}if(this._hierarchy&&this._setHierarchyProperty(this,t,n,s))return;let r=this._properties[n];pn(r)||(this._properties[n]=new Array(i),r=this._properties[n]),r[t]=mf(s)}_checkBatchId(t){if(!(t>=0&&t<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(t,n){return t.unpack(t.typedArray,n)}_setBinaryProperty(t,n,s){t.pack(s,t.typedArray,n)}_initializeBinaryProperties(){let t=null;for(const n in this._properties){const s=this._properties[n],i=this._initializeBinaryProperty(n,s);i&&(t=t||{},t[n]=i)}return t}_initializeBinaryProperty(t,n){if("byteOffset"in n){const s=n;ls(this.binary,`Property ${t} requires a batch table binary.`),ls(s.type,`Property ${t} requires a type.`);const i=VY(s,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:i.values,componentCount:i.size,unpack:i.unpacker,pack:i.packer}}return null}_hasPropertyInHierarchy(t,n){if(!this._hierarchy)return!1;const s=fl(this._hierarchy,t,(i,r)=>{const a=i.classIds[r],l=i.classes[a].instances;return pn(l[n])});return pn(s)}_getPropertyNamesInHierarchy(t,n){fl(this._hierarchy,t,(s,i)=>{const r=s.classIds[i],a=s.classes[r].instances;for(const l in a)a.hasOwnProperty(l)&&n.indexOf(l)===-1&&n.push(l)})}_getHierarchyProperty(t,n){return fl(this._hierarchy,t,(s,i)=>{const r=s.classIds[i],a=s.classes[r],l=s.classIndexes[i],h=a.instances[n];return pn(h)?pn(h.typedArray)?this._getBinaryProperty(h,l):mf(h[l]):null})}_setHierarchyProperty(t,n,s,i){const r=fl(this._hierarchy,n,(a,l)=>{const h=a.classIds[l],d=a.classes[h],g=a.classIndexes[l],_=d.instances[s];return pn(_)?(ls(l===n,`Inherited property "${s}" is read-only.`),pn(_.typedArray)?this._setBinaryProperty(_,g,i):_[g]=mf(i),!0):!1});return pn(r)}}const A0=4;function Xd(e,t,n=0){const s=new DataView(t);if(e.magic=s.getUint32(n,!0),n+=A0,e.version=s.getUint32(n,!0),n+=A0,e.byteLength=s.getUint32(n,!0),n+=A0,e.version!==1)throw new Error(`3D Tile Version ${e.version} not supported`);return n}const ma=4,XS="b3dm tile in legacy format.";function x1(e,t,n){const s=new DataView(t);let i;e.header=e.header||{};let r=s.getUint32(n,!0);n+=ma;let a=s.getUint32(n,!0);n+=ma;let l=s.getUint32(n,!0);n+=ma;let h=s.getUint32(n,!0);return n+=ma,l>=570425344?(n-=ma*2,i=r,l=a,h=0,r=0,a=0,console.warn(XS)):h>=570425344&&(n-=ma,i=l,l=r,h=a,r=0,a=0,console.warn(XS)),e.header.featureTableJsonByteLength=r,e.header.featureTableBinaryByteLength=a,e.header.batchTableJsonByteLength=l,e.header.batchTableBinaryByteLength=h,e.header.batchLength=i,n}function N1(e,t,n,s){return n=qY(e,t,n),n=YY(e,t,n),n}function qY(e,t,n,s){const{featureTableJsonByteLength:i,featureTableBinaryByteLength:r,batchLength:a}=e.header||{};if(e.featureTableJson={BATCH_LENGTH:a||0},i&&i>0){const l=WC(t,n,i);e.featureTableJson=JSON.parse(l)}return n+=i||0,e.featureTableBinary=new Uint8Array(t,n,r),n+=r||0,n}function YY(e,t,n,s){const{batchTableJsonByteLength:i,batchTableBinaryByteLength:r}=e.header||{};if(i&&i>0){const a=WC(t,n,i);e.batchTableJson=JSON.parse(a),n+=i,r&&r>0&&(e.batchTableBinary=new Uint8Array(t,n,r),e.batchTableBinary=new Uint8Array(e.batchTableBinary),n+=r)}return n}function hM(e,t,n){if(!t&&(!e||!e.batchIds||!n))return null;const{batchIds:s,isRGB565:i,pointCount:r=0}=e;if(s&&n){const a=new Uint8ClampedArray(r*3);for(let l=0;l<r;l++){const h=s[l],g=n.getProperty(h,"dimensions").map(_=>_*255);a[l*3]=g[0],a[l*3+1]=g[1],a[l*3+2]=g[2]}return{type:Ft.UNSIGNED_BYTE,value:a,size:3,normalized:!0}}if(t&&i){const a=new Uint8ClampedArray(r*3);for(let l=0;l<r;l++){const h=dq(t[l]);a[l*3]=h[0],a[l*3+1]=h[1],a[l*3+2]=h[2]}return{type:Ft.UNSIGNED_BYTE,value:a,size:3,normalized:!0}}return t&&t.length===r*3?{type:Ft.UNSIGNED_BYTE,value:t,size:3,normalized:!0}:{type:Ft.UNSIGNED_BYTE,value:t||new Uint8ClampedArray,size:4,normalized:!0}}const GS=new ve;function KY(e,t){if(!t)return null;if(e.isOctEncoded16P){const n=new Float32Array((e.pointsLength||0)*3);for(let s=0;s<(e.pointsLength||0);s++)pq(t[s*2],t[s*2+1],GS),GS.toArray(n,s*3);return{type:Ft.FLOAT,size:2,value:n}}return{type:Ft.FLOAT,size:2,value:t}}function JY(e,t,n){return e.isQuantized?n["3d-tiles"]&&n["3d-tiles"].decodeQuantizedPositions?(e.isQuantized=!1,ZY(e,t)):{type:Ft.UNSIGNED_SHORT,value:t,size:3,normalized:!0}:t}function ZY(e,t){const n=new ve,s=new Float32Array(e.pointCount*3);for(let i=0;i<e.pointCount;i++)n.set(t[i*3],t[i*3+1],t[i*3+2]).scale(1/e.quantizedRange).multiply(e.quantizedVolumeScale).add(e.quantizedVolumeOffset).toArray(s,i*3);return s}async function QY(e,t,n,s,i){n=Xd(e,t,n),n=x1(e,t,n),n=N1(e,t,n),tK(e);const{featureTable:r,batchTable:a}=eK(e);return await oK(e,r,a,s,i),nK(e,r,s),sK(e,r,a),iK(e,r),n}function tK(e){e.attributes={positions:null,colors:null,normals:null,batchIds:null},e.isQuantized=!1,e.isTranslucent=!1,e.isRGB565=!1,e.isOctEncoded16P=!1}function eK(e){const t=new B1(e.featureTableJson,e.featureTableBinary),n=t.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");t.featuresLength=n,e.featuresLength=n,e.pointsLength=n,e.pointCount=n,e.rtcCenter=t.getGlobalProperty("RTC_CENTER",Ft.FLOAT,3);const s=rK(e,t);return{featureTable:t,batchTable:s}}function nK(e,t,n){if(e.attributes=e.attributes||{positions:null,colors:null,normals:null,batchIds:null},!e.attributes.positions){if(t.hasProperty("POSITION"))e.attributes.positions=t.getPropertyArray("POSITION",Ft.FLOAT,3);else if(t.hasProperty("POSITION_QUANTIZED")){const s=t.getPropertyArray("POSITION_QUANTIZED",Ft.UNSIGNED_SHORT,3);if(e.isQuantized=!0,e.quantizedRange=65535,e.quantizedVolumeScale=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Ft.FLOAT,3),!e.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(e.quantizedVolumeOffset=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Ft.FLOAT,3),!e.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");e.attributes.positions=JY(e,s,n)}}if(!e.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function sK(e,t,n){if(e.attributes=e.attributes||{positions:null,colors:null,normals:null,batchIds:null},!e.attributes.colors){let s=null;t.hasProperty("RGBA")?(s=t.getPropertyArray("RGBA",Ft.UNSIGNED_BYTE,4),e.isTranslucent=!0):t.hasProperty("RGB")?s=t.getPropertyArray("RGB",Ft.UNSIGNED_BYTE,3):t.hasProperty("RGB565")&&(s=t.getPropertyArray("RGB565",Ft.UNSIGNED_SHORT,1),e.isRGB565=!0),e.attributes.colors=hM(e,s,n)}t.hasProperty("CONSTANT_RGBA")&&(e.constantRGBA=t.getGlobalProperty("CONSTANT_RGBA",Ft.UNSIGNED_BYTE,4))}function iK(e,t){if(e.attributes=e.attributes||{positions:null,colors:null,normals:null,batchIds:null},!e.attributes.normals){let n=null;t.hasProperty("NORMAL")?n=t.getPropertyArray("NORMAL",Ft.FLOAT,3):t.hasProperty("NORMAL_OCT16P")&&(n=t.getPropertyArray("NORMAL_OCT16P",Ft.UNSIGNED_BYTE,2),e.isOctEncoded16P=!0),e.attributes.normals=KY(e,n)}}function rK(e,t){let n=null;if(!e.batchIds&&t.hasProperty("BATCH_ID")&&(e.batchIds=t.getPropertyArray("BATCH_ID",Ft.UNSIGNED_SHORT,1),e.batchIds)){const s=t.getGlobalProperty("BATCH_LENGTH");if(!s)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:i,batchTableBinary:r}=e;n=new uM(i,r,s)}return n}async function oK(e,t,n,s,i){let r,a,l;const h=e.batchTableJson&&e.batchTableJson.extensions&&e.batchTableJson.extensions["3DTILES_draco_point_compression"];h&&(l=h.properties);const d=t.getExtension("3DTILES_draco_point_compression");if(d){a=d.properties;const _=d.byteOffset,m=d.byteLength;if(!a||!Number.isFinite(_)||!m)throw new Error("Draco properties, byteOffset, and byteLength must be defined");r=(e.featureTableBinary||[]).slice(_,_+m),e.hasPositions=Number.isFinite(a.POSITION),e.hasColors=Number.isFinite(a.RGB)||Number.isFinite(a.RGBA),e.hasNormals=Number.isFinite(a.NORMAL),e.hasBatchIds=Number.isFinite(a.BATCH_ID),e.isTranslucent=Number.isFinite(a.RGBA)}if(!r)return!0;const g={buffer:r,properties:{...a,...l},batchTableProperties:l};return await aK(e,g,s,i)}async function aK(e,t,n,s){if(!s)return;const i={...n,draco:{...n==null?void 0:n.draco,extraAttributes:t.batchTableProperties||{}}};delete i["3d-tiles"];const r=await R1(t.buffer,uC,i,s),a=r.attributes.POSITION&&r.attributes.POSITION.value,l=r.attributes.COLOR_0&&r.attributes.COLOR_0.value,h=r.attributes.NORMAL&&r.attributes.NORMAL.value,d=r.attributes.BATCH_ID&&r.attributes.BATCH_ID.value,g=a&&r.attributes.POSITION.value.quantization,_=h&&r.attributes.NORMAL.value.quantization;if(g){const y=r.POSITION.data.quantization,E=y.range;e.quantizedVolumeScale=new ve(E,E,E),e.quantizedVolumeOffset=new ve(y.minValues),e.quantizedRange=(1<<y.quantizationBits)-1,e.isQuantizedDraco=!0}_&&(e.octEncodedRange=(1<<r.NORMAL.data.quantization.quantizationBits)-1,e.isOctEncodedDraco=!0);const m={};if(t.batchTableProperties)for(const y of Object.keys(t.batchTableProperties))r.attributes[y]&&r.attributes[y].value&&(m[y.toLowerCase()]=r.attributes[y].value);e.attributes={positions:a,colors:hM(e,l,void 0),normals:h,batchIds:d,...m}}const wm={URI:0,EMBEDDED:1};function fM(e,t,n,s){e.rotateYtoZ=!0;const i=(e.byteOffset||0)+(e.byteLength||0)-n;if(i===0)throw new Error("glTF byte length must be greater than 0.");return e.gltfUpAxis=s!=null&&s["3d-tiles"]&&s["3d-tiles"].assetGltfUpAxis?s["3d-tiles"].assetGltfUpAxis:"Y",e.gltfArrayBuffer=NW(t,n,i),e.gltfByteOffset=0,e.gltfByteLength=i,n%4===0||console.warn(`${e.type}: embedded glb is not aligned to a 4-byte boundary.`),(e.byteOffset||0)+(e.byteLength||0)}async function dM(e,t,n,s){const i=(n==null?void 0:n["3d-tiles"])||{};if(cK(e,t),i.loadGLTF){if(!s)return;if(e.gltfUrl){const{fetch:r}=s,a=await r(e.gltfUrl,n);e.gltfArrayBuffer=await a.arrayBuffer(),e.gltfByteOffset=0}if(e.gltfArrayBuffer){const r=await R1(e.gltfArrayBuffer,Xl,n,s);e.gltf=A1(r),e.gpuMemoryUsageInBytes=tC(e.gltf),delete e.gltfArrayBuffer,delete e.gltfByteOffset,delete e.gltfByteLength}}}function cK(e,t,n){switch(t){case wm.URI:if(e.gltfArrayBuffer){const s=new Uint8Array(e.gltfArrayBuffer,e.gltfByteOffset),r=new TextDecoder().decode(s);e.gltfUrl=r.replace(/[\s\0]+$/,"")}delete e.gltfArrayBuffer,delete e.gltfByteOffset,delete e.gltfByteLength;break;case wm.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}async function lK(e,t,n,s,i){var a;n=uK(e,t,n,s),await dM(e,wm.EMBEDDED,s,i);const r=(a=e==null?void 0:e.gltf)==null?void 0:a.extensions;return r&&r.CESIUM_RTC&&(e.rtcCenter=r.CESIUM_RTC.center),n}function uK(e,t,n,s,i){n=Xd(e,t,n),n=x1(e,t,n),n=N1(e,t,n),n=fM(e,t,n,s);const r=new B1(e.featureTableJson,e.featureTableBinary);return e.rtcCenter=r.getGlobalProperty("RTC_CENTER",Ft.FLOAT,3),n}async function hK(e,t,n,s,i){return n=fK(e,t,n,s),await dM(e,e.gltfFormat||0,s,i),n}function fK(e,t,n,s,i){var d;if(n=Xd(e,t,n),e.version!==1)throw new Error(`Instanced 3D Model version ${e.version} is not supported`);n=x1(e,t,n);const r=new DataView(t);if(e.gltfFormat=r.getUint32(n,!0),n+=4,n=N1(e,t,n),n=fM(e,t,n,s),!((d=e==null?void 0:e.header)!=null&&d.featureTableJsonByteLength)||e.header.featureTableJsonByteLength===0)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const a=new B1(e.featureTableJson,e.featureTableBinary),l=a.getGlobalProperty("INSTANCES_LENGTH");if(a.featuresLength=l,!Number.isFinite(l))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");e.eastNorthUp=a.getGlobalProperty("EAST_NORTH_UP"),e.rtcCenter=a.getGlobalProperty("RTC_CENTER",Ft.FLOAT,3);const h=new uM(e.batchTableJson,e.batchTableBinary,l);return dK(e,a,h,l),n}function dK(e,t,n,s){const i=new Array(s),r=new ve;new ve,new ve,new ve;const a=new O1,l=new UY,h=new ve,d={},g=new hd,_=[],m=[],y=[],E=[];for(let b=0;b<s;b++){let R;if(t.hasProperty("POSITION"))R=t.getProperty("POSITION",Ft.FLOAT,3,b,r);else if(t.hasProperty("POSITION_QUANTIZED")){R=t.getProperty("POSITION_QUANTIZED",Ft.UNSIGNED_SHORT,3,b,r);const P=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Ft.FLOAT,3);if(!P)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const J=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Ft.FLOAT,3);if(!J)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const et=65535;for(let q=0;q<3;q++)R[q]=R[q]/et*J[q]+P[q]}if(!R)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");if(r.copy(R),d.translation=r,e.normalUp=t.getProperty("NORMAL_UP",Ft.FLOAT,3,b,_),e.normalRight=t.getProperty("NORMAL_RIGHT",Ft.FLOAT,3,b,m),e.normalUp){if(!e.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");e.hasCustomOrientation=!0}else{if(e.octNormalUp=t.getProperty("NORMAL_UP_OCT32P",Ft.UNSIGNED_SHORT,2,b,_),e.octNormalRight=t.getProperty("NORMAL_RIGHT_OCT32P",Ft.UNSIGNED_SHORT,2,b,m),e.octNormalUp)throw e.octNormalRight?new Error("i3dm: oct-encoded orientation not implemented"):new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");e.eastNorthUp?(re.WGS84.eastNorthUpToFixedFrame(r,g),g.getRotationMatrix3(a)):a.identity()}l.fromMatrix3(a),d.rotation=l,h.set(1,1,1);const M=t.getProperty("SCALE",Ft.FLOAT,1,b,y);Number.isFinite(M)&&h.multiplyByScalar(M);const N=t.getProperty("SCALE_NON_UNIFORM",Ft.FLOAT,3,b,_);N&&h.scale(N),d.scale=h;let O=t.getProperty("BATCH_ID",Ft.UNSIGNED_SHORT,1,b,E);O===void 0&&(O=b);const x=new hd().fromQuaternion(d.rotation);g.identity(),g.translate(d.translation),g.multiplyRight(x),g.scale(d.scale);const I=g.clone();i[b]={modelMatrix:I,batchId:O}}e.instances=i}async function gK(e,t,n,s,i,r){n=Xd(e,t,n);const a=new DataView(t);for(e.tilesLength=a.getUint32(n,!0),n+=4,e.tiles=[];e.tiles.length<e.tilesLength&&(e.byteLength||0)-n>12;){const l={shape:"tile3d"};e.tiles.push(l),n=await r(t,n,s,i,l)}return n}async function pK(e,t,n,s){var i,r;if(e.rotateYtoZ=!0,e.gltfUpAxis=(i=n==null?void 0:n["3d-tiles"])!=null&&i.assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y",(r=n==null?void 0:n["3d-tiles"])!=null&&r.loadGLTF){if(!s)return t.byteLength;const a=await R1(t,Xl,n,s);e.gltf=A1(a),e.gpuMemoryUsageInBytes=tC(e.gltf)}else e.gltfArrayBuffer=t;return t.byteLength}async function gM(e,t=0,n,s,i={shape:"tile3d"}){switch(i.byteOffset=t,i.type=UW(e,t),i.type){case hl.COMPOSITE:return await gK(i,e,t,n,s,gM);case hl.BATCHED_3D_MODEL:return await lK(i,e,t,n,s);case hl.GLTF:return await pK(i,e,n,s);case hl.INSTANCED_3D_MODEL:return await hK(i,e,t,n,s);case hl.POINT_CLOUD:return await QY(i,e,t,n,s);default:throw new Error(`3DTileLoader: unknown type ${i.type}`)}}const _K=1952609651,mK=1;async function AK(e,t,n){if(new Uint32Array(e.slice(0,4))[0]!==_K)throw new Error("Wrong subtree file magic number");if(new Uint32Array(e.slice(4,8))[0]!==mK)throw new Error("Wrong subtree file verson, must be 1");const r=WS(e.slice(8,16)),a=new Uint8Array(e,24,r),h=new TextDecoder("utf8").decode(a),d=JSON.parse(h),g=WS(e.slice(16,24));let _=new ArrayBuffer(0);if(g&&(_=e.slice(24+r)),await Af(d,d.tileAvailability,_,n),Array.isArray(d.contentAvailability))for(const m of d.contentAvailability)await Af(d,m,_,n);else await Af(d,d.contentAvailability,_,n);return await Af(d,d.childSubtreeAvailability,_,n),d}async function Af(e,t,n,s){const i=Number.isFinite(t.bitstream)?t.bitstream:t.bufferView;if(typeof i!="number")return;const r=e.bufferViews[i],a=e.buffers[r.buffer];if(!(s!=null&&s.baseUrl))throw new Error("Url is not provided");if(!s.fetch)throw new Error("fetch is not provided");if(a.uri){const h=`${(s==null?void 0:s.baseUrl)||""}/${a.uri}`,g=await(await s.fetch(h)).arrayBuffer();t.explicitBitstream=new Uint8Array(g,r.byteOffset,r.byteLength);return}const l=e.buffers.slice(0,r.buffer).reduce((h,d)=>h+d.byteLength,0);t.explicitBitstream=new Uint8Array(n.slice(l,l+a.byteLength),r.byteOffset,r.byteLength)}function WS(e){const t=new DataView(e),n=t.getUint32(0,!0),s=t.getUint32(4,!0);return n+2**32*s}const pM={dataType:null,batchType:null,id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:GC,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:AK,options:{}};/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var Zn=null;try{Zn=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Wt(e,t,n){this.low=e|0,this.high=t|0,this.unsigned=!!n}Wt.prototype.__isLong__;Object.defineProperty(Wt.prototype,"__isLong__",{value:!0});function sn(e){return(e&&e.__isLong__)===!0}function qS(e){var t=Math.clz32(e&-e);return e?31-t:t}Wt.isLong=sn;var YS={},KS={};function fo(e,t){var n,s,i;return t?(e>>>=0,(i=0<=e&&e<256)&&(s=KS[e],s)?s:(n=zt(e,0,!0),i&&(KS[e]=n),n)):(e|=0,(i=-128<=e&&e<128)&&(s=YS[e],s)?s:(n=zt(e,e<0?-1:0,!1),i&&(YS[e]=n),n))}Wt.fromInt=fo;function Qn(e,t){if(isNaN(e))return t?Ti:ds;if(t){if(e<0)return Ti;if(e>=_M)return yM}else{if(e<=-9223372036854776e3)return An;if(e+1>=TK)return AM}return e<0?Qn(-e,t).neg():zt(e%Ya|0,e/Ya|0,t)}Wt.fromNumber=Qn;function zt(e,t,n){return new Wt(e,t,n)}Wt.fromBits=zt;var fd=Math.pow;function I1(e,t,n){if(e.length===0)throw Error("empty string");if(typeof t=="number"?(n=t,t=!1):t=!!t,e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return t?Ti:ds;if(n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=e.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return I1(e.substring(1),t,n).neg();for(var i=Qn(fd(n,8)),r=ds,a=0;a<e.length;a+=8){var l=Math.min(8,e.length-a),h=parseInt(e.substring(a,a+l),n);if(l<8){var d=Qn(fd(n,l));r=r.mul(d).add(Qn(h))}else r=r.mul(i),r=r.add(Qn(h))}return r.unsigned=t,r}Wt.fromString=I1;function ys(e,t){return typeof e=="number"?Qn(e,t):typeof e=="string"?I1(e,t):zt(e.low,e.high,typeof t=="boolean"?t:e.unsigned)}Wt.fromValue=ys;var JS=65536,yK=1<<24,Ya=JS*JS,_M=Ya*Ya,TK=_M/2,ZS=fo(yK),ds=fo(0);Wt.ZERO=ds;var Ti=fo(0,!0);Wt.UZERO=Ti;var Ma=fo(1);Wt.ONE=Ma;var mM=fo(1,!0);Wt.UONE=mM;var Om=fo(-1);Wt.NEG_ONE=Om;var AM=zt(-1,2147483647,!1);Wt.MAX_VALUE=AM;var yM=zt(-1,-1,!0);Wt.MAX_UNSIGNED_VALUE=yM;var An=zt(0,-2147483648,!1);Wt.MIN_VALUE=An;var at=Wt.prototype;at.toInt=function(){return this.unsigned?this.low>>>0:this.low};at.toNumber=function(){return this.unsigned?(this.high>>>0)*Ya+(this.low>>>0):this.high*Ya+(this.low>>>0)};at.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(An)){var n=Qn(t),s=this.div(n),i=s.mul(n).sub(this);return s.toString(t)+i.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var r=Qn(fd(t,6),this.unsigned),a=this,l="";;){var h=a.div(r),d=a.sub(h.mul(r)).toInt()>>>0,g=d.toString(t);if(a=h,a.isZero())return g+l;for(;g.length<6;)g="0"+g;l=""+g+l}};at.getHighBits=function(){return this.high};at.getHighBitsUnsigned=function(){return this.high>>>0};at.getLowBits=function(){return this.low};at.getLowBitsUnsigned=function(){return this.low>>>0};at.getNumBitsAbs=function(){if(this.isNegative())return this.eq(An)?64:this.neg().getNumBitsAbs();for(var t=this.high!=0?this.high:this.low,n=31;n>0&&(t&1<<n)==0;n--);return this.high!=0?n+33:n+1};at.isZero=function(){return this.high===0&&this.low===0};at.eqz=at.isZero;at.isNegative=function(){return!this.unsigned&&this.high<0};at.isPositive=function(){return this.unsigned||this.high>=0};at.isOdd=function(){return(this.low&1)===1};at.isEven=function(){return(this.low&1)===0};at.equals=function(t){return sn(t)||(t=ys(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low};at.eq=at.equals;at.notEquals=function(t){return!this.eq(t)};at.neq=at.notEquals;at.ne=at.notEquals;at.lessThan=function(t){return this.comp(t)<0};at.lt=at.lessThan;at.lessThanOrEqual=function(t){return this.comp(t)<=0};at.lte=at.lessThanOrEqual;at.le=at.lessThanOrEqual;at.greaterThan=function(t){return this.comp(t)>0};at.gt=at.greaterThan;at.greaterThanOrEqual=function(t){return this.comp(t)>=0};at.gte=at.greaterThanOrEqual;at.ge=at.greaterThanOrEqual;at.compare=function(t){if(sn(t)||(t=ys(t)),this.eq(t))return 0;var n=this.isNegative(),s=t.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1};at.comp=at.compare;at.negate=function(){return!this.unsigned&&this.eq(An)?An:this.not().add(Ma)};at.neg=at.negate;at.add=function(t){sn(t)||(t=ys(t));var n=this.high>>>16,s=this.high&65535,i=this.low>>>16,r=this.low&65535,a=t.high>>>16,l=t.high&65535,h=t.low>>>16,d=t.low&65535,g=0,_=0,m=0,y=0;return y+=r+d,m+=y>>>16,y&=65535,m+=i+h,_+=m>>>16,m&=65535,_+=s+l,g+=_>>>16,_&=65535,g+=n+a,g&=65535,zt(m<<16|y,g<<16|_,this.unsigned)};at.subtract=function(t){return sn(t)||(t=ys(t)),this.add(t.neg())};at.sub=at.subtract;at.multiply=function(t){if(this.isZero())return this;if(sn(t)||(t=ys(t)),Zn){var n=Zn.mul(this.low,this.high,t.low,t.high);return zt(n,Zn.get_high(),this.unsigned)}if(t.isZero())return this.unsigned?Ti:ds;if(this.eq(An))return t.isOdd()?An:ds;if(t.eq(An))return this.isOdd()?An:ds;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(ZS)&&t.lt(ZS))return Qn(this.toNumber()*t.toNumber(),this.unsigned);var s=this.high>>>16,i=this.high&65535,r=this.low>>>16,a=this.low&65535,l=t.high>>>16,h=t.high&65535,d=t.low>>>16,g=t.low&65535,_=0,m=0,y=0,E=0;return E+=a*g,y+=E>>>16,E&=65535,y+=r*g,m+=y>>>16,y&=65535,y+=a*d,m+=y>>>16,y&=65535,m+=i*g,_+=m>>>16,m&=65535,m+=r*d,_+=m>>>16,m&=65535,m+=a*h,_+=m>>>16,m&=65535,_+=s*g+i*d+r*h+a*l,_&=65535,zt(y<<16|E,_<<16|m,this.unsigned)};at.mul=at.multiply;at.divide=function(t){if(sn(t)||(t=ys(t)),t.isZero())throw Error("division by zero");if(Zn){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var n=(this.unsigned?Zn.div_u:Zn.div_s)(this.low,this.high,t.low,t.high);return zt(n,Zn.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Ti:ds;var s,i,r;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return Ti;if(t.gt(this.shru(1)))return mM;r=Ti}else{if(this.eq(An)){if(t.eq(Ma)||t.eq(Om))return An;if(t.eq(An))return Ma;var a=this.shr(1);return s=a.div(t).shl(1),s.eq(ds)?t.isNegative()?Ma:Om:(i=this.sub(t.mul(s)),r=s.add(i.div(t)),r)}else if(t.eq(An))return this.unsigned?Ti:ds;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();r=ds}for(i=this;i.gte(t);){s=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var l=Math.ceil(Math.log(s)/Math.LN2),h=l<=48?1:fd(2,l-48),d=Qn(s),g=d.mul(t);g.isNegative()||g.gt(i);)s-=h,d=Qn(s,this.unsigned),g=d.mul(t);d.isZero()&&(d=Ma),r=r.add(d),i=i.sub(g)}return r};at.div=at.divide;at.modulo=function(t){if(sn(t)||(t=ys(t)),Zn){var n=(this.unsigned?Zn.rem_u:Zn.rem_s)(this.low,this.high,t.low,t.high);return zt(n,Zn.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))};at.mod=at.modulo;at.rem=at.modulo;at.not=function(){return zt(~this.low,~this.high,this.unsigned)};at.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};at.clz=at.countLeadingZeros;at.countTrailingZeros=function(){return this.low?qS(this.low):qS(this.high)+32};at.ctz=at.countTrailingZeros;at.and=function(t){return sn(t)||(t=ys(t)),zt(this.low&t.low,this.high&t.high,this.unsigned)};at.or=function(t){return sn(t)||(t=ys(t)),zt(this.low|t.low,this.high|t.high,this.unsigned)};at.xor=function(t){return sn(t)||(t=ys(t)),zt(this.low^t.low,this.high^t.high,this.unsigned)};at.shiftLeft=function(t){return sn(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?zt(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):zt(0,this.low<<t-32,this.unsigned)};at.shl=at.shiftLeft;at.shiftRight=function(t){return sn(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?zt(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):zt(this.high>>t-32,this.high>=0?0:-1,this.unsigned)};at.shr=at.shiftRight;at.shiftRightUnsigned=function(t){return sn(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?zt(this.low>>>t|this.high<<32-t,this.high>>>t,this.unsigned):t===32?zt(this.high,0,this.unsigned):zt(this.high>>>t-32,0,this.unsigned)};at.shru=at.shiftRightUnsigned;at.shr_u=at.shiftRightUnsigned;at.rotateLeft=function(t){var n;return sn(t)&&(t=t.toInt()),(t&=63)===0?this:t===32?zt(this.high,this.low,this.unsigned):t<32?(n=32-t,zt(this.low<<t|this.high>>>n,this.high<<t|this.low>>>n,this.unsigned)):(t-=32,n=32-t,zt(this.high<<t|this.low>>>n,this.low<<t|this.high>>>n,this.unsigned))};at.rotl=at.rotateLeft;at.rotateRight=function(t){var n;return sn(t)&&(t=t.toInt()),(t&=63)===0?this:t===32?zt(this.high,this.low,this.unsigned):t<32?(n=32-t,zt(this.high<<n|this.low>>>t,this.low<<n|this.high>>>t,this.unsigned)):(t-=32,n=32-t,zt(this.low<<n|this.high>>>t,this.high<<n|this.low>>>t,this.unsigned))};at.rotr=at.rotateRight;at.toSigned=function(){return this.unsigned?zt(this.low,this.high,!1):this};at.toUnsigned=function(){return this.unsigned?this:zt(this.low,this.high,!0)};at.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()};at.toBytesLE=function(){var t=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]};at.toBytesBE=function(){var t=this.high,n=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Wt.fromBytes=function(t,n,s){return s?Wt.fromBytesLE(t,n):Wt.fromBytesBE(t,n)};Wt.fromBytesLE=function(t,n){return new Wt(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,n)};Wt.fromBytesBE=function(t,n){return new Wt(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],n)};const EK=16;function TM(e){e==="X"&&(e="");const t=e.padEnd(EK,"0");return Wt.fromString(t,!0,16)}function bK(e){if(e.isZero())return"X";let t=e.countTrailingZeros();const n=t%4;t=(t-n)/4;const s=t;t*=4;const r=e.shiftRightUnsigned(t).toString(16).replace(/0+$/,"");return Array(17-s-r.length).join("0")+r}function SK(e,t){const n=RK(e).shiftRightUnsigned(2);return e.add(Wt.fromNumber(2*t+1-4).multiply(n))}function RK(e){return e.and(e.not().add(1))}const vK=3,CK=30,MK=2*CK+1,QS=180/Math.PI;function wK(e){if(e.length===0)throw new Error(`Invalid Hilbert quad key ${e}`);const t=e.split("/"),n=parseInt(t[0],10),s=t[1],i=s.length;let r=0;const a=[0,0];for(let l=i-1;l>=0;l--){r=i-l;const h=s[l];let d=0,g=0;h==="1"?g=1:h==="2"?(d=1,g=1):h==="3"&&(d=1);const _=Math.pow(2,r-1);BK(_,a,d,g),a[0]+=_*d,a[1]+=_*g}if(n%2===1){const l=a[0];a[0]=a[1],a[1]=l}return{face:n,ij:a,level:r}}function OK(e){if(e.isZero())return"";let t=e.toString(2);for(;t.length<vK+MK;)t="0"+t;const n=t.lastIndexOf("1"),s=t.substring(0,3),i=t.substring(3,n),r=i.length/2,a=Wt.fromString(s,!0,2).toString(10);let l="";if(r!==0)for(l=Wt.fromString(i,!0,2).toString(4);l.length<r;)l="0"+l;return`${a}/${l}`}function EM(e,t,n){const s=1<<t;return[(e[0]+n[0])/s,(e[1]+n[1])/s]}function t3(e){return e>=.5?1/3*(4*e*e-1):1/3*(1-4*(1-e)*(1-e))}function bM(e){return[t3(e[0]),t3(e[1])]}function SM(e,[t,n]){switch(e){case 0:return[1,t,n];case 1:return[-t,1,n];case 2:return[-t,-n,1];case 3:return[-1,-n,-t];case 4:return[n,-1,-t];case 5:return[n,t,-1];default:throw new Error("Invalid face")}}function RM([e,t,n]){const s=Math.atan2(n,Math.sqrt(e*e+t*t));return[Math.atan2(t,e)*QS,s*QS]}function BK(e,t,n,s){if(s===0){n===1&&(t[0]=e-1-t[0],t[1]=e-1-t[1]);const i=t[0];t[0]=t[1],t[1]=i}}function xK(e){const t=EM(e.ij,e.level,[.5,.5]),n=bM(t),s=SM(e.face,n);return RM(s)}const NK=100;function e3(e){const{face:t,ij:n,level:s}=e,i=[[0,0],[0,1],[1,1],[1,0],[0,0]],r=Math.max(1,Math.ceil(NK*Math.pow(2,-s))),a=new Float64Array(4*r*2+2);let l=0,h=0;for(let d=0;d<4;d++){const g=i[d].slice(0),_=i[d+1],m=(_[0]-g[0])/r,y=(_[1]-g[1])/r;for(let E=0;E<r;E++){g[0]+=m,g[1]+=y;const b=EM(n,s,g),R=bM(b),M=SM(t,R),N=RM(M);Math.abs(N[1])>89.999&&(N[0]=h);const O=N[0]-h;N[0]+=O>180?-360:O<-180?360:0,a[l++]=N[0],a[l++]=N[1],h=N[0]}}return a[l++]=a[0],a[l++]=a[1],a}function D1(e){const t=IK(e);return wK(t)}function IK(e){if(e.indexOf("/")>0)return e;const t=TM(e);return OK(t)}function DK(e){const t=D1(e);return xK(t)}function PK(e){let t;if(e.face===2||e.face===5){let n=null,s=0;for(let i=0;i<4;i++){const r=`${e.face}/${i}`,a=D1(r),l=e3(a);(typeof n>"u"||n===null)&&(n=new Float64Array(4*l.length)),n.set(l,s),s+=l.length}t=n3(n)}else{const n=e3(e);t=n3(n)}return t}function n3(e){if(e.length%2!==0)throw new Error("Invalid corners");const t=[],n=[];for(let s=0;s<e.length;s+=2)t.push(e[s]),n.push(e[s+1]);return t.sort((s,i)=>s-i),n.sort((s,i)=>s-i),{west:t[0],east:t[t.length-1],north:n[n.length-1],south:n[0]}}function FK(e,t){const n=(t==null?void 0:t.minimumHeight)||0,s=(t==null?void 0:t.maximumHeight)||0,i=D1(e),r=PK(i),a=r.west,l=r.south,h=r.east,d=r.north,g=[];return g.push(new ve(a,d,n)),g.push(new ve(h,d,n)),g.push(new ve(h,l,n)),g.push(new ve(a,l,n)),g.push(new ve(a,d,s)),g.push(new ve(h,d,s)),g.push(new ve(h,l,s)),g.push(new ve(a,l,s)),g}function vM(e){const t=e.token,n={minimumHeight:e.minimumHeight,maximumHeight:e.maximumHeight},s=FK(t,n),i=DK(t),r=i[0],a=i[1],l=re.WGS84.cartographicToCartesian([r,a,n.maximumHeight]),h=new ve(l[0],l[1],l[2]);s.push(h);const d=l5(s);return[...d.center,...d.halfAxes]}const UK=4,LK=8,kK={QUADTREE:UK,OCTREE:LK};function zK(e,t,n){if(e!=null&&e.box){const s=TM(e.s2VolumeInfo.token),i=SK(s,t),r=bK(i),a={...e.s2VolumeInfo};switch(a.token=r,n){case"OCTREE":const d=e.s2VolumeInfo,g=d.maximumHeight-d.minimumHeight,_=g/2,m=d.minimumHeight+g/2;d.minimumHeight=m-_,d.maximumHeight=m+_;break}return{box:vM(a),s2VolumeInfo:a}}}async function CM(e){const{subtree:t,subtreeData:n={level:0,x:0,y:0,z:0},parentData:s={mortonIndex:0,localLevel:-1,localX:0,localY:0,localZ:0},childIndex:i=0,implicitOptions:r,loaderOptions:a,s2VolumeBox:l}=e,{subdivisionScheme:h,subtreeLevels:d,maximumLevel:g,contentUrlTemplate:_,subtreesUriTemplate:m,basePath:y}=r,E={children:[],lodMetricValue:0,contentUrl:""};if(!g)return R3.once(`Missing 'maximumLevel' or 'availableLevels' property. The subtree ${_} won't be loaded...`),E;const b=s.localLevel+1,R=n.level+b;if(R>g)return E;const M=kK[h],N=Math.log2(M),O=i&1,x=i>>1&1,I=i>>2&1,P=Xr(s.localX,O,1),J=Xr(s.localY,x,1),et=Xr(s.localZ,I,1),q=Xr(n.x,P,b),Q=Xr(n.y,J,b),rt=Xr(n.z,et,b),ct=Xr(s.mortonIndex,i,N),ft=b===d&&y0(t.childSubtreeAvailability,ct);let Y,Tt,K,lt;if(ft){const U=`${y}/${m}`,st=Bm(U,R,q,Q,rt);Y=await gr(st,pM,a),lt=0,Tt={level:R,x:q,y:Q,z:rt},K={mortonIndex:0,localLevel:0,localX:0,localY:0,localZ:0}}else Y=t,lt=(M**b-1)/(M-1)+ct,Tt=n,K={mortonIndex:ct,localLevel:b,localX:P,localY:J,localZ:et};if(!y0(Y.tileAvailability,lt))return E;y0(Y.contentAvailability,lt)&&(E.contentUrl=Bm(_,R,q,Q,rt));for(let U=0;U<M;U++){const st=zK(l,U,h),ut=await CM({subtree:Y,subtreeData:Tt,parentData:K,childIndex:U,implicitOptions:r,loaderOptions:a,s2VolumeBox:st});(ut.contentUrl||ut.children.length)&&E.children.push(ut)}return E.contentUrl||E.children.length?VK(E,{level:R,x:q,y:Q,z:rt},r,l):E}function y0(e,t){let n;return Array.isArray(e)?(n=e[0],e.length>1&&R3.once('Not supported extension "3DTILES_multiple_contents" has been detected')):n=e,"constant"in n?!!n.constant:n.explicitBitstream?$K(t,n.explicitBitstream):!1}function VK(e,t,n,s){const{basePath:i,refine:r,getRefine:a,lodMetricType:l,getTileType:h,rootLodMetricValue:d,rootBoundingVolume:g}=n,_=e.contentUrl&&e.contentUrl.replace(`${i}/`,""),m=d/2**t.level,y=s!=null&&s.box?{box:s.box}:g,E=HK(y,t,n.subdivisionScheme);return{children:e.children,contentUrl:e.contentUrl,content:{uri:_},id:e.contentUrl,refine:a(r),type:h(e),lodMetricType:l,lodMetricValue:m,geometricError:m,transform:e.transform,boundingVolume:E}}function HK(e,t,n){if(e.region){const{level:s,x:i,y:r,z:a}=t,[l,h,d,g,_,m]=e.region,y=2**s,E=(d-l)/y,[b,R]=[l+E*i,l+E*(i+1)],M=(g-h)/y,[N,O]=[h+M*r,h+M*(r+1)];let x,I;if(n==="OCTREE"){const P=(m-_)/y;[x,I]=[_+P*a,_+P*(a+1)]}else[x,I]=[_,m];return{region:[b,N,R,O,x,I]}}if(e.box)return e;throw new Error(`Unsupported bounding volume type ${JSON.stringify(e)}`)}function Xr(e,t,n){return(e<<n)+t}function Bm(e,t,n,s,i){const r=jK({level:t,x:n,y:s,z:i});return e.replace(/{level}|{x}|{y}|{z}/gi,a=>r[a])}function jK(e){const t={};for(const n in e)t[`{${n}}`]=e[n];return t}function $K(e,t){const n=Math.floor(e/8),s=e%8;return(t[n]>>s&1)===1}function P1(e,t=""){if(!t)return yi.EMPTY;const s=t.split("?")[0].split(".").pop();switch(s){case"pnts":return yi.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return yi.SCENEGRAPH;default:return s||yi.EMPTY}}function F1(e){switch(e){case"REPLACE":case"replace":return gs.REPLACE;case"ADD":case"add":return gs.ADD;default:return e}}function xm(e,t){if(/^[a-z][0-9a-z+.-]*:/i.test(t)){const s=new URL(e,`${t}/`);return decodeURI(s.toString())}else if(e.startsWith("/"))return e;return PW(t,e)}function s3(e,t){var i;if(!e)return null;let n;if(e.content){const r=e.content.uri||((i=e.content)==null?void 0:i.url);typeof r<"u"&&(n=xm(r,t))}return{...e,id:n,contentUrl:n,lodMetricType:Wa.GEOMETRIC_ERROR,lodMetricValue:e.geometricError,transformMatrix:e.transform,type:P1(e,n),refine:F1(e.refine)}}async function XK(e,t,n){let s=null;const i=r3(e.root);i&&e.root?s=await i3(e.root,e,t,i,n):s=s3(e.root,t);const r=[];for(r.push(s);r.length>0;){const a=r.pop()||{},l=a.children||[],h=[];for(const d of l){const g=r3(d);let _;g?_=await i3(d,e,t,g,n):_=s3(d,t),_&&(h.push(_),r.push(_))}a.children=h}return s}async function i3(e,t,n,s,i){var x,I,P;const{subdivisionScheme:r,maximumLevel:a,availableLevels:l,subtreeLevels:h,subtrees:{uri:d}}=s,g=Bm(d,0,0,0,0),_=xm(g,n),m=await gr(_,pM,i),y=(x=e.content)==null?void 0:x.uri,E=y?xm(y,n):"",b=(I=t==null?void 0:t.root)==null?void 0:I.refine,R=e.geometricError,M=(P=e.boundingVolume.extensions)==null?void 0:P["3DTILES_bounding_volume_S2"];if(M){const et={box:vM(M),s2VolumeInfo:M};e.boundingVolume=et}const N=e.boundingVolume,O={contentUrlTemplate:E,subtreesUriTemplate:d,subdivisionScheme:r,subtreeLevels:h,maximumLevel:Number.isFinite(l)?l-1:a,refine:b,basePath:n,lodMetricType:Wa.GEOMETRIC_ERROR,rootLodMetricValue:R,rootBoundingVolume:N,getTileType:P1,getRefine:F1};return await GK(e,n,m,O,i)}async function GK(e,t,n,s,i){if(!e)return null;const{children:r,contentUrl:a}=await CM({subtree:n,implicitOptions:s,loaderOptions:i});let l,h=null;return a&&(l=a,h={uri:a.replace(`${t}/`,"")}),{...e,id:l,contentUrl:l,lodMetricType:Wa.GEOMETRIC_ERROR,lodMetricValue:e.geometricError,transformMatrix:e.transform,type:P1(e,l),refine:F1(e.refine),content:h||e.content,children:r}}function r3(e){var t;return((t=e==null?void 0:e.extensions)==null?void 0:t["3DTILES_implicit_tiling"])||(e==null?void 0:e.implicitTiling)}const U1={dataType:null,batchType:null,id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:GC,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:WK,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};async function WK(e,t={},n){const s=t["3d-tiles"]||{};let i;return s.isTileset==="auto"?i=(n==null?void 0:n.url)&&n.url.indexOf(".json")!==-1:i=s.isTileset,i?qK(e,t,n):YK(e,t,n)}async function qK(e,t,n){var h;const s=JSON.parse(new TextDecoder().decode(e)),i=(n==null?void 0:n.url)||"",r=KK(i),a=await XK(s,r,t||{});return{...s,shape:"tileset3d",loader:U1,url:i,queryString:(n==null?void 0:n.queryString)||"",basePath:r,root:a||s.root,type:_n.TILES3D,lodMetricType:Wa.GEOMETRIC_ERROR,lodMetricValue:((h=s.root)==null?void 0:h.geometricError)||0}}async function YK(e,t,n){const s={content:{shape:"tile3d",featureIds:null}};return await gM(e,0,t,n,s.content),s.content}function KK(e){return DW(e)}const o3=[0],JK={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:"",loader:U1,onTilesetLoad:{type:"function",value:e=>{}},onTileLoad:{type:"function",value:e=>{}},onTileUnload:{type:"function",value:e=>{}},onTileError:{type:"function",value:(e,t,n)=>{}},_getMeshColor:{type:"function",value:e=>[255,255,255]}};class dd extends Rv{initializeState(){"onTileLoadFail"in this.props&&kt.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}get isLoaded(){var t,n;return!!((n=(t=this.state)==null?void 0:t.tileset3d)!=null&&n.isLoaded()&&super.isLoaded)}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState({props:t,oldProps:n,changeFlags:s}){if(t.data&&t.data!==n.data&&this._loadTileset(t.data),s.viewportChanged){const{activeViewports:i}=this.state;Object.keys(i).length&&(this._updateTileset(i),this.state.lastUpdatedViewports=i,this.state.activeViewports={})}if(s.propsChanged){const{layerMap:i}=this.state;for(const r in i)i[r].needsUpdate=!0}}activateViewport(t){const{activeViewports:n,lastUpdatedViewports:s}=this.state;this.internalState.viewport=t,n[t.id]=t;const i=s==null?void 0:s[t.id];(!i||!t.equals(i))&&(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}getPickingInfo({info:t,sourceLayer:n}){const s=n&&n.props.tile;return t.picked&&(t.object=s),t.sourceTile=s,t}filterSubLayer({layer:t,viewport:n}){const{tile:s}=t.props,{id:i}=n;return s.selected&&s.viewportIds.includes(i)}_updateAutoHighlight(t){const n=t.sourceTile,s=this.state.layerMap[n==null?void 0:n.id];s&&s.layer&&s.layer.updateAutoHighlight(t)}async _loadTileset(t){const{loadOptions:n={}}=this.props,s=this.props.loader||this.props.loaders,i=Array.isArray(s)?s[0]:s,r={loadOptions:{...n}};let a=t;if(i.preload){const d=await i.preload(t,n);d.url&&(a=d.url),d.headers&&(r.loadOptions.fetch={...r.loadOptions.fetch,headers:d.headers}),Object.assign(r,d)}const l=await gr(a,i,r.loadOptions),h=new xW(l,{onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError,...r});this.setState({tileset3d:h,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(h)}_onTileLoad(t){const{lastUpdatedViewports:n}=this.state;this.props.onTileLoad(t),this._updateTileset(n),this.setNeedsUpdate()}_onTileUnload(t){delete this.state.layerMap[t.id],this.props.onTileUnload(t)}_updateTileset(t){if(!t)return;const{tileset3d:n}=this.state,{timeline:s}=this.context,i=Object.keys(t).length;!s||!i||!n||n.selectTiles(Object.values(t)).then(r=>{this.state.frameNumber!==r&&this.setState({frameNumber:r})})}_getSubLayer(t,n){if(!t.content)return null;switch(t.type){case yi.POINTCLOUD:return this._makePointCloudLayer(t,n);case yi.SCENEGRAPH:return this._make3DModelLayer(t);case yi.MESH:return this._makeSimpleMeshLayer(t,n);default:throw new Error(`Tile3DLayer: Failed to render layer of type ${t.content.type}`)}}_makePointCloudLayer(t,n){const{attributes:s,pointCount:i,constantRGBA:r,cartographicOrigin:a,modelMatrix:l}=t.content,{positions:h,normals:d,colors:g}=s;if(!h)return null;const _=n&&n.props.data||{header:{vertexCount:i},attributes:{POSITION:h,NORMAL:d,COLOR_0:g}},{pointSize:m,getPointColor:y}=this.props,E=this.getSubLayerClass("pointcloud",um);return new E({pointSize:m},this.getSubLayerProps({id:"pointcloud"}),{id:`${this.id}-pointcloud-${t.id}`,tile:t,data:_,coordinateSystem:Nt.METER_OFFSETS,coordinateOrigin:a,modelMatrix:l,getColor:r||y,_offset:0})}_make3DModelLayer(t){const{gltf:n,instances:s,cartographicOrigin:i,modelMatrix:r}=t.content,a=this.getSubLayerClass("scenegraph",y1);return new a({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:`${this.id}-scenegraph-${t.id}`,tile:t,data:s||o3,scenegraph:n,coordinateSystem:Nt.METER_OFFSETS,coordinateOrigin:i,modelMatrix:r,getTransformMatrix:l=>l.modelMatrix,getPosition:[0,0,0],_offset:0})}_makeSimpleMeshLayer(t,n){const s=t.content,{attributes:i,indices:r,modelMatrix:a,cartographicOrigin:l,coordinateSystem:h=Nt.METER_OFFSETS,material:d,featureIds:g}=s,{_getMeshColor:_}=this.props,m=n&&n.props.mesh||new Na({topology:"triangle-list",attributes:ZK(i),indices:r}),y=this.getSubLayerClass("mesh",T1);return new y(this.getSubLayerProps({id:"mesh"}),{id:`${this.id}-mesh-${t.id}`,tile:t,mesh:m,data:o3,getColor:_(t),pbrMaterial:d,modelMatrix:a,coordinateOrigin:l,coordinateSystem:h,featureIds:g,_offset:0})}renderLayers(){const{tileset3d:t,layerMap:n}=this.state;return t?t.tiles.map(s=>{const i=n[s.id]=n[s.id]||{tile:s};let{layer:r}=i;return s.selected&&(r?i.needsUpdate&&(r=this._getSubLayer(s,r),i.needsUpdate=!1):r=this._getSubLayer(s)),i.layer=r,r}).filter(Boolean):null}}dd.defaultProps=JK;dd.layerName="Tile3DLayer";function ZK(e){const t={};return t.positions={...e.positions,value:new Float32Array(e.positions.value)},e.normals&&(t.normals=e.normals),e.texCoords&&(t.texCoords=e.texCoords),e.colors&&(t.colors=e.colors),e.uvRegions&&(t.uvRegions=e.uvRegions),t}const QK="modulepreload",tJ=function(e){return"/vite-react-map-gl-deck-gl-template/"+e},a3={},eJ=function(t,n,s){let i=Promise.resolve();if(n&&n.length>0){let a=function(d){return Promise.all(d.map(g=>Promise.resolve(g).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),h=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));i=a(n.map(d=>{if(d=tJ(d),d in a3)return;a3[d]=!0;const g=d.endsWith(".css"),_=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${_}`))return;const m=document.createElement("link");if(m.rel=g?"stylesheet":QK,g||(m.as="script"),m.crossOrigin="",m.href=d,h&&m.setAttribute("nonce",h),document.head.appendChild(m),g)return new Promise((y,E)=>{m.addEventListener("load",y),m.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${d}`)))})}))}function r(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return i.then(a=>{for(const l of a||[])l.status==="rejected"&&r(l.reason);return t().catch(r)})},nJ=mt.createContext(null);function sJ(e,t){const n=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0,i=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0;return n===i&&s===r}function Us(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Us(e[n],t[n]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(const i of n)if(!t.hasOwnProperty(i)||!Us(e[i],t[i]))return!1;return!0}return!1}function c3(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function l3(e,t){const n=t.viewState||t,s={};if("longitude"in n&&"latitude"in n&&(n.longitude!==e.center.lng||n.latitude!==e.center.lat)){const i=e.center.constructor;s.center=new i(n.longitude,n.latitude)}return"zoom"in n&&n.zoom!==e.zoom&&(s.zoom=n.zoom),"bearing"in n&&n.bearing!==e.bearing&&(s.bearing=n.bearing),"pitch"in n&&n.pitch!==e.pitch&&(s.pitch=n.pitch),n.padding&&e.padding&&!Us(n.padding,e.padding)&&(s.padding=n.padding),s}const iJ=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function u3(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const s of e.layers)t[s.id]=s;const n=e.layers.map(s=>{let i=null;"interactive"in s&&(i=Object.assign({},s),delete i.interactive);const r=t[s.ref];if(r){i=i||Object.assign({},s),delete i.ref;for(const a of iJ)a in r&&(i[a]=r[a])}return i||s});return{...e,layers:n}}const h3={version:8,sources:{},layers:[]},f3={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},d3={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},g3={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},rJ=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],oJ=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Ka{constructor(t,n,s){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=i=>{const r=this.props[g3[i.type]];r?r(i):i.type==="error"&&console.error(i.error)},this._onCameraEvent=i=>{if(this._internalUpdate)return;i.viewState=this._propsedCameraUpdate||c3(this._map.transform);const r=this.props[d3[i.type]];r&&r(i)},this._onCameraUpdate=i=>this._internalUpdate?i:(this._propsedCameraUpdate=c3(i),l3(i,this.props)),this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const r=this.props[f3[i.type]];r&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),r(i),delete i.features)},this._MapClass=t,this.props=n,this._initialize(s)}get map(){return this._map}setProps(t){const n=this.props;this.props=t;const s=this._updateSettings(t,n),i=this._updateSize(t),r=this._updateViewState(t);this._updateStyle(t,n),this._updateStyleComponents(t),this._updateHandlers(t,n),(s||i||r&&!this._map.isMoving())&&this.redraw()}static reuse(t,n){const s=Ka.savedMaps.pop();if(!s)return null;const i=s.map,r=i.getContainer();for(n.className=r.className;r.childNodes.length>0;)n.appendChild(r.childNodes[0]);i._container=n;const a=i._resizeObserver;a&&(a.disconnect(),a.observe(n)),s.setProps({...t,styleDiffing:!1}),i.resize();const{initialViewState:l}=t;return l&&(l.bounds?i.fitBounds(l.bounds,{...l.fitBoundsOptions,duration:0}):s._updateViewState(l)),i.isStyleLoaded()?i.fire("load"):i.once("style.load",()=>i.fire("load")),i._update(),s}_initialize(t){const{props:n}=this,{mapStyle:s=h3}=n,i={...n,...n.initialViewState,container:t,style:u3(s)},r=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[r.longitude||0,r.latitude||0],zoom:r.zoom||0,pitch:r.pitch||0,bearing:r.bearing||0}),n.gl){const l=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=l,n.gl)}const a=new this._MapClass(i);r.padding&&a.setPadding(r.padding),n.cursor&&(a.getCanvas().style.cursor=n.cursor),a.transformCameraUpdate=this._onCameraUpdate,a.on("style.load",()=>{var l;this._styleComponents={light:a.getLight(),sky:a.getSky(),projection:(l=a.getProjection)==null?void 0:l.call(a),terrain:a.getTerrain()},this._updateStyleComponents(this.props)}),a.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const l in f3)a.on(l,this._onPointerEvent);for(const l in d3)a.on(l,this._onCameraEvent);for(const l in g3)a.on(l,this._onEvent);this._map=a}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),Ka.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_updateSize(t){const{viewState:n}=t;if(n){const s=this._map;if(n.width!==s.transform.width||n.height!==s.transform.height)return s.resize(),!0}return!1}_updateViewState(t){const n=this._map,s=n.transform;if(!n.isMoving()){const r=l3(s,t);if(Object.keys(r).length>0)return this._internalUpdate=!0,n.jumpTo(r),this._internalUpdate=!1,!0}return!1}_updateSettings(t,n){const s=this._map;let i=!1;for(const r of rJ)if(r in t&&!Us(t[r],n[r])){i=!0;const a=s[`set${r[0].toUpperCase()}${r.slice(1)}`];a==null||a.call(s,t[r])}return i}_updateStyle(t,n){if(t.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==n.mapStyle){const{mapStyle:s=h3,styleDiffing:i=!0}=t,r={diff:i};"localIdeographFontFamily"in t&&(r.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(u3(s),r)}}_updateStyleComponents({light:t,projection:n,sky:s,terrain:i}){var l,h;const r=this._map,a=this._styleComponents;r.style._loaded&&(t&&!Us(t,a.light)&&(a.light=t,r.setLight(t)),n&&!Us(n,a.projection)&&n!==((l=a.projection)==null?void 0:l.type)&&(a.projection=typeof n=="string"?{type:n}:n,(h=r.setProjection)==null||h.call(r,a.projection)),s&&!Us(s,a.sky)&&(a.sky=s,r.setSky(s)),i!==void 0&&!Us(i,a.terrain)&&(!i||r.getSource(i.source))&&(a.terrain=i,r.setTerrain(i)))}_updateHandlers(t,n){const s=this._map;for(const i of oJ){const r=t[i]??!0,a=n[i]??!0;Us(r,a)||(r?s[i].enable(r):s[i].disable())}}_queryRenderedFeatures(t){const n=this._map,{interactiveLayerIds:s=[]}=this.props;try{return n.queryRenderedFeatures(t,{layers:s.filter(n.getLayer.bind(n))})}catch{return[]}}_updateHover(t){var i;const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const r=t.type,a=((i=this._hoveredFeatures)==null?void 0:i.length)>0,l=this._queryRenderedFeatures(t.point),h=l.length>0;!h&&a&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=l,h&&!a&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=r}else this._hoveredFeatures=null}}Ka.savedMaps=[];const aJ=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function cJ(e){if(!e)return null;const t=e.map,n={getMap:()=>t};for(const s of lJ(t))!(s in n)&&!aJ.includes(s)&&(n[s]=t[s].bind(t));return n}function lJ(e){const t=new Set;let n=e;for(;n;){for(const s of Object.getOwnPropertyNames(n))s[0]!=="_"&&typeof e[s]=="function"&&s!=="fire"&&s!=="setEventedParent"&&t.add(s);n=Object.getPrototypeOf(n)}return Array.from(t)}const uJ=typeof document<"u"?mt.useLayoutEffect:mt.useEffect;function hJ(e,t){const{RTLTextPlugin:n,maxParallelImageRequests:s,workerCount:i,workerUrl:r}=t;if(n&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:a,lazy:l=!0}=typeof n=="string"?{pluginUrl:n}:n;e.setRTLTextPlugin(a,h=>{h&&console.error(h)},l)}s!==void 0&&e.setMaxParallelImageRequests(s),i!==void 0&&e.setWorkerCount(i),r!==void 0&&e.setWorkerUrl(r)}const Gd=mt.createContext(null);function fJ(e,t){const n=mt.useContext(nJ),[s,i]=mt.useState(null),r=mt.useRef(),{current:a}=mt.useRef({mapLib:null,map:null});mt.useEffect(()=>{const d=e.mapLib;let g=!0,_;return Promise.resolve(d||eJ(()=>import("./maplibre-gl-D4nQ15Do.js").then(m=>m.m),[])).then(m=>{if(!g)return;if(!m)throw new Error("Invalid mapLib");const y="Map"in m?m:m.default;if(!y.Map)throw new Error("Invalid mapLib");hJ(y,e),e.reuseMaps&&(_=Ka.reuse(e,r.current)),_||(_=new Ka(y.Map,e,r.current)),a.map=cJ(_),a.mapLib=y,i(_),n==null||n.onMapMount(a.map,e.id)}).catch(m=>{const{onError:y}=e;y?y({type:"error",target:null,originalEvent:null,error:m}):console.error(m)}),()=>{g=!1,_&&(n==null||n.onMapUnmount(e.id),e.reuseMaps?_.recycle():_.destroy())}},[]),uJ(()=>{s&&s.setProps(e)}),mt.useImperativeHandle(t,()=>a.map,[s]);const l=mt.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),h={height:"100%"};return mt.createElement("div",{id:e.id,ref:r,style:l},s&&mt.createElement(Gd.Provider,{value:a},mt.createElement("div",{"mapboxgl-children":"",style:h},e.children)))}const dJ=mt.forwardRef(fJ);var MM=y3();const gJ=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Si(e,t){if(!e||!t)return;const n=e.style;for(const s in t){const i=t[s];Number.isFinite(i)&&!gJ.test(s)?n[s]=`${i}px`:n[s]=i}}function wM(e,t){if(e===t)return null;const n=p3(e),s=p3(t),i=[];for(const r of s)n.has(r)||i.push(r);for(const r of n)s.has(r)||i.push(r);return i.length===0?null:i}function p3(e){return new Set(e?e.trim().split(/\s+/):[])}mt.memo(mt.forwardRef((e,t)=>{const{map:n,mapLib:s}=mt.useContext(Gd),i=mt.useRef({props:e}),r=mt.useMemo(()=>{let M=!1;mt.Children.forEach(e.children,x=>{x&&(M=!0)});const N={...e,element:M?document.createElement("div"):void 0},O=new s.Marker(N);return O.setLngLat([e.longitude,e.latitude]),O.getElement().addEventListener("click",x=>{var I,P;(P=(I=i.current.props).onClick)==null||P.call(I,{type:"click",target:O,originalEvent:x})}),O.on("dragstart",x=>{var P,J;const I=x;I.lngLat=r.getLngLat(),(J=(P=i.current.props).onDragStart)==null||J.call(P,I)}),O.on("drag",x=>{var P,J;const I=x;I.lngLat=r.getLngLat(),(J=(P=i.current.props).onDrag)==null||J.call(P,I)}),O.on("dragend",x=>{var P,J;const I=x;I.lngLat=r.getLngLat(),(J=(P=i.current.props).onDragEnd)==null||J.call(P,I)}),O},[]);mt.useEffect(()=>(r.addTo(n.getMap()),()=>{r.remove()}),[]);const{longitude:a,latitude:l,offset:h,style:d,draggable:g=!1,popup:_=null,rotation:m=0,rotationAlignment:y="auto",pitchAlignment:E="auto"}=e;mt.useEffect(()=>{Si(r.getElement(),d)},[d]),mt.useImperativeHandle(t,()=>r,[]);const b=i.current.props;(r.getLngLat().lng!==a||r.getLngLat().lat!==l)&&r.setLngLat([a,l]),h&&!sJ(r.getOffset(),h)&&r.setOffset(h),r.isDraggable()!==g&&r.setDraggable(g),r.getRotation()!==m&&r.setRotation(m),r.getRotationAlignment()!==y&&r.setRotationAlignment(y),r.getPitchAlignment()!==E&&r.setPitchAlignment(E),r.getPopup()!==_&&r.setPopup(_);const R=wM(b.className,e.className);if(R)for(const M of R)r.toggleClassName(M);return i.current.props=e,MM.createPortal(e.children,r.getElement())}));mt.memo(mt.forwardRef((e,t)=>{const{map:n,mapLib:s}=mt.useContext(Gd),i=mt.useMemo(()=>document.createElement("div"),[]),r=mt.useRef({props:e}),a=mt.useMemo(()=>{const l={...e},h=new s.Popup(l);return h.setLngLat([e.longitude,e.latitude]),h.once("open",d=>{var g,_;(_=(g=r.current.props).onOpen)==null||_.call(g,d)}),h},[]);if(mt.useEffect(()=>{const l=h=>{var d,g;(g=(d=r.current.props).onClose)==null||g.call(d,h)};return a.on("close",l),a.setDOMContent(i).addTo(n.getMap()),()=>{a.off("close",l),a.isOpen()&&a.remove()}},[]),mt.useEffect(()=>{Si(a.getElement(),e.style)},[e.style]),mt.useImperativeHandle(t,()=>a,[]),a.isOpen()){const l=r.current.props;(a.getLngLat().lng!==e.longitude||a.getLngLat().lat!==e.latitude)&&a.setLngLat([e.longitude,e.latitude]),e.offset&&!Us(l.offset,e.offset)&&a.setOffset(e.offset),(l.anchor!==e.anchor||l.maxWidth!==e.maxWidth)&&(a.options.anchor=e.anchor,a.setMaxWidth(e.maxWidth));const h=wM(l.className,e.className);if(h)for(const d of h)a.toggleClassName(d);r.current.props=e}return MM.createPortal(e.children,i)}));function Tr(e,t,n,s){const i=mt.useContext(Gd),r=mt.useMemo(()=>e(i),[]);return mt.useEffect(()=>{const a=t,l=null,h=typeof t=="function"?t:null,{map:d}=i;return d.hasControl(r)||(d.addControl(r,a==null?void 0:a.position),l&&l(i)),()=>{h&&h(i),d.hasControl(r)&&d.removeControl(r)}},[]),r}function pJ(e){const t=Tr(({mapLib:n})=>new n.AttributionControl(e),{position:e.position});return mt.useEffect(()=>{Si(t._container,e.style)},[e.style]),null}mt.memo(pJ);function _J(e){const t=Tr(({mapLib:n})=>new n.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return mt.useEffect(()=>{Si(t._controlContainer,e.style)},[e.style]),null}mt.memo(_J);function mJ(e,t){const n=mt.useRef({props:e}),s=Tr(({mapLib:i})=>{const r=new i.GeolocateControl(e),a=r._setupUI;return r._setupUI=()=>{r._container.hasChildNodes()||a()},r.on("geolocate",l=>{var h,d;(d=(h=n.current.props).onGeolocate)==null||d.call(h,l)}),r.on("error",l=>{var h,d;(d=(h=n.current.props).onError)==null||d.call(h,l)}),r.on("outofmaxbounds",l=>{var h,d;(d=(h=n.current.props).onOutOfMaxBounds)==null||d.call(h,l)}),r.on("trackuserlocationstart",l=>{var h,d;(d=(h=n.current.props).onTrackUserLocationStart)==null||d.call(h,l)}),r.on("trackuserlocationend",l=>{var h,d;(d=(h=n.current.props).onTrackUserLocationEnd)==null||d.call(h,l)}),r},{position:e.position});return n.current.props=e,mt.useImperativeHandle(t,()=>s,[]),mt.useEffect(()=>{Si(s._container,e.style)},[e.style]),null}mt.memo(mt.forwardRef(mJ));function AJ(e){const t=Tr(({mapLib:n})=>new n.NavigationControl(e),{position:e.position});return mt.useEffect(()=>{Si(t._container,e.style)},[e.style]),null}const yJ=mt.memo(AJ);function TJ(e){const t=Tr(({mapLib:r})=>new r.ScaleControl(e),{position:e.position}),n=mt.useRef(e),s=n.current;n.current=e;const{style:i}=e;return e.maxWidth!==void 0&&e.maxWidth!==s.maxWidth&&(t.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==s.unit&&t.setUnit(e.unit),mt.useEffect(()=>{Si(t._container,i)},[i]),null}mt.memo(TJ);function EJ(e){const t=Tr(({mapLib:n})=>new n.TerrainControl(e),{position:e.position});return mt.useEffect(()=>{Si(t._container,e.style)},[e.style]),null}mt.memo(EJ);function bJ(e){const t=Tr(({mapLib:n})=>new n.LogoControl(e),{position:e.position});return mt.useEffect(()=>{Si(t._container,e.style)},[e.style]),null}mt.memo(bJ);const T0=512,SJ=Math.PI/180;function OM({map:e,gl:t,deck:n}){if(e.__deck)return e.__deck;const s=n==null?void 0:n.props._customRender,i=n==null?void 0:n.props.onLoad,r=xM({...n==null?void 0:n.props,_customRender:()=>{e.triggerRepaint(),s==null||s("")}});let a;return(!n||n.props.gl===t)&&(Object.assign(r,{gl:t,width:null,height:null,touchAction:"unset",viewState:Yl(e)}),n!=null&&n.isInitialized?_3(n,e):r.onLoad=()=>{i==null||i(),_3(a,e)}),n?(a=n,n.setProps(r),n.userData.isExternal=!0):(a=new Vl(r),e.on("remove",()=>{BM(e)})),a.userData.mapboxLayers=new Set,e.__deck=a,e.on("render",()=>{a.isInitialized&&OJ(a,e)}),a}function _3(e,t){const n=()=>{e.isInitialized?BJ(e,t):t.off("move",n)};t.on("move",n)}function BM(e){var t;(t=e.__deck)==null||t.finalize(),e.__deck=null}function xM(e){return{...e,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...e.parameters},views:e.views||[new t1({id:"mapbox"})]}}function RJ(e,t){e.userData.mapboxLayers.add(t),L1(e)}function vJ(e,t){e.userData.mapboxLayers.delete(t),L1(e)}function CJ(e,t){L1(e)}function MJ(e,t,n){let{currentViewport:s}=e.userData,i=!1;s||(s=NM(e,t,!0),e.userData.currentViewport=s,i=!0),e.isInitialized&&e._drawLayers("mapbox-repaint",{viewports:[s],layerFilter:({layer:r})=>n.id===r.id||r.props.operation.includes("terrain"),clearStack:i,clearCanvas:!1})}function Yl(e){var i;const{lng:t,lat:n}=e.getCenter(),s={longitude:(t+540)%360-180,latitude:n,zoom:e.getZoom(),bearing:e.getBearing(),pitch:e.getPitch(),padding:e.getPadding(),repeat:e.getRenderWorldCopies()};return(i=e.getTerrain)!=null&&i.call(e)&&wJ(e,s),s}function wJ(e,t){if(e.getFreeCameraOptions){const{position:n}=e.getFreeCameraOptions();if(!n||n.z===void 0)return;const s=e.transform.height,{longitude:i,latitude:r,pitch:a}=t,l=n.x*T0,h=(1-n.y)*T0,d=n.z*T0,g=Ul([i,r]),_=l-g[0],m=h-g[1],y=Math.sqrt(_*_+m*m),E=a*SJ,b=1.5*s,R=E<.001?b*Math.cos(E)/d:b*Math.sin(E)/y;t.zoom=Math.log2(R);const M=b*Math.cos(E)/R,N=d-M;t.position=[0,0,N/Rf(r)]}else typeof e.transform.elevation=="number"&&(t.position=[0,0,e.transform.elevation])}function NM(e,t,n=!0){return new ro({id:"mapbox",x:0,y:0,width:e.width,height:e.height,...Yl(t),nearZMultiplier:n?.02:.1,nearZ:t.transform._nearZ/t.transform.height,farZ:t.transform._farZ/t.transform.height})}function OJ(e,t){const{mapboxLayers:n,isExternal:s}=e.userData;if(s){const i=Array.from(n,g=>g.id),a=Ha(e.props.layers,Boolean).some(g=>g&&!i.includes(g.id));let l=e.getViewports();const h=l.findIndex(g=>g.id==="mapbox"),d=l.length>1||h<0;(a||d)&&(h>=0&&(l=l.slice(),l[h]=NM(e,t,!1)),e._drawLayers("mapbox-repaint",{viewports:l,layerFilter:g=>(!e.props.layerFilter||e.props.layerFilter(g))&&(g.viewport.id!=="mapbox"||!i.includes(g.layer.id)),clearCanvas:!1}))}e.userData.currentViewport=null}function BJ(e,t){e.setProps({viewState:Yl(t)}),e.needsRedraw({clearRedrawFlags:!0})}function L1(e){if(e.userData.isExternal)return;const t=[];e.userData.mapboxLayers.forEach(n=>{const s=n.props.type,i=new s(n.props);t.push(i)}),e.setProps({layers:t})}class xJ{constructor(t){if(!t.id)throw new Error("Layer must have an unique id");this.id=t.id,this.type="custom",this.renderingMode=t.renderingMode||"3d",this.map=null,this.deck=null,this.props=t}onAdd(t,n){this.map=t,this.deck=OM({map:t,gl:n,deck:this.props.deck}),RJ(this.deck,this)}onRemove(){this.deck&&vJ(this.deck,this)}setProps(t){Object.assign(this.props,t,{id:this.id}),this.deck&&CJ(this.deck)}render(){MJ(this.deck,this.map,this)}}const E0="__UNDEFINED__";function yf(e,t,n,s){if(!e||!t||!e.style||!e.style._loaded)return;const i=Ha(s,Boolean);if(n!==s){const l=Ha(n,Boolean),h=new Set(l.map(d=>d.id));for(const d of i)h.delete(d.id);for(const d of h)e.getLayer(d)&&e.removeLayer(d)}for(const l of i){const h=e.getLayer(l.id);h?(h.implementation||h).setProps(l.props):e.addLayer(new xJ({id:l.id,deck:t}),l.props.beforeId)}const r=e.style._order,a={};for(const l of i){let{beforeId:h}=l.props;(!h||!r.includes(h))&&(h=E0),a[h]=a[h]||[],a[h].push(l.id)}for(const l in a){const h=a[l];let d=l===E0?r.length:r.indexOf(l),g=l===E0?void 0:l;for(let _=h.length-1;_>=0;_--){const m=h[_],y=r.indexOf(m);y!==d-1&&(e.moveLayer(m,g),y>d&&d++),d--,g=m}}}class NJ{constructor(t){this._handleStyleChange=()=>{yf(this._map,this._deck,this._props.layers,this._props.layers)},this._updateContainerSize=()=>{if(this._map&&this._container){const{clientWidth:i,clientHeight:r}=this._map.getContainer();Object.assign(this._container.style,{width:`${i}px`,height:`${r}px`})}},this._updateViewState=()=>{const i=this._deck;i&&(i.setProps({viewState:Yl(this._map)}),i.isInitialized&&i.redraw())},this._handleMouseEvent=i=>{const r=this._deck;if(!r||!r.isInitialized)return;const a={type:i.type,offsetCenter:i.point,srcEvent:i},l=this._lastMouseDownPoint;switch(!i.point&&l&&(a.deltaX=i.originalEvent.clientX-l.clientX,a.deltaY=i.originalEvent.clientY-l.clientY,a.offsetCenter={x:l.x+a.deltaX,y:l.y+a.deltaY}),a.type){case"mousedown":r._onPointerDown(a),this._lastMouseDownPoint={...i.point,clientX:i.originalEvent.clientX,clientY:i.originalEvent.clientY};break;case"dragstart":a.type="panstart",r._onEvent(a);break;case"drag":a.type="panmove",r._onEvent(a);break;case"dragend":a.type="panend",r._onEvent(a);break;case"click":a.tapCount=1,r._onEvent(a);break;case"dblclick":a.type="click",a.tapCount=2,r._onEvent(a);break;case"mousemove":a.type="pointermove",r._onPointerMove(a);break;case"mouseout":a.type="pointerleave",r._onPointerMove(a);break;default:return}};const{interleaved:n=!1,...s}=t;this._interleaved=n,this._props=s}setProps(t){this._interleaved&&t.layers&&yf(this._map,this._deck,this._props.layers,t.layers),Object.assign(this._props,t),this._deck&&this._deck.setProps(this._interleaved?xM(this._props):this._props)}onAdd(t){return this._map=t,this._interleaved?this._onAddInterleaved(t):this._onAddOverlaid(t)}_onAddOverlaid(t){const n=document.createElement("div");return Object.assign(n.style,{position:"absolute",left:0,top:0,textAlign:"initial",pointerEvents:"none"}),this._container=n,this._deck=new Vl({...this._props,parent:n,viewState:Yl(t)}),t.on("resize",this._updateContainerSize),t.on("render",this._updateViewState),t.on("mousedown",this._handleMouseEvent),t.on("dragstart",this._handleMouseEvent),t.on("drag",this._handleMouseEvent),t.on("dragend",this._handleMouseEvent),t.on("mousemove",this._handleMouseEvent),t.on("mouseout",this._handleMouseEvent),t.on("click",this._handleMouseEvent),t.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),n}_onAddInterleaved(t){const n=t.painter.context.gl;return n instanceof WebGLRenderingContext&&kt.warn("Incompatible basemap library. See: https://deck.gl/docs/api-reference/mapbox/overview#compatibility")(),this._deck=OM({map:t,gl:n,deck:new Vl({...this._props,gl:n})}),t.on("styledata",this._handleStyleChange),yf(t,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){const t=this._map;t&&(this._interleaved?this._onRemoveInterleaved(t):this._onRemoveOverlaid(t)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(t){var n;t.off("resize",this._updateContainerSize),t.off("render",this._updateViewState),t.off("mousedown",this._handleMouseEvent),t.off("dragstart",this._handleMouseEvent),t.off("drag",this._handleMouseEvent),t.off("dragend",this._handleMouseEvent),t.off("mousemove",this._handleMouseEvent),t.off("mouseout",this._handleMouseEvent),t.off("click",this._handleMouseEvent),t.off("dblclick",this._handleMouseEvent),(n=this._deck)==null||n.finalize()}_onRemoveInterleaved(t){t.off("styledata",this._handleStyleChange),yf(t,this._deck,this._props.layers,[]),BM(t)}getDefaultPosition(){return"top-left"}pickObject(t){return Be(this._deck),this._deck.pickObject(t)}pickMultipleObjects(t){return Be(this._deck),this._deck.pickMultipleObjects(t)}pickObjects(t){return Be(this._deck),this._deck.pickObjects(t)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}}function IJ(){const e=i=>(Tr(()=>new NJ(i)).setProps(i),null),n=[new dd({id:"nagasaki-point-cloud-layer",type:typeof dd,pointSize:1.6,data:"https://smb.optgeo.org/ipfs/QmdAr2FWQKCVv7CAcLRuTBt1583Qi7DA4gaA92g3ujeL1v/tileset.json",loaders:[U1]})],s={longitude:129.339,latitude:33.0124,zoom:9,pitch:60,bearing:0};return pi.jsx(pi.Fragment,{children:pi.jsxs("main",{children:[pi.jsx("h1",{children:'"Nagasaki Point Cloud" by deck.gl + react-map-gl'}),pi.jsxs(dJ,{mapStyle:"https://tile.openstreetmap.jp/styles/osm-bright-en/style.json",attributionControl:{compact:!0},maxZoom:22,maxPitch:85,scrollZoom:!0,dragPan:!0,dragRotate:!0,hash:!0,initialViewState:s,children:[pi.jsx(e,{layers:n}),pi.jsx(yJ,{position:"top-right",visualizePitch:!0,showZoom:!0,showCompass:!0})]})]})})}GO.createRoot(document.getElementById("root")).render(pi.jsx(kO.StrictMode,{children:pi.jsx(IJ,{})}));export{Nm as g};
